---
title: '[!DNL Cloud Automation Patching Service (CAPS)]疑难解答指南'
description: 对 [!DNL Cloud Automation Patching Service (CAPS)]中的常见问题和错误消息进行故障诊断
hide: true
hidefromtoc: true
source-git-commit: eff8c0ae9e1d9db6b46ba7cfbb915685ab5b194d
workflow-type: tm+mt
source-wordcount: '946'
ht-degree: 0%

---

# [!DNL Cloud Automation Patching Service (CAPS)]疑难解答指南

使用[!DNL CAPS]进行修补程序操作时，可能会遇到错误消息和问题，这些消息和问题可能会阻止修补程序应用程序成功或进行反向。 本指南为最常见的问题提供了解决方案。

## 快速疑难解答步骤

### 如果修补操作失败

* 检查操作状态以了解哪个阶段失败
* 查看特定失败原因的错误消息
* 检查错误日志以了解技术详细信息
* 遵循本指南中提供的解决方案

### 修补程序操作持续时间

对于大多数环境，以下时间线描述了修补操作需要多长时间，但具体时间长短取决于环境大小和复杂性：

* **预处理：** 2-5分钟
* **正在修补：** 5-15分钟
* **后处理：** 10-40分钟
* **总计：** 15-60分钟

### 取消正在进行的修补程序

>[!WARNING]
>
>修补程序操作开始后，应允许它完成。 该系统包括即使操作失败也运行的清理过程。 中断进程可能会使您的环境处于不一致的状态。

## 常见成功消息

* **“作业已成功完成”** — 修补程序已成功应用/还原，没有任何问题。

* **“已应用修补程序”** — 您正在尝试应用已应用的修补程序。 系统检测到您的环境中已存在该修补程序。 无需执行任何操作。

* **“修补程序已还原”** — 您正在尝试还原已还原的修补程序。 系统检测到当前未应用修补程序。 无需执行任何操作。

## 常见错误消息和解决方案

### 修补应用程序错误

#### “无法应用修补程序，因为[!DNL CAPS]检测到您的代码库或修补程序文件存在这些问题”

**发生时间：**&#x200B;初步检查期间

**原因：**&#x200B;修补程序与当前代码库冲突，或者修补程序本身有问题

**解决方案：**

* 查看提供的详细错误日志，确定是代码库问题还是修补程序问题
* 检查代码中是否存在冲突的自定义项
* 验证该修补程序是否与您的Adobe Commerce版本兼容
* 考虑手动解决冲突或联系支持人员

#### “此修补程序不是由[!DNL CAPS]管理的。 无法还原”

**发生时间：**&#x200B;还原操作期间

**原因：**&#x200B;您正在尝试还原未通过[!DNL CAPS]应用的修补程序

**解决方案：**&#x200B;使用最初用于应用修补程序的方法，或者与支持人员联系以获得手动帮助

### 环境和验证错误

#### “环境与父环境不同步”

**发生时间：**&#x200B;验证期间

**原因：**&#x200B;您的集成环境与父环境不同

**解决方案：**

* 将您的环境与父分支同步
* 重试修补操作
* 如果同步问题仍然存在，请联系支持人员

#### “未满足生产环境保护要求”

**发生时间：**&#x200B;在生产环境的初步检查期间

**原因：**&#x200B;生产环境不符合所需的安全条件

**解决方案：**

* 为生产存储启用维护模式
* 在生产环境中禁用cron作业
* 重试之前验证是否同时满足两个条件

>[!IMPORTANT]
>
> [!DNL CAPS]不会自动启用维护模式或禁用cron作业 — 这些作业必须由您在外部完成

#### “已应用修补程序，但运行状况检查失败。 请考虑恢复”

**发生时：**&#x200B;在验证期间修补应用程序之后

**原因：**&#x200B;已成功应用修补程序，但运行状况检查失败

**解决方案：**

* 查看应用程序日志以查看特定错误
* 手动测试关键功能
* 如果问题仍然存在，请考虑恢复修补程序
* 如果您需要帮助，请联系支持人员

### 身份验证和访问错误

#### “Adobe Commerce存储库身份验证失败”

**发生时间：**&#x200B;在任何阶段

**原因：** Adobe Commerce存储库凭据无效或过期

**解决方案：**

解决此问题的建议选项有两种：

**选项1：修复`env:COMPOSER_AUTH`环境级别变量（推荐）**

* 确保您为`env:COMPOSER_AUTH`设置了正确的凭据。
* 通过单击云项目UI左上角的齿轮图标访问全局配置，然后选择&#x200B;**变量**&#x200B;选项卡。
* 确保选择&#x200B;_在生成时间_&#x200B;期间可用，并取消选择&#x200B;_在运行时_&#x200B;期间可用。

如果选项1不能解决您的问题，请继续执行选项2。

**选项2：手动创建和部署`auth.json`文件**

* 通过SSH连接到服务器。
* 使用以下方式检索当前`env:COMPOSER_AUTH`变量的内容：\
  `echo $COMPOSER_AUTH`
* 复制上述步骤的所有内容（以JSON格式）。
* 使用这些内容创建一个名为`auth.json`的新文件。
* 将此新创建的`auth.json`文件提交到存储库的根目录。
* 触发新部署。

#### “环境访问权限不足”

**发生时：**&#x200B;环境创建或访问期间

**原因：**&#x200B;您的用户帐户缺少必要的权限

**解决方案：**

* 检查您的用户角色和权限
* 联系您的系统管理员
* 验证您是否具有环境管理权限
* 确保您具有部署权限

### 资源和配额错误

#### “超出环境配额”

**发生时间：**&#x200B;环境创建期间

**原因：**&#x200B;您已达到环境限制

**解决方案：**

* 停用未使用的环境
* 清理旧分支和部署
* 联系支持人员以请求增加配额
* 考虑升级您的计划

#### “操作资源不足”

**发生时间：**&#x200B;在任何阶段

**原因：**&#x200B;您的环境缺少足够的CPU、内存或存储空间

**解决方案：**

* 检查您的环境资源使用情况
* 通过清除文件释放资源
* 等待资源变为可用
* 如果资源问题仍然存在，请联系支持人员

## 获取帮助

**何时联系支持人员：**

在以下情况下联系Adobe Commerce云支持：

* 错误消息不明确或缺少足够的详细信息
* 修补程序操作始终失败
* 您需要手动冲突解决方面的帮助
* 运行状况检查失败，但原因不明
* 您需要有关环境同步问题的帮助

**要提供的信息：**

在联系支持人员时，提供：

* **项目ID** — 您的Adobe Commerce Cloud项目标识符
* **环境ID** — 发生问题的特定环境
* **操作ID** - [!DNL CAPS]操作标识符
* **错误详细信息** — 完整的错误消息和日志
* **重现问题的步骤** — 发生错误时您正在做什么
* **以前的尝试** — 您已经尝试解决此问题的内容

### 其他资源

有关更详细的技术信息：

* 查看随失败操作提供的完整错误日志
* 有关特定于修补程序的指南，请查看Adobe Commerce文档
* 有关特定于环境的问题，请联系Adobe Commerce云支持

### 相关主题

* [Adobe Commerce Cloud文档](https://experienceleague.adobe.com/en/docs/commerce-cloud-service/user-guide/overview.html)
* [Adobe Commerce安装指南](https://experienceleague.adobe.com/en/docs/commerce-operations/installation-guide/overview.html)
* [CAPS介绍](intro.md)
* [如何访问](access.md)
* [工作流](workflow.md)
* [最佳实践](best-practices.md)
