---
title: ACSD-68190：在GraphQL购物车视图中删除优惠券后未正确应用和移除的折扣
description: 应用ACSD-68190修补程序以解决以下问题：“removeCouponFromCart”删除所有折扣（包括非优惠券折扣），而不仅仅是优惠券折扣。
feature: GraphQL, Checkout, Price Rules
role: Admin, Developer
type: Troubleshooting
source-git-commit: 6001c9c04ea198697ad3aea19bef24cd4576f6f1
workflow-type: tm+mt
source-wordcount: '429'
ht-degree: 0%

---


# ACSD-68190：在[!DNL GraphQL]购物车视图中删除优惠券后未正确应用和删除折扣

ACSD-68190修补程序修复了以下问题：折扣不适用，[!DNL GraphQL]购物车查看响应中无法正确显示应用的折扣，以及在删除优惠券折扣时删除非优惠券折扣。 安装[[!DNL Quality Patches Tool (QPT)]](/help/tools/quality-patches-tool/quality-patches-tool-to-self-serve-quality-patches.md) 1.1.73时，此修补程序可用。 修补程序ID为ACSD-68190。 请注意，此问题计划在Adobe Commerce 2.4.8中修复。

## 受影响的产品和版本

**为Adobe Commerce版本创建了修补程序：**

* Adobe Commerce（所有部署方法） 2.4.6-p3

**与Adobe Commerce版本兼容：**

* Adobe Commerce（所有部署方法） 2.4.4 - 2.4.6-p13

>[!NOTE]
>
>该修补程序可能适用于具有新[!DNL Quality Patches Tool]发行版本的其他版本。 要检查修补程序是否与您的Adobe Commerce版本兼容，请将`magento/quality-patches`包更新到最新版本，并在[[!DNL Quality Patches Tool]：搜索修补程序页面](https://experienceleague.adobe.com/tools/commerce-quality-patches/index.html)上检查兼容性。 使用修补程序ID作为搜索关键字来查找修补程序。

## 问题

折扣不适用，应用的折扣未正确显示在[!DNL GraphQL]购物车查看响应中，并且删除优惠券折扣时移除了非优惠券折扣。

<u>重现步骤</u>：

1. 创建以下类别树：
   1. 新建根类别
      1. category1 
         1. 子类别1.1
1. 转到&#x200B;**[!UICONTROL Stores]** > **[!UICONTROL Stores]**，并将新创建的根类别分配给您的存储。
1. 创建新产品并将其分配给category1。
1. 创建适用于category1的规则1（无需优惠券）。
1. 将“放弃后续规则”设置为“否”。
1. 创建规则2（需要特定优惠券）。
1. 将“放弃后续规则”设置为“否”
1. 创建客户。
1. 使用[!DNL GraphQL]获取客户令牌。
1. 使用[!DNL GraphQL]将产品添加到购物车。
1. 检查最初是否不应用规则1（非优惠券折扣）。
1. 使用[!DNL GraphQL] `applyCouponToCart`突变应用优惠券。
1. 验证规则1和规则2折扣现在是否均适用。
1. 使用[!DNL GraphQL] `removeCouponFromCart`突变删除优惠券。

<u>预期的结果</u>：

只应删除优惠券折扣；非优惠券折扣应保持不变。
非优惠券折扣（规则1）仍应用于购物车。

<u>实际结果</u>：

使用removeCouponFromCart时会删除所有折扣。
购物车响应未显示应用折扣，即使非优惠券折扣仍应有效。

## 应用修补程序

要应用单独的修补程序，请根据您的部署方法使用以下链接：

* Adobe Commerce或Magento Open Source内部部署： [[!DNL Quality Patches Tool] 指南中的](/help/tools/quality-patches-tool/usage.md)>使用情况[!DNL Quality Patches Tool]。
* 云基础架构上的Adobe Commerce：云基础架构上的Commerce指南中的[升级和修补程序>应用修补程序](https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/develop/upgrade/apply-patches.html)。

## 相关阅读

要了解有关[!DNL Quality Patches Tool]的更多信息，请参阅：

* [[!DNL Quality Patches Tool]： “工具”指南中用于高质量修补程序的](/help/tools/quality-patches-tool/quality-patches-tool-to-self-serve-quality-patches.md)的自助服务工具。
