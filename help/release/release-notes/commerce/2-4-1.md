---
title: Adobe Commerce 2.4.1发行说明
description: 了解2.4.1 Adobe Commerce版本中的新增功能、增强功能、错误修复和已知问题。
exl-id: 230df894-2347-4d68-8386-d0f0e40c2659
source-git-commit: 55e0e688999c47f72593df46648609d9f9f98398
workflow-type: tm+mt
source-wordcount: '16721'
ht-degree: 0%

---

# Adobe Commerce 2.4.1发行说明

Adobe Commerce 2.4.1在性能和安全性方面进行了增强，并且对B2B功能集进行了重大补充。 安全增强功能包括支持 `SameSite` 属性，为支付相关和订单相关API端点以及下单店面页面添加了CAPTCHA保护。 B2B改进侧重于订单审批流程、B2B送货方法、扩展的管理员操作日志记录以及增强店面安全性。

此版本包括2.4.0中包含的所有核心质量改进、对核心代码的150多项新修复以及超过15项安全增强。 其中包括我们的社区成员解决近300个GitHub问题。 这些社区贡献的内容涵盖从对核心代码进行次要清理到GraphQL中的重大增强功能。

2.4.0中识别的所有已知问题都已在此版本中修复。

{{bics}}

## 应用 `AC-3022.patch` 继续提供DHL作为运输承运商

DHL已引入了架构版本6.2，并且将在不久的将来弃用架构版本6.0。 支持DHL集成的Adobe Commerce 2.4.4及更早版本仅支持版本6.0。部署这些版本的商家应适用 `AC-3022.patch` 尽早继续提供DHL作为运输承运商。 请参阅 [应用补丁以继续将DHL作为运输承运人](https://support.magento.com/hc/en-us/articles/7707818131597-Apply-a-patch-to-continue-offering-DHL-as-shipping-carrier) 知识库文章，了解有关下载和安装修补程序的信息。

## 安全补丁可用

商家现在可以安装时效性安全修复，而无需应用完整季度版本（例如2.4.0-p1）提供的数百个功能修复和增强功能。 修补程序2.4.0.1（Composer包2.4.0-p1）是一个安全修补程序，针对我们以前的季度版本2.4.0中发现的漏洞提供修复。此安全修补程序中包含应用于2.4.0版本的所有修补程序。 (A) *热修复* 提供了对已发布版本的修复，该版本可解决特定问题或错误。)

有关安全修补程序的一般信息，请参见 [引入新的安全修补程序版本](https://community.magento.com/t5/Magento-DevBlog/Introducing-the-New-Security-Patch-Release/ba-p/141287). 有关下载和应用安全修补程序（包括修补程序2.3.5-p2）的说明，请参阅 [快速启动内部部署](../../../installation/composer.md). 安全修补程序仅包括安全错误修复，而不包括完整修补程序中包含的其他安全增强功能。

## 其他发行信息

虽然这些功能的代码与季度版本捆绑在一起，但其中几个项目(例如B2B、Page Builder和Progressive Web Application(PWA)Studio)也单独发布。 每个项目的文档中都提供了特定于项目的单独发行信息，其中记录了这些项目的错误修复。

## 亮点

在此版本中查找以下亮点。

### 显着的安全增强功能

此版本包括15项以上的安全修复和平台安全改进。 所有安全修复均已反向移植到2.4.0-p1和2.3.6。

#### 提供了超过15项安全增强功能，有助于消除远程代码执行(RCE)和跨站点脚本(XSS)漏洞

到目前为止，尚未发生任何与这些问题相关的已确认攻击。 但是，可能会攻击某些漏洞以访问客户信息或接管管理员会话。 这些问题中的大多数要求攻击者首先获得对管理员的访问权限。 因此，我们提醒您采取一切必要步骤保护您的管理员，包括但不限于以下工作：IP列入允许列表、 [双重身份验证](https://devdocs.magento.com/guides/v2.4/security/two-factor-authentication.html)，使用VPN，使用唯一位置而不是 `/admin`和良好的密码卫生。 参见 [可用于Magento的安全更新](https://helpx.adobe.com/security/products/magento/apsb20-59.html) 以讨论这些修复的问题。

#### 其他安全增强功能

此版本的安全性改进包括：

* **验证码** 保护已添加到以下产品区域：

   * 下单店面页以及REST和GraphQL端点 <!-- MC-36067-->
   * 与支付相关的REST和GraphQL端点。<!-- MC-36064-->

   默认情况下，这些附加页面的验证码保护处于禁用状态。 在管理员中启用该功能，其方式与验证码涵盖的其他页面相同。 此保护已添加为反暴力机制，以保护商店免受梳理攻击。 参见 [验证码](https://docs.magento.com/user-guide/stores/security-captcha.html).

* **支持Cookie的SameSite属性**. 为了支持新的Cookie分类系统的Google Chrome实施，已更新处理Cookie的应用程序类以支持 `SameSite` Cookie属性。 此属性设置为 `Lax` 默认情况下，但可以显式覆盖。 <!-- MC-35389-->

* **增强的安全扫描工具**. Adobe已与 [Sanguine Security](https://sansec.io/)在防止数字泄露方面处于领先地位，可将其8700多个威胁签名数据库集成到安全扫描工具中。 通过这种合作关系，商家能够通过主动检测恶意软件并减少误报，实时了解其网站的安全状态。 商家可以通过访问 `https://account.magento.com/scanner`. 欲了解更多信息，请参见 [使用增强的安全扫描工具保护您的店面](https://magento.com/blog/magento-news/secure-your-storefront-enhanced-magento-security-scan-tool) 博客帖子。

{{cve-notice}}

### 基础架构改进

此版本包含对核心质量的增强，这些改进改进了Framework和以下功能区域的质量：客户帐户、目录、CMS、OMS、导入/导出、促销和定位、购物车和结账、B2B以及暂存和预览。

* **网站范围分析工具与管理员集成**. 此 [工具](https://docs.magento.com/user-guide/reports/site-wide-analysis-tool.html) 借助全天候实时性能监控、报告和自助服务建议，为云基础架构安装上的Adobe提供系统洞察和检测工具。 商家可以使用新的管理员 [角色资源](https://docs.magento.com/user-guide/system/permissions-role-resources.html) 以通过管理员安全地访问其Customer Detail页面。 请参阅 [常见问题解答](https://support.magento.com/hc/en-us/articles/360048646671) 了解概述。 <!-- SWAT-807-->

### 性能改进

* **减少Redis和Magento之间的网络传输量**. 现在，插件列表配置是在执行 `bin/magento di:compile` 命令。 此配置信息将根据作用域写入生成的元数据文件夹。 以前，此信息存储在缓存中。 由此带来的性能改进包括减少网络缓存大小和执行时间（在许多情况下）。<!-- MC-31617-->

* **增强的消息队列使用者性能**. 三个新的配置设置支持减少使用者队列CPU消耗。 这些可选参数可增强对使用者的控制并节省服务器资源。 参见 [配置消息队列](https://developer.adobe.com/commerce/php/development/components/message-queues/configuration/) 以了解 `maxIdleTime`， `sleep`、和 `onlySpawnWhenMessageAvailable` 参数。

* **改进了执行时间** 对象 `bin/magento` 命令。

### Adobe Stock集成

此版本包括Adobe Stock集成v2.1.0。

### 新建媒体集

现在，管理员中默认启用新媒体集。 商家现在可以对媒体集中的图像执行以下操作：

* 批量删除图像
* 通过识别店面未使用的重复图像和图像优化媒体存储
* 按图像使用的店面区域筛选图像，包括产品和类别内容以及CMS块
* 使用图像元数据
   * 查看上传到媒体集的图像中的元数据
   * 编辑图像元数据（标题、描述和关键词）
   * 按图像的元数据搜索图像

### 页面生成器

Page Builder现在支持全屏模式，该模式支持更轻松地编辑内容，并为管理员编辑内容提供一致的体验。 参见 [工作区](https://docs.magento.com/user-guide/cms/page-builder-workspace.html). <!-- PB-543-->

### GraphQL

此版本添加了GraphQL对以下功能的覆盖：

* **产品评论**. 客户和嘉宾可以撰写产品评论。 客户可以检索其产品审查历史记录。 参见 [创建产品评论](https://devdocs.magento.com/guides/v2.4/graphql/mutations/create-product-review.html) 和 [productReviewRatingsMetadata查询](https://devdocs.magento.com/guides/v2.4/graphql/queries/product-review-ratings-metadata.html) 有关检索有关审阅基础架构的信息。<!-- MC-32349-->

* **赠品选项**. 所有客户和来宾都可以在订单中添加礼品消息。 在Adobe Commerce安装中，他们还可以将礼品包装、礼品收据和打印卡添加到订单中。 参见 [`setGiftOptionsOnCart` 变异](https://devdocs.magento.com/guides/v2.4/graphql/mutations/set-gift-options.html) 和 [`updateCartItems` 变异](https://devdocs.magento.com/guides/v2.4/graphql/mutations/update-cart-items.html) <!-- MC-32345-->

* **奖励积分**. 客户可以在购物车上申请或删除奖励积分。 他们还可以查看自己的奖励积分历史。 参见 [`applyRewardPointsToCart`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/apply-reward-points.html) 和 [`removeRewardPointsFromCart`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/remove-reward-points.html) 有关管理购物车中的奖励积分的讨论。<!-- MC-23366-->

* **订单历史记录**. 所有客户都可以查看有关其订单历史记录的详细信息，包括发票、发运和退款。<!-- MC-20635-->

* **添加到购物车**. 此 [`addProductsToCart` 变异](https://devdocs.magento.com/guides/v2.4/graphql/mutations/add-products-to-cart.html) 允许您将任何类型的产品添加到活动购物车。 我们建议使用这种突变而不是单一目的突变，例如 `addSimpleProductsToCart`. _Yaroslav Rogoza在拉取请求中提交的修复 [27914](https://github.com/magento/magento2/pull/27914)_. [GitHub-28524](https://github.com/magento/magento2/issues/28524)  <!-- MC-21513-->

* **存储的支付方式**. 登录客户现在可以将付款详细信息(包括Braintree信用卡和使用PayPal的Braintree)存储在“我的帐户”中。 <!-- MC-32348 35945 35946-->

* **在Magento Open Source中支持愿望清单**.  您可以 [添加项目](https://devdocs.magento.com/guides/v2.4/graphql/mutations/add-products-to-wishlist.html) 到， [更新项目](https://devdocs.magento.com/guides/v2.4/graphql/mutations/update-products-in-wishlist.html) 在中，和 [删除项目](https://devdocs.magento.com/guides/v2.4/graphql/mutations/remove-products-from-wishlist.html) 来自一个愿望清单。

* **改进了对客户帐户的管理**. 我们已添加 [`createCustomerV2`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/create-customer-v2.html) 和 [`updateCustomerV2`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/update-customer-v2.html) 管理客户帐户的变体。 这些新的突变需要不同的输入对象 `createCustomer` 和 `updateCustomer` 突变。 要更改客户的电子邮件地址，请使用新的 [`updateCustomerEmail`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/update-customer-email.html) 突变。

* **支持Payflow Pro Vault**. 为添加了GraphQL Vault支持 [Payflow Pro Vault](https://devdocs.magento.com/guides/v2.4/graphql/payment-methods/payflow-pro-vault.html) 付款方式。 _Oleh Usik在拉取请求中提交的修复 [28821](https://github.com/magento/magento2/pull/28821)_. [GitHub-28520](https://github.com/magento/magento2/issues/28520)

* 更新了GraphQL [`storeConfig` 查询](https://devdocs.magento.com/guides/v2.4/graphql/queries/store-config.html) 以包含新的客户配置设置。 _Oleh Usik在拉取请求中提交的修复 [27876](https://github.com/magento/magento2/pull/27876)_. [GitHub-28521](https://github.com/magento/magento2/issues/28521)

* 添加了 [`requestPasswordResetEmail` 变异](https://devdocs.magento.com/guides/v2.4/graphql/mutations/request-password-reset-email.html)，它会触发所提供电子邮件地址的密码重置电子邮件。 _Oleh Usik在拉取请求中提交的修复 [27876](https://github.com/magento/magento2/pull/27876)_. [GitHub-28521](https://github.com/magento/magento2/issues/28521)

* **克拉娜·GraphQL**. 在中添加或更新了关于GraphQL韩语的主题 [克拉尔纳的支付方式](https://devdocs.magento.com/guides/v2.4/graphql/payment-methods/klarna.html) 和 [`createKlarnaPaymentsSession`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/create-klarna-payments-session.html)

请参阅 [GraphQL开发人员指南](https://devdocs.magento.com/guides/v2.4/graphql/) 以了解有关这些增强功能的详细信息。

### PWA Studio

PWA Studiov8.0.0引入了以下新增功能和增强功能：

* 对适用于设计令牌、排版规则、颜色、核心组件和页面布局的Venia样式指南进行了更新 <!-- PWA-519 419-->

* 对Venia迷你购物车体验的改进 <!-- PWA-236-->

* 对Venia店面的多个区域设置和本地化内容的初始支持 <!-- PWA-295-->

* 对Venia店面的MyAccount体验进行了多项改进 <!-- PWA-247-->

参见 [兼容性](https://developer.adobe.com/commerce/pwa-studio/integrations/adobe-commerce/version-compatibility/) PWA Studio版本及其兼容版本的列表。 有关增强功能和错误修复的信息，请参阅 [PWA Studio版本](https://github.com/magento/pwa-studio/releases).

### B2B

版本2.4.1引入了B2B v1.3.0。此版本包括对订单审批、配送方式、购物车和管理员操作日志记录进行了改进。

#### 订单审批改进

B2B订单审批已得到增强，以提高可用性并允许对采购订单执行批量操作。
对订单批准和拒绝的改进包括以下内容：

* **对于没有编辑权限的用户，新增了“查看规则”页**. B2B购买者现在可以在新的“查看规则”页面上查看适用于其公司的规则（如果他们无权编辑这些规则）。 <!-- BUNDLE-104 -->

* **“需要我的审批”选项卡上的计数警报图标**. “我的采购订单”视图中的“需要我的审批”标签现在显示一个计数器，指示待定审批活动的数量。 <!-- BUNDLE-102 -->

* **批量订单审批和拒绝**. B2B经理和公司管理员现在可以批量拒绝和批准采购订单。 这些更改允许审批人在一次操作中批准或拒绝多个采购订单。 <!-- BUNDLE-140 128 111 153 -->

* 商家现在可以搜索 **应用于** 和 **需要获得批准** “我的采购订单”视图中的字段，您可以在规则创建期间选择多个用户角色。 <!-- BUNDLE-105 106-->

* “规则配置”页面上提供了如何配置订单批准规则的示例。 <!-- BUNDLE-103 -->

参见 [审批规则](https://docs.magento.com/user-guide/customers/account-dashboard-approval-rules.html)

#### B2B配送方式增强功能

B2B商家现在可以控制提供给每家公司的配送方式。 商家可以从管理员配置以下内容：<!-- BUNDLE-160 161 162 -->

* B2B公司帐户的一组特定配送方式
* 对每个公司帐户使用“全部”或B2B特定的配送方式
* 每个公司帐户的B2B配送方式的特定列表

#### 购物车改进

* 商家现在可以允许用户在一次操作中清除其购物车的内容，并可以在每个网站上独立配置此功能。 <!-- BUNDLE-108 -->

* B2B购买者现在可以将单个项目或其购物车的全部内容直接添加到申请列表。 <!-- BUNDLE-145 144-->

#### 新的管理员功能

* B2B商户可以从管理员代表客户创建订单，使用分期付款作为付款方式。 <!-- BUNDLE-166 178-->
* 商户现在可以从客户的详细信息页面直接查看与用户关联的所有报价。 <!-- BUNDLE-139 -->
* 商户现在可以按公司筛选“Customers Now Online”网格。 <!-- BUNDLE-137 -->
* 管理员现在可以在Admin中按销售代表筛选客户。 <!-- BUNDLE-110 -->

参见 [B2B功能](https://docs.magento.com/user-guide/configuration/general/b2b-features.html).

#### 增强店面安全性

为了减少诈骗或垃圾邮件帐户的创建，商家现在可以在店面的新公司申请表上启用Google reCAPTCHA。 参见 [reCAPTCHA](https://docs.magento.com/user-guide/configuration/security/google-recaptcha-storefront.html).<!-- BUNDLE-154 -->

#### 扩展了管理员操作的日志记录

在公司模块中执行的管理员操作现在记录在管理员操作日志中。 从所有相关公司模块记录操作： `Company`， `NegotiableQuote`， `CompanyCredit`， `SharedCatalog`.
<!-- BUNDLE-180 181 182 183 -->

此版本还包括多个错误修复。 参见 [B2B发行说明](https://experienceleague.adobe.com/docs/commerce-admin/b2b/release-notes.html).

### 功能测试框架(MFTF)

MFTF 3.1.0现已可用。 参见 [功能测试框架更改日志](https://github.com/magento/magento2-functional-testing-framework/blob/develop/CHANGELOG.md).

### 供应商开发的扩展

有关此版本功能和更改的更新，请参阅以下文章：

* [Amazon Pay](https://marketplace.magento.com/amzn-amazon-pay-magento-2-module.html)

* [Braintree](https://experienceleague.adobe.com/docs/commerce-admin/stores-sales/payments/braintree.html)

* [dotdigital Engagement Cloud](https://marketplace.magento.com/dotdigital-dotdigital-magento2-os-package.html)

* [克拉尔纳](https://marketplace.magento.com/klarna-m2-klarna.html)

* [顶点云](https://marketplace.magento.com/vertexinc-vertex-tax-module.html)

* [Yotpo产品审核](https://marketplace.magento.com/yotpo-module-yotpo.html)

## 修复的问题

我们已在2.4.1核心代码中修复了数百个问题。

### 安装、升级、部署

<!-- MC-36113-->

* 在CLI命令中使用依赖于Store模块API的第三方扩展进行安装不会再失败。 以前，应用程序显示此错误消息： `The default website isn't defined. Set the website and try again`. 这是2.4.0中的一个已知问题。

<!-- MC-33273-->

* `bin/magento setup:di:compile` 不再引发致命错误。 以前，应用程序在您第一次运行此命令时抛出错误，但第二次执行导致编译成功。

<!-- MC-34429-->

* 在上声明插件时，升级不再失败 `Magento\Framework\Encryption\Encryptor`.

<!-- MC-36231-->

* 当某些主题在运行后未部署时，应用程序现在会显示信息性错误消息 `bin/magento setup:static-content:deploy`. 以前，当部署成功完成但未部署所有包时，应用程序不会显示错误。 当此命令在启用并行处理的情况下执行，并且每个主题需要部署的时间超过指定的最大执行时间时，此命令可以成功完成，尽管未部署主题。

<!-- MC-35001-->

* 此 **使用默认值** 用于韩国付款的复选框(**商店** > **配置** > **销售** > **支付方式** > **克拉尔纳**)现在，当网站范围更改时，会按预期保持选中状态。

<!-- MC-17959 ENGCOM-7629-->

* 正在运行 `/bin/magento config:show vendor_module/general/value` 现在返回 `0` 或按预期显示空字符串。 以前，它返回 `Configuration for path: "vendor_module/general/value" doesn't exist`. _Vadim Malesh在拉取请求中提交的修复 [28549](https://github.com/magento/magento2/pull/28549)._ [GitHub-23290](https://github.com/magento/magento2/issues/23290)

<!-- MC-33788-->

* 升级不再导致Galera群集突然出现故障。 以前，Galera群集在升级后立即重新索引后突然退出。 在升级过程中，索引表会发生更改，并且引擎会从 `MEMORY` 到 `InnoDB`. 此时，这些表的内容在Galera群集的节点之间变得不同步。 [GitHub-25334](https://github.com/magento/magento2/issues/25334)

<!-- MC-34254-->

* 禁用PageBuilder模块不再影响产品页面的渲染。 以前，当模块被禁用时，产品页面上的自定义布局消失，应用程序显示一个空白页面。

<!-- ENGCOM-7219-->

* 您现在可以使用 `bin/magento sampledata:deploy` 以在使用编辑器安装Adobe Commerce后按预期部署示例数据。 以前，应用程序引发此错误： `Git installations must deploy sample data from GitHub; see https://devdocs.magento.com/guides/v2.3/install-gde/install/sample-data-after-clone.html for more information`. _Andrii Beziazychnyi在拉取请求中提交的修复 [27481](https://github.com/magento/magento2/pull/27481)_. [GitHub-19481](https://github.com/magento/magento2/issues/19481)

<!-- ENGCOM-7459-->

* 店面性能通过消除 `Datepicker` 组件。 _修复了Mateusz Krzeszowiak在拉取请求中提交的错误 [27860](https://github.com/magento/magento2/pull/27860)_. [GitHub-28823](https://github.com/magento/magento2/issues/28823)

<!-- ENGCOM-7265-->

* 正在执行 `bin/magento setup:upgrade` 现在可按预期完成。 以前，应用程序显示缓存的打印阵列内容。 _Sathish Subramanian在拉取请求中提交的修复 [27567](https://github.com/magento/magento2/pull/27567)_. [GitHub-27091](https://github.com/magento/magento2/issues/27091)

<!-- ENGCOM-7853-->

* `bin/magento setup:static-content:deploy --language=all` 现在，在未设置语言参数时，部署店面中使用的所有语言以及管理员用户配置的所有语言。 (`en_US` 默认情况下始终部署。) _Anton Evers在拉取请求中提交的修复 [28922](https://github.com/magento/magento2/pull/28922)_. [GitHub-29218](https://github.com/magento/magento2/issues/29218)

<!-- ENGCOM-7883-->

* 禁用“备份”功能后，应用程序不再显示“备份”菜单。 _Eden Duong在拉取请求中提交的修复 [29222](https://github.com/magento/magento2/pull/29222)_. [GitHub-29280](https://github.com/magento/magento2/issues/29280)

<!-- ENGCOM-7987-->

* 目录图像帮助程序初始化现在使用产品模型，而不是 `DataObject`. _修复了由拉取请求中的jmonteros422提交的错误 [29435](https://github.com/magento/magento2/pull/29435)_. [GitHub-1711](https://github.com/magento/adobe-stock-integration/issues/1711)

<!-- MC-37226-->

* 管理员用户现在可以保存空 **客户令牌生命周期（小时）** 字段（管理员） **商店**  >  **配置**  >  **服务**  >  **OAuth**  >  **访问令牌过期**)。 [GitHub-29502](https://github.com/magento/magento2/issues/29502)

<!-- ENGCOM-7724 -->

* 此 **为旧URL创建永久重定向** 默认情况下，类别中的设置处于禁用状态。 _Vadim Malesh在拉取请求中提交的修复 [28752](https://github.com/magento/magento2/pull/28752)_. [GitHub-24922](https://github.com/magento/magento2/issues/24922)

### AdminGWS

<!-- MC-36164-->

* 应用程序不再显示 **添加属性** 按钮(**商店** > **属性** 或 **添加属性集** 按钮(**商店** > **属性** > **客户**)时，登录管理员将缺少创建这些实体的相应权限。 以前，当不具有相应权限的网站管理员尝试创建 **属性集** 或 **客户** 属性。

<!-- MC-36230-->

* 当特定网站具有受限角色的管理员尝试从管理员创建子类别时，应用程序不再引发错误。

### Adobe Stock集成

<!-- ENGCOM-7776-->

* 在清除过滤器后，Adobe Stock图像网格中的图像现在可以正确对齐。 _Nazar Klovanych在拉取请求中提交的修复 [28366](https://github.com/magento/magento2/pull/28366)_. [GitHub-824](https://github.com/magento/adobe-stock-integration/issues/824)， [GitHub-972](https://github.com/magento/adobe-stock-integration/issues/972)

<!-- ENGCOM-7709 -->

* 此 **使用位置** “Adobe Stock图库图像详细信息”页面的部分现在可以准确地识别图像是否与产品关联。 _Nazar Klovanych在拉取请求中提交的修复 [28798](https://github.com/magento/magento2/pull/28798)_. [GitHub-1474](https://github.com/magento/adobe-stock-integration/issues/1474)

<!-- ENGCOM-7873 -->

* `\Magento\MediaGallery\Model\ResourceModel\Keyword\SaveAssetsKeywords::execute` 现在会删除指向参数中未指定的关键字的链接，并在编辑图像详细信息时删除关键字标记时插入新链接。 _修复了由拉取请求中的jmonteros422提交的错误 [29207](https://github.com/magento/magento2/pull/29207)_. [GitHub-1391](https://github.com/magento/adobe-stock-integration/issues/1391)

<!-- ENGCOM-7981 -->

* 此 `Login failed` 商家点击时应用程序显示的消息 **许可证** 对于之前保存的、未授予许可的Adobe Stock图像，不再包含HTML标记。 _由您在拉取请求中提交的修复 [29398](https://github.com/magento/magento2/pull/29398)_. [GitHub-1684](https://github.com/magento/adobe-stock-integration/issues/1684)

<!-- ENGCOM-7976 -->

* 单击 **使用位置** “图像详细资料”页的部分现在显示一个网格，该网格显示按图像过滤的所有实体。 此外，还可正确设置和显示资源筛选器。 以前，应用程序不会在中显示资源标题 **应用的过滤器** 部分。 _Nazar Klovanych在拉取请求中提交的修复 [29367](https://github.com/magento/magento2/pull/29367)_. [GitHub-1694](https://github.com/magento/adobe-stock-integration/issues/1694)

<!-- ENGCOM-7976 -->

* 应用程序不再显示 **使用位置** 图像未使用时图像的“详细信息”页面的部分。 _Nazar Klovanych在拉取请求中提交的修复 [29367](https://github.com/magento/magento2/pull/29367)_. [GitHub-1699](https://github.com/magento/adobe-stock-integration/issues/1699)

<!-- ENGCOM-7976 -->

* 修复了在添加超过最大字符数的新图像标记时出现的显示问题。 _Nazar Klovanych在拉取请求中提交的修复 [29367](https://github.com/magento/magento2/pull/29367)_. [GitHub-1702](https://github.com/magento/adobe-stock-integration/issues/1702)

<!-- ENGCOM-7976 -->

* 现在可以使用图像详细信息中的资源筛选器按预期检查资源 **使用位置** 部分。 _Nazar Klovanych在拉取请求中提交的修复 [29367](https://github.com/magento/magento2/pull/29367)_. [GitHub-1704](https://github.com/magento/adobe-stock-integration/issues/1704)

<!-- ENGCOM-7976 -->

* 有关不同实体(例如， `page` 和 `category`)现已列在“图像详细信息”页面中，且已更正。 _Nazar Klovanych在拉取请求中提交的修复 [29367](https://github.com/magento/magento2/pull/29367)_. [GitHub-1747](https://github.com/magento/adobe-stock-integration/issues/1747)

<!-- ENGCOM-7778-->

* 您现在可以使用新的 `UrlFilterApplier` 要对产品应用筛选器的组件，`cms_page`、和 `cms_block` 使用GETURL参数的网格。 _由Gabriel da Gama在拉取请求中提交的修复 [28932](https://github.com/magento/magento2/pull/28932)_. [GitHub-1501](https://github.com/magento/adobe-stock-integration/issues/1501)

<!-- ENGCOM-8019-->

* 单击 **使用位置** 媒体库中图像的部分现在会按预期打开由图像过滤的实体的网格。 以前，图像标题不会显示在网格的已应用滤镜部分中。 _Nazar Klovanych在拉取请求中提交的修复 [29429](https://github.com/magento/magento2/pull/29429)_. [GitHub-1694](https://github.com/magento/adobe-stock-integration/issues/1694)

<!-- ENGCOM-8019-->

* 现在，当您在媒体集中连续编辑多个图像时，应用程序可以正确添加标记。 _Nazar Klovanych在拉取请求中提交的修复 [29429](https://github.com/magento/magento2/pull/29429)_. [GitHub-1755](https://github.com/magento/adobe-stock-integration/issues/1755)

<!-- ENGCOM-8015-->

* 现在，在商家删除标记并保存图像详细信息后，应用程序将删除Adobe Stock图像的标记。 以前，在刷新页面之前不会删除标记。 _由Honeymay Louiese Ignacio在拉取请求中提交的修复 [29400](https://github.com/magento/magento2/pull/29400)_. [GitHub-1703](https://github.com/magento/adobe-stock-integration/issues/1703)

### Amazon Pay

* Amazon Pay现在会检查用户在呈现付款选项之前是否已登录。

* 多因素身份验证问题和放弃的购物车已得到解决。

* Amazon Pay现在可正确填充 `store name` 在电子邮件和其他显示的位置中。 如果 **存储名称** Amazon Pay配置中的字段为空，扩展将检索商店的默认名称（即您在“管理员”中提供的商店名称）。

* 已解决拒绝方案的本地化/翻译问题。 显示的文本不再始终为英文。

### 分析

<!-- MC-33314-->

* 具有正确权限的管理员现在可以访问高级报表和区段报表。

<!-- MC-34352-->

* Adobe Commerce成功生成高级报告数据文件，并按预期将其发送到使用拆分数据库的部署清单。 以前，应用程序不会生成或发送 `quotes.csv` 文件到清单，因此，清单未生成预期的报告。

### Braintree

* 现在，在结帐页面上应用促销代码时，Braintree会将正确的金额发送到PayPal。

* 在结帐页面上启用条款和条件后，Apple Pay现在可按预期工作。

* 从管理员启用Venmo后，在桌面设备上签出期间不再发生浏览器错误。

* 当购物者在 **名称** 签出工作流的字段。 以前，身份验证失败，因为Braintree3DS API不支持非ASCII字符。

* 使用PayPal下订单时，应用程序现在会在结账工作流的配送区中显示正确的收件人姓名。

* 当购物者在结帐期间多次更改配送方式时，应用程序现在会按预期更新“订单审核”页面。

### 捆绑产品

<!-- MC-36281-->

* 当您尝试在安装了清单的部署中创建产品时，应用程序不再引发异常，但是 `Magento_InventoryBundleProduct` 模块已禁用。

<!-- MC-34261-->

* 现在，该应用程序可以正确计算包含捆绑产品的订单的离线退款。

<!-- MC-24363-->

* 现在，当为简单产品分配了层价格时，迷你购物车会显示捆绑产品的正确价格。 [GitHub-22807](https://github.com/magento/magento2/issues/22807)

<!-- ENGCOM-7499-->

* 商户现在可以为捆绑产品创建贷项通知单，该贷项通知单无需退款即可提供退款。 以前，应用程序抛出错误。 _Dzung Nguyen在拉取请求中提交的修复 [27455](https://github.com/magento/magento2/pull/27455)_. [GitHub-23440](https://github.com/magento/magento2/issues/23440)

<!-- ENGCOM-7655-->

* 当购物者将捆绑产品添加到购物车而未选择所需选项时，应用程序不再显示冗余的验证消息。 _Dzung Nguyen在拉取请求中提交的修复 [27455](https://github.com/magento/magento2/pull/27455)_. [GitHub-23440](https://github.com/magento/magento2/issues/23440)

<!-- ENGCOM-7985 MC-29908-->

* GraphQL现在支持为具有选项类型的捆绑产品下订单 `radio` 和 `dropdown` 多个选项。 以前，应用程序显示一条消息，指出输入的无效 `BundleItem.type: radio/dropdown`. _修复了由Michal Derlatka在拉取请求中提交的文件 [29256](https://github.com/magento/magento2/pull/29256)_. [GitHub-26110](https://github.com/magento/magento2/issues/26110)

### 缓存

<!-- MC-36096-->

* 现在，本地缓存存储会保留到中设置的时间段 **商店** > **配置** > **常规** > **Web** > **默认Cookie设置**. 以前，Cookie的过期日期硬编码为一天，这会使其与此设置不同步。 因此，欢迎消息不会在预期持续时间内保留回访客户信息。

<!-- ENGCOM-7780-->

* 对页面缓存的调用数 `config` 已减少。 _Lukasz Bajsarowicz在拉取请求中提交的修复 [28992](https://github.com/magento/magento2/pull/28992)_. [GitHub-29159](https://github.com/magento/magento2/issues/29159)

<!-- ENGCOM-7073-->

* 清漆不再抛出 `Connection reset by peer` 按计划重新索引大型目录时出错。 _由Matthew O&#39;Loughlin在拉取请求中提交的修复 [26256](https://github.com/magento/magento2/pull/8815)_. [GitHub-26255](https://github.com/magento/magento2/issues/8815)

<!-- MC-29069-->

* 在“管理员”中编辑产品后，不再为不相关的产品清除全页缓存。 [GitHub-25670](https://github.com/magento/magento2/issues/25670)

### 购物车和结账

<!-- ENGCOM-7950-->

* 直接SQL查询已被数据提供程序取代，这改进了签出性能。 _Lukasz Bajsarowicz在拉取请求中提交的修复 [29376](https://github.com/magento/magento2/pull/29376)_. [GitHub-29453](https://github.com/magento/magento2/issues/29453)

<!-- MC-36252-->

* “比较”和“最近比较的产品”列表中的产品现在按预期工作。 以前，当比较列表展开时，应用程序不显示产品，即使部分指出该列表包含产品。

<!-- MC-35329-->

* 此 **删除** 上的按钮 **按SKU添加到购物车** 客户的 **管理购物车** 现在，在选择了多行时，页面可按预期工作。

<!-- MC-34999-->

* 当您尝试按SKU订购产品时，如果输入的数字与有效的SKU匹配，但大小写不同，则应用程序不再引发错误。 之前，当您在以下 **我的帐户** > **按SKU排序** 与有效的SKU不完全匹配时，应用程序抛出错误。

<!-- MC-25042-->

* 现在，如果客户发货地址位于允许国家/地区列表中标识的国家/地区，并且该列表仅包含该国家/地区，则结帐时默认选择客户的发货地址。 以前，应用程序不选择地址作为默认地址，而是显示此错误消息： `Please specify a regionId in shipping address`.

<!-- MC-24043-->

* 商家现在可以启用 **应用于装运金额** 在的“操作”选项卡中 **营销** > **购物车价格规则** > **添加新规则** 时间 **整个购物车的固定金额折扣** 中所有规则都适用的URL的区域。 [GitHub-24422](https://github.com/magento/magento2/issues/24422)

<!-- MC-23992-->

* 当购物者在开始结帐并导航到店面主页后尝试取消设置持久性Cookie时，应用程序不再引发异常。 以前，当购物者单击 **不是你吗？** 链接时，应用程序引发此异常： `The shipping address is missing. Set the address and try again`. [GitHub-24218](https://github.com/magento/magento2/issues/24218)

<!-- MC-33899-->

* 现在，当客户将缺货产品添加到购物车时，应用程序会显示添加到购物车的成功消息。 以前，虽然添加了产品，但应用程序未显示成功消息。

<!-- MC-35989-->

* 自定义地址属性现在按预期包含在结账工作流中为付款步骤显示的表单中。

<!-- MC-36060-->

* 此 **州/省/地区** 输入框现在按预期启用，时间： **我的帐户** > **通讯簿** > **添加新地址**.

<!-- ENGCOM-7746-->

* 现在，在以下情况下，折扣将按预期应用于运费 **应用于装运金额** 已启用。 _Andrii Kalinich在拉取请求中提交的修复 [28839](https://github.com/magento/magento2/pull/28839)_. [GitHub-26723](https://github.com/magento/magento2/issues/26723)

<!-- ENGCOM-7752-->

* 支持关闭迷你购物车的代码已重构以删除 `closeSidebar` 函数。 已将相应的点击绑定添加到 `[data-action="close"]` 元素。 _拉取请求中按行提交的修复 [28906](https://github.com/magento/magento2/pull/28906)_. [GitHub-29161](https://github.com/magento/magento2/issues/29161)

<!-- ENGCOM-7585-->

* 新 **在购物车页面上显示“清除购物车”按钮** 配置设置提供对显示的控制 **清除购物车** “购物车查看”页面上的按钮。 默认禁用此设置。 _Pavlo Sydorenko在拉取请求中提交的修复 [27917](https://github.com/magento/magento2/pull/27917)_. [GitHub-28705](https://github.com/magento/magento2/issues/28705)

<!-- ENGCOM-7457-->

* 验证已添加到签出工作流中的“电话”字段。 _Oleh Usik在拉取请求中提交的修复 [27537](https://github.com/magento/magento2/pull/27537)_. [GitHub-28800](https://github.com/magento/magento2/issues/28800)

<!-- ENGCOM-5629-->

* 当购物车包含可下载的产品，且 **可共享** 和 **如果购物车包含可下载的项目，则禁用访客签出** 设置已禁用。 _拉取请求中由Rani Priya提交的修复 [23972](https://github.com/magento/magento2/pull/23972)_. [GitHub-23971](https://github.com/magento/magento2/issues/23971)

<!-- ENGCOM-7949-->

* 当购物者从客户帐户侧边栏将产品添加到购物车时，应用程序显示的成功消息现在包含指向购物者的购物车的链接。 _由Ajith在拉取请求中提交的修复 [27977](https://github.com/magento/magento2/pull/27977)_. [GitHub-29097](https://github.com/magento/magento2/issues/29097)

<!-- ENGCOM-7825-->

* 应用程序现在为签出工作流上的前缀下拉选项菜单默认选择一个空值。 _Vadim Malesh在拉取请求中提交的修复 [28238](https://github.com/magento/magento2/pull/28238)_. [GitHub-18823](https://github.com/magento/magento2/issues/18823)

<!-- ENGCOM-8004-->

* 现在，当您从购物车中删除多个项目时，应用程序显示的弹出消息准确地描述了您选择删除的实体的数量和类型。 _Nazar Klovanych在拉取请求中提交的修复 [29490](https://github.com/magento/magento2/pull/29490)_. [GitHub-1749](https://github.com/magento/adobe-stock-integration/issues/1749)

<!-- MC-36418-->

* 现在，当访客用户完成结帐时，应用程序会显示客户注册表单。

<!-- MC-35607-->

* 自定义客户地址属性字段现在按预期显示在店面结账工作流中。

<!-- ENGCOM-7793-->

* 应用程序现在会在结帐期间检索当前客户组以获取有效的报价。 以前，应用程序使用在首次将产品添加到购物车时处于活动状态的客户组，如果该客户组在结帐前已被删除，则应用程序会引发错误。 _由Konstantin在拉取请求中提交的修复 [28902](https://github.com/magento/magento2/pull/28902)_. [GitHub-29327](https://github.com/magento/magento2/issues/29327)

### 目录

<!-- MC-31068-->

* 应用程序现在会在结帐前从购物车的购物车中删除禁用的产品。 以前，当购物者向购物车中添加在结账完成之前禁用的产品时，应用程序从购物车中删除了禁用的产品，但是该产品保留在报价中，购物者无法结账。 [GitHub-26680](https://github.com/magento/magento2/issues/26680)

<!-- MC-30624-->

* 该应用程序现在按预期对畅销产品进行排序。 以前，产品计数和排序结果分页均不正确。 [GitHub-25955](https://github.com/magento/magento2/issues/25955)

<!-- ENGCOM-7292-->

* 购物者现在可以通过单击比较产品侧边栏中的产品名称来打开产品的详细信息页面。 _Eduard Chitoraga在拉取请求中提交的修复 [27451](https://github.com/magento/magento2/pull/27451)_. [GitHub-21101](https://github.com/magento/magento2/issues/21101)

<!-- ENGCOM-7513-->

* `children_count` 现在，当管理员删除类别时，值保持为正。 以前，当管理员删除类别时， `children_count` 其余类别为负数。 _Vitaliy Prokopov在拉取请求中提交的修复 [28044](https://github.com/magento/magento2/pull/28044)_. [GitHub-27969](https://github.com/magento/magento2/issues/27969)

<!-- MC-34314-->

* 应用程序现在使用默认选项(**配置** > **Web** > **默认布局** > **默认产品布局**)，您已为 `page_layout` 属性。 以前，不会应用您选择的默认值。

<!-- MC-34258-->

* 您现在可以成功地对库存产品库存执行成批活动。 以前，当您尝试对库存产品库存执行成批活动时，应用产品将显示一个空白页。 如果您在开发人员模式下对应用程序执行此操作，则应用程序会引发以下错误： `Notice: Undefined offset: 32000 in /Users/kodithuw/sites/m23inventory/inventory/InventoryCatalogAdminUi/view/adminhtml/templates/catalog/product/edit/action/inventory.phtml on line 24`

<!-- MC-32552-->

* 单击时显示的记录总数 **添加产品** 将产品添加到目录类别时，Products选项卡上的不再根据产品排序顺序进行更改。

<!-- ENGCOM-7854 -->

* 此 `{products(filter: {sku: {eq: "some sku"}}) {…}` query现在返回已转换为预期货币的值。 以前， `price_tiers.final_price.value` 以基础货币显示的特殊价格。 _Petkovski Marjan在拉取请求中提交的修复 [28890](https://github.com/magento/magento2/pull/28890)_. [GitHub-26121](https://github.com/magento/magento2/issues/26121)

### 目录规则

<!-- MC-33487-->

* 在保存具有以下条件的目录规则时，应用程序不再引发致命错误： `If ALL of these conditions are FALSE:, If ALL of these conditions are TRUE:, Attribute set is default`

### 清理

<!-- ENGCOM-7281-->

* 更正了“管理销售订单”网格复选框的对齐错误。 _由涂阮在拉取请求中提交的修复 [27642](https://github.com/magento/magento2/pull/27642)_. [GitHub-27633](https://github.com/magento/magento2/issues/27633)

<!-- ENGCOM-7723-->

* 更正了销售订单地址保存处理程序中的送货地址ID getter中的拼写错误。 _由Konstantin在拉取请求中提交的修复 [28810](https://github.com/magento/magento2/pull/28810)_. [GitHub-28982](https://github.com/magento/magento2/issues/28982)

<!-- ENGCOM-7745-->

* 已更正 `getRegionNameExpresion` 方法名称到 `getRegionNameExpression`. _由Pierre Grimaud在拉取请求中提交的修复 [28832](https://github.com/magento/magento2/pull/28832)_. [GitHub-28829](https://github.com/magento/magento2/issues/28829)

<!-- ENGCOM-7657-->

* 冗余 `init` 方法已从 `app/code/Magento/AdvancedPricingImportExport/Model/Import/AdvancedPricing/Validator/Website.php` 和 `app/code/Magento/AdvancedPricingImportExport/Model/Import/AdvancedPricing/Validator/TierPriceType.php`. _Oleh Usik在拉取请求中提交的修复 [28650](https://github.com/magento/magento2/pull/28650)_. [GitHub-29009](https://github.com/magento/magento2/issues/29009)

<!-- ENGCOM-7698-->

* `localStorage` 已将polyfill从 `base` 到 `frontend`. _修复了由Ihor Sviziev在拉取请求中提交的错误 [28749](https://github.com/magento/magento2/pull/28749)_. [GitHub-28900](https://github.com/magento/magento2/issues/28900)

<!-- ENGCOM-7753-->

* 更新了Adobe Commerce徽标并删除了自述文件中的无关空格。 _修复了Rafael Corea r̻ Gomes在拉取请求中提交的错误 [28891](https://github.com/magento/magento2/pull/28891)_. [GitHub-29056](https://github.com/magento/magento2/issues/29056)

<!-- ENGCOM-7771-->

* 不必要 `overflowed` 已从迷你购物车侧边栏小组件中删除类。 _拉取请求中按行提交的修复 [28963](https://github.com/magento/magento2/pull/28963)_. [GitHub-29160](https://github.com/magento/magento2/issues/29160)

<!-- ENGCOM-7658-->

* 已更正“装运”页面中错误的CSS选择器。 _由涂阮在拉取请求中提交的修复 [28639](https://github.com/magento/magento2/pull/28639)_. [GitHub-29261](https://github.com/magento/magento2/issues/29261)

<!-- ENGCOM-7680-->

* 此 `lib/internal/Magento/Framework/App/Request/Http.php` 通过优化逻辑和删除冗余变量分配以及函数中返回值的过度使用，文件得到了简化。 _由Chris Snedaker在拉取请求中提交的修复 [28608](https://github.com/magento/magento2/pull/28608)_. [GitHub-29381](https://github.com/magento/magento2/issues/29381)

<!-- ENGCOM-7925-->

* 此 `bin/magento module:status` 命令现在接受多个模块名称作为参数。 _Chandru Rajendran在拉取请求中提交的修复 [28250](https://github.com/magento/magento2/pull/28250)_. [GitHub-29344](https://github.com/magento/magento2/issues/29344)

<!-- ENGCOM-7983-->

* 修复了的类描述中的拼写错误 `\Magento\Downloadable\Block\Sales\Order\Email\Items\Downloadable`. _Benjamin Rosenberger在拉取请求中提交的修复 [29451](https://github.com/magento/magento2/pull/29451)_. [GitHub-29470](https://github.com/magento/magento2/issues/29470)

<!-- ENGCOM-7993-->

* 此 `TierPriceManagement` 类已重构以删除冗余代码。 _Lukasz Bajsarowicz在拉取请求中提交的修复 [29202](https://github.com/magento/magento2/pull/29202)_. [GitHub-29477](https://github.com/magento/magento2/issues/29477)

<!-- ENGCOM-7830-->

* `autoload.php` 已进行重构以提高可读性和返回速度。 _Vitaliy Ryaboy在拉取请求中提交的修复 [28923](https://github.com/magento/magento2/pull/28923)_. [GitHub-29527](https://github.com/magento/magento2/issues/29527)

### CMS内容

<!-- MC-35971-->

* 现在，选定默认存储视图的“层次结构”选项卡可按预期显示选定的父页面。

<!-- ENGCOM-7602-->

* 当新存储视图包含的CMS页面的URL键与另一个存储视图中的页面相同时，应用程序不再在创建存储视图期间引发错误。 _Vadim Malesh在拉取请求中提交的修复 [28421](https://github.com/magento/magento2/pull/28421)_. [GitHub-28357](https://github.com/magento/magento2/issues/28357)

<!-- MC-35480-->

* 现在，当商家使用与公司结构页面相同的URL创建CMS页面时，应用程序会引发错误。 以前，应用程序显示CMS页面而不是公司结构页面。

### 可配置产品

<!-- MC-33523-->

* 已纠正可配置产品编辑当前变体列表的分页问题。

<!-- MC-33406-->

* 当购物者为可配置产品选择选项时，应用程序不再更新“相关产品”价格框。 以前，每当购物者选择可配置产品的选项时，应用程序都会更新价格框。

<!-- MC-29882-->

* 现在，该应用程序在“管理员创建订单”页面上为带有可自定义选项的可配置产品显示正确的价格。 如预期的那样，显示的价格是子产品的价格和自定义选项的价格之和。 以前，应用程序仅显示自定义选项价格。 [GitHub-25766](https://github.com/magento/magento2/issues/25766)

<!-- MC-33745-->

* 应用购物车价格规则后，订单摘要现在会显示正确的折扣金额。 以前，规则在计算运费折扣时无法正确舍入金额。

<!-- MC-33765-->

* 从范围受限的管理员帐户创建的管理员用户帐户现在可以创建具有预期属性的可配置产品。 以前，应用程序引发此错误： `Notice: Undefined index: value_index in 23develop/app/code/Magento/ConfigurableProduct/Helper/Product/Options/Factory.php on line 101`.

<!-- ENGCOM-7787-->

* 使用POST时，应用程序不再引发验证错误 `/V1/products` 可配置产品的 `int` 值为0。 以前，应用程序引发此错误： `Product with id "%1" does not contain required attribute "%2"."` _Vadim Malesh在拉取请求中提交的修复 [29001](https://github.com/magento/magento2/pull/29001)_. [GitHub-13210](https://github.com/magento/magento2/issues/13210)

<!-- ENGCOM-7214-->

* 不再将父产品的配置选项属性分配给新的可配置产品的 `size` 属性。 _由Abel Truong在拉取请求中提交的修复 [27339](https://github.com/magento/magento2/pull/27339)_. [GitHub-26449](https://github.com/magento/magento2/issues/26449)

### Cookie

<!-- ENGCOM-7156-->

* 应用程序现在最多创建1个 `mage-translation-file-version` 和 `mage-translation-storage` 每个会话的Cookie。 _修复了由Ihor Sviziev在拉取请求中提交的错误 [27364](https://github.com/magento/magento2/pull/27364)_. [GitHub-27355](https://github.com/magento/magento2/issues/27355)

### cron

<!-- MC-35884-->

* 扩展了消息队列使用者配置，添加了新参数，这些参数有助于控制使用者并保存服务器资源，并且可能会减少使用者队列CPU消耗。 参见 [配置消息队列](https://developer.adobe.com/commerce/php/development/components/message-queues/configuration/) 以了解 `maxIdleTime`， `sleep`、和 `onlySpawnWhenMessageAvailable` 参数。

<!-- ENGCOM-7863-->

* `cron` 表达式，例如  `3/10 * * * *` 现已按预期计划。 _Anton Evers在拉取请求中提交的修复 [28930](https://github.com/magento/magento2/pull/28930)_. [GitHub-29240](https://github.com/magento/magento2/issues/29240)

<!-- ENGCOM-7193-->

* `sales_clean_quotes` 不再一次加载所有过期的引号。 以前，由于所有过期的报价都是同时加载的，因此应用程序失败，出现此严重错误： `PHP Fatal error: Allowed memory size of 2147483648 bytes exhausted (tried to allocate 20480 bytes) in /path/to/magento2/vendor/magento/framework/Model/AbstractModel.php on line 359`，

### CSS

<!-- ENGCOM-7678-->

* 在以下情况下，应用程序不再复制CSS **关键CSS** 已启用。 _由涂阮在拉取请求中提交的修复 [28480](https://github.com/magento/magento2/pull/28480)_. [GitHub-26498](https://github.com/magento/magento2/issues/26498)

<!-- MC-24981-->

* 服务器端LESS编译器现在会在您运行时按预期导入所有远程CSS文件 `bin/magento setup:static-content:deploy -f`. 以前，应用程序未导入远程文件，并引发错误。 [GitHub-25119](https://github.com/magento/magento2/issues/25119)

### 自定义客户属性

<!-- MC-36387-->

* 更正了有关密码和 **职务** “客户编辑帐户信息”页面上的字段。

<!-- MC-33645-->

* 现在，当新客户单击 **创建帐户** 按钮进行注册。 以前，应用程序不会创建客户帐户，并在客户单击按钮时显示错误。

<!-- MC-34024-->

* 客户尚未输入任何数据时，结帐工作流不再显示自定义客户地址属性值。

### 客户

<!-- MC-33679-->

* 管理员客户地址中的区域名称现在按预期进行了翻译。

<!-- MC-36226-->

* 此 **省/市/自治区** 字段现在按预期在“编辑地址”页面上填充(**我的帐户** > **通讯簿**)。

<!-- MC-34655-->

* 当客户单击 **提交** 多次在启用了不可见reCAPTCHA的店面表单上按此按钮。 以前，多次单击此按钮会导致类似于以下内容的内部错误： `Internal error: Make sure you are using reCaptcha V3 api keys`.

<!-- MC-33522-->

* 现在，从管理员保存已删除的客户只会生成一条错误消息。 以前，应用程序显示一个空白页面，并生成一个包含此字符串的报告： `"0":"No such entity with customerId = 3","1":"#1 Magento\\Customer\\Model CustomerRegistry->retrieve() called at [app\/code\/Magento\/Customer\/Model\/ResourceModel\/CustomerRepository.php:340"`.

<!-- MC-33357-->

* 当管理员尝试为刚刚删除帐户的客户保存地址时，应用程序现在会按预期显示错误消息。 以前，应用程序显示一个空白消息框。

<!-- MC-33150-->

* 已编辑签出工作流和通讯簿中地址字段的标签，以保持一致性。

<!-- ENGCOM-7244 -->

* 现在，如果前端标签的值不为空，则将其回退到存储标签。 以前，客户属性使用默认的前端标签。 _Toan Nguyen在拉取请求中提交的修复 [27064](https://github.com/magento/magento2/pull/27064)_. [GitHub-27063](https://github.com/magento/magento2/issues/27063)

<!-- ENGCOM-7147 -->

* 此 `sortOrder`已更正布局XML中的链接数。 以前，该顺序是反向的，并且使用降序。 _由涂阮在拉取请求中提交的修复 [27340](https://github.com/magento/magento2/pull/27340)_. [GitHub-27162](https://github.com/magento/magento2/issues/27162)

### 客户区段

<!-- MC-33184-->

* 批量操作已重构以异步保存和刷新客户区段，对于包含许多客户（超过3,000,000个）的部署，这提高了这些任务的性能。

<!-- MC-36224-->

* 现在，客户区段条件在拆分数据库部署中按预期工作。 以前，当您尝试通过添加条件来编辑客户区段时，应用程序会引发错误： `SQLSTATE[42S02]: Base table or view not found`.

### 目录

<!-- MC-32271-->

* 现在，省/市/自治区下拉菜单的格式在管理员中是一致的。

### dotdigital

* 当订单包含目录中不再存在的产品SKU时，订单同步不再失败。

* Web分析数据中不再包含空的产品类别。

* Web行为跟踪现在适用于具有某些主题配置的商家。 新的回退选择器可解决此问题。

* 使用cron运行客户同步时，订阅者状态数据字段不再包含空值。 （应用程序模拟解决了此问题。）

* 在默认级别启用dotdigital帐户，但在主网站中禁用该帐户时，通讯簿映射现在可按预期工作。

* 现在（使用外部动态内容URL生成优惠券）为包含加号(“+”)的电子邮件地址生成优惠券。

* 在以下情况下，不再重新订阅联系人： `last_subscribed_at` 值为null。

* 影响早期版本的升级错误（自4.5.2开始）已得到解决。

* 修复了4.5.3中引入的回归问题，该问题在准备订户导出时影响使用获得订户状态的方法。

* 现在可以正确计算已同步订阅者的总人数（显示在日志和屏幕上）。

### 可下载

<!-- MC-35026-->

* 现在，“我的可下载产品”区域会按预期显示已购买可下载产品的链接，这些产品属于分组产品。

<!-- MC-34262-->

* 单击可下载产品的 **示例** 现在，管理员产品页面中的按钮可按预期下载示例。 以前，当您单击 **示例**&#x200B;时，应用程序显示此错误： `The product that was requested doesn't exist. Verify the product and try again`.

<!-- ENGCOM-7757-->

* 现在，购物者可以下载无库存的可下载产品样品。 以前，当购物者尝试下载示例时，应用程序会打开一个新选项卡，但不会显示信息性消息或开始下载过程。 _Vadim Malesh在拉取请求中提交的修复 [28898](https://github.com/magento/magento2/pull/28898)_. [GitHub-23638](https://github.com/magento/magento2/issues/23638)

<!-- ENGCOM-7796-->

* 改进了当购物者尝试为可下载产品设置送货地址时应用程序显示的例外消息。 _修复了由Michal Derlatka在拉取请求中提交的文件 [28904](https://github.com/magento/magento2/pull/28904)_. [GitHub-26107](https://github.com/magento/magento2/issues/26107)

<!-- ENGCOM-7715 -->

* 产品的 `stock_item` 当您使用RESTPUT调用进行更新时，数据将更新，可下载的产品链接和示例将按预期保留 `stock_item` 值。 以前，产品更新后，该产品不再包含下载内容的链接。 _Vadim Malesh在拉取请求中提交的修复 [28799](https://github.com/magento/magento2/pull/28799)_. [GitHub-21811](https://github.com/magento/magento2/issues/21811)

<!-- MC-29905-->

* 现在，当客户为仅包含可下载产品的订单设置送货地址时，应用程序会显示一条信息更丰富的消息。

### 动态块（以前称为横幅）

<!-- MC-33266-->

* 现在，在创建动态块并添加相关目录价格规则时，表标题会与数据表匹配（预期）。

### 电子邮件

<!-- MC-32789-->

* 如果在创建订单后更改了客户电子邮件，则应用程序现在会向正确的客户电子邮件发送有关订单更改的电子邮件通知。

<!-- MC-36015-->

* 发送给客户的订单更新电子邮件现在包含正确的订单状态。 以前，如果订单状态从 `processing` 对于另一个州，订单电子邮件未反映状态更改。

<!-- MC-34107-->

* 应用程序在访客结帐期间不再显示有关现有帐户的误导性消息。 以前，当访客导航到签出页面，然后导航回送货页面时，应用程序显示以下错误： `You already have an account with us. Sign in or continue as guest`.

<!-- MC-33905-->

* 现在，自定义电子邮件模板会加载与本机默认电子邮件模板相同的元素。 以前，某些元素缺失，包括变量值。

<!-- MC-33700-->

* 您现在可以创建发送电子邮件的电子邮件模板 `Content-Type: "text/plain"`. 以前，应用程序忽略模板中指定的内容类型。 _由twoonesixdigital在拉取请求中提交的修复 [26474](https://github.com/magento/magento2/pull/26474)_. [GitHub-26471](https://github.com/magento/magento2/issues/26471)

<!-- ENGCOM-7576-->

* 已从电子邮件预览模板中删除不必要的CSS。 _由涂阮在拉取请求中提交的修复 [27828](https://github.com/magento/magento2/pull/27828)_. [GitHub-27543](https://github.com/magento/magento2/issues/27543)

<!-- ENGCOM-7177-->

* 电子邮件模板中重复页脚已显示的文本的文本已被删除。 _修复了Pawel Tylek在拉取请求中提交的错误 [27356](https://github.com/magento/magento2/pull/27356)_. [GitHub-28433](https://github.com/magento/magento2/issues/28433)

<!-- ENGCOM-7506-->

* 产品警报电子邮件现在从订阅警报的存储区发送。 以前，此电子邮件始终从默认存储区发送。 _修复了Maciej Pawlowski在拉取请求中提交的错误 [26534](https://github.com/magento/magento2/pull/26534)_. [GitHub-28968](https://github.com/magento/magento2/issues/28968)

<!-- ENGCOM-7815-->

* 重复 `customer.name` 变量已从电子邮件模板中删除。 _修复了Pawel Tylek在拉取请求中提交的错误 [29054](https://github.com/magento/magento2/pull/29054)_. [GitHub-29087](https://github.com/magento/magento2/issues/29087)

<!-- MC-33232-->

* 发送给分配给公司的销售代表的通知电子邮件现在包含分配的公司徽标。 以前，通知电子邮件包含默认的LUMA徽标，而不是上传的企业徽标电子邮件。

### 框架

<!-- MC-35893-->

* 此 **一天中发送数据的时间** 管理员的字段 **商店** > **配置** >常规> **高级报告** 页面现在已正确呈现。

<!-- MC-34153-->

* 当订单列表跨越多个页面时，购物者现在可以更改每页显示的订单数。 以前，当您导航到订单的最后一页并尝试更改每页显示的订单数时，应用程序会显示此消息： `You have placed no orders`. 这是2.4.0中的一个已知问题。

<!-- MC-35020-->

* 现在，您可以在实施2级缓存时将产品添加到类别。

<!-- MC-29755-->

* `X-Magento-Tags` 标头不再超过HTTP规范允许的大小。 以前，包含许多产品的类别页面返回 `X-Magento-Tag` 标头导致503错误。

<!-- MC-34257-->

* `sales_order_shipment_track_save_commit_after` 现在按预期在您使用REST API创建装运时触发。

<!-- MC-33898-->

* 应用程序现在会显示信息性错误消息，当 `di compile` 由于不存在依赖关系而失败。 以前，显示的消息不标识发生异常的类。

<!-- MC-32929-->

* 当Redis使用所有允许内存时，应用程序不再引发以下致命错误： `report.CRITICAL: OOM command not allowed when used memory > 'maxmemory'`.

<!-- MC-18021-->

* 现在，购物者可以在以下情况下将多种产品添加到购物车中： `Persistent` 模块已禁用。 [GitHub-14486](https://github.com/magento/magento2/issues/14486)

### 常规修复

<!-- MC-36048-->

* 对管理员的产品排序(**商店** > **属性** > **产品**)现在显示符合搜索条件的所有产品。 以前，应用程序不显示记录，并且要对记录进行排序，您必须导航到搜索结果的第一页。

<!-- MC-36343-->

* 中的URL周围出现不必要的引号和转义 `tracking.phtml` 已被删除。

<!-- MC-35998-->

* 此 `var/log/system.log` 当用户尝试访问静态目录下的非现有资源文件并启用SCD OnDemand和生产模式时，现在显示更准确的消息。 应用程序现在记录404错误。 以前，应用程序记录当错误在开发人员模式下发生时所记录的相同消息。

<!-- ENGCOM-7286-->

* JavaScript缩小现在可以正确运行。 缩小文件解析程序不再将变量泄露给全局范围。 以前， `ctx`， `origNameToUrl`、和 `baseUrl` 窗口下的变量被泄露。 _修复了Mateusz Krzeszowiak在拉取请求中提交的错误 [27622](https://github.com/magento/magento2/pull/27622)_. [GitHub-28110](https://github.com/magento/magento2/issues/28110)

<!-- ENGCOM-7532-->

* 在调试阻止创建对象的错误时，应用程序现在会打印并记录原始异常消息。 以前，仅记录消息。 _Marvin Hinz在拉取请求中提交的修复 [26572](https://github.com/magento/magento2/pull/26572)_. [GitHub-26550](https://github.com/magento/magento2/issues/26550)

<!-- ENGCOM-7577-->

* 提交数据库更改后的回调执行已得到改进。 以前，如果一个回调失败并出现异常，则所有回调都将失败。 _由Alok Patel在拉取请求中提交的修复 [27134](https://github.com/magento/magento2/pull/27134)_. [GitHub-28167](https://github.com/magento/magento2/issues/28167)

<!-- ENGCOM-7447-->

* 未定义依赖项的模块的Mixin不再引发此错误： `TypeError: Cannot read property 'map' of null`. _修复了Mateusz Krzeszowiak在拉取请求中提交的错误 [27690](https://github.com/magento/magento2/pull/27690)_. [GitHub-28340](https://github.com/magento/magento2/issues/28340)

<!-- ENGCOM-7299-->

* 现在，只有在 `localStorage` 或 `sessionStorage` 不可用。 _修复了Mateusz Krzeszowiak在拉取请求中提交的错误 [27619](https://github.com/magento/magento2/pull/27619)_. [GitHub-28381](https://github.com/magento/magento2/issues/28381)

<!-- ENGCOM-7610-->

* 现在，当购物者从第二个或后续结果页面更改每页显示的结果数量时，多页店面订单列表会按预期运行。 以前，当购物者更改 **我的帐户** > **我的订单** 列表： `You have placed no orders`. _Vadim Malesh在拉取请求中提交的修复 [28417](https://github.com/magento/magento2/pull/28417)_. [GitHub-28488](https://github.com/magento/magento2/issues/28488)

<!-- ENGCOM-7565-->

* 已弃用 `addWarning` 方法已替换为 `addWarningMessage` 方法。 _修复了拉取请求中由kishorekumarkesavan提交的 [28264](https://github.com/magento/magento2/pull/28264)_. [GitHub-28308](https://github.com/magento/magento2/issues/28308)

<!-- ENGCOM-7588-->

* 使用生成的代码 `bin/magento` 命令行命令现在与要求和编码标准一致。 _Lukasz Bajsarowicz在拉取请求中提交的修复 [28351](https://github.com/magento/magento2/pull/28351)_. [GitHub-28376](https://github.com/magento/magento2/issues/28376)

<!-- MC-33744-->

* 如果一个CMS页面被分配到多个存储视图，则应用程序不会再在站点层次结构中多次显示该页面。

<!-- ENGCOM-7511-->

* 保存属性 `backend_type = static` 不再删除 `frontend_class` 字段。 _修复了由合并帕特尔在拉取请求中提交的错误 [27369](https://github.com/magento/magento2/pull/27369)_. [GitHub-27051](https://github.com/magento/magento2/issues/27051)

<!-- ENGCOM-7462-->

* 不必要的代码和 `responsive.js` 已从主题加载的文件中删除。 _修复了Mateusz Krzeszowiak在拉取请求中提交的错误 [27617](https://github.com/magento/magento2/pull/27617)_. [GitHub-28811](https://github.com/magento/magento2/issues/28811)

<!-- ENGCOM-7856-->

* 验证已添加到 **符号数** 字段。 _Eden Duong在拉取请求中提交的修复 [29199](https://github.com/magento/magento2/pull/29199)_. [GitHub-29198](https://github.com/magento/magento2/issues/29198)

<!-- ENGCOM-7999-->

* RSS馈送现在可以正确加载。 以前，馈送不会首次加载，尽管在刷新页面时它按预期加载。 _Vadim Malesh在拉取请求中提交的修复 [29455](https://github.com/magento/magento2/pull/29455)_. [GitHub-25211](https://github.com/magento/magento2/issues/25211)

<!-- MC-35550-->

* 购物者重新登录后，已过期的永久会话现在会按预期续订。

<!-- MC-35230-->

* 密码生命周期，在中设置 **商店** > **配置** > **高级** > **管理员** 现在很荣幸。 以前，如果您单击 **忘记密码？** 提示重置密码时，您可以绕过密码重置。

<!-- MC-34369-->

* 优惠券代码现在仅适用于指定的产品。 以前，应用程序将优惠券代码应用于购物车中的所有产品。 [GitHub-28246](https://github.com/magento/magento2/issues/28246)

<!-- MC-35008-->

* 发生库存或价格更新时，购物车到期设置不再重新设置。 以前，当购物车设置为在24小时后过期，并且发生了库存更新或价格更新时，索引器会填充 `updated_at table`，会重新设置到期时间。

<!-- MC-33313-->

* 当管理员将具有活动购物车的客户分配给客户组时，应用程序不再引发致命错误。

<!-- ENGCOM-7834 -->

* 从中选择工具栏选项 **开发人员工具**  >  **网络**  在产品页面上，运行Chrome浏览器时不再初始化 `toolbar.js` 两次。 _修复了Pawel Tylek在拉取请求中提交的错误 [28838](https://github.com/magento/magento2/pull/28838)_. [GitHub-25934](https://github.com/magento/magento2/issues/25934)

<!-- ENGCOM-7420-->

* 应用程序现在将管理员用户的ACL角色ID添加到产品类别树缓存ID。 这将限制范围有限的管理员可以按预期看到的类别树。 _由拉取请求中的quangdo-aligent提交的修复 [27429](https://github.com/magento/magento2/pull/27429)_. [GitHub-28306](https://github.com/magento/magento2/issues/28306)

### 礼品卡

<!-- MC-36118-->

* 礼品卡帐户现在会按预期捕获订单编号。 以前， **更多信息** 选定礼品帐户的“历史记录”选项卡中的字段未显示订单ID。

<!-- MC-34519-->

* 现在，使用逗号作为小数分隔符可按预期工作。 以前，逗号分隔符忽略小数值。

<!-- MC-34469-->

* 礼品卡现在按预期显示在迷你购物车中。 以前，应用程序将HTML对象渲染为文本。

<!-- MC-33851-->

* 信用备忘录现在正确地反映了涉及折扣产品以及用礼品卡和商店信用支付订单的总额。

### Google标签管理器

<!-- MC-33729-->

* 在以下情况下，应用程序在签出期间不再引发JavaScript错误： **Cookie限制模式** 设置和Google Tag Manager已启用。

### GraphQL

<!-- ENGCOM-7661 7662 7559 MC-35646 32345-->

* 购物者可以在结账时选择礼品信息和包装选项。 GraphQL现在包含适用于不同类型购物车商品的礼品消息选项。 参见 [`setGiftOptionsOnCart` 变异](https://devdocs.magento.com/guides/v2.4/graphql/mutations/set-gift-options.html) 和 [`updateCartItems` 变异](https://devdocs.magento.com/guides/v2.4/graphql/mutations/update-cart-items.html). _Oleh Usik在拉取请求中提交的修复 [28519](https://github.com/magento/magento2/pull/28105)， [27956](https://github.com/magento/magento2/pull/27956)， [28072](https://github.com/magento/magento2/pull/28072)， [28072](https://github.com/magento/magento2/pull/28072)和246个私有存储库合作伙伴 — magento2ee_. [GitHub-253](https://github.com/magento/magento2/issues/28519)

<!-- ENGCOM-7508 -->

* 客户和嘉宾可以撰写产品评论。 客户还可以检索其产品审阅历史记录。 参见 [创建产品评论](https://devdocs.magento.com/guides/v2.4/graphql/mutations/create-product-review.html) 和 [productReviewRatingsMetadata查询](https://devdocs.magento.com/guides/v2.4/graphql/queries/product-review-ratings-metadata.html) 有关检索有关审阅基础架构的信息。 _Eduard Chitoraga在拉取请求中提交的修复 [27882](https://github.com/magento/magento2/pull/27882)_. [GitHub-28523](https://github.com/magento/magento2/issues/28523)

<!-- ENGCOM-7800 7841-->

* 客户可以在购物车上申请或删除奖励积分。 他们还可以查看自己的奖励积分历史。 参见 [`applyRewardPointsToCart`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/apply-reward-points.html) 和 [`removeRewardPointsFromCart`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/remove-reward-points.html) 有关管理购物车中的奖励积分的讨论。 _Petkovski Marjan在拉取请求中提交的修复285在私有存储库合作伙伴 — magento2ee和Dmitriy Gallyamov在拉取请求中提交的修复284和281在私有存储库合作伙伴 — magento2ee中提交的修复_. [GitHub-28835](https://github.com/magento/magento2/issues/28835)， [GitHub-28833](https://github.com/magento/magento2/issues/28833)

<!-- ENGCOM-7968 -->

* 此 [`addProductsToCart` 变异](https://devdocs.magento.com/guides/v2.4/graphql/mutations/add-products-to-cart.html) 允许您将任何类型的产品添加到活动购物车。 我们建议使用这种突变而不是单一目的突变，例如 `addSimpleProductsToCart`. _Yaroslav Rogoza在拉取请求中提交的修复 [27914](https://github.com/magento/magento2/pull/27914)_. [GitHub-28524](https://github.com/magento/magento2/issues/28524)

<!-- ENGCOM-7801 7816-->

* 现在，对相关产品的GraphQL查询会返回从target规则创建的相关产品的值。 以前，只有从产品设置添加相关产品时，对相关产品（向上销售和交叉销售）的查询才会返回值。 _Ulzii在私有存储库合作伙伴magento2ee中提交的拉取请求288修复_. [GitHub-28566](https://github.com/magento/magento2/issues/28566)

<!-- MC-34187-->

* 新 `availableStores` query会返回同一网站下多个可用商店的配置属性列表（基于当前商店）。 它不会公开网站列表。 参见 [`availableStores` 查询](https://devdocs.magento.com/guides/v2.4/graphql/queries/available-stores.html). _由Dmitriy Gallyamov在拉取请求中提交的修复 [28794](https://github.com/magento/magento2/pull/28794)_. [GitHub-28569](https://github.com/magento/magento2/issues/28569)

<!-- ENGCOM-7512 -->

* GraphQL现在仅使用授权令牌来检索用户类型及其ID。 以前，当授权令牌为空时，GraphQL使用活动客户的Cookie检索此信息。 _Alexander Taranovsky在拉取请求中提交的修复 [27373](https://github.com/magento/magento2/pull/27373)_. [GitHub-28040](https://github.com/magento/magento2/issues/28040)

<!-- ENGCOM-7839 32949-->

* 我们已添加 [`createCustomerV2`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/create-customer-v2.html) 和 [`updateCustomerV2`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/update-customer-v2.html) 管理客户帐户的变体。 这些新的突变需要不同的输入对象 `createCustomer` 和 `updateCustomer` 突变。 要更改客户的电子邮件地址，请使用新的 [`updateCustomerEmail`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/update-customer-email.html) 突变。 _修复了由Michal Derlatka在拉取请求中提交的文件 [28888](https://github.com/magento/magento2/pull/28888)_. [GitHub-28570](https://github.com/magento/magento2/issues/28570)

<!-- ENGCOM-7750 -->

* `updateCustomer` 不再允许您设置无效 `INT` 中的值 `gender` 参数。 _Alexander Taranovsky在拉取请求中提交的修复 [28487](https://github.com/magento/magento2/pull/28487)_. [GitHub-28481](https://github.com/magento/magento2/issues/28481)

<!-- ENGCOM-7663 -->

* 您可以使用 `subscribeEmailToNewsletter` 让客户订阅新闻稿的变体。 参见 [`subscribeEmailToNewsletter` 变异](https://devdocs.magento.com/guides/v2.4/graphql/mutations/subscribe-email-to-newsletter.html). _Alexander Taranovsky在拉取请求中提交的修复 [27586](https://github.com/magento/magento2/pull/27586)_. [GitHub-27337](https://github.com/magento/magento2/issues/27337)

<!-- ENGCOM-7216 -->

* 删除了中的冗余逻辑 `setShippingMethodsOnCart` 变异解析器。 _Alexander Taranovsky在拉取请求中提交的修复 [27349](https://github.com/magento/magento2/pull/27349)_. [GitHub-28262](https://github.com/magento/magento2/issues/28262)

<!-- ENGCOM-7638 -->

* 已添加的测试覆盖范围 `Please provide Email of sender` 与相关的错误 `sendEmailToFriend` 突变。 _Alexander Taranovsky在拉取请求中提交的修复 [28034](https://github.com/magento/magento2/pull/28034)_. [GitHub-28138](https://github.com/magento/magento2/issues/28138)

<!-- ENGCOM-7743 34485-->

* 此 `products` query现在会按预期返回默认商店视图的产品属性选项标签。 以前，此查询返回为管理员设置的产品属性选项标签。 _由Dmitriy Gallyamov在拉取请求中提交的修复 [28647](https://github.com/magento/magento2/pull/28647)_. [GitHub-28568](https://github.com/magento/magento2/issues/28568)

<!-- ENGCOM-7743 -->

* 自定义属性聚合现在返回特定于存储的选项值。 _由Dmitriy Gallyamov在拉取请求中提交的修复 [28647](https://github.com/magento/magento2/pull/28647)_. [GitHub-28572](https://github.com/magento/magento2/issues/28572)

<!-- ENGCOM-7707 -->

* 在产品汇总中返回的价格间隔现在只能为数字（不允许使用通配符）。 _由Dmitriy Gallyamov在拉取请求中提交的修复 [28745](https://github.com/magento/magento2/pull/28745)_. [GitHub-28628](https://github.com/magento/magento2/issues/28628)

<!-- ENGCOM-7729 -->

* 此 `categoryList` 现在，使用片段时，查询会返回正确的响应。 _Ulzii在拉取请求中提交的修复 [28710](https://github.com/magento/magento2/pull/28710)_. [GitHub-28584](https://github.com/magento/magento2/issues/28584)

<!-- ENGCOM-7732 7733-->

* GraphQL产品搜索现在会考虑已配置的类别权限。 以前，产品搜索会忽略 **启用** 设置(**商店**  >  **配置**  >  **目录**  >  **目录** > **类别权限**)。 _Petkovski Marjan在拉取请求中提交的修复 [28757](https://github.com/magento/magento2/pull/28757) 和拉取请求271`partners-magento2ee`_. [GitHub-28563](https://github.com/magento/magento2/issues/28563)

<!-- MC-31084-->

* 您现在可以使用将产品添加到购物车 `addSimpleProductToCart` 当购物车中的其他商品缺货时。 以前，应用程序返回以下错误： `Some of the products are out of stock`. [GitHub-26683](https://github.com/magento/magento2/issues/26683)

* 默认GraphQL `Category` 方法现在按类别位置按预期排序。 _由Derrik Nyomo在拉取请求中提交的修复 [29301](https://github.com/magento/magento2/pull/29301)_. [GitHub-104](https://github.com/magento/catalog-storefront/issues/104)

* 在Magento Open Source中添加了对愿望清单的支持。 您可以 [添加项目](https://devdocs.magento.com/guides/v2.4/graphql/mutations/add-products-to-wishlist.html) 到， [更新项目](https://devdocs.magento.com/guides/v2.4/graphql/mutations/update-products-in-wishlist.html) 在中，和 [删除项目](https://devdocs.magento.com/guides/v2.4/graphql/mutations/remove-products-from-wishlist.html) 来自一个愿望清单。 _Eduard Chitoraga在拉取请求中提交的修复 [28205](https://github.com/magento/magento2/pull/28205) 和264在私有存储库合作伙伴 — magento2ee中_. [GitHub-28551](https://github.com/magento/magento2/issues/28551)

* 此 [`addProductsToCart` 变异](https://devdocs.magento.com/guides/v2.4/graphql/mutations/add-products-to-cart.html) 允许您将任何类型的产品添加到活动购物车。 我们建议使用这种突变而不是单一目的突变，例如 `addSimpleProductsToCart`. _Yaroslav Rogoza在拉取请求中提交的修复 [27914](https://github.com/magento/magento2/pull/27914)_. [GitHub-28524](https://github.com/magento/magento2/issues/28524)

* 为添加了GraphQL Vault支持 [Payflow Pro Vault](https://devdocs.magento.com/guides/v2.4/graphql/payment-methods/payflow-pro-vault.html) 付款方式。 _Oleh Usik在拉取请求中提交的修复 [28821](https://github.com/magento/magento2/pull/28821)_. [GitHub-28520](https://github.com/magento/magento2/issues/28520)

* 更新了GraphQL [`storeConfig` 查询](https://devdocs.magento.com/guides/v2.4/graphql/queries/store-config.html) 以包含新的客户配置设置。 _Oleh Usik在拉取请求中提交的修复 [27876](https://github.com/magento/magento2/pull/27876)_. [GitHub-28521](https://github.com/magento/magento2/issues/28521)

* 添加了 [`resetPassword` 变异](https://devdocs.magento.com/guides/v2.4/graphql/mutations/reset-password.html). _Oleh Usik在拉取请求中提交的修复 [27876](https://github.com/magento/magento2/pull/27876)_. [GitHub-28521](https://github.com/magento/magento2/issues/28521)

* 添加了 [`requestPasswordResetEmail` 变异](https://devdocs.magento.com/guides/v2.4/graphql/mutations/request-password-reset-email.html)，它会触发所提供电子邮件地址的密码重置电子邮件。 _Oleh Usik在拉取请求中提交的修复 [27876](https://github.com/magento/magento2/pull/27876)_. [GitHub-28521](https://github.com/magento/magento2/issues/28521)

* 在中添加了有关GraphQL的讨论 [克拉尔纳的支付方式](https://devdocs.magento.com/guides/v2.4/graphql/payment-methods/klarna.html) 和[`createKlarnaPaymentsSession`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/create-klarna-payments-session.html)

### 图像

<!-- ENGCOM-7691-->

* 缩略图图像的HTML标记已得到改进。 _由涂阮在拉取请求中提交的修复 [28642](https://github.com/magento/magento2/pull/28642)_. [GitHub-29468](https://github.com/magento/magento2/issues/29468)

### 导入/导出

<!-- MC-35479-->

* 此 `error_report.csv` 现在，下载文件时将包含内容，并且该文件可在以下位置找到： `var/import_history/` 目录。 以前，导入后不会生成此文件。

<!-- ENGCOM-7616-->

* 现在，使用CSV文件导入产品会生成 `error_report.csv` 文件按预期显示。 以前，应用程序生成文件，但在导入完成后将其删除。 _Vadim Malesh在拉取请求中提交的修复 [28460](https://github.com/magento/magento2/pull/28460)_. [GitHub-28420](https://github.com/magento/magento2/issues/28420)

<!-- ENGCOM-7673-->

* 删除了整个代码库中的冗余类导入。 _Oleh Usik在拉取请求中提交的修复 [28696](https://github.com/magento/magento2/pull/28696)_. [GitHub-29012](https://github.com/magento/magento2/issues/29012)

<!-- MC-33730-->

* 现在，对于未定义地区的国家/地区，该应用程序可成功导入包含地区的客户地址。 以前，应用程序引发此错误： `Please enter a valid region`.

<!-- MC-33277-->

* 现在，当商家在计划新导出时选择实体类型时，应用程序会加载正确的实体属性集。

<!-- MC-32956-->

* 产品在产品中的位置 `catalog_category_product` 现在，当管理员在管理员中创建产品并将其分配给类别时，表会按预期更新。 以前，新产品的位置始终被指定为0值。

<!-- MC-34939-->

* 现在，客户数据已成功从管理员中导出，导出数据网格会按预期显示客户数据。 以前，在导出期间发生与内存分配相关的错误。

<!-- MC-34657-->

* 导入的CSV文件现在会按预期捕获相关的产品信息。 以前，在首次导入CSV文件时，相关的产品信息上传不一致。

<!-- MC-37424-->

* 删除中未使用的构造参数 `AdvancedPricing.php`. [GitHub-29531](https://github.com/magento/magento2/issues/29531)

### 索引

<!-- ENGCOM-7073-->

* `Magento_CacheInvalidate` 现在可在执行操作时正确处理大型标记模式 `PURGE`. `sendPurgeRequest` 已重构为处理标记数组，而不是要求调用方使用 `implode()`. _由Matthew O&#39;Loughlin在拉取请求中提交的修复 [26256](https://github.com/magento/magento2/pull/26256)_. [GitHub-26255](https://github.com/magento/magento2/issues/26255)

<!-- MC-30568-->

* 共享索引器现在显示以下状态 **有效** 运行之后 `bin/magento indexer:status` 重新索引之后。 以前，共享索引器使用 **无效** 完全重新索引后的状态。

### 基础架构

<!-- MC-37243-->

* 在运行PHP 7.4.9的部署中加载目录和产品页面时不再出现问题。 以前，当您尝试加载目录和产品页面时，应用程序会引发此错误： `There has been an error processing your request. Exception printing is disabled by default for security reasons`. [GitHub-29502](https://github.com/magento/magento2/issues/29502)

<!-- ENGCOM-7994-->

* 现在，当布局在生产模式下呈现时发生的所有异常都记录在异常日志文件(`var/report`)。 以前，应用程序会在系统日志中将这些消息记录为严重问题。

<!-- ENGCOM-7154-->

* 现在，由于数量增加，正则表达式适用于较大的页面。 `ipcre.backtrack_limi`t和 `pcre.recursion_limit` 增加至约1000000。 _修复了Mateusz Krzeszowiak在拉取请求中提交的错误 [27270](https://github.com/magento/magento2/pull/27270)_. [GitHub-26026](https://github.com/magento/magento2/issues/26026)

<!-- ENGCOM-7483-->

* 改进了拦截器的生成方式。 `} else {` 声明已从拦截器上删除，以及 `array_map` 已替换 `foreach`. _Lukasz Bajsarowicz在拉取请求中提交的修复 [27902](https://github.com/magento/magento2/pull/27902)_. [GitHub-28383](https://github.com/magento/magento2/issues/28383)

<!-- ENGCOM-7651-->

* 阵列创建过程现在在整个类中是一致的(`app/code/Magento/Sales/Model/Order/Pdf/Items/Invoice/DefaultInvoice.php`)。 _由Nathan de Graaf在拉取请求中提交的修复 [28515](https://github.com/magento/magento2/pull/28515)_. [GitHub-28795](https://github.com/magento/magento2/issues/28795)

<!-- ENGCOM-7484-->

* 插件已迁移出框架，以遵循在框架命名空间中禁止插件的最佳实践。 _Lukasz Bajsarowicz在拉取请求中提交的修复 [27965](https://github.com/magento/magento2/pull/27965)_. [GitHub-27962](https://github.com/magento/magento2/issues/27962)

<!-- ENGCOM-7713-->

* 应用程序不再抛出 `Undefined class constant` 生成侦听器时出错。 _Vova Yatsyuk在拉取请求中提交的修复 [28797](https://github.com/magento/magento2/pull/28797)_. [GitHub-28981](https://github.com/magento/magento2/issues/28981)

<!-- ENGCOM-7523-->

* 现在，当您使用已使用的名称保存集成时，如果应用程序引发集成异常，则表单数据会持续存在。 _修复了由Aditya Yadav在拉取请求中提交的错误 [26660](https://github.com/magento/magento2/pull/26660)_. [GitHub-28143](https://github.com/magento/magento2/issues/28143)

<!-- ENGCOM-7756-->

* 应用程序不再截断 `X-Forwarded-For` 标头为32个字符。 _修复了由Ihor Sviziev在拉取请求中提交的错误 [27221](https://github.com/magento/magento2/pull/27221)_. [GitHub-28693](https://github.com/magento/magento2/issues/28693)

<!-- ENGCOM-7820-->

* 现在，使用自定义管理域时，检查重定向是否为内部重定向的逻辑可在管理中正确运行。 以前，此逻辑的问题会导致许多管理员重定向到默认存储的主页。 _Vadim Malesh在拉取请求中提交的修复 [29066](https://github.com/magento/magento2/pull/29066)_. [GitHub-28943](https://github.com/magento/magento2/issues/28943)

<!-- ENGCOM-7758-->

* 的问题 `styles-old.less` 文件已被删除，而且Linting不再标识错误。 _由涂阮在拉取请求中提交的修复 [28895](https://github.com/magento/magento2/pull/28895)_. [GitHub-24004](https://github.com/magento/magento2/issues/24004)

<!-- ENGCOM-7781-->

* `NonComposerComponentRegistration.php` 已重构。 _Vitaliy Ryaboy在拉取请求中提交的修复 [28975](https://github.com/magento/magento2/pull/28975)_. [GitHub-29308](https://github.com/magento/magento2/issues/29308)

<!-- ENGCOM-7926-->

* `ResourceConnection.php` 已进行重构以提高课程可读性。 _Lukasz Bajsarowicz在拉取请求中提交的修复 [29341](https://github.com/magento/magento2/pull/29341)_. [GitHub-29389](https://github.com/magento/magento2/issues/29389)

<!-- ENGCOM-7910-->

* 内置Web服务器的自述文件已更新为包含所有Elasticsearch参数。 _修复了由Yevhenii Dumskyi在拉取请求中提交的错误 [29300](https://github.com/magento/magento2/pull/29300)_. [GitHub-29299](https://github.com/magento/magento2/issues/29299)

<!-- ENGCOM-7814-->

* 此 `Magento\CmsUrlRewrite\Plugin\Cms\Model\Store\View::aftersSave` plugin现在会按预期返回值。 以前，此插件不返回值，因此，保存存储视图会导致错误。 _修复由Pieter Hoste在拉取请求中提交 [29035](https://github.com/magento/magento2/pull/29035)_. [GitHub-29034](https://github.com/magento/magento2/issues/29034)

<!-- ENGCOM-7566-->

* 为添加了以下对魔术方法的支持 `DataObject`：

   * 要支持的新扩展 `get/set/has/uns` magic方法(使用时 `__call`)
   * 支持SessionManager，它将所有调用转发到DataObject容器
   * 扩展的测试覆盖率
   * 更新了筛选错误检查的测试
   * 将PHPStan检查级别从0增加到1。 _Oleksandr Kravchuk在拉取请求中提交的修复 [27905](https://github.com/magento/magento2/pull/27905)_. [GitHub-28303](https://github.com/magento/magento2/issues/28303)

<!-- ENGCOM-7906-->

* `ScopeConfigInterface` 现在可以不只是一个字符串。 限制 `magentoConfigFixture` “ to string only（仅字符串）”是上一拉取请求的意外结果，已还原。 _Kristof， Fooman在拉取请求中提交的修复 [29305](https://github.com/magento/magento2/pull/29305)_. [GitHub-29345](https://github.com/magento/magento2/issues/29345)

<!-- ENGCOM-8000-->

* 此 `convertConfigTimeToUtc` 方法不再由于向发送错误的参数而引发致命错误 `Phrase` 构造函数。 _Kos Rafal在拉取请求中提交的修复 [29483](https://github.com/magento/magento2/pull/29483)_. [GitHub-29525](https://github.com/magento/magento2/issues/29525)

<!-- ENGCOM-7962 -->

* 在以下情况下，价格筛选器现在可在网格数据上按预期工作： `Magento\Backend\Block\Widget\Grid\Column\Filter\Price::getCondition` 和 `Magento\Backend\Block\Widget\Grid\Column\Filter\Price::getValue()` 返回一个数组，其索引包含 `from` 或 `to` 字符串数据。 以前，应用程序引发此错误： `Notice: A non well formed numeric value encountered in vendor/magento/module-backend/Block/Widget/Grid/Column/Filter/Price.php on line 197`. _Nikita Sarychev在拉取请求中提交的修复 [29214](https://github.com/magento/magento2/pull/29214)_. [GitHub-29213](https://github.com/magento/magento2/issues/29213)

<!-- ENGCOM-7911 -->

* 添加了扩展点以支持将HTML添加到“类别”页面。 这会更正上一个拉取请求所导致的错误。 _修复由iGerchak在拉取请求中提交的错误 [29291](https://github.com/magento/magento2/pull/29291)_. [GitHub-29286](https://github.com/magento/magento2/issues/29286)

### 库存

<!-- ENGCOM-7979-->

* 已删除不必要的代码注释 `app/code/Magento/CatalogInventory/Model/StockState.php`. _Vitaliy Prokopov在拉取请求中提交的修复 [27758](https://github.com/magento/magento2/pull/27758)_. [GitHub-26702](https://github.com/magento/magento2/issues/26702)

### 分层导航

<!-- MC-25043-->

* 分层导航侧边栏现在显示具有两个选项(**是**/**否**)和匹配的产品计数。 以前，分层导航不会返回 **否** 选项，用于使用Elasticsearch进行部署时的布尔属性。

<!-- ENGCOM-7493-->

* 样本分层导航筛选器现在与整个Adobe Commerce中使用的标准筛选器一致。 _修复了Bartlomiej Szubert在拉取请求中提交的错误 [28015](https://github.com/magento/magento2/pull/28015)_. [GitHub-28011](https://github.com/magento/magento2/issues/28011)

### 日志记录

<!-- ENGCOM-7692-->

* 现在，当部署仅处于开发人员模式时，将记录所有损坏的引用错误。 以前，在生产模式下也会为部署记录一个错误，这会增加错误日志。 _修复了Bartlomiej Szubert在拉取请求中提交的错误 [28735](https://github.com/magento/magento2/pull/28735)_. [GitHub-26504](https://github.com/magento/magento2/issues/26504)

### 媒体集

<!-- ENGCOM-8014-->

* 媒体集配置UI（管理员） **商店**  >  **配置**  >   **高级**  >  **系统**)已重新组织。 _由Shankar Konar在拉取请求中提交的修复 [29433](https://github.com/magento/magento2/pull/29433)_. [GitHub-28011](https://github.com/magento/adobe-stock-integration/issues/1738)

<!-- ENGCOM-7972 -->

* 添加了测试以涵盖 **使用位置** 媒体集中图像的链接。 _Nazar Klovanych在拉取请求中提交的修复 [29392](https://github.com/magento/magento2/pull/29392)_. [GitHub-1963](https://github.com/magento/adobe-stock-integration/issues/1693)

<!-- ENGCOM-8006-->

* 禁用媒体库后，如果商家尝试保存产品及其相关图像，则应用程序不再引发异常。 _Nazar Klovanych在拉取请求中提交的修复 [29492](https://github.com/magento/magento2/pull/29492)_. [GitHub-1750](https://github.com/magento/adobe-stock-integration/issues/1750)

### MFTF

<!-- ENGCOM-7963 -->

* 此 `AdminSubmitAdvancedInventoryFormActionGroup`， `AdminClickOnAdvancedInventoryLinkActionGroup`、和  `AdminSetStockStatusConfigActionGroup` 操作组现在根据最佳实践在测试中使用。 _Oleh USIA在拉取请求中提交的修复 [29386](https://github.com/magento/magento2/pull/29386)_. [GitHub-29420](https://github.com/magento/magento2/issues/29420)

<!-- ENGCOM-7964 -->

* `SearchProductGridByKeywordActionGroup` 现在用于产品网格中的搜索。 _Oleh Usik在拉取请求中提交的修复 [29385](https://github.com/magento/magento2/pull/29385)_. [GitHub-29434](https://github.com/magento/magento2/issues/29434)

<!-- ENGCOM-7915 -->

* `AdminCategoriesClickDoneButtonOnPopupActionGroup` 现在用于单击 **完成** “搜索类别”弹出窗口中的。 _Oleh Usik在拉取请求中提交的修复 [28989](https://github.com/magento/magento2/pull/28989)_. [GitHub-29380](https://github.com/magento/magento2/issues/29380)

<!-- ENGCOM-7529 -->

* `LoginToStorefrontActionGroup` 现在用于替换一系列用于商店前端客户登录的操作。 _Sathish Subramanian在拉取请求中提交的修复 [28113](https://github.com/magento/magento2/pull/28113)_. [GitHub-28165](https://github.com/magento/magento2/issues/28165)

<!-- ENGCOM-7590 -->

* `AdminUpdateCustomURLRewritesPermanentTest` 已进行重构以符合多边基金的最佳做法。 _Kate Kyzyma在拉取请求中提交的修复 [28361](https://github.com/magento/magento2/pull/28361)_. [GitHub-28393](https://github.com/magento/magento2/issues/28393)

<!-- ENGCOM-7343 -->

* 已更改测试名称以符合MFTF约定。 _修复了由Evgeny Levinsky在拉取请求中提交的错误 [27839](https://github.com/magento/magento2/pull/27839)_. [GitHub-28305](https://github.com/magento/magento2/issues/28305)

#### 新建操作组

<!-- ENGCOM-7991 -->

* `StorefrontCheckoutClickNextButtonActionGroup` _Oleh Usik在拉取请求中提交的修复 [29472](https://github.com/magento/magento2/pull/29472)_. [GitHub-29539](https://github.com/magento/magento2/issues/29539)

<!-- ENGCOM-7857 -->

* `AdminProductFormSaveActionGroup` _Oleh Usik在拉取请求中提交的修复 [29142](https://github.com/magento/magento2/pull/29142)_. [GitHub-29292](https://github.com/magento/magento2/issues/29292)

<!-- ENGCOM-7928 -->

* `AdminSaveCategoryActionGroup` _Oleh Usik在拉取请求中提交的修复 [28993](https://github.com/magento/magento2/pull/28993)_. [GitHub-29388](https://github.com/magento/magento2/issues/29388)

<!-- ENGCOM-7790 -->

* `AdminProductGridSectionClickFirstRowActionGroup` _Oleh Usik在拉取请求中提交的修复 [29000](https://github.com/magento/magento2/pull/29000)_. [GitHub-29295](https://github.com/magento/magento2/issues/29295)

<!-- ENGCOM-7591 -->

* `AdminProductFormCategoryExistInCategoryListActionGroup` 和 `AdminProductFormCategoryNotExistInCategoryListActionGroup` _Alexander Steshuk在拉取请求中提交的修复 [28287](https://github.com/magento/magento2/pull/28287)_. [GitHub-28392](https://github.com/magento/magento2/issues/28392)

<!-- ENGCOM-7867 -->

* `AdminExpandCategoryTreeActionGroup` _Oleh Usik在拉取请求中提交的修复 [29133](https://github.com/magento/magento2/pull/29133)_. [GitHub-29289](https://github.com/magento/magento2/issues/29289)

<!-- ENGCOM-7881 -->

* `AdminTaxRateGridOpenPageActionGroup` _Oleh Usik在拉取请求中提交的修复 [29007](https://github.com/magento/magento2/pull/29007)_. [GitHub-29281](https://github.com/magento/magento2/issues/29281)

<!-- ENGCOM-7868 -->

* `AdminNavigateNewCustomerActionGroup` _Oleh Usik在拉取请求中提交的修复 [29134](https://github.com/magento/magento2/pull/29134)_. [GitHub-29287](https://github.com/magento/magento2/issues/29287)

#### 新测试

<!-- ENGCOM-7600 -->

* 添加了以管理员用户身份删除CMS页面的测试。 _由Dmitry Tsymbal在拉取请求中提交的修复 [28112](https://github.com/magento/magento2/pull/28112)_. [GitHub-28202](https://github.com/magento/magento2/issues/28202)

* 添加了 `StorefrontShareCustomerWishlistActionGroup` 测试客户希望列表与无效电子邮件地址的共享。 希望列表共享的现有测试(`StorefrontShareWishlistEntityTest`)已重构。 `StorefrontCustomerShareWishlistActionGroup` 已弃用。

<!-- ENGCOM-7682 -->

* 添加了测试，以检查的实施 **仅X左侧阈值** 配置设置。 _Oleh Usik在拉取请求中提交的修复 [27549](https://github.com/magento/magento2/pull/27549)_. [GitHub-28755](https://github.com/magento/magento2/issues/28755)

### 新闻稿

<!-- MC-34714-->

* 使用导出新闻稿订阅者列表 `Excel XML` 选项现在会按预期导出所有行。 以前，导出的数据仅包含页面分页值，而不包含所有行。

<!-- ENGCOM-7522-->

* 新闻稿订阅电子邮件现在使用与其他新闻稿相关电子邮件相同的HTML标记。 _修复了Pawel Tylek在拉取请求中提交的错误 [27357](https://github.com/magento/magento2/pull/27357)_. [GitHub-28166](https://github.com/magento/magento2/issues/28166)

<!-- ENGCOM-7788-->

* 添加测试，用于作为管理员用户删除新闻稿订阅者。 _由Dmitry Tsymbal在拉取请求中提交的修复 [28972](https://github.com/magento/magento2/pull/28972)_. [GitHub-29032](https://github.com/magento/magento2/issues/29032)

<!-- ENGCOM-7739-->

* 为配置语句中具有不允许选项的来宾添加了新闻稿订阅测试。 此测试取代了已弃用的测试 `VerifyRegistredLinkDisplayedForGuestSubscriptionNoTest` 和 `StorefrontCreateNewSubscriberActionGroup`. _由Dmitry Tsymbal在拉取请求中提交的修复 [28872](https://github.com/magento/magento2/pull/28872)_. [GitHub-29039](https://github.com/magento/magento2/issues/29039)

### 订单

<!-- ENGCOM-7858-->

* 此 `GetAssetIdByContentFieldInterface` 及其实施 `MediaContent` 模块现在允许Adobe Stock集成扩展 `MediaGallery` 筛选器功能。 _由Gabriel da Gama在拉取请求中提交的修复 [29058](https://github.com/magento/magento2/pull/29058)_. [GitHub-1464](https://github.com/magento/magento2/issues/1464)

<!-- ENGCOM-7885-->

* 此 `CustomerAddressI` 现在会在引号中验证新创建客户的值。 _Andrii Kalinich在拉取请求中提交的修复 [29139](https://github.com/magento/magento2/pull/29139)_. [GitHub-28793](https://github.com/magento/magento2/issues/28793)

<!-- ENGCOM-7798-->

* 总金额为零的贷项通知单的订单状态现在为 `Closed`. 以前，应用程序将其订单状态报告为 `Complete`. _Andrii Kalinich在拉取请求中提交的修复 [29023](https://github.com/magento/magento2/pull/29023)_. [GitHub-22762](https://github.com/magento/magento2/issues/22762)

### 页面生成器

<!-- ENGCOM-7918-->

* 此 `description` 和 `short_description` 产品属性已重新排序，以更好地适应对页面生成器内容暂存的计划更改。 _由Matt Walters在拉取请求中提交的修复 [29238](https://github.com/magento/magento2/pull/29238)_. [GitHub-543](https://github.com/magento/magento2-page-builder/issues/543)

### 支付方式

<!-- MC-34363-->

* 应用产品现在会显示一条消息，提示您输入必需的信用卡数据，然后单击 **提交** 未输入有效付款信息的管理员订单。 以前，当付款输入字段无效且页面处于非活动状态时，Braintree卡验证器不会引发错误。

<!-- MC-33494-->

* 您现在可以从管理员中为帐户中存储了信用卡(Braintree)的客户更改您创建的订单的配送方式。 以前，当您选择其他送货方法时，不会选择存储的卡，并且应用程序不会下订单。

#### PayPal

<!-- MC-33879-->

* 现在，结帐工作流的“订单复查”页通过Braintree订单显示PayPal的正确发运金额，在结帐期间发运方式已更改。 以前，当客户在结帐工作流的“PayPal订单审核”页面上更改配送方式时，应用程序未使用正确的方法更新订单总额。

<!-- MC-34152-->

* 商家现在可以成功取消使用PayPal授权的订单。 以前，应用程序不会取消订单并显示以下错误： `Declined: 10601-Authorization has expired`.

<!-- MC-33330-->

* 当您通过首次完成另一张订单后关闭PayPal付款弹出窗口来取消订单时，应用产品不再清空购物车。

### 性能

* 三个新的配置设置支持减少使用者队列CPU消耗。 这些可选参数可增强对使用者的控制并节省服务器资源。 参见 [配置消息队列](https://developer.adobe.com/commerce/php/development/components/message-queues/configuration/) 以了解 `maxIdleTime`， `sleep`、和 `onlySpawnWhenMessageAvailable` 参数。

<!-- MC-31617-->

* 现在，插件列表配置是在执行 `di:compile` 命令。 此配置信息将根据作用域写入生成的元数据文件夹。 以前，此信息存储在缓存中。 由此产生的性能改进包括：

   * 网络缓存大小已减小
   * 许多场景的执行时间已得到改进。

<!-- ENGCOM-7290-->

* 应用程序现在可按需加载相应的滑块构件，这改进了页面加载。 触控滑块构件自定义已移至单独的文件，因此只能在兼容的设备上加载。 现在，仅当页面上实际使用了范围绑定时，才加载相应的滑块构件类型。 _修复了Mateusz Krzeszowiak在拉取请求中提交的错误 [27616](https://github.com/magento/magento2/pull/27616)_. [GitHub-28807](https://github.com/magento/magento2/issues/28807)

<!-- MC-33107-->

* 提高了多订单同时结账的性能。

<!-- MC-25062-->

* 当导入进程执行批量插入并且重新索引进程同时通过select执行大型插入时，不再发生死锁。 以前，应用程序显示此错误： `PDOException: SQLSTATE[40001]: Serialization failure: 1213 Deadlock found when trying to get lock`. [GitHub-8933](https://github.com/magento/magento2/issues/8933)

### 退货授权(RMA)

<!-- MC-35984-->

* 在您为退货授权(RMA)创建发运标签后，“退货”页面现在可以按预期工作。 以前，商家在为RMA创建送货标签后无法与Returns页面上的任何页面元素进行交互。 这是2.4.0中的一个已知问题，并且 `MC-35984-2.4.0-CE-composer.patch` 已在2.4.0中解决此问题。

<!-- MC-35826-->

* 现在，当具有受限权限的管理员尝试为不再位于分配的网站范围内的产品创建退货时，应用程序会显示信息性错误消息或所有可用产品。 以前，应用程序显示一个空白页。

### 审核

<!-- MC-33405-->

* 的唯一键 `entity_pk_value-entity_type-store_id` 已添加到 `review_entity_summary` 表，以防止为同一产品ID创建重复行(`entity_pk_value`)。 以前，缺少唯一键会导致同一产品ID出现重复行和SQL错误。

### 销售

<!-- MC-35675-->

* 应用程序不再分配状态 `Complete` 对需要零付款的订单开票之后。

<!-- MC-35888-->

* 现在，由REST API生成的新发运电子邮件包含与从管理员手动创建的发运相同的发运和客户信息。 以前，此电子邮件不包含客户名称、跟踪信息、订购的产品和其他订单信息。

<!-- MC-35837-->

* 现在，当管理员加载或自定义电子邮件时，来宾用户名会按预期显示在发票和装运相关电子邮件中。

<!-- MC-35707-->

* PDF发票现在已转换为下订单所在商店视图的语言。 以前，PDF发票是使用管理员的语言翻译的。

<!-- MC-35858-->

* 现在，您可以按预期从贷项通知单页发出退款。 [GitHub-29014](https://github.com/magento/magento2/issues/29014)

<!-- MC-35353-->

* 店面订单页面上显示的本地化区域名称现在可以正确翻译。 以前，区域名称不基于指定的区域设置，除非在“管理员”中进行编辑。

<!-- MC-35633-->

* 通过POST创建的装运 `/rest/V1/shipment` 端点现在可以正确更新订单。 以前，应用产品创建发运，但发运状态仍为处理状态。

<!-- ENGCOM-7639 -->

* 贷项通知单现在显示从发出订单的商店范围中派生出的付款方式。 以前，贷项通知单显示默认存储范围定义的名称。 _由Ledian Hymetllari在拉取请求中提交的修复 [27582](https://github.com/magento/magento2/pull/27582)_. [GitHub-27570](https://github.com/magento/magento2/issues/27570)

### 搜索 {#search-heading}

<!-- MC-31304-->

* 您现在可以使用QuickSearch从“管理员客户”视图中按属性搜索产品。 以前，目录搜索结果页面上发生异常。

<!-- MC-32518-->

* 添加产品属性后，应用程序现在会按预期在类别页面上显示可配置产品。

<!-- MC-33952-->

* Elasticsearch结果现在包含每个商店视图属性选项的正确值。 如果“下拉列表”或“多选”属性在非默认商店视图中的选项值不同于默认商店视图中的选项值，则Elasticsearch现在会对该值进行索引，或者在结果中返回具有该值的产品。 以前，Elasticsearch不对该值进行索引，也不在结果中返回具有该值的产品。

<!-- MC-35013-->

* 现在，通过SKU搜索可按预期方式使用Elasticsearch进行高级搜索。 以前，当您尝试按SKU进行搜索时，应用程序会显示以下错误消息： `We can't find any items matching these search criteria. Modify your search`.

<!-- ENGCOM-7222-->

* 高级搜索不再允许购物者过滤负价格。 _Rohan Hapani在拉取请求中提交的修复 [27359](https://github.com/magento/magento2/pull/27359)_. [GitHub-27358](https://github.com/magento/magento2/issues/27358)

<!-- ENGCOM-7917-->

* 范围值现在在“新建同义词组”窗体上按预期重置。 _Sathish Subramanian在拉取请求中提交的修复 [29206](https://github.com/magento/magento2/pull/29206)_. [GitHub-28947](https://github.com/magento/magento2/issues/28947)

### 配送

<!-- MC-34734-->

* 升级后，应用程序现在可以正确计算运费表费率。 以前，运费表费率是根据不含增值税的净价格计算的。

<!-- MC-35955-->

* 现在，当使用多个地址结帐时，客户可以在结帐工作流的订单审核页面上成功删除奖励点。 以前，应用程序抛出 `404 Not Found` 客户单击 **移除** 按钮以删除任何地址的点。 这是2.4.0中的一个已知问题。

<!-- MC-33737-->

* 现在，对于将FedEx指定为发运方法的订单，应用产品会在结帐工作流中以正确的币种显示发运费率。

<!-- MC-33267-->

* 现在，UPS发运的订单的发运标签的多页PDF会显示正确的计数。

<!-- MC-35514-->

* “创建包”页的JavaScript组件问题已得到解决。 以前，应用程序不显示 **创建送货标签** 复选框，则无法为现有订单创建送货标签。

### Sitemap

<!-- ENGCOM-7924-->

* 中的站点地图 `robots.txt` 现在特定于商店。 _Vadim Malesh在拉取请求中提交的修复 [29331](https://github.com/magento/magento2/pull/29331)_. [GitHub-28901](https://github.com/magento/magento2/issues/28901)

<!-- MC-34617-->

* 现在，经过编码的值会在中正确转义 `sitemap.xml` 文件。 以前，当您在产品名称或图像标题中包含编码字符时，生成的站点地图无效。

### 暂存

<!-- MC-36458-->

* 此 **将产品设置为新产品** 属性标签现在按预期显示在产品的详细信息和计划的更新页面上。

<!-- MC-34484-->

* 您现在可以成功预览CMS块的暂存计划。 以前，应用程序抛出致命错误。

<!-- MC-33789-->

* 现在，在编辑具有计划更新的CMS页面并将其从默认存储重新分配到其他存储时，您可以访问“CMS预览”页面。 以前，单击预览链接时，应用程序抛出404错误。

<!-- MC-33572-->

* 您现在可以使用POST `/V1/products/special-price` 更新产品的特殊价格而不指定 `price_to` 参数值。 以前，会尝试设置价格更新，而不执行 `price_to` 指定的参数不成功。

### 存储

<!-- MC-35853-->

* 删除以前创建的存储视图不会再导致使用拆分数据库配置的部署中出现错误。 以前，应用程序抛出异常。

<!-- MC-32634-->

* 您现在可以导出 `config.php` 和默认网站代码，用于在多网站部署中的第二个网站上安装和配置应用程序。 以前，默认存储和视图在导出后消失，店面发生错误。

### Swagger

<!-- ENGCOM-7720-->

* 您现在可以使用Swagger生成客户令牌。 以前，在输入有效的客户访问信息时，Swagger不会生成响应代码，并且应用程序会显示以下错误： `The account sign-in was incorrect or your account is disabled temporarily. Please wait and try again later`. _Vadim Malesh在拉取请求中提交的修复 [28822](https://github.com/magento/magento2/pull/28822)_. [GitHub-27098](https://github.com/magento/magento2/issues/27098)

### 样本

<!-- ENGCOM-7845-->

* 现在，当购物者单击时，带色板的可配置产品会显示分层定价 **编辑** 在购物车中。 以前，应用程序在结帐前不会在购物车中显示层价格。 _Sathish Subramanian在拉取请求中提交的修复 [29137](https://github.com/magento/magento2/pull/29137)_. [GitHub-28270](https://github.com/magento/magento2/issues/28270)

<!-- MC-33147-->

* 应用程序现在可按预期显示可配置产品变体的层价格。

### TargetRule

<!-- MC-36162-->

* 在以下条件下，产品页面的性能已得到改进：

   * 目标规则模块已安装
   * 实施关联产品功能（相关产品、向上销售和交叉销售产品）

### 税金

<!-- MC-36049-->

* 当商家从产品的属性集中取消分配产品后，应用产品不再在店面上显示产品的固定产品税属性。

### 测试

<!-- ENGCOM-7874-->

* 单元测试中已修复PHPUnit 9错误。 _Anton Evers在拉取请求中提交的修复 [29244](https://github.com/magento/magento2/pull/29244)_. [GitHub-29329](https://github.com/magento/magento2/issues/29329)

<!-- ENGCOM-7995-->

* 添加了用于批准使用已过期的折扣发出的采购订单的单元测试，它将按全额下单，而不会更新采购订单总计。 _修复Joan He在拉取请求中提交的错误 [18](https://github.com/magento/partners-magento2-infrastructure/pull/18)_. [GitHub-204](https://github.com/magento/partners-magento2b2b/issues/204)

<!-- ENGCOM-8003-->

* `SynchronizeFilesInterface` 集成测试现已涵盖。 _修复了由拉取请求中的jmonteros422提交的错误 [29493](https://github.com/magento/magento2/pull/29493)_. [GitHub-1742](https://github.com/magento/magento2/issues/1742)

<!-- ENGCOM-8009-->

* 函数已添加到 `\Magento\TestFramework\TestCase\WebapiAbstract` 这样就可以比较测试中预期结果和实际结果的大型嵌套数组，并允许测试者忽略实际结果中的无关键。 _由Jekabs在拉取请求中提交的修复 [29458](https://github.com/magento/magento2/pull/29458)_. [GitHub-29498](https://github.com/magento/magento2/issues/29498)

<!-- ENGCOM-7887 -->

* 更正了中预期值与实际值的反转 `app/code/Magento/Newsletter/Test/Unit/Model/SubscriptionManagerTest.php`. _Lukasz Bajsarowicz在拉取请求中提交的修复 [29271](https://github.com/magento/magento2/pull/29271)_. [GitHub-29283](https://github.com/magento/magento2/issues/29283)

<!-- ENGCOM-7886 -->

* 使用 `ObjectManager` 用于在测试期间实例化类已在unit tests中替换为new关键字。 _Lukasz Bajsarowicz在拉取请求中提交的修复 [29272](https://github.com/magento/magento2/pull/29272)_. [GitHub-29346](https://github.com/magento/magento2/issues/29346)

<!-- ENGCOM-7593 -->

* 已添加针对以下情况的测试覆盖率： `updateCustomer` 突变：出生日期无效、电子邮件地址无效和客户姓氏为空。 _Alexander Taranovsky在拉取请求中提交的修复 [28304](https://github.com/magento/magento2/pull/28304)_. [GitHub-28394](https://github.com/magento/magento2/issues/28394)

<!-- MC-30844-->

* 此 `ApiFunctional TestFramework` GraphQL客户端现在可以正确解析标头。 [GitHub-26425](https://github.com/magento/magento2/issues/26425)

### 主题

<!-- MC-34397-->

* 现在，在用户代理规则中添加的主题会在您运行时按预期受到影响 `bin/magento catalog:images:resize`. 以前，只有分配给商店的主题会受以下情况的影响： `bin/magento catalog:images:resize` 运行。

### 翻译和区域设置

<!-- MC-20372-->

* 当管理员更改时，应用程序不再引发错误 **日期** 当管理员区域设置为中文或日文时，在管理员产品创建或保存过程中出现的字段。 [GitHub-24696](https://github.com/magento/magento2/issues/24696)

<!-- ENGCOM-7829-->

* 应用程序现在检查区域(前端或 `adminhtml`)，然后渲染内联翻译标记。 以前，调用API `/rest/V1/integration/admin/token` 启用内联翻译时，如果凭据不正确，则会导致在API响应中的错误消息周围包含内联翻译标记。 _Zach Nanninga在拉取请求中提交的修复 [28856](https://github.com/magento/magento2/pull/28856)_. [GitHub-28656](https://github.com/magento/magento2/issues/28656)

<!-- ENGCOM-7536-->

* 保加利亚地区已添加到 `directory_country_region` 表格。 _Nikola Lardev在拉取请求中提交的修复 [27957](https://github.com/magento/magento2/pull/27957)_. [GitHub-28215](https://github.com/magento/magento2/issues/28215)

<!-- ENGCOM-7535-->

* 管理员的标题和按钮 **客户**  >  **添加新地址** 和 **编辑产品**  >  **高级清点** 模型现在可以翻译。 _Sathish Subramanian在拉取请求中提交的修复 [28174](https://github.com/magento/magento2/pull/28174)_. [GitHub-28201](https://github.com/magento/magento2/issues/28201)

<!-- ENGCOM-7521-->

* 术语FPT现在可以在“管理员”上翻译  **商店**  > **配置**  > **销售**  > **税金**  > **固定产品税**. _Vadim Malesh在拉取请求中提交的修复 [28108](https://github.com/magento/magento2/pull/28108)_. [GitHub-5477](https://github.com/magento/magento2/issues/5477)

<!-- ENGCOM-7631 -->

* 此 **运送到此处** “签出工作流送货地址”模式上的按钮标签已更改，以匹配用于其他按钮的驼峰式大小写。 现在，此案例与翻译文件中使用的案例匹配。 以前，由于大小写不匹配，因此不翻译此标签。 _WK在拉取请求中提交的修复 [28547](https://github.com/magento/magento2/pull/28547)_. [GitHub-28685](https://github.com/magento/magento2/issues/28685)

### UI

<!-- ENGCOM-7514-->

* 现在，当显示“隐私和Cookie策略”页面时，页脚中的隐私和Cookie策略链接将显示为活动链接。 _Sathish Subramanian在拉取请求中提交的修复 [28004](https://github.com/magento/magento2/pull/28004)_. [GitHub-27985](https://github.com/magento/magento2/issues/27985)

<!-- MC-36260-->

* 修复了与您从“管理员”中选择的订单关联的发票的“发票注释”文本区域中的光标未对齐问题 **销售** > **订单**.

<!-- MC-36044-->

* 此时会显示“创建新订单”页 **按SKU添加产品** 和 **添加产品** 按钮。

<!-- MC-35974-->

* 当所选产品的产品评级可用时，应用程序现在会正确显示“编辑审阅”页面。

<!-- MC-35475-->

* 现在，该应用程序可在运行Safari的iPhone上正确显示“管理员客户编辑”页面。

<!-- MC-35370-->

* 更正了“创建新订单”页上不必要的滚动。

<!-- MC-35345-->

* 直接单击 **出口税率** “添加新税则”页的按钮(**商店**  >  **税则**)现在可下载 `tax_rates.csv` 文件按预期显示。 以前，商家必须单击 **出口税率** 按钮。 这是2.4.0中的一个已知问题。

<!-- MC-35313-->

* 此 **将选择添加到我的购物车** 购物车底部的按钮现在可按预期工作。 这是2.4.0中的一个已知问题。

<!-- MC-35296-->

* 此 **刷新** 的按钮 **最近查看的产品** 客户活动页面的部分现在可按预期工作。 以前，当您单击 **刷新**，产品列表未刷新，页面进行了滚动。

<!-- MC-35412-->

* 应用程序现在可以在的“条件”选项卡上正确显示用于选择客户出生日期的日历图标 **客户** > **区段** > **添加区段**.

<!-- MC-35658-->

* 当购物者在Internet Explorer 11.x上滚动浏览此页面时，签出工作流的签出摘要部分不再闪烁。

<!-- MC-34602-->

* 应用程序现在可以在店面类别页面上正确显示按SKU排序构件。 以前，不会呈现此构件的HTML代码，并且应用程序不会显示 **加载SKU列表** 链接。

<!-- MC-37444-->

* 已使用禁用的UI组件 `this.disabled(true)` 不再出现在店面。 [GitHub-29098](https://github.com/magento/magento2/issues/29098)

<!-- ENGCOM-7264-->

* 该应用程序现在可以在移动设备视图中正确显示最近查看过的产品构件。 _由涂阮在拉取请求中提交的修复 [27572](https://github.com/magento/magento2/pull/27572)_. [GitHub-27058](https://github.com/magento/magento2/issues/27058)

<!-- ENGCOM-7575-->

* 从管理员更改产品位置现在会反映在店面的产品位置中。 _Oleg Aleksin在拉取请求中提交的修复 [28150](https://github.com/magento/magento2/pull/28150)_. [GitHub-28149](https://github.com/magento/magento2/issues/28149)

<!-- ENGCOM-7507-->

* 登录表单样式现在与空白主题中其他表单上的样式一致。 已删除设置容器控件环绕输入字段宽度的不必要样式。 _由涂阮在拉取请求中提交的修复 [28084](https://github.com/magento/magento2/pull/28084)_. [GitHub-28059](https://github.com/magento/magento2/issues/28059)

<!-- ENGCOM-7578-->

* 此 **确定** 现在，迷你购物车删除产品确认弹出窗口上的按钮的行为与预期一致。 _由涂阮在拉取请求中提交的修复 [28083](https://github.com/magento/magento2/pull/28083)_. [GitHub-27095](https://github.com/magento/magento2/issues/27095)

<!-- ENGCOM-7456-->

* 在页面加载期间，产品库元素不再闪烁。 _修复了Mateusz Krzeszowiak在拉取请求中提交的错误 [27871](https://github.com/magento/magento2/pull/27871)_. [GitHub-28339](https://github.com/magento/magento2/issues/28339)

<!-- ENGCOM-8007-->

* 控制字段宽度的CSS类现在按预期应用于整个Admin中的Start Time元素。 _由Shankar Konar在拉取请求中提交的修复 [29511](https://github.com/magento/magento2/pull/29511)_. [GitHub-29496](https://github.com/magento/magento2/issues/29496)

<!-- ENGCOM-7992-->

* 条款和条件文本标签现在可以正确显示较长的文本字符串。 _修复了Bartlomiej Szubert在拉取请求中提交的错误 [29413](https://github.com/magento/magento2/pull/29413)_. [GitHub-24060](https://github.com/magento/magento2/issues/24060)

<!-- ENGCOM-7967-->

* 已重写订单失败页面的标题以提高准确性。 以前，当购物者取消订单时，应用程序会显示一个具有以下标题的页面： `We received your order!`. _Angelo Romano在拉取请求中提交的修复 [29410](https://github.com/magento/magento2/pull/29410)_. [GitHub-29416](https://github.com/magento/magento2/issues/29416)

<!-- ENGCOM-7770-->

* 现在，已取消订单视图页面上的已取消项目总数在已取消订单视图页面上可正确识别。 以前，此字段标记为 **到期总计**. _Madhu Rajawat在拉取请求中提交的修复 [27516](https://github.com/magento/magento2/pull/27516)_. [GitHub-26191](https://github.com/magento/magento2/issues/26191)

<!-- ENGCOM-7579 -->

* 创建可配置产品页面上的切换按钮现在可按预期工作。 _由涂阮在拉取请求中提交的修复 [28032](https://github.com/magento/magento2/pull/28032)_. [GitHub-22702](https://github.com/magento/magento2/issues/22702)

<!-- ENGCOM-7579 -->

* 现在，“高级属性属性”页面上的高级属性属性块图标的行为与预期一致。 _由涂阮在拉取请求中提交的修复 [28032](https://github.com/magento/magento2/pull/28032)_. [GitHub-26022](https://github.com/magento/magento2/issues/26022)

<!-- ENGCOM-7619 -->

* 现在，当您尝试保存新模块的配置设置时，系统配置页面的“管理员”部分将展开以按预期显示必填字段。 _修复了Bartlomiej Szubert在拉取请求中提交的错误 [28285](https://github.com/magento/magento2/pull/28285)_. [GitHub-26427](https://github.com/magento/magento2/issues/26427)

<!-- ENGCOM-7826 -->

* 当模式设置为时，已更正放大镜的行为 `inside`. _修复了Sean van Zuidam在拉取请求中提交的错误 [29077](https://github.com/magento/magento2/pull/29077)_. [GitHub-29076](https://github.com/magento/magento2/issues/29076)

<!-- ENGCOM-7010 -->

* 更正了购物者在页脚的subscribe字段中输入无效电子邮件地址时导致输入字段宽度过长而令人分心的问题。 _Dipesh Rangani在拉取请求中提交的修复 [27106](https://github.com/magento/magento2/pull/27106)_. [GitHub-27099](https://github.com/magento/magento2/issues/27099)

<!-- ENGCOM-7972 -->

* An `Uncaught ReferenceError` 添加新标记并将鼠标光标移动到该标记上方时，开发控制台中不再显示错误。 _Nazar Klovanych在拉取请求中提交的修复 [29392](https://github.com/magento/magento2/pull/29392)_. [GitHub-1700](https://github.com/magento/magento2/issues/1700)

<!-- ENGCOM-7635-->

* 删除了一个未使用的 `AdminAnalytics` 测试(`TrackingScriptTest`)。 _Lukasz Bajsarowicz在拉取请求中提交的修复 [28605](https://github.com/magento/magento2/pull/28605)_. [GitHub-28850](https://github.com/magento/magento2/issues/28850)

<!-- ENGCOM-7142 -->

* 解决了运行连续测试时静态属性的序列化和取消序列化问题。 _修复了Pavel Bystritsky在拉取请求中提交的错误 [26175](https://github.com/magento/magento2/pull/26175)_. [GitHub-28319](https://github.com/magento/magento2/issues/28319)， [GitHub-29313](https://github.com/magento/magento2/issues/29313)

### URL重写

<!-- MC-34483-->

* 将商店视图移动到其他网站时，不再重置URL。 以前，应用程序错误地重新生成CMS和产品URL重写。

* 您现在可以成功预览CMS块的暂存计划。 以前，应用程序抛出致命错误。

<!-- MC-33028-->

* 将存储视图分配给其他存储时，应用程序现在会按预期保留现有目录URL重写。 以前，应用程序删除了特定于存储的URL重写。

### 清漆

<!-- ENGCOM-7761-->

* 重新启动Varnish不再导致503错误。 _修复了由Ihor Sviziev在拉取请求中提交的错误 [28137](https://github.com/magento/magento2/pull/28137)_. [GitHub-24353](https://github.com/magento/magento2/issues/24353)

### 保险库

<!-- MC-34674-->

* 在以下情况下，应用产品不再保存信用卡号码： **保存供以后使用** 未选中结帐工作流付款部分上的复选框。

### Visual Merchander

<!-- MC-35574-->

* 现在，当您在可视化促销中对产品进行排序，并且启用了库存时，应用程序会显示来源库存而不是默认产品库存。

### Web API框架

<!-- MC-36084-->

* 使用REST创建的发票现在包含与在管理员中创建的发票类似的礼品卡信息。 以前，使用POST `/V1/order/:id/invoice` 要开票，订单未显示已核销的礼品卡代码或礼品卡金额。

<!-- MC-35838-->

* 拥有多个网站的商家现在可以使用REST API创建和更新产品，同时保留图像和图像角色继承。 以前，当商家使用REST API创建和更新产品，以及为商店视图更新产品，以及为商店视图加载和保存默认图像角色时。 因此，存储视图图像角色在更新后停止从默认范围继承。

<!-- MC-36419-->

* 当资源权限允许访问时，无作用域的集成用户帐户现在可以通过REST API访问资源。

<!-- MC-35975-->

* 现在，搜索标准过滤器可按预期用于创建可配置产品期间使用的产品属性。 [GitHub-29126](https://github.com/magento/magento2/issues/29126)

<!-- ENGCOM-7785 -->

* 客户组ID现已通过POST验证 `/rest/V1/customers` 请求。 以前，当您使用无效时，应用程序不会显示错误消息 `group_id` 这些请求中的。 _Vadim Malesh在拉取请求中提交的修复 [28903](https://github.com/magento/magento2/pull/28903)_. [GitHub-28064](https://github.com/magento/magento2/issues/28064)

<!-- ENGCOM-7611 -->

* 默认情况下，不会为匿名REST调用创建PHP会话。 以前，即使没有必要，也会启动会话。 _修复了Maciej Pawlowski在拉取请求中提交的错误 [26032](https://github.com/magento/magento2/pull/26032)_. [GitHub-7213](https://github.com/magento/magento2/issues/7213)

<!-- ENGCOM-7612 -->

* 使用各种REST端点更新包含自定义选项的订单不再删除自定义选项信息。 以前，值位于 `info_buyRequest` 已被删除。 _Vadim Malesh在拉取请求中提交的修复 [28483](https://github.com/magento/magento2/pull/28483)_. [GitHub-22431](https://github.com/magento/magento2/issues/22431)

<!-- ENGCOM-7665 -->

* 使用GET `V1/customers/me` 现在敬上 **共享客户帐户**  设置（管理员） **商店** >  **配置**  >  **客户**  >  **客户配置**  > **帐户共享选项**)时，发送电子邮件给用户。 _修复了Pavel Bystritsky在拉取请求中提交的错误 [28213](https://github.com/magento/magento2/pull/28213)_. [GitHub-26089](https://github.com/magento/magento2/issues/26089)

<!-- ENGCOM-7563 -->

* 与地址相关的扩展属性可以设置为数据阵列。 以前，当包含的POST请求时，应用程序会引发错误  `extension_attributes` 已发送至 `estimate-shipping-methods`. 此错误由以前的提交引入，它影响上设置的任意扩展属性 `Magento\Quote\Api\Data\AddressInterface` 不是什么东西。 _Alexander Menk在拉取请求中提交的修复 [27338](https://github.com/magento/magento2/pull/27338)_. [GitHub-26682](https://github.com/magento/magento2/issues/26682)

<!-- ENGCOM-7618 -->

* 在使用PUT更新客户时，您现在可以指定单个字段 `V1/customers/:id` 端点。 以前，端点要求您指定客户电子邮件和创建客户所需的其他字段。 _Vadim Malesh在拉取请求中提交的修复 [28332](https://github.com/magento/magento2/pull/28332)_. [GitHub-21237](https://github.com/magento/magento2/issues/21237)

### 网站限制

<!-- MC-32366-->

* 启用网站限制不再阻止以访客身份登录的客户的Varnish ESI请求。 以前，这些来宾无法访问主页主菜单。

<!-- MC-32369-->

* 现在，当启用网站限制时，应用程序会按预期加载产品主页。

### 愿望清单

<!-- MC-35810-->

* 现在，您可以使用愿望清单搜索功能，在启用了多个愿望清单支持的部署中，在公共愿望清单中查找产品。 以前，在客户使用愿望清单搜索功能查找产品后，选择该产品，然后单击 **添加到购物车**，应用程序没有将产品添加到购物车并显示此错误： `Invalid Form Key. Please refresh the page`.

<!-- MC-35622-->

* 客户现在可以从愿望清单本身更改愿望清单中产品的数量。 以前，应用程序不更新产品数量，也不显示消息。

<!-- MC-35618-->

* 客户现在可以从愿望清单本身更改愿望清单中分组产品的数量。 以前，应用程序不更新产品数量或显示消息。

<!-- MC-34408-->

* 店面类别页面现在按预期显示愿望清单搜索小组件。

<!-- ENGCOM-7580 7285-->

* 聚合填充 `Map`， `WeakMap`， `FormData`、和 `MutationObserver` 现在仅在需要时加载。 _由Dmitry Tsymbal在拉取请求中提交的修复 [28330](https://github.com/magento/magento2/pull/28330) 和马特乌什·克尔泽索维亚克提出拉取请求 [27618](https://github.com/magento/magento2/pull/27618)_. [GitHub-28377](https://github.com/magento/magento2/issues/28377)， [GitHub-28382](https://github.com/magento/magento2/issues/28382)

<!-- ENGCOM-7561-->

* 希望列表更新过程现在支持同时更新希望列表项及其描述。 _Eduard Chitoraga在拉取请求中提交的修复 [28222](https://github.com/magento/magento2/pull/28222)_. [GitHub-28261](https://github.com/magento/magento2/issues/28261)

<!-- ENGCOM-7564-->

* 应用程序现在可以正确验证购物者可以创建的最大允许愿望清单。 _Eduard Chitoraga在私有存储库合作伙伴magento2ee的拉取请求247中提交的修复_.

<!-- MC-36250-->

* 管理员现在可以配置已由客户从非默认存储添加到愿望清单的可配置产品。 以前，当客户还从非默认商店添加可配置产品时，应用程序会引发错误。

<!-- ENGCOM-7660-->

* 添加了一个测试，用于与超过允许数量的电子邮件共享客户的愿望清单。 _由Dmitry Tsymbal在拉取请求中提交的修复 [28641](https://github.com/magento/magento2/pull/28641)_. [GitHub-28720](https://github.com/magento/magento2/issues/28720)

<!-- ENGCOM-7674-->

* 添加了一个测试，用于以管理员用户身份从客户的愿望列表中删除项目。 _由Dmitry Tsymbal在拉取请求中提交的修复 [28632](https://github.com/magento/magento2/pull/28632)_. [GitHub-28721](https://github.com/magento/magento2/issues/28721)

<!-- ENGCOM-7675-->

* 添加了禁用愿望清单功能的测试。 _由Dmitry Tsymbal在拉取请求中提交的修复 [28635](https://github.com/magento/magento2/pull/28635)_. [GitHub-28744](https://github.com/magento/magento2/issues/28744)

<!-- ENGCOM-7580-->

* 添加了一项测试，说明在共享客户希望列表时使用无效的电子邮件地址。 `StorefrontShareWishlistEntityTest` 已重构。 `StorefrontCustomerShareWishlistActionGroup` 已弃用。 _由Dmitry Tsymbal在拉取请求中提交的修复 [28330](https://github.com/magento/magento2/pull/28330)_. [GitHub-28377](https://github.com/magento/magento2/issues/28377)

<!-- ENGCOM-7717-->

* 添加了用于共享超出允许文本长度限制的客户的愿望清单的测试。 _由Dmitry Tsymbal在拉取请求中提交的修复 [28812](https://github.com/magento/magento2/pull/28812)_. [GitHub-28969](https://github.com/magento/magento2/issues/28969)

## 已知问题

**问题**：使用第三方支付提供商时，用于结账的新CAPTCHA功能在“下订单”页面上无法正常工作。 运行2.3.6或2.4.1且已在下单店面页面上启用验证码保护的商户，在使用第三方支付提供商（如PayPal）结帐时将会看到此错误： `Please provide CAPTCHA code and try again`. **解决方法**：此问题的修复程序现已可用。 请参阅 [签出中的Adobe Commerce v2.3.6/2.4.1验证码不起作用](https://support.magento.com/hc/en-us/articles/360051235772) 知识库文章。 我们的下一个季度修补程序(Q12021)中还将包含一个修补程序。

**问题**：没有管理员权限的用户当前无法设置其个人2FA访问权限。 2FA包括两个ACL角色。 一个角色会影响全局系统配置，只有在配置系统时才需要该角色。 第二个ACL角色影响单个用户2FA帐户。 管理员用户必须配置第二种类型的2FA ACL。 **解决方法**：用户登录并查看访问被拒绝屏幕后，即可访问 `https://<magento store>/<admin_path>/tfa/tfa/requestconfig/` 以强制进行配置。 注意：我们不建议禁用安全设置。 但是，此解决方法仅在禁用管理员URL密钥时有效。

**问题**：此 **创建帐户** 如果购物者输入了无效数据，“创建新帐户”页面上的按钮将保持禁用状态。 这样可防止购物者在出错后重新尝试创建帐户。 **解决方法**：应用修补程序 `MC-38509`. 我们的下一个季度版本（2.4.2、2.4.1-p1和2.3.6-p1）中也将包含修复，这些版本计划于2021年第1季度发布。 请参阅 [2.4.1和2.3.6创建帐户按钮禁用的修补程序](https://support.magento.com/hc/en-us/articles/360051130212) 知识库文章。  [GitHub-30513](https://github.com/magento/magento2/issues/30513)

**问题**：启用dotdigital后，商家无法从Safari中的管理员登录到dotdigital。 请参阅 [启用dotdigital帐户后，无法通过admin面板登录dotdigital](https://support.magento.com/hc/en-us/articles/360050092291) 知识库文章。

**问题**：当购物者选择的送货地址与帐单地址不同时，在付款期间顶点地址验证不起作用。 此问题将在2.4.2中修复。请参阅 [2.4.1已知问题：更新地址后，顶点地址验证消息未消失](https://support.magento.com/hc/en-us/articles/360050139631) 知识库文章。

**问题**：当商家在Safari浏览器上保存Dotdigital Page Builder表单时，应用程序显示空页面。 **解决方法**：重新加载页面以应用更改。 请参阅 [2.4.1已知问题：保存dotdigital Page Builder表单后页面为空](https://support.magento.com/hc/en-us/articles/360049819092) 知识库文章。

**问题**：在某些情况下，应用程序会自动将客户登录到以前使用的Amazon帐户，而不是提示他们在使用Amazon Pay结帐时登录。 请参阅 [2.4.1已知问题：无法在Google Chrome中更改Amazon帐户](https://support.magento.com/hc/en-us/articles/360049814152) 知识库文章。

**问题**：在选择PayPalBraintree支付和多个地址发运时，应用程序会在结账工作流的账单页面上简要显示一条错误消息。 请参阅 [2.4.1已知问题：使用PayPalBraintree结帐时出现错误](https://support.magento.com/hc/en-us/articles/360050253211) 知识库文章。

**问题**：在禁用访客结帐时，如果访客客户尝试通过Braintree使用PayPal下订单，则应用程序会显示非信息性错误消息。 请参阅 [2.4.1已知问题：使用Paypal通过Braintree进行来宾结帐时出现非信息性错误消息](https://support.magento.com/hc/en-us/articles/360050368111) 知识库文章。

## 社区投稿

我们感谢更广泛的Magento Open Source界，并感谢他们对这一版本的贡献。 您可以通过以下方式了解社区对我们当前版本的贡献：

* 如果社区成员提供了此版本的修复，我们会在这些注释的修复问题部分中通过短语来标识修复， ”*社区成员提供的修复*“。

* 社区工程团队 [Magento参与者](https://magento.biterg.io/app/kibana) 按月、季度和年维护最佳贡献个人和合作伙伴的列表。 在该参与者页面中，您可以单击链接，以访问他们在GitHub上合并的PR。

### 合作伙伴投稿

下表列出了合作伙伴的贡献。 此表列出了提出拉取请求的合作伙伴、外部拉取请求以及与其关联的GitHub问题编号（如果可用）。

{{$include /help/_includes/release-notes/engcomm-2-4-1-partner.md}}

### 个人投稿人

下表列出了来自社区成员的贡献。 此表列出了外部拉取请求、与其关联的GitHub问题编号（如果可用）以及促成拉取请求的社区成员。

{{$include /help/_includes/release-notes/engcomm-2-4-1-issues.md}}

### 系统要求

我们的技术栈栈是基于PHP和MySQL构建的。 有关更多信息，请参阅 [系统要求](../../../installation/system-requirements.md).

### 安装和升级说明

您可以使用编辑器安装Adobe Commerce 2.4.1。

## 迁移工具包

数据迁移工具可帮助将现有Magento1.x存储数据转移到Magento2.x。此命令行界面包括验证、进度跟踪、日志记录和测试功能。 有关安装说明，请参阅 [安装数据迁移工具](../../../tools/data-migration-tool/install.md). 考虑探索或参与 [数据迁移存储库](https://github.com/magento/data-migration-tool).

此 [代码迁移工具包](https://github.com/magento-commerce/code-migration) 帮助将现有Magento1.x存储扩展和自定义项传输到Magento2.x。命令行界面包括用于转换Magento1.x模块和布局的脚本。
