---
title: Adobe Commerce 2.4.0发行说明
description: 了解2.4.0 Adobe Commerce版本中的新增功能、增强功能、错误修复和已知问题。
exl-id: 8dc18855-b040-4bc3-8c99-dd7e1407b1fa
source-git-commit: 95ffff39d82cc9027fa633dffedf15193040802d
workflow-type: tm+mt
source-wordcount: '20454'
ht-degree: 0%

---

# Adobe Commerce 2.4.0发行说明

Adobe Commerce 2.4.0引入了对PHP 7.4、Elasticsearch7.6.x和MySQL 8.0的支持。重大的安全更改包括默认情况下在管理员中启用双重身份验证。 B2B增强功能包括新的“订单审批”工作流。

**在此版本中，Authorize.Net、eWay、CyberSource和Worldpay支付方法集成已从核心代码中删除。 商家应迁移到Commerce Marketplace上提供的官方扩展**.

>[!NOTE]
>
>**Braintree支付集成**：在2.4.0之前，建议商户从Commerce Marketplace安装和配置官方Braintree支付集成扩展，以替换核心集成。 在此版本(2.4.0)中，扩展现已包含在版本中。 商家必须执行其他步骤，以确保Braintree在2.4.0部署中正常工作。 参见 [Braintree](https://docs.magento.com/user-guide/payment/braintree.html) 有关如何迁移到2.4.0的更多信息。

此版本包括2.3.5-p1中包含的所有核心质量改进、核心代码的100多项新修复以及30项安全增强。 其中包括我们的社区成员解决226个GitHub问题。 这些社区贡献的内容涵盖从对核心代码进行小幅清理到Inventory management和GraphQL中的重大增强功能。

>[!NOTE]
>
>次要版本带来了代码的大幅增强。 在升级到2.4.0之前，请确认您的环境满足最低要求 [技术栈栈要求](../../../installation/system-requirements.md).

{{bics}}

>[!NOTE]
>
>安全版本的包名称通常附加 — p1。 但是，我们无法避免偏离这些命名惯例2.3.5，这反过来又对后续的安全包名称产生了暂时的涟漪效应。 具体而言，完整功能2.3.5版本是2.3.5-p1。 我们将在2.4.0 GA时发布的安全版本将为2.3.5-p2。 我们希望在以后的版本中恢复为通常的命名惯例。

## 应用 `AC-3022.patch` 继续提供DHL作为运输承运商

DHL引入了架构版本6.2，并将在2022年9月弃用架构版本6.0。 支持DHL集成的Adobe Commerce 2.4.4及更早版本仅支持版本6.0。部署这些版本的商家应适用 `AC-3022.patch` 尽早继续提供DHL作为运输承运商。 请参阅 [应用补丁以继续将DHL作为运输承运人](https://support.magento.com/hc/en-us/articles/7707818131597-Apply-a-patch-to-continue-offering-DHL-as-shipping-carrier) 知识库文章，了解有关下载和安装修补程序的信息。

## 安全补丁可用

商户现在可以安装时效性安全修复，而无需应用完整季度版本（例如2.3.5-p2）提供的数百个功能修复和增强。 修补程序2.3.5.2（Composer包2.3.5-p2）是一个安全修补程序，针对我们以前的季度版本2.3.5-p1中发现的漏洞提供修复。 此安全修补程序中包含应用于2.3.5版的所有修补程序。 (A) *热修复* 提供了对已发布版本的修复，该版本可解决特定问题或错误。)

有关安全修补程序的一般信息，请参见 [引入新的安全修补程序版本](https://community.magento.com/t5/Magento-DevBlog/Introducing-the-New-Security-Patch-Release/ba-p/141287)有关下载和应用安全修补程序（包括修补程序2.3.5-p2）的说明，请参见 [快速启动内部部署](../../../installation/composer.md). 安全修补程序仅包括安全错误修复，而不包括完整修补程序中包含的其他安全增强功能。

## 其他发行信息

虽然这些功能的代码与季度版本捆绑在一起，但其中几个项目(例如B2B、Page Builder、Inventory management和Progressive Web Application(PWA)Studio)也单独发布。 每个项目的文档中都提供了特定于项目的单独发行信息，其中记录了这些项目的错误修复。

## 亮点

在此版本中查找以下亮点：

### 显着的安全增强功能

此版本包括30多项安全修复和平台安全改进。

#### 超过30项安全增强功能，可帮助消除远程代码执行(RCE)和跨站点脚本(XSS)漏洞

到目前为止，尚未发生任何与这些问题相关的已确认攻击。 但是，可能会攻击某些漏洞以访问客户信息或接管管理员会话。 这些问题中的大多数要求攻击者首先获得对管理员的访问权限。 因此，我们提醒您采取一切必要步骤保护您的管理员，包括但不限于以下工作：IP列入允许列表、 [双重身份验证](https://devdocs.magento.com/guides/v2.4/security/two-factor-authentication.html)，使用VPN，使用唯一位置而不是 `/admin`和良好的密码卫生。 参见 [可用于Magento的安全更新](https://helpx.adobe.com/security/products/magento/apsb20-47.html) 以讨论这些修复的问题。

#### 其他安全增强功能

* **实施用于管理员帐户、magento.com用户帐户和云SSH访问的2FA**

   * **保护您的管理员帐户**. 现在，管理员需要双重身份验证(2FA)。 管理员用户必须先配置其2FA，然后才能通过UI或Web API登录到管理员。 2FA默认处于启用状态。 我们强烈建议不要禁用2FA模块。  此额外的身份验证步骤使得恶意用户更难以未经授权登录到管理员。 参见 [双重身份验证(2FA)](https://devdocs.magento.com/guides/v2.4/security/two-factor-authentication.html). <!-- MC-22631-->

   * **保护您的帐户**. 双重身份验证(2FA)提供了一层附加的可选安全层，可以更好地保护您的magento.com帐户，以防未经授权的用户以您不希望的方式使用您的帐户。 参见 [保护您的帐户](https://docs.magento.com/user-guide/magento/magento-account-secure.html).

   * **保护云SSH访问**. 云基础架构上的Adobe提供了多重身份验证(MFA)实施，以管理对云环境的SSH访问的身份验证要求。 默认情况下，项目上未启用2FA的多因素身份验证。  Adobe强烈建议启用此功能。 联系支持人员寻求帮助。 参见 [为SSH访问启用多重身份验证](https://devdocs.magento.com/cloud/project/project-enable-mfa-enforcement.html).

* **默认情况下，模板筛选条件严格模式现在已启用**. 在旧模式下使用模板过滤器的组件（包括CMS页面和块）容易受到远程代码执行(RCE)的攻击。 默认情况下启用严格模式可确保不会故意启用RCE攻击。 <!-- MC-22982-->

* **UI数据提供程序的数据渲染现在默认处于禁用状态**. 这消除了恶意用户执行任意JavaScript的机会。 <!-- MC-17356-->

* **新 `\Magento\Framework\Escaper` 类**. 此类提供给 `.phtml` 模板和负责生成HTML的PHP类。 此类包含与多个上下文相关的HTML清理方法。 此 `$escaper` 内部提供了局部变量 `.phtml` 模板和的使用，而不是已弃用的 `$block->escape{method}`. 使用 `$escaper` 而不是 `$block` 作为使用 `$block->escape{method}` 已弃用。

* **支持security.txt文件**. 此文件是服务器上的行业标准文件，可帮助安全研究人员向站点管理员报告潜在安全问题。

* **增强了对内容安全策略(CSP)的支持**. `SecureHtmlRenderer` 已添加到框架，并可在以下位置找到： `.phtml` 要内联列入白名单的模板 `style` 和 `script` 标记之间。 默认CSP配置不允许使用内联脚本和样式，XML文件可以覆盖这些脚本和样式。 <!-- MC-34433-->

{{cve-notice}}

### 平台升级

以下平台升级有助于增强网站的安全性和性能。 支持的PHP和PHPUnit版本、Elasticsearch、MySQL和其他依赖项列在 [技术栈栈要求](../../../installation/system-requirements.md).

* **引入了PHP 7.4支持，并弃用PHP 7.1和7.2**. 2.4.0引入了对PHP 7.4的支持。

* **支持PHPUnit 9.x并弃用PHPUnit 6.5**. PHP 7.4需要使用最新的PHPUnit测试框架，即PHPUnit 9.x。Commerce Marketplace扩展供应商必须确认所有新的扩展版本都与PHP 7.4兼容，并且所有单元测试和集成测试都已配置为使用PHPUnit 9运行。

* **支持Elasticsearch7.6.x**. Elasticsearch7.6.x现在是Adobe Commerce和Adobe Commerce的默认目录搜索引擎。 如果不安装Elasticsearch7.6.x，则无法安装或升级到版本2.4.0。已删除版本2.x代码的Elasticsearch。 Elasticsearch版本5.x和6.x已被弃用，不再受支持。 参见 [搜索引擎先决条件](../../../installation/prerequisites/search-engine/overview.md).

* **MySQL 8.0支持**. 版本2.4.x支持MySQL 8.x。（2.4.0已通过MySQL 8.0.20进行测试。） 我们鼓励商家将其部署迁移到MySQL 8.x，以利用其改进的性能、安全性和可靠性。 虽然Magento2.4.x仍支持MySQL 5.7，但不再支持MySQL 5.6。 无法使用MySQL 5.6数据库托管2.4.x。 参见 [MySQL](../../../installation/prerequisites/database/mysql.md).

* **MariaDB 10.4支持**. 对MySQL 8.0的支持为商家提供了使用Adobe Commerce部署MariaDB 10.4的机会。 虽然商家仍然可以使用MariaDB 10.2和2.4.0，但我们建议升级到MariaDB 10.4以提高性能和可靠性。 不再支持MariaDB 10.0和10.1（因为此版本中不再支持MySQL 5.6）。
* **删除了MySQL目录搜索引擎**. MySQL搜索引擎已从2.4.0中删除，并取代为默认搜索引擎，但使用Elasticsearch。 Elasticsearch提供卓越的搜索功能以及目录性能优化。  所有商家都必须有Elasticsearch安装和部署2.4.0。参见 [验证是否已安装Elasticsearch](https://experienceleague.adobe.com/docs/commerce-operations/upgrade-guide/prepare/prerequisites.html).

* **将Zend框架上的依赖项迁移到 [Laminas项目](https://getlaminas.org/about/foundation)** 以反映Zend框架到Linux基金会的Laminas项目的转换。 Zend框架已被弃用。 请参阅 [将Zend框架迁移到Laminas项目](https://community.magento.com/t5/Magento-DevBlog/Migration-of-Zend-Framework-to-the-Laminas-Project/ba-p/443251) DevBlog文章。

* **控制器分解** 允许扩展开发人员直接实施ActionInterface，而无需使用“层超类型”类。 请参阅 [控制器分解](https://community.magento.com/t5/Magento-DevBlog/Decomposition-of-Magento-Controllers/ba-p/430883) DevBlog文章。 _由Vinai Kopp在拉取请求中启动的增强功能 [16268](https://github.com/magento/magento2/pull/16268) 最后由Lukasz Bajsarowicz在拉取请求中确定 [26778](https://github.com/magento/magento2/pull/26778)_. [GitHub-9582](https://github.com/magento/magento2/issues/9582)

* **删除了重要欺诈保护法的核心集成**. 不再支持此核心功能。 商家应迁移至 [显着扩展了欺诈和按存储容量使用计费保护功能](https://marketplace.magento.com/signifyd-module-connect.html) 可在Commerce Marketplace上找到的区段。

* 此 **已从代码库中移除核心Braintree模块**. Braintree支付模块现在提供了相同的功能集。 参见 [Braintree付款](https://marketplace.magento.com/paypal-module-braintree.html).

* 不再支持Internet Explorer 11.x浏览器。

### 基础架构改进

此版本包含对核心质量的增强，这些增强改进了Framework和以下模块的质量：客户帐户、目录、CMS、导入、购物车和结帐以及B2B。

* **删除了第三方支付方法的核心集成**. 在此版本中，已从核心代码中删除Authorize.Net支付方法集成。 商家应迁移到Commerce Marketplace上提供的官方扩展。 请参阅 [弃用支付集成](https://community.magento.com/t5/Magento-DevBlog/Deprecation-of-Magento-core-payment-integrations/ba-p/426445) devblog文章。 <!-- MC-29029-->

* **支持Elasticsearch的部分单词搜索（新的默认搜索引擎）**. 在使用快速搜索时，Elasticsearch现在支持在搜索词中使用部分词来搜索产品名称和SKU。 MySQL搜索引擎支持此功能，但已将其弃用，并在此版本中替换为Elasticsearch。

* **PayPal JavaScript SDK升级**. 我们已将PayPal Express Checkout集成迁移到最新的PayPal JavaScript SDK，该SDK可自动收集所需的风险参数并将其传递给PayPal。 PayPal Express Checkout付款方法的行为保持不变。 但是，将此SDK升级到最新版本可让商家访问最新功能和安全增强功能。 <!-- MC-30962-->

* **弃用和删除Web设置向导**. 必须使用命令行安装或升级2.4.0。参见 [安装Magento](../../../installation/advanced.md).

* **Composer更新插件**. Composer插件通过解决必须对根项目进行的更改而简化了升级过程 `composer.json` 文件。 此插件可防止覆盖自定义设置。 参见 [使用编辑器根插件升级](https://experienceleague.adobe.com/docs/commerce-operations/upgrade-guide/implementation/perform-upgrade.html).

* **卖方辅助购物**. 此功能允许商家代表其客户查看店面。 客户选择允许店面访问其帐户。 此社区开发的功能包括由开发的原始扩展 [MAGEVAN](https://magefan.com/). 参见 [卖方辅助购物](https://docs.magento.com/user-guide/configuration/customers/login-as-customer.html). 功能包括：

   * ACL可以针对每个网站配置哪些管理员可以登录到客户帐户
   * 与多个网站和客户帐户范围的兼容性
   * 代表客户下达的订单将记录在店面和管理员
   * 管理员注销后，所有会话都会被销毁，并且管理员无法访问客户密码。

### 性能改进

* **改进了客户数据部分失效逻辑**. 此版本引入了一种使所有客户部分数据失效的新方式，可避免在自定义版本时出现与本地存储有关的已知问题 `sections.xml` 无效处于活动状态。  (以前，当您具有自定义时，私有内容（本地存储）未正确填充 *etc/frontend/sections.xml* 操作无效。) 参见 [私有内容](https://developer.adobe.com/commerce/php/development/cache/page/private-content/).

* **对Redis性能进行多项优化**. 增强功能最大限度地减少了针对每个请求执行的Redis查询次数。 这些优化包括：

   * 减少Redis和Magento之间的网络数据传输量

   * 通过提高适配器自动确定需要加载内容的能力，减少Redis的CPU周期消耗

   * 减少Redis写入操作的竞争条件
   参见 [对页面和默认缓存使用Redis](../../../configuration/cache/redis-pg-cache.md) 和 [配置缓存](../../../configuration/cache/caching-overview.md).

* **改进了对清单表的SQL查询结果的缓存**. 这些增强功能包括：

   * 缓存的SQL查询 `inventory_stock_sales_channel` 表（1个查询而不是16个）

   * 将查询结果缓存到 `inventory_stock` 表（1个查询而不是16个）

* **将“快速订购”添加到购物车的性能提高了25-30%**.

* 商家现在可以使用 [延迟加载](https://en.wikipedia.org/wiki/Lazy_loading) 以加载图像。

### Adobe Stock集成v2.0

**能够从媒体集许可库存图像预览**. 商家现在可以在媒体库中找到任何Adobe Stock预览图像，这减少了许可库存预览图像所需的步骤数。

### 新建媒体集

这是对以前媒体集的替代，为媒体资产提供了一个新的可搜索界面。 管理员现在可以搜索、筛选和排序图像，比早期版本的这项功能快30倍。 商家可以使用此工具来评估店面图像使用情况。 扩展开发人员应注意，为媒体库开发的扩展将无法与新媒体库一起正常工作。

### 页面生成器

页面生成器现在支持PHP 7.4。

### Inventory management

此版本的Inventory management增强功能包括支持店内收取和捆绑销售产品支持。 参见 [Inventory management发行说明](https://experienceleague.adobe.com/docs/commerce-admin/inventory/release-notes.html) 有关最新Inventory management错误修复的更详细讨论。

### GraphQL

GraphQL增强功能包括：

* `pickupLocations` 查询支持库存店内提货功能
* `categories` 查询返回与指定过滤器匹配的类别列表。 此查询与 `categoryList` 查询中它支持分页。
* `reorderItems` 突变允许登录用户将之前订单中的所有产品添加到其购物车中。

请参阅 [GraphQL开发人员指南](https://devdocs.magento.com/guides/v2.4/graphql/) 以了解有关此增强功能和其他增强功能的详细信息。 参见 [发行说明](https://devdocs.magento.com/guides/v2.4/graphql/release-notes.html) 详细讨论了最近的GraphQL错误修复。

### PWA Studio

参见 [兼容性](https://developer.adobe.com/commerce/pwa-studio/integrations/adobe-commerce/version-compatibility/) PWA Studio版本及其兼容版本的列表。 有关增强功能和错误修复的信息，请参阅 [PWA Studio版本](https://github.com/magento/pwa-studio/releases).

### B2B

**适用于B2B的订单审批工作流功能**. 订单审批允许买方组织的经理为其买方配置审批规则。 参见 [批准规则](https://docs.magento.com/user-guide/customers/account-dashboard-approval-rules.html). 功能包括：

* 每个公司帐户独特审批规则的自助配置
* 可基于订单金额、行项目数或具有可配置阈值的发运成本的规则标准
* 该功能各个方面的可自定义权限
* 需要审批的采购订单的快速店面视图
* 每个采购订单上已执行操作的完整历史记录日志
* 在批准流程的所有步骤中向相关方发送电子邮件通知。

此版本还包括多个错误修复。 参见 [B2B发行说明](https://experienceleague.adobe.com/docs/commerce-admin/b2b/release-notes.html).

### 功能测试框架(MFTF)

MFTF v3.0.0包含这些新增功能，并包含对PHP 7.4和PHPUnit 9的支持：

* MFTF帮助程序，可以在测试框架之外创建自定义操作
* 测试实体的架构更新
* 测试模块中的子文件夹
* 嵌套断言语法
* 静态检查，用于检查和报告对已弃用测试实体的引用

此版本还删除了为将测试升级到MFTF主版本要求而添加的已弃用操作和升级脚本。

### 供应商开发的扩展增强功能

此版本包括由第三方供应商开发的扩展。 它在这些扩展中引入了质量和UX方面的改进，并扩展了MFTF覆盖范围。

Commerce Marketplace扩展供应商在发布其2.4.0扩展的新版本时，应确认其扩展与PHP 7.4兼容。

#### dotdigital

此版本包括以下增强功能：

* 由任何输入类型（例如，下拉列表、多选）捕获的客户属性值现在正确同步为数据字段。
* 现在，会为所有活动报价发送购物车分析数据，即使它们不包含任何项目也是如此。 这允许商家在清空购物车时从项目中退出联系人。
* 商家现在可以按单个数据字段同步网站名称、商店名称和商店视图名称。
* 希望列表、查看和订购同步现在仅查找一次事务性数据同步限制。
* Client类的日志记录输出已得到改进，现在在API包装器中的所有方法中是一致的。
* 可配置产品现在有一个库存数字，即其子产品的总和。
* 新的插件可检测由第三方代码（管理员之外）执行的股票更新。
* [数据映射](https://docs.magento.com/user-guide/configuration/dotdigital/data-mapping.html) 和 [事务性电子邮件](https://docs.magento.com/user-guide/configuration/dotdigital/transactional-emails.html) 配置信息已更新。

#### Amazon Pay

此版本包括：

* CSP允许列表的更新
* 能够针对多物料订单执行多项授权
* 支持日语地址

#### Braintree付款

此捆绑扩展取代了我们的核心Braintree集成，此集成已在此版本中移除。 参见 [Braintree付款](https://marketplace.magento.com/paypal-module-braintree.html).

#### 克拉尔纳

此版本包括新的现场消息传送选项，以帮助购物者了解可用的信贷和融资选项。 它还包括对以下方面的改进：

* 退款
* API效率
* Cookie和单元测试
* 折扣
* 配置设置现在包含现场消息传送部分，用于控制韩语促销消息的店面显示。 参见 [设置克拉尔纳](https://docs.magento.com/user-guide/payment/klarna-setup.html).

#### 顶点

此版本的Vertex包括以下新功能和增强功能：

* 对管理员配置用户体验的改进
* 用XML模式文件和修补程序替换安装和升级脚本
* 删除已弃用的代码(`ApiClient` 和 `ClientInterface`)

#### 约特波

Yotpo评级和审阅已与Page Builder集成。

## 修复的问题

我们已在2.4.0核心代码中修复了数百个问题。

### 安装、升级、部署

<!-- MC-23940-->

* 现在，您可以在中成功删除网站以及该网站的特定作用域配置设置 `app/etc/config.php` 如预期。 以前，当您尝试删除网站时，操作失败，应用程序显示以下错误： `The website with code xxx that was requested wasn't found. Verify the website and try again`. 此外，应用程序在店面上显示此错误： `Config files have changed. Run app:config:import or setup:upgrade command to synchronize configuration`. [GitHub-24061](https://github.com/magento/magento2/issues/24061)

<!-- MC-30140-->

* 在中禁用的配置设置 `index.php` 无法再从管理员进行编辑。

<!-- MC-32405-->

* 现在，如果在中预定义了存储配置，则Adobe Commerce安装会成功完成，并会按预期创建存储 `config.php`.

<!-- MC-33151-->

* `\Magento\Store\App\Config\Source\RuntimeConfigSource::getEntities` 已重构，以减少 `SHOW TABLE STATUS` 进行查询。 （此更改将还原为此函数在2.3.3中显示的行为。）

<!-- MC-23890-->

* 每当尝试通过运行来升级数据库时，数据脚本将不再重新运行 `bin/magento setup:upgrade`. 以前，升级脚本会不必要地重新运行，从而影响性能。 [GitHub-19469](https://github.com/magento/magento2/issues/19469)

<!-- MC-30397-->

* 当与Redis的连接中断时，应用程序现在会显示以下行为。 以前，应用程序不会重新加载当前页面并显示以下错误： `An error has happened during application run. See exception log for details`.

   * 管理员和店面会话过期
   * 管理员和店面用户必须再次登录
   * 会话数据保存到 `var/session/`
   * 未记录任何错误或异常。

<!-- ENGCOM-6686-->

* 此 `bin/magento setup:di:compile` 命令不再因匿名类而失败。 _由Yeven Sentiabov在拉取请求中提交的修复 [26533](https://github.com/magento/magento2/pull/26533)_. [GitHub-26532](https://github.com/magento/magento2/issues/26532)， [GitHub-21555](https://github.com/magento/magento2/issues/21555)

<!-- ENGCOM-5546-->

* 解决了在使用替代的LESS编译器（而不是默认随应用程序提供的LESS编译器）时，Magento的Luma主题中的LESS编译问题。 _修复由Pieter Hoste在拉取请求中提交 [24003](https://github.com/magento/magento2/pull/24003)_. [GitHub-23619](https://github.com/magento/magento2/issues/23619)

<!-- ENGCOM-6367-->

* 您不再需要具有可写的 `env.php` 切换为维护模式时的文件。 相反，应用程序会设置 `no-cache` 维护模式下的所有前端请求的标头(`Cache-Control`)。 以前，在以下情况下无法启用维护模式： `env.php` 是只读的，应用程序尝试在切换到维护模式时禁用FPC。 _由Marco k̦ Pcke在拉取请求中提交的修复 [25790](https://github.com/magento/magento2/pull/25790)_. [GitHub-24229](https://github.com/magento/magento2/issues/24229)

<!-- ENGCOM-7236-->

* `db-ssl-verify`  不再导致未定义的索引错误。 `ddev` 设置。 _Daniel Ruf在拉取请求中提交的修复 [26763](https://github.com/magento/magento2/pull/26763)_. [GitHub-26762](https://github.com/magento/magento2/issues/26762)

<!-- ENGCOM-6247-->

* 更新了编辑器依赖关系，以实施Redis密钥过期，从而改进了Redis性能。 _由毒物在拉取请求中提交的修复 [25488](https://github.com/magento/magento2/pull/25488)_. [GitHub-25487](https://github.com/magento/magento2/issues/25487)

### AdminGWS

<!-- MC-33031-->

* 角色范围有限的管理员现在可以修改替换文字，应用程序将保存这些值。 如果不允许管理员修改替换文字，则替换文字框将灰显。

### Adobe Stock集成

<!-- ENGCOM-6507-->

* 已将CSS样式添加到Adobe Stock图像显示，以支持突出显示选定的图像。  _Serhiy Zhovnir在拉取请求中提交的修复 [25864](https://github.com/magento/magento2/pull/25864)_. [GitHub-761](https://github.com/magento/adobe-stock-integration/issues/761)

<!-- ENGCOM-7021-->

* 使用箭头键移动输入字段光标后，不再触发浏览Adobe Stock预览图像的操作。  _Adarsh Manickam在拉取请求中提交的修复 [27138](https://github.com/magento/magento2/pull/27138)_. [GitHub-973](https://github.com/magento/adobe-stock-integration/issues/973)

<!-- ENGCOM-6840-->

* 应用程序现在可以缓存消息，以查找客户尝试将过滤器应用于Adobe Stock图像时发生的错误。 _由Shankar Konar在拉取请求中提交的修复 [26502](https://github.com/magento/magento2/pull/26502)_. [GitHub-863](https://github.com/magento/adobe-stock-integration/issues/863)

<!-- ENGCOM-7195-->

* 单击后将光标移动到窗口的左侧垂直滚动条时，应用程序不再保存Adobe Stock图像的预览 **保存预览** 但未确认保存操作。 _Serhiy Zhovnir在拉取请求中提交的修复 [27399](https://github.com/magento/magento2/pull/27399)_. [GitHub-1002](https://github.com/magento/adobe-stock-integration/issues/1002)

### 分析

<!-- MC-32086-->

* 现在，在您更改商店的URL后，商店的分析报表即可按预期使用。 以前，当您尝试在URL更改后访问报告时，应用程序显示404错误。

<!-- MC-32085-->

* 启用AR订阅后，现在可按预期启用Analytics报表的数据同步。

### 后端

<!-- MC-25036-->

* 电子邮件模板(**管理员** > **营销** > **通信** > **电子邮件模板**)现在可以在启用JavaScript缩小后从管理员中预览。 以前，当您尝试预览电子邮件模板时，“电子邮件预览”弹出窗口为空。 [GitHub-25068](https://github.com/magento/magento2/issues/25068)

<!-- ENGCOM-6433-->

* 在创建具有有限权限的管理员帐户后，管理员现在可以按预期登录到管理员。 以前，无法访问管理员。 相反，具有这些权限的用户被重定向到店面，并显示404错误。 _Eden Duong在拉取请求中提交的修复 [25909](https://github.com/magento/magento2/pull/25909)_. [GitHub-25881](https://github.com/magento/magento2/issues/25881)

<!-- ENGCOM-6785-->

* 当您复制产品时，应用程序不再复制SEO数据，如URL键、元标题、元关键字和元描述。  _由Dasharth Patel在拉取请求中提交的修复 [26659](https://github.com/magento/magento2/pull/26659)_. [GitHub-26054](https://github.com/magento/magento2/issues/26054)

<!-- ENGCOM-6442-->

* 当您从中创建图像时，从页面中删除图像时，应用程序不再引发错误 **管理员**  > **内容** > **页面**  >  **添加新页面**. 以前，应用程序在开发人员控制台中抛出此错误： `500 (Internal Server Error)`. _Eden Duong在拉取请求中提交的修复 [25924](https://github.com/magento/magento2/pull/25924)_. [GitHub-25893](https://github.com/magento/magento2/issues/25893)

### 捆绑产品

<!-- MC-25251-->

* 性能 `catalog_product_price` 改进了捆绑产品重新索引操作。

<!-- MC-29633-->

* 当捆绑产品的时，管理员无法再在管理员中为捆绑产品手动输入税分类 **税分类** 和 **动态价格** 默认存储视图的设置被禁用。 以前，当管理员取消选中 **使用默认值** 选项旁边的 **税分类**，应用程序启用了选项，允许管理员输入其他值并保存产品。

<!-- MC-30257-->

* 现在，可在产品页面上正确计算捆绑包产品价格。

<!-- MC-29745-->

* 现在，您可以向购物车添加任意数量的捆绑销售产品，而不会出错。 以前，在将捆绑包产品添加到购物车，然后导航到购物车时，应用程序显示以下错误： `Please correct the quantity for some products`.

### 缓存

<!-- ENGCOM-7114-->

* 此 `cache.xsd` 架构自 `Magento\Framework\Cache` 已重构，使缓存类型不具有 `instance` 通过管理缓存管理禁用模块时，属性不再导致异常。 以前，在创建缓存类型时，使用 `cache.xml` 不使用 `instance` 参数，则在尝试禁用该参数时，应用程序会引发异常。  _Andrii Beziazychnyi在拉取请求中提交的修复 [27307](https://github.com/magento/magento2/pull/27307)_. [GitHub-26224](https://github.com/magento/magento2/issues/26224)

<!-- ENGCOM-6834-->

* `health_check.php` 如果在部署中配置了数据库缓存引擎，将不再失败。 _Andrii Beziazychnyi在拉取请求中提交的修复 [25722](https://github.com/magento/magento2/pull/25722)_. [GitHub-25669](https://github.com/magento/magento2/issues/25669)

### 购物车和结账

<!-- MC-23870-->

* 在以下情况下，应用程序在签出期间不再引发错误： **与后端同步** 已启用配置设置。 [GitHub-23833](https://github.com/magento/magento2/issues/23833)

<!-- MC-29786-->

* 送货方法的单选按钮现在已在签出工作流中按预期启用。

<!-- MC-30258-->

* 现在，当条款和条件具有时，对于要发运到多个地址的订单，结帐工作流中的订单审核页面会成功加载 **手动应用** 设置已启用。 以前，“审阅”页面未通过验证，应用程序显示404错误。

<!-- MC-32330-->

* 应用程序现在会在购物车上更新价格时显示旋转图标。

<!-- MC-33230-->

* 现在，当迷你购物车中的产品在结账前缺货时，应用程序会显示一条信息性消息。 删除缺货项目后，应用程序会显示 **继续结帐** 按钮。 以前，应用程序不显示此按钮。

<!-- MC-31391-->

* 现在，当您尝试通过单击来添加产品时，应用程序会显示一条信息性错误消息 **按SKU排序** 上传文件损坏时。 以前，应用程序显示一个空白页。

<!-- MC-32962-->

* 应用程序现在仅将购物车价格规则应用于符合规则条件的捆绑产品子产品。 以前，应用程序将购物车价格规则应用于属于捆绑包产品的所有子产品。

<!-- ENGCOM-7485-->

* `StorefrontMiniCartSection`  已替换为`StorefrontMinicartSection` 在MFTF测试中。   _Andrii Kalinich在拉取请求中提交的修复 [27955](https://github.com/magento/magento2/pull/27955)_. [GitHub-27897](https://github.com/magento/magento2/issues/27897)

<!-- ENGCOM-6389-->

* 已删除装运地址表单上对国家选择器组件的硬编码引用。  _修复了Mateusz Krzeszowiak在拉取请求中提交的错误 [25541](https://github.com/magento/magento2/pull/25541)_. [GitHub-22416](https://github.com/magento/magento2/issues/22416)

<!-- ENGCOM-6522-->

* 在Internet Explorer中查看店面时，当光标悬停在购物车中的删除图标上时，应用程序不再为购物车中的删除图标加下划线。  _修复了拉取请求中由divyajyothi5321提交的错误 [26173](https://github.com/magento/magento2/pull/26173)_. [GitHub-26164](https://github.com/magento/magento2/issues/26164)

<!-- ENGCOM-6615-->

* 为帐单地址和送货地址同时选择了单个地址时，更改帐单地址不再更改客户的送货地址。 _由Yurii Tvardyi在拉取请求中提交的修复 [26279](https://github.com/magento/magento2/pull/26279)_. [GitHub-26276](https://github.com/magento/magento2/issues/26276)

<!-- ENGCOM-6251-->

* 迷你购物车的促销区域现在按预期呈现。 _由Matti Vapa在拉取请求中提交的修复 [25375](https://github.com/magento/magento2/pull/25375)_. [GitHub-25373](https://github.com/magento/magento2/issues/25373)

### 购物车价格规则

<!-- MC-23986-->

* 现在，在结帐工作流中会应用基于付款方法的购物车价格规则。 [GitHub-24206](https://github.com/magento/magento2/issues/24206)

<!-- ENGCOM-6550-->

* 更正了上的日期选取器页面元素的行为 **管理员** > **营销** > **促销活动** > **目录价格规则**. _Hitesh在拉取请求中提交的修复 [26290](https://github.com/magento/magento2/pull/26290)_. [GitHub-26289](https://github.com/magento/magento2/issues/26289)

<!-- ENGCOM-7485-->

* `StorefrontMiniCartSection`  已替换为 `StorefrontMinicartSection` 在MFTF测试中。   _Andrii Kalinich在拉取请求中提交的修复 [27955](https://github.com/magento/magento2/pull/27955)_. [GitHub-27897](https://github.com/magento/magento2/issues/27897)

<!-- ENGCOM-5822-->

* 已禁用创建新购物车价格规则工作流中未使用的优惠券网格。 _Eden Duong在拉取请求中提交的修复 [24471](https://github.com/magento/magento2/pull/24471)_. [GitHub-24468](https://github.com/magento/magento2/issues/24468)

<!-- ENGCOM-6615-->

* 为帐单地址和送货地址同时选择了单个地址后，更改帐单地址不再更改客户的送货地址。 _由Yurii Tvardyi在拉取请求中提交的修复 [26279](https://github.com/magento/magento2/pull/26279)_. [GitHub-26276](https://github.com/magento/magento2/issues/26276)

### 目录

<!-- MC-23633-->

* 该应用程序现在禁用受限管理员更改产品数量属性的功能，并按预期禁用高级库存。 以前，只有数量属性的可视化显示受到影响，而应用程序在保存产品后更改了数据库中的数量值。

<!-- MC-25235-->

* 当您更改计划更新中包含的分层产品的名称时，应用程序不再引发错误。 以前，当您尝试使用新名称保存产品时，应用程序会显示以下错误： `SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry '3-0-0-2.0000-0' for key 'UNQ_EBC6A54F44DFA66FA9024CAD97FED6C7', query was: INSERT INTO catalog_product_entity_tier_price (all_groups, customer_group_id, qty, value, website_id, percentage_value, row_id) VALUES (?, ?, ?, ?, ?, ?, ?)`

<!-- MC-29023-->

* 现在，可以按预期从管理员保存自定义属性值。

<!-- MC-29775-->

* 现在，当满足以下条件时，“最近查看产品”功能会显示仅与多存储部署中的当前存储视图关联的产品 **商店** > **配置** > **目录** > **最近查看/比较的产品** > **为当前显示** 设置为 **商店视图**. 以前，应用程序显示所有网站中最近查看过的产品，无论该产品被分配到哪个网站。

<!-- MC-29896-->

* 应用程序现在可以在迷你购物车中显示产品图像而不会失真。 以前，应用程序拉伸迷你购物车中的图像以填充图像容器的整个宽度和高度。

<!-- MC-29866-->

* 此 `getBasePrice` 函数现在会按预期返回浮点值，而不是字符串。

<!-- MC-30229-->

* 产品比较功能现在按预期工作。 它现在只显示当前用户比较列表中的产品。

<!-- MC-30234-->

* 您现在可以为主题指定默认水印。 以前，在分配水印后，应用程序抛出致命错误。

<!-- MC-30540-->

* 现在，您可以从管理员中成功编辑具有多个变体（约5,000个）的可配置产品。 以前，当您尝试编辑具有多个子产品的可配置产品时，应用程序会显示以下错误： `Warning: DOMDocumentFragment::appendXML(): Entity: line 1: parser error : CData section too big found in /vendor/magento/framework/View/TemplateEngine/Xhtml/Template.php on line 60`

<!-- MC-30734-->

* 对属性集进行排序 **管理员** > **目录** > **产品** 现在按预期字母顺序排列。

<!-- MC-30794-->

* 现在，“最近查看的产品”功能在多存储部署中可按预期工作。

<!-- MC-31837-->

* 目录权限受限的管理员现在可以创建可下载的产品。 以前，管理员无法创建可下载的产品，并且应用程序引发错误。

<!-- MC-31838-->

* 此 **网站中的产品** 默认情况下，多站点部署中的受限制管理员已启用“新产品”页面的复选框。 以前，未预先选中非默认网站的复选框，如果管理员未选中该复选框，则应用程序会显示错误消息。

<!-- MC-32772-->

* `addToCart` 现在，可在Data Layer中按预期跟踪事件。 以前，在更改产品的可配置选项后，单击 **添加到购物车**，新 `addToCart` 事件未添加到数据层。

<!-- MC-29449-->

* 迷你购物车和管理员购物车(**管理员** > **客户** > **管理购物车**)现在在应用目录价格规则时显示正确的产品价格。 以前，店面购物车显示正确的产品价格，但迷你购物车和管理员购物车显示原始产品价格。

<!-- MC-30777-->

* 现在，可在管理产品网格网站列上按预期筛选。 以前，筛选器结果不显示正确的产品数量，而是始终将产品总数显示为1。

<!-- MC-31432-->

* 价格条件使用 `catalog_product_entity_decimal` 以按价格过滤。 但是，此表不包含可配置、捆绑动态和分组产品的记录，因为这些产品没有固定价格。 用于按价格过滤的正确表是 `catalog_product_index_price`.

<!-- ENGCOM-7104-->

* 管理员目录和产品列表现在在“MSRP”、“成本”和“特殊价格”列中显示货币符号。 _修复了由Sergiy Vasiutynskyi在拉取请求中提交的错误 [27261](https://github.com/magento/magento2/pull/27261)_. [GitHub-21910](https://github.com/magento/magento2/issues/21910)， [GitHub-20906](https://github.com/magento/magento2/issues/20906)， [GitHub-20472](https://github.com/magento/magento2/issues/20472)

<!-- ENGCOM-6375-->

* “为客户组添加价格”弹出窗口(**管理员** > **目录**  > **产品** > **新产品** > **高级定价**)现在会在您单击关闭图标时按预期关闭。 _Ashna-Jahan在拉取请求中提交的修复 [25759](https://github.com/magento/magento2/pull/25759)_. [GitHub-25433](https://github.com/magento/magento2/issues/25433)

<!-- ENGCOM-6300-->

* 为新产品的描述和标题提供的示例描述不再包含双引号。  _Nathan Morgan在拉取请求中提交的修复 [25655](https://github.com/magento/magento2/pull/25655)_. [GitHub-25654](https://github.com/magento/magento2/issues/25654)

<!-- ENGCOM-6424-->

* 当您尝试在“类别”页面上使用无效价格筛选产品时，应用程序不再引发错误。 以前，应用程序会在系统日志中记录此错误。 _修复了由Ihor Sviziev在拉取请求中提交的错误 [25912](https://github.com/magento/magento2/pull/25912)_. [GitHub-25911](https://github.com/magento/magento2/issues/25911)

<!-- ENGCOM-6455-->

* 您现在可以导航浏览多页面类别搜索结果。 以前，当您尝试使用“返回”按钮返回到结果的第一页时，应用程序会创建重复的搜索结果页。 _Douglas Radburn在拉取请求中提交的修复 [25337](https://github.com/magento/magento2/pull/25337)_. [GitHub-14971](https://github.com/magento/magento2/issues/14971)

<!-- ENGCOM-6194-->

* 将退货类型更正为 `string|null` 对于 `getSourceModel` 中的方法 `Eav\Attribute.php` 类。 _由Mychailo在拉取请求中提交的修复 [25333](https://github.com/magento/magento2/pull/25333)_. [GitHub-25278](https://github.com/magento/magento2/issues/25278)

<!-- ENGCOM-6625-->

* 保存新的（重复的）产品不再导致产品图像重复数百次。 _由Jeroen在拉取请求中提交的修复 [25875](https://github.com/magento/magento2/pull/25875)_. [github-9466](https://github.com/magento/magento2/issues/9466)

<!-- ENGCOM-6818-->

* 当您删除具有类型的自定义选项的产品时，应用程序不再引发JavaScript错误 `file` 从管理员创建订单期间。  _修复了拉取请求中由adrian-martinez-interactiv4提交的错误 [24843](https://github.com/magento/magento2/pull/24843)_. [GitHub-24842](https://github.com/magento/magento2/issues/24842)

<!-- ENGCOM-6959-->

* 使用创建无图像产品 `product_page_image_large` 在布局中，占位符图像按预期显示。 以前，应用程序引发此错误： `Fatal error: PHP Fatal error: Uncaught TypeError: Argument 1 passed to Magento\Catalog\Block\Product\ImageFactory::getRatio() must be of the type integer, null given`. _Lukasz Bajsarowicz在拉取请求中提交的修复 [26974](https://github.com/magento/magento2/pull/26974)_. [GitHub-26973](https://github.com/magento/magento2/issues/26973)

<!-- ENGCOM-6983-->

* 您可以使用 `POST /V1/:sku/links` 端点，用于在产品具有现有链接时通过空的产品数组设置产品链接。 以前，应用程序抛出错误。 _Sathish Subramanian在拉取请求中提交的修复 [26979](https://github.com/magento/magento2/pull/26979)_. [GitHub-26800](https://github.com/magento/magento2/issues/26800)

<!-- ENGCOM-7151-->

* 现在，您可以使用产品网格中的操作下拉菜单，指定当您从管理员更新多个产品的属性时，产品是否具有权重。  _修复了Bartomiej Szubert在拉取请求中提交的错误 [26075](https://github.com/magento/magento2/pull/26075)_. [GitHub-6310](https://github.com/magento/magento2/issues/6310)

<!-- ENGCOM-7453-->

* 验证逻辑已添加到 **网格上每页的产品允许值** 和 **网格上每页产品默认值** 存储配置页面的字段。 以前，存储管理员可以在这些字段中输入不可用的值。  _Lukasz Bajsarowicz在拉取请求中提交的修复 [27093](https://github.com/magento/magento2/pull/27093)_. [GitHub-27089](https://github.com/magento/magento2/issues/27089)_

### 目录规则

<!-- ENGCOM-6550-->

* 更正了上的日期选取器页面元素的行为 **管理员** > **营销** > **促销活动** > **目录价格规则**. _Hitesh在拉取请求中提交的修复 [26290](https://github.com/magento/magento2/pull/26290)_. [GitHub-26289](https://github.com/magento/magento2/issues/26289)

<!-- ENGCOM-5122-->

* 现在，目录价格规则可按产品详细信息页面上的预期使用自定义选项。 _修复了Pavel Bystritsky在拉取请求中提交的错误 [22917](https://github.com/magento/magento2/pull/22917)_. [GitHub-22856](https://github.com/magento/magento2/issues/22856)

### 目录小组件

<!-- MC-29167-->

* 此 `CatalogWidget` 现在，“产品”列表可按预期方式与锚点类别一起使用，锚点类别中的产品现在可匹配并显示。 以前，当您选择作为锚点的父类别，但不包含分配的产品时，产品在小部件中不可见。

<!-- MC-30260-->

* 应用程序现在会按预期显示选定父类别的所有子项。 以前，如果您选择的父类别是锚点，但不包含分配的产品，则应用程序不会显示所有嵌套产品。

<!-- MC-31171-->

* 现在，“最近查看的产品”小组件在以下情况下可正常工作： **商店** > **配置** > **目录** > **目录** > **最近查看/比较** > **将构件产品与后端存储同步** 设置为 **是**.

### CMS内容

<!-- MC-29619-->

* 您现在可以保存和复制所有CMS页面。 以前，当您尝试复制某些页面时，应用程序会引发此异常： `Unique constraint violation found`.

<!-- MC-30963-->

* 如果块被分配给不同的存储视图，则应用程序现在允许您创建具有相同名称的CMS块。

<!-- MC-30103-->

* 现在，可以按预期缓存从图库图像缩略图中选择。 以前，这些图像会动态调整大小。

<!-- MC-32275-->

* 在保存已分配给多个存储区的CMS页面时，应用程序不再引发错误。 以前，当您创建或编辑CMS页面时，应用程序会保存该页面，但也会引发以下错误： `Item (Magento\VersionsCms\Model\Hierarchy\Node) with the same ID "PAGE_ID" already exists`.

<!-- MC-32452-->

* 新的CMS页面现在按预期添加到网站的商店页面层次结构中。

<!-- ENGCOM-7033-->

* CMS页面自定义布局更新逻辑已得到改进。 应用程序现在应用以下位置的特定布局更改： `cms_page_view_selectable_home_somechanges.xml`. _修复了由Sergiy Vasiutynskyi在拉取请求中提交的错误 [27131](https://github.com/magento/magento2/pull/27131)_. [GitHub-26758](https://github.com/magento/magento2/issues/26758)

### 清理

<!-- ENGCOM-6573-->

* 从模块XML中删除了一个额外的结束标记。 _修复了由Tejash Kumbhare在拉取请求中提交的错误 [26339](https://github.com/magento/magento2/pull/26339)_. [GitHub-26338](https://github.com/magento/magento2/issues/26338)

<!-- ENGCOM-6521-->

* 已纠正的对齐错误 **我的帐单地址和送货地址相同** 复选框位于结帐工作流的“复查和付款”页面部分。  _修复了拉取请求中由divyajyothi5321提交的错误 [26169](https://github.com/magento/magento2/pull/26169)_. [GitHub-26168](https://github.com/magento/magento2/issues/26168)

<!-- ENGCOM-6581-->

* 删除了签出工作流的“送货地址”部分上的字段标签和星号之间不必要的空格。  _Daniel Ruf在拉取请求中提交的修复 [26285](https://github.com/magento/magento2/pull/26285)_. [GitHub-26275](https://github.com/magento/magento2/issues/26275)

<!-- ENGCOM-6480-->

* 更正了签出工作流的“送货方法”部分上的单选按钮未对齐的问题。  _Hitesh在拉取请求中提交的修复 [25966](https://github.com/magento/magento2/pull/25966)_. [GitHub-25962](https://github.com/magento/magento2/issues/25962)

<!-- ENGCOM-6579-->

* 更正了移动视图中菜单间距不一致的问题。 _Hitesh在拉取请求中提交的修复 [26238](https://github.com/magento/magento2/pull/26238)_. [GitHub-26235](https://github.com/magento/magento2/issues/26235)

<!-- ENGCOM-7225-->

* 更正了移动视图中迷你购物车“编辑”和“删除”图标的对齐错误。  _Vasilii Burlacu在拉取请求中提交的修复 [27493](https://github.com/magento/magento2/pull/27493)_. [GitHub-26652](https://github.com/magento/magento2/issues/26652)

<!-- ENGCOM-6967-->

* 更正了税率“邮政编码”范围与“添加新税率”/“邮政编码”页上的复选框的对齐错误(**管理员**  >  **存储**  >  **税金** >  **税区和税率**)。 _Sathish Subramanian在拉取请求中提交的修复 [26932](https://github.com/magento/magento2/pull/26932)_. [GitHub-26917](https://github.com/magento/magento2/issues/26917)

<!-- ENGCOM-7237-->

* 从设置向导到管理员的链接现在按预期工作。 _Oleh Usik在拉取请求中提交的修复 [26100](https://github.com/magento/magento2/pull/26100)_. [GitHub-24990](https://github.com/magento/magento2/issues/24990)

<!-- ENGCOM-6531-->

* 已在“管理”的“缓存管理”网格的“状态”列上禁用排序。 _Sathish Subramanian在拉取请求中提交的修复 [26215](https://github.com/magento/magento2/pull/26215)_. [GitHub-26208](https://github.com/magento/magento2/issues/26208)

<!-- ENGCOM-7015-->

* 已纠正页面上页面元素的对齐错误 **管理员** >  **商店**  >  **属性**  > **评级** >  **添加新评级** 对话框。 _Sathish Subramanian在拉取请求中提交的修复 [27014](https://github.com/magento/magento2/pull/27014)_. [GitHub-26992](https://github.com/magento/magento2/issues/26992)

<!-- ENGCOM-6485-->

* 更正了“添加设计更改”页面上日历图标的对齐错误。 _Eduard Chitoraga在拉取请求中提交的修复 [26063](https://github.com/magento/magento2/pull/26063)_. [GitHub-20379](https://github.com/magento/magento2/issues/20379)

<!-- ENGCOM-6447-->

* 移除了主页悬停菜单上的子菜单显示中不必要的空间。 _Hitesh在拉取请求中提交的修复 [25973](https://github.com/magento/magento2/pull/25973)_. [GitHub-25972](https://github.com/magento/magento2/issues/25972)

<!-- ENGCOM-6534-->

* 更正了店面产品详细信息页面上的价格标签对齐错误。 _修复了拉取请求中由divyajyothi5321提交的错误 [26237](https://github.com/magento/magento2/pull/26237)_. [GitHub-25936](https://github.com/magento/magento2/issues/25936)

<!-- ENGCOM-6536-->

* 已更正缺货文本与  **添加到购物车** “产品列表”页面上的按钮。  _修复了拉取请求中由divyajyothi5321提交的错误 [26183](https://github.com/magento/magento2/pull/26183)_. [GitHub-26181](https://github.com/magento/magento2/issues/26181)

<!-- ENGCOM-6458-->

* 集成成功消息显示于  **管理员**  > **系统** > **扩展** > **集成** 现在可以正确显示。 _修复了拉取请求中由divyajyothi5321提交的错误 [26011](https://github.com/magento/magento2/pull/26011)_. [GitHub-25930](https://github.com/magento/magento2/issues/25930)

### 可配置产品

<!-- MC-23546-->

* 现在可以通过API成功禁用可配置产品的子产品。

<!-- MC-30391-->

* 带有的购物车价格规则 **条件集为“类别”（仅限父级）** 现在总是按预期工作。

<!-- MC-30989-->

* 现在，您可以从交叉销售选项卡将可配置产品添加到购物车。 当您选择产品并单击 **添加到购物车** 从此选项卡，您将转到产品详细信息页面，您可以在其中选择特定的产品选项。 以前，应用程序会将您重定向到404错误页面。

<!-- MC-32411-->

* 当链接这些产品的API调用失败时，应用程序不再将简单产品链接到可配置产品。

<!-- ENGCOM-6483-->

* 更正了可配置产品的当前变体列表中SKU的呈现。 _修复了由KaushikChavda在拉取请求中提交的错误 [26007](https://github.com/magento/magento2/pull/26007)_. [GitHub-25591](https://github.com/magento/magento2/issues/25591)

<!-- ENGCOM-6460-->

* 您现在可以保存 `system.xml` 配置信息，方法是：  **管理员** > **系统** > **配置** 位于没有关联标签的字段中。 _由Andrii Chorniy在拉取请求中提交的修复 [25985](https://github.com/magento/magento2/pull/25985)_. [GitHub-23899](https://github.com/magento/magento2/issues/23899)

<!-- ENGCOM-6689-->

* 性能 `\Magento\ConfigurableProduct\Model\Product\Type\Configurable::isSalable` 已优化。  _修复了由Stanislav Ilnytskyi在拉取请求中提交的错误 [26071](https://github.com/magento/magento2/pull/26071)_. [GitHub-26065](https://github.com/magento/magento2/issues/26065)

<!-- ENGCOM-6992-->

* 改进了负责更新可配置产品映像的逻辑。 以前，与可配置产品相关联的简单产品仅显示与可配置产品相关联的默认图像，并且应用程序有时显示错误的产品主图像。 _修复了由Sergiy Vasiutynskyi在拉取请求中提交的错误 [26560](https://github.com/magento/magento2/pull/26560)_. [GitHub-26473](https://github.com/magento/magento2/issues/26473)， [GitHub-26856](https://github.com/magento/magento2/issues/26856)， [GitHub-26858](https://github.com/magento/magento2/issues/26858)

<!-- ENGCOM-6520-->

* 现在，当您选择可配置产品的折扣选项时，应用程序会按预期显示产品的特殊价格。 以前， `class="normal-price"` 未更改为 `class="special-price"` 于已选择折扣期权时确认。 _Ravi Chandra在拉取请求中提交的修复 [26170](https://github.com/magento/magento2/pull/26170)_. [GitHub-24972](https://github.com/magento/magento2/issues/24972)

### Cookie

<!-- MC-24182-->

* 此 `setRedirectCookie` 和 `clearRedirectCookie` 功能现在按预期工作。 以前，这些函数会将Cookie发送到浏览器，但缺少所有Cookie参数。 [GitHub-24547](https://github.com/magento/magento2/issues/24547)

<!-- MC-30789-->

* 当客户导航到新商店而不接受Google Tag Manager Cookie时，将不再触发Google Tag Manager标记。

<!-- ENGCOM-6891-->

* 元数据已添加到 `setRedirectCookie` 和 `clearRedirectCookie` 函数。  _Alexander Lukyanov在拉取请求中提交的修复 [24612](https://github.com/magento/magento2/pull/24612)_. [GitHub-24547](https://github.com/magento/magento2/issues/24547)

### 自定义客户属性

<!-- MC-30739-->

* 应用程序现在会按预期在结账工作流的地址部分显示自定义客户地址属性值。 以前，应用程序显示自定义客户地址属性代码而不是值，并触发了JavaScript错误。

<!-- MC-32301-->

* 当您在中包含空的客户属性字段时，应用程序不再引发错误 **要在其中使用的Forms** 在店面创建公司帐户时显示的字段。 以前，应用程序引发此错误： `PHP Fatal error: Uncaught TypeError: Argument 2 passed to Magento\Eav\Model\Attribute\Data\Text::validateLength() must be of the type string, null given`.

<!-- MC-33361-->

* 该应用程序现在可以保存自定义客户地址属性，并按照预期在注册表单中实施这些属性。 以前，当您在从购物车中创建帐户时创建新的自定义客户地址属性时，应用程序不会保存属性信息。

### 客户

<!-- MC-29102-->

* 注册新帐户后，不再取消订阅作为来宾订阅快讯的客户。

<!-- MC-29841-->

* 应用程序现在使用新的 `PHPSession` 每次更改密码。

<!-- MC-30650-->

* 您现在可以使用上的关联至网站下拉菜单，成功创建客户并将其与特定网站关联 **客户** > **所有客户** > **添加新客户**. 以前，当您尝试在多站点部署中将新客户与非默认网站关联时，应用程序会显示以下错误： `The store view is not in the associated website`.

<!-- MC-29946-->

* 现在，当交易最初由于信用卡无效而被拒绝，但后来成功完成时，应用产品会保存客户在结账期间在默认帐单和送货字段中输入的信息。 以前，尽管应用产品在客户输入有效付款信息时创建了订单，但是它没有更新结帐工作流中“我的帐户”部分的默认帐单或送货地址。

<!-- MC-32325-->

* 现在，当您从管理员在多站点部署中创建新客户时，应用程序会遵循客户组设置。

<!-- MC-31481-->

* 现在，应用程序使用成功导入客户数据 **客户和地址（单个文件）** 选项条件 `cron` 已启用，并且客户网格索引器设置为 **按计划更新**. 晚于 `cron` 执行时，导入的客户信息在管理员中按预期可用。 以前，应用程序会导入客户数据，但不会使用新导入的客户记录更新客户网格。

<!-- MC-31117-->

* 当需要出生日期时，您现在可以从店面创建新客户。 以前，即使输入了有效的DOB值，您也无法在需要此字段时创建新客户。 [GitHub-26700](https://github.com/magento/magento2/issues/26700)

<!-- MC-31945-->

* 从管理员创建的客户现在会按预期遵循默认客户组设置。

<!-- MC-31435-->

* 此 `PHPSessionId` 在客户注销并重新登录后，现在会按预期更改。

<!-- MC-32152-->

* 现在，客户购物车的管理员视图会显示多网站部署中从多个网站添加到购物车的所有产品。 以前，当客户将产品从非默认网站添加到购物车时，即使当 **共享客户帐户** 设置为 **全局**.

<!-- ENGCOM-7036-->

* 现在，验证可按预期方式用于 **出生日期** 从管理员编辑客户时显示的字段。 以前，应用程序不考虑用户区域设置，对于某些生日，会显示以下错误： `The Date of Birth should not be greater than today`.   _修复了由Sergiy Vasiutynskyi在拉取请求中提交的错误 [27149](https://github.com/magento/magento2/pull/27149)_. [GitHub-27027](https://github.com/magento/magento2/issues/27027)

<!-- ENGCOM-6208-->

* 从管理员下订单时不再需要电子邮件字段。  _由solwininfotech在拉取请求中提交的修复 [24479](https://github.com/magento/magento2/pull/24479)_. [GitHub-22251](https://github.com/magento/magento2/issues/22251)

<!-- ENGCOM-6667-->

* 现在，当管理员查看购物车时，应用程序仅显示客户放入购物车的产品。 以前，从管理员那里查看时，客户的购物车会显示目录中的所有产品。 _Ravinder在拉取请求中提交的修复 [26489](https://github.com/magento/magento2/pull/26489)_. [GitHub-26437](https://github.com/magento/magento2/issues/26437)

<!-- ENGCOM-6423-->

* “我的帐户”仪表板现在在移动视图中正确显示电子邮件地址值。 _Eden Duong在拉取请求中提交的修复 [25942](https://github.com/magento/magento2/pull/25942)_. [GitHub-25935](https://github.com/magento/magento2/issues/25935)

<!-- ENGCOM-7034-->

* 单击 **创建帐户** 客户注册表单上的按钮不再多次提交注册请求。 _由princeCB在拉取请求中提交的修复 [26642](https://github.com/magento/magento2/pull/26642)_. [GitHub-26590](https://github.com/magento/magento2/issues/26590)

### 客户区段

<!-- MC-29471-->

* 当您以分配给客户区段的用户的身份登录时，当客户区段包含过去订单的条件时，应用程序不再从客户区段中删除您的客户帐户。 以前，您必须单击 **刷新区段数据** 登录后，应用程序会在Matched Customers列表中显示您的帐户。

<!-- MC-30466-->

* 当区段条件包括订单总数时，客户区段现在可按预期工作。

<!-- MC-32409-->

* 现在，当客户帐户设置为全局共享时，可按预期应用客户区段规则。

<!-- MC-33081-->

* 我们改进了编辑和保存包含大量客户（超过300万）的客户区段的性能。 以前，当您创建或编辑包含许多客户的客户区段时，应用程序会引发500错误。

### 目录

<!-- MC-33168-->

* “默认状态”下拉菜单现在由数据填充，该数据基于在您为配置值时分配给所选网站的允许的国家/地区 **默认纳税目标计算** 字段。 以前，此下拉列表列出分配给默认网站的国家/地区。

### 可下载

<!-- MC-32306-->

* 您现在可以使用导入文件按SKU和描述批量更新可下载的产品。 以前，发生验证错误，导入失败。

### 动态块（以前称为横幅）

<!-- MC-23852 31632-->

* 现在，动态块可按预期用于客户区段。 当应触发动态块的条件未满足时，应用程序不再显示动态块。 以前，当购物车为空时，应用程序会为以访客身份登录的用户显示一个动态块。

<!-- MC-32652-->

* 动态块现在根据客户区段和商店视图在店面中呈现。

### EAV

<!-- MC-29999-->

* 应用程序现在遵循特定于存储的设置，这些设置确定在多站点部署中是否需要签出工作流的电话号码字段。 以前，在部署中，如果一个存储要求在签出工作流中填写此字段，而另一个存储未填写，则在签出时未要求填写此字段的客户会遇到此错误： `Please check the shipping address information. "telephone" is required. Enter and try again`.

<!-- ENGCOM-6489-->

* EAV排序依据 `attribute option_id` 现在按预期工作。 _Tan Sezer在拉取请求中提交的修复 [24360](https://github.com/magento/magento2/pull/24360)_. [GitHub-24357](https://github.com/magento/magento2/issues/24357)

<!-- ENGCOM-7082-->

* 现在，您可以通过REST添加新属性，并将其分配给管理员的属性集后，再创建新产品。 以前，应用程序抛出500错误。  _修复了由Sergiy Vasiutynskyi在拉取请求中提交的错误 [27191](https://github.com/magento/magento2/pull/27191)_. [GitHub-26827](https://github.com/magento/magento2/issues/26827)

### 电子邮件

<!-- MC-32842-->

* 向客户请求退货时发送的授权电子邮件现在按预期包含RMA状态。 以前，此电子邮件显示空字符串，而不是预期的返回状态。

<!-- MC-32864-->

* 当客户在全局共享客户帐户的多站点部署中报告忘记密码时，不再从当前网站重定向客户。 以前，客户会被重定向到创建帐户的网站。

<!-- MC-31544-->

* 向客户发送的订单确认电子邮件现在按预期包括订购项目列表。 以前，当您通过加载和保存默认模板在“管理员”中创建电子邮件模板时，从此模板生成的电子邮件不包括已排序项目的列表。 [GitHub-26882](https://github.com/magento/magento2/issues/26882)

### 框架

* Zend框架上的依赖项已迁移到 [Laminas项目](https://getlaminas.org/about/foundation) 以反映Zend框架到Linux基金会的Laminas项目的转换。 Zend框架已被弃用。 _修复了由Ihor Sviziev在拉取请求中提交的错误 [26436](https://github.com/magento/magento2/pull/26436)_. [GitHub-26335](https://github.com/magento/magento2/issues/26335)

<!-- MC-25257-->

* 现在，对于使用荷兰语区域设置的管理员帐户，特殊价格范围设置（起始/截止日期）可正常使用。

<!-- MC-29388-->

* `php bin/magento cron:run` 不再多次处理更改日志表中的项目。 以前，当更改日志表中有超过100000个新版本时，可能会多次调用同一版本的操作 `entity id`.

* 此 `php bin/magento setup:cron:run` 命令现已删除。 此外，升级时，请删除crontabs中对此文件的引用。

* 此 `update/cron.php` 文件已在2.4.0中删除，如果该文件存在于您的安装中，则可以安全地将其删除。 此外，升级时，请删除crontabs中对此文件的引用。

<!-- MC-30544-->

* Update Attribute操作现在可以正确更新产品的时间戳 `updated_at column` 起始日期 `catalog_product_entity` 从管理员编辑产品页面更新产品时。

<!-- MC-30834-->

* 设置 `'persistent' => '1'` 在 `env.php` 运行时不再引发错误 `setup:upgrade`.

<!-- MC-32243-->

* 此 **表单键无效。 请刷新页面** 登录页面上的文本字符串现在按预期翻译。

<!-- MC-33278-->

* 我们改进了 `Magento\Framework\App\DeploymentConfig\Reader::load` 函数。 以前，向Magento发出请求时，会重复调用此函数，这导致 `config.php` 和 `env.php config` 每次调用方法时加载的文件。

<!-- MC-31728-->

* 应用程序不再下载 `blank.html` 页面。

<!-- MC-31729-->

* 在引用说明中为页面上不存在（未声明）的组件向默认布局中添加了不可缓存的块，这些块不再影响页面缓存。 将不可缓存块添加到默认布局处理程序会使得所有页面都不可缓存。 这是布局生成过程的结果：在布局生成期间，应用程序收集特定页面的所有可用布局句柄，并将来自这些句柄的说明合并到页面的最终布局结构中。 默认布局句柄用作每个页面的基本句柄。 因此，为默认处理程序声明的布局更新将显示在每个页面上。 [GitHub-9041](https://github.com/magento/magento2/issues/9041)

<!-- MC-31920-->

* MySQL锁定管理器现在是主锁定管理器。 因此，最低要求的MySQL版本为5.7.9。

<!-- ENGCOM-6431-->

* `queue_consumer.xml` 现在允许在 `handler` 类。 以前，当处理程序在其路径中包含数字时，XSD验证失败。 _Eden Duong在拉取请求中提交的修复 [25952](https://github.com/magento/magento2/pull/25952)_. [GitHub-25731](https://github.com/magento/magento2/issues/25731)

<!-- ENGCOM-6902-->

* 不正确 `@var` 中的引用 `doc` 类成员变量的块 `$queueIterator` 在类中 `\Magento\Framework\MessageQueue\Topology\Config` 已更正。 _Artem Voloznov在拉取请求中提交的修复 [24976](https://github.com/magento/magento2/pull/24976)_. [GitHub-24971](https://github.com/magento/magento2/issues/24971)

<!-- ENGCOM-5305 6684-->

* JavaScript页面加载侦听器现在触发，以在文档不再运行时触发 `loading` 而不是等到标记为 `complete` 在文档标记为 `complete` 可能会导致呈现JavaScript内容时出现严重延迟。 _由John Hughes在拉取请求中提交的修复 [23313](https://github.com/magento/magento2/pull/23313) 和拉取请求 [50](https://github.com/magento/partners-magento2ee/pull/50)_. [GitHub-22909](https://github.com/magento/magento2/issues/22909)

<!-- ENGCOM-6305-->

* 现在，当您尝试将数量为0或负数的产品添加到愿望清单时，应用程序会显示以下信息性消息： `Please enter a valid number in this field`. 以前，应用程序显示此错误： `We can't update your Wish List right now`. _修复了由Pawe Tylek在拉取请求中提交的错误 [25641](https://github.com/magento/magento2/pull/25641)_. [GitHub-25032](https://github.com/magento/magento2/issues/25032)

<!-- ENGCOM-7071-->

* 该应用程序不再支持从 `Magento\Framework\Api\AbstractExtensibleObject` 类。 缺少PHP注释 `@api`  已添加至 `AbstractExtensibleModel`，和缺失项 `@deprecated`  注释已添加到 `AbstractExtensibleObject`.  _Alexander Taranovsky在拉取请求中提交的修复 [22011](https://github.com/magento/magento2/pull/22011)_. [GitHub-22010](https://github.com/magento/magento2/issues/22010)

<!-- ENGCOM-6552-->

* 现在，您可以在更改产品相关日期(例如， `news_from_date`， `news_to_date`， `special_price_from_date`， `special_price_to_date`)。 以前，应用程序抛出与以下内容类似的错误：  `Invalid input datetime format of value '22/5/2019`.

### 常规修复

<!-- MC-21347-->

* 客户模块不再依赖于审核模块。 以前，由于此依赖关系，您无法禁用审阅模块。

<!-- MC-25250-->

* 现在，当页面的默认属性集包含带有选择标签的下拉列表属性时，产品编辑页面会成功加载。

<!-- MC-25260-->

* 现在，可从“管理员”的“订单”标签访问的图形订单图表可准确反映订单数量。

<!-- MC-29273-->

* 当这两个URL不同时，商店的管理员URL不再重定向到店面URL。

<!-- MC-29658-->

* 现在，当在多个网站中使用性能工具包配置文件时，可以正确生成子类别的URL重写。

<!-- MC-30224-->

* 您现在可以删除空的用户模型，而无需删除为其分配的管理员角色。

<!-- MC-30636-->

* TinyMCE4编辑器现在支持所有HTML标签。

<!-- MC-31128-->

* 单击 **离线退款** 创建贷项通知单工作流中的按钮现在会按预期生成贷项通知单。 以前，出现JavaScript错误时会禁用此按钮，并且应用程序不会创建贷项通知单。

<!-- MC-31832-->

* 商家现在可以创建类型的产品属性 `Decimal`. 以前，由于较早的错误修复，应用程序不显示产品属性类型 `Price`. [GitHub-26949](https://github.com/magento/magento2/issues/26949)

<!-- MC-32175-->

* 当您尝试在店面打开类别页面时，应用程序不再返回500错误 **布局=产品 — 全宽** 已在“类别”页面的“设计”选项卡中设置。

<!-- MC-32697-->

* 更正了中的错误 `AbstractSimpleObjectBuilder.php`.

<!-- MC-33427-->

* MAP（最低广告价格）现可按预期用于集团产品。

<!-- MC-29998-->

* 现在，当您在多存储部署的CMS页面上更改语言时，应用程序会将您重定向到相应存储视图的主页。 以前，当您更改某些CMS页面上的语言时，应用程序会显示404页面。

<!-- MC-30162-->

* 订购查询(`SalesOrderIndexGridAsyncInsertCron`)已重构，以减小返回的数据集大小和查询频率。

<!-- MC-32371-->

* 您现在可以成功创建CMS页面，并将其分配给CMS层次结构中的网站根类别。

<!-- MC-32783-->

* 现在，启用类别权限后(例如，当 **未登录** 客户组已被授予这些权限)。

<!-- MC-32815-->

* 产品规则现在按预期应用于缺货产品。 以前，即使将规则配置为显示缺货产品，应用程序也不会在相关产品列表中显示缺货产品。

<!-- MC-33222-->

* 单击 **跟踪运送** 管理员中订单的按钮现在会按预期在弹出窗口中显示跟踪信息。 以前，此链接会将管理员转至“登录”页面。

<!-- MC-31305-->

* 现在，应用程序显示信息性错误消息，并在客户尝试完成包含多选客户属性的注册表单时出现错误时继续按预期显示注册表单。 以前，应用程序显示500错误。

<!-- MC-32224-->

* 应用程序现在显示 **贷项通知单** 部分退款订单之后的按钮。 以前，在您创建部分退款后，应用产品不会显示此按钮，并且您不能为订单的其余部分创建贷项通知单。

<!-- MC-31878-->

* 通过REST批量更新订单现在可按预期修改订单状态。 以前，应用程序引发此错误： `report.ERROR: Property "AdditionalInformation" does not have accessor method "setAdditionalInformation" in class "Magento\Sales\Api\Data\OrderPaymentInterface".`

<!-- MC-30398-->

* 属性过滤器现在按预期显示在“类别”页面的“购物选项”块中。

<!-- MC-25138-->

* 现在，您可以在安装了B2B的部署中，将“类别”页面上的产品限制从24更改为36。 以前，当此产品限制增加到36时，应用程序会引发致命错误。

<!-- ENGCOM-7175-->

* 在Internet Explorer中显示时，客户帐单和送货地址现在会按预期显示在“管理客户编辑”页面的“地址”选项卡下。 _Vasilii Burlacu在拉取请求中提交的修复 [27383](https://github.com/magento/magento2/pull/27383)_. [GitHub-27370](https://github.com/magento/magento2/issues/27370)

<!-- ENGCOM-6546-->

* 现在，删除书签视图时，所有书签视图都可编辑。 以前，在您删除具有多个书签视图的帐户的第一个视图后，所有书签视图都变为不可编辑。 _修复了Bartomiej Szubert在拉取请求中提交的错误 [26263](https://github.com/magento/magento2/pull/26263)_. [GitHub-14913](https://github.com/magento/magento2/issues/14913)

<!-- ENGCOM-7042-->

* 分层导航不再中断样本模块的HTML5验证。 以前，对于中未定义的属性，会发生HTML验证错误。 [W3C标记验证服务](https://validator.w3.org/)但是，这些属性已更改为数据属性。 _Nirav Patel在拉取请求中提交的修复 [26055](https://github.com/magento/magento2/pull/26055)_. [GitHub-22363](https://github.com/magento/magento2/issues/22363)

<!-- ENGCOM-7065-->

* 未使用的 `require.JS` 别名(`critical-css-loader``) has been removed from app/code/Magento/Theme/view/frontend/requirejs-config.js`. _由涂阮在拉取请求中提交的修复 [26987](https://github.com/magento/magento2/pull/26987)_. [GitHub-26963](https://github.com/magento/magento2/issues/26963)

<!-- ENGCOM-6242-->

* 该应用程序现在实现PHP7.x [可丢帧接口](https://www.php.net/manual/en/class.throwable.php) 用于捕获可能泄露敏感信息（如密码）的所有错误。 _由miszyman在拉取请求中提交的修复 [25250](https://github.com/magento/magento2/pull/25250)_. [GitHub-23350](https://github.com/magento/magento2/issues/23350)

<!-- ENGCOM-6284-->

* 在“创建新文件夹”弹出窗口中输入新文件夹名称时，按ESC键现在会按预期关闭弹出窗口，而不创建文件夹。  _由Shankar Konar在拉取请求中提交的修复 [25349](https://github.com/magento/magento2/pull/25349)_. [GitHub-572](https://github.com/magento/magento2/issues/572)

<!-- ENGCOM-7464-->

* 已更正错误嵌套的HTML结构。 以前，此结构会导致相关、追加销售或交叉销售产品列表的布局中断。 _修复由Pieter Hoste在拉取请求中提交 [27926](https://github.com/magento/magento2/pull/27926)_. [GitHub-27920](https://github.com/magento/magento2/issues/27920)

<!-- ENGCOM-7144-->

* 已删除对的重复调用 `addToolbarBlock`，导致出现以下两种类似情况 `ORDER BY`.  _Vasilii Burlacu在拉取请求中提交的修复 [27263](https://github.com/magento/magento2/pull/27263)_. [GitHub-26708](https://github.com/magento/magento2/issues/26708)

<!-- ENGCOM-6014-->

* 商家现在可以设置管理员用户帐户的到期日期。 _由Laura Folco在拉取请求中提交的修复 [22837](https://github.com/magento/magento2/pull/22837)_. [GitHub-22833](https://github.com/magento/magento2/issues/22833)

<!-- ENGCOM-7071-->

* 我们已经添加了 `@api`  PHP注释到 `AbstractExtensibleModel`，则 `@deprecated` PHP注释到 `AbstractExtensibleObject`、和 `@see` 到 `AbstractExtensibleModel`.  _Alexander Taranovsky在拉取请求中提交的修复 [22011](https://github.com/magento/magento2/pull/22011)_. [GitHub-22010](https://github.com/magento/magento2/issues/22010)

### 礼品卡

<!-- MC-31041-->

* GET `V1/orders/:orderId` 调用会按预期返回礼品卡代码。

### 礼品包装

<!-- MC-29893-->

* 现在，在产品级别启用礼品包装后，可以将其添加到购物车。 以前，您可以将礼品包装添加到店面的产品中，但应用程序不会在订单摘要中包含礼品包装。

<!-- MC-30543-->

* 当您将过期日期更改为将来日期时，已过期的礼品卡将按预期激活。 以前，礼品卡仍然过期。

<!-- MC-32551-->

* 现在，当满足以下条件时，管理员创建订单页面会正确加载 **允许订单级别的礼品消息** 已启用设置和模板缩小。 以前，当您尝试在启用这些设置时打开此页面时，应用程序会引发以下错误： `Warning: require(content.phtml): failed to open stream: No such file or directory`.

<!-- MC-31427-->

* 现在，该应用程序可根据您订购的礼品包装产品数量正确计算礼品包装成本。 以前，该应用程序只包括订单中一项产品的礼品包装费用。

### Google标签管理器

<!-- MC-29878-->

* 商家现在可以推迟向Google Analytics发送数据，直到满足指定的条件。

<!-- MC-30673-->

* 缺失的 `Magento_GoogleTagManager::checkout/set_checkout_option.phtml` 模板已恢复。

### GraphQL

<!-- ENGCOM-7074-->

* 应用程序现在会返回GraphQL消息 `The cart isn't active` 而不是 `Current user does not have an active cart` 在某些情况下，购物车将变为不活动状态并创建新购物车ID。 _Vadim Malesh在拉取请求中提交的修复 [27187](https://github.com/magento/magento2/pull/27187)_. [GitHub-26117](https://github.com/magento/magento2/issues/26117)

<!-- ENGCOM-7105-->

* 删除了当之前添加的产品缺货时，使用GraphQL将产品添加到购物车时导致错误的代码。 _由AleksLi在拉取请求中提交的修复 [27015](https://github.com/magento/magento2/pull/27015)_. [GitHub-26683](https://github.com/magento/magento2/issues/26683)

<!-- ENGCOM-6535-->

* 修复了GraphQL中的一个问题：在对产品查询中使用片段时，应用程序未返回所有必需的信息。 _Riccardo Tempesta在拉取请求中提交的修复 [26218](https://github.com/magento/magento2/pull/26218)_. [GitHub-26217](https://github.com/magento/magento2/issues/26217)

* GraphQL突变 `setShippingMethodsOnCart` 不再检索中的错误数据  `available_shipping_methods` 属性。 _Vadim Malesh在拉取请求中提交的修复 [27004](https://github.com/magento/magento2/pull/27004)_. [GitHub-26742](https://github.com/magento/magento2/issues/26742)

### 分组的产品

<!-- ENGCOM-6115-->

* 现在，当属于同一组的另一个简单产品缺货时，您可以将属于该组产品的简单产品添加到购物车。  _Gihovani Filip Pereira Detrio在拉取请求中提交m̩的修复 [24955](https://github.com/magento/magento2/pull/24955)_. [GitHub-22304](https://github.com/magento/magento2/issues/22304)

<!-- ENGCOM-6768-->

* 现在，该应用程序会按预期向客户发送有关退款组产品的电子邮件。  _Alexander Taranovsky在拉取请求中提交的修复 [26246](https://github.com/magento/magento2/pull/26246)_. [GitHub-26245](https://github.com/magento/magento2/issues/26245)

<!-- MC-30313-->

* 当分组产品的其他子产品之一缺货时，您现在可以将分组产品的子产品添加到购物车。 以前，当一个子产品缺货时，您无法将任何其他子产品添加到购物车。

### 图像

<!-- MC-29523-->

* 图像现在保存在中 `pub/media/catalog/category` 在保存类别图像时按预期操作。 以前，应用程序将这些图像保存在 `pub/media/catalog/tmp/category`.

<!-- MC-30320-->

* 水印图像不再遮蔽它们覆盖的产品图像。 以前，当水印图像大于其所应用于的产品图像时，该产品图像不可见。

<!-- MC-32273-->

* 您现在可以从管理员成功将图像保存到类别。 以前，保存图像后，URL的一部分丢失，无法重新打开图像。

<!-- MC-31727-->

* 此时将显示应用程序 `.png` 上传后的图像。

<!-- MC-29483-->

* 现在，当从基本URL与店面URL不同的管理员上传图像时，使用页面生成器上传到CMS块的图像会按预期显示在预览中。

<!-- ENGCOM-7063-->

* 使用REST添加或更新图像时，现在会按预期创建图像缩略图。 _修复了由Sergiy Vasiutynskyi在拉取请求中提交的错误 [27170](https://github.com/magento/magento2/pull/27170)_. [GitHub-26825](https://github.com/magento/magento2/issues/26825)

<!-- ENGCOM-6962-->

* 生成的图像的自定义属性 `Block\Product\ImageFactory` 现在可正确呈现。 以前，由于HTML输出的转义不正确，您无法将自己的自定义属性添加到属性标记中。 _修复了alexander-aleman在拉取请求中提交的错误 [26959](https://github.com/magento/magento2/pull/26959)_. [GitHub-25219](https://github.com/magento/magento2/issues/25219)

<!-- ENGCOM-5980-->

* 从iPhone查看店面时，图像不再模糊。  _由Dmitriy在拉取请求中提交的修复 [24743](https://github.com/magento/magento2/pull/24743)_. [GitHub-24735](https://github.com/magento/magento2/issues/24735)

<!-- ENGCOM-6999-->

* 店面上的图像现在可以响应。 以前，图像高度会被扭曲。  _修复了Sean van Zuidam在拉取请求中提交的错误 [27041](https://github.com/magento/magento2/pull/27041)_. [GitHub-27040](https://github.com/magento/magento2/issues/27040)

<!-- ENGCOM-7253-->

* 现在，店面上有默认商店徽标时， `Magento_blank` 使用主题。 _Vasilii Burlacu在拉取请求中提交的修复 [27497](https://github.com/magento/magento2/pull/27497)_. [GitHub-27496](https://github.com/magento/magento2/issues/27496)

### 导入/导出

<!-- MC-25206-->

* 当导入的数据包含 `swatch_image` store-view键的值为 `no_selection`. 以前，应用程序引发此错误： `Imported resource (image) could not be downloaded from external resource due to timeout or access permissions in row(s): 1`. [GitHub-25026](https://github.com/magento/magento2/issues/25026)

<!-- MC-29417-->

* 现在，当您使用时，应用程序会按预期更新图像 `hide_from_product_page` 设置。

<!-- MC-29677-->

* 在以下情况下，现在可自定义选项会按预期导入 `row_id` 不等于产品的 `entity_id`. 以前，应用程序在以下情况下不会导入可自定义的选项： `row_id` 不等于产品的 `entity_id`，从而导致某些产品无法导入。

<!-- MC-29916-->

* 现在，与可配置产品关联的图像可在导入期间正确上传，并可按预期从产品编辑页面中查看。

<!-- MC-30304-->

* 已导出 `.csv` 文件现在反映用于包含缺货或缺货产品的过滤器设置。 以前，应用程序会导出所有产品，无论您选择哪种库存设置。

<!-- MC-30323-->

* 您现在可以使用导入工作流的客户和地址单个文件选项成功导入或更新客户。 以前，当您选择此选项时，应用程序不会导入客户数据并显示以下错误： `Invalid data for insert`.

<!-- MC-30357-->

* 现在，导入并更新产品状态后，Stock Indexer会按预期触发。 以前，Stock Indexer不对更改的产品库存数据进行索引。

<!-- MC-30528-->

* 在以下情况下，应用程序现在可以成功导入可配置产品的子产品的所有自定义选项 `store_view_code` 已指定。 无论您选择单独还是集体导入可配置产品，此功能都有效。 以前，当导入文件包含多个项目和 `store_view_code` 已指定。

<!-- MC-30672-->

* 现在，应用程序会在产品导入期间提供一条消息，标识导入的产品 `.csv` 文件有重复的键。 商家可以使用此信息解决冲突。 以前，应用程序显示此错误： `Notice: Undefined index: name in /var/www/html/ee233dev/app/code/Magento/CatalogImportExport/Model/Import/Product.php on line 2524`

<!-- MC-29960-->

* 现在，当您尝试从以下位置删除目录时，应用程序会显示一个信息更丰富的错误消息，并且不显示下载链接： **系统** > **导出** 列表。 以前，当您尝试从此列表中删除目录时，应用程序继续显示无法下载文件的下载链接，并显示一条信息不详的错误消息。

<!-- MC-29959-->

* 此 `.csv` 导入期间使用的文件现在包含可下载产品的正确链接，并且其格式现在正确以支持导入和更新可下载产品。

<!-- MC-30189-->

* 应用程序现在已成功导出 `.csv` 文件为“替换”设置导入行为时，选择先前导出的 `.csv` 文件，然后单击 **检查数据**. 以前，应用程序显示此错误： `Data validation failed. Please fix the following errors and upload the file again` 和 `Following Error(s) has been occurred during importing process`.

<!-- MC-30141-->

* 现在，导入并更新产品状态后，Stock Indexer会按预期触发。 以前，Stock Indexer不对更改的产品库存数据进行索引。

<!-- MC-31198-->

* `.csv` 在产品导入期间生成的文件现在按预期包含可下载产品的组标题。 以前，不必要地验证 `group_title` 导入期间禁止显示可下载产品的组标题。

<!-- MC-32153-->

* 时间 `cron` 已启用，您使用执行客户导入 **(客户和地址（单个文件）)** 选项，则应用程序会按预期将数据填充到管理员客户网格中。 在手动重新索引完成后，客户网格会显示客户 `customer_grid indexer`. 以前，应用程序不会使用新导入的客户地址更新客户网格。

<!-- MC-32154-->

* 应用程序现在在自动重新索引后按预期显示客户列表。 以前，尽管手动运行 `bin/magento index:reindex` 运行，客户网格在自动重新索引后不显示客户信息。

<!-- MC-30148-->

* 应用程序现在删除临时文件 `<Magento_home>/var` 在产品导入完成后按预期操作。

<!-- MC-31879-->

* 由导入产品时，应用程序不再在管理员中创建重复的SKU `.csv` 文件。

<!-- ENGCOM-6141-->

* 当导入的可配置属性的值中包含等号(=)时，导入不再失败。 _修复由dhoang89在拉取请求中提交 [25194](https://github.com/magento/magento2/pull/25194)_. [GitHub-25188](https://github.com/magento/magento2/issues/25188)

<!-- ENGCOM-6901-->

* 现在，所有导出的网格数据(Adobe Commerce和自定义数据)都具有选项标签，而不是具有类型的所有列的选项值 `Select` 或 `Multiselect`. 以前，在导出此数据时，导出的电子表格包含具有ID的列，而不是网格中显示的值。 _Maksym Novik在拉取请求中提交的修复 [26523](https://github.com/magento/magento2/pull/26523)_. [GitHub-25963](https://github.com/magento/magento2/issues/25963)

<!-- ENGCOM-7145-->

* 现在，通过导入来更新产品后，应用程序会按预期在店面上显示捆绑产品。 `.csv` 文件。 _修复了Pavel Bystritsky在拉取请求中提交的错误 [25664](https://github.com/magento/magento2/pull/25664)_. [GitHub-25540](https://github.com/magento/magento2/issues/25540)

### 索引

<!-- MC-25236 30779-->

* 我们改进了 `indexer_update_all_views`. 现在索引速度更快，不再处理不活动的规则，并且缓存中仅清除了已更改产品的条目。

<!-- MC-29917-->

* 店面上的产品价格现在准确地反映了计划目录价格规则更新的应用。 以前，在手动重新索引之前，价格不会反映计划的购物车价格规则(`php bin/magento indexer:reindex catalogrule_rule`)。

<!-- MC-30588-->

* 现在，在添加不可搜索的属性(即 `is_searchable`， `is_filterable`， `is_visible_in_advanced_search` 属性被禁用)。

<!-- ENGCOM-6533-->

* 应用程序现在显示一条消息，标识索引器以及重新索引操作失败时索引操作所用的时间。 _Lukasz Bajsarowicz在拉取请求中提交的修复 [26207](https://github.com/magento/magento2/pull/26207)_. [GitHub-26206](https://github.com/magento/magento2/issues/26206)

<!-- ENGCOM-7179-->

* 保存在商店中的产品，  `onthefly` 现在启用索引器和平面表时遵循网站分配。 以前，如果您从产品中删除所有网站分配然后保存它，则所有平面表都将包含该产品，而不管指定的网站分配是什么。  _由Abel Truong在拉取请求中提交的修复 [27365](https://github.com/magento/magento2/pull/27365)_. [GitHub-16315](https://github.com/magento/magento2/issues/16315)

### 基础架构

* 不再支持Internet Explorer 11.x浏览器。

<!-- MC-32223-->

* 与关联的验证逻辑 **出生日期** 客户注册表单的字段不再触发JavaScript错误。

<!-- ENGCOM-7000-->

* 添加了要涵盖的集成测试 `$storeId` 对于类别存储库 `get()` 方法。 _Lukasz Bajsarowicz在拉取请求中提交的修复 [27048](https://github.com/magento/magento2/pull/27048)_. [GitHub-27044](https://github.com/magento/magento2/issues/27044)

<!-- ENGCOM-6378-->

* 启用 **阻止所有Cookie** 在Safari中设置不再导致JavaScript错误，并且应用程序显示 `cookies disabled` 消息符合预期。 以前，应用程序显示多个 `SecurityError (DOM Exception 18): The operation is insecure` 控制台中出现错误。 _Rl a̼ Verdugo Lorenzo在拉取请求中提交的修复 [25324](https://github.com/magento/magento2/pull/25324)_. [GitHub-13865](https://github.com/magento/magento2/issues/13865)

<!-- ENGCOM-6674-->

* 运行集成测试时，应用程序不再引发此错误： `Error: Call to a member function findFile() on array (/var/www/html/lib/internal/Magento/Framework/Code/Generator/DefinedClasses.php:59)`. 以前，的问题 `AutoloaderRegistry::getAutoloader` 导致集成测试随机失败。 _Lukasz Bajsarowicz在拉取请求中提交的修复 [26480](https://github.com/magento/magento2/pull/26480)_. [GitHub-26479](https://github.com/magento/magento2/issues/26479)

<!-- ENGCOM-6958-->

* 此 `date` 标记位置 `/module-sales/view/frontend/templates/order/order_date.phtml`  已更正为 `span`. 以前，应用程序在 `exception.log` 文件（单击） **查看订单** 店面 **我的帐户** > **我的订单** 页面。 _由Andrii Chorniy在拉取请求中提交的修复 [25895](https://github.com/magento/magento2/pull/25895)_. [GitHub-13269](https://github.com/magento/magento2/issues/13269)， [GitHub-25738](https://github.com/magento/magento2/issues/25738)

<!-- ENGCOM-6316-->

* JavaScript Mixin模块已重构，以改进高级捆绑模块的Mixin加载和应用。 以前，应用程序不会为高级捆绑模块加载或应用mixin。  _修复了Mateusz Krzeszowiak在拉取请求中提交的错误 [25587](https://github.com/magento/magento2/pull/25587)_. [GitHub-25586](https://github.com/magento/magento2/issues/25586)

<!-- ENGCOM-6344-->

* 此 `grunt clean` 命令现在会按预期清除生成的代码和元数据文件夹。 _Andrii Beziazychnyi在拉取请求中提交的修复 [25765](https://github.com/magento/magento2/pull/25765)_. [GitHub-25739](https://github.com/magento/magento2/issues/25739)

<!-- ENGCOM-6463-->

* `getVersion` 结果(`ProductMetadata::getVersion`)现已缓存，从而提高了 `ProductMetadata::getVersion` 方法。  _Lukasz Lewandowski在拉取请求中提交的修复 [26001](https://github.com/magento/magento2/pull/26001)_. [GitHub-24025](https://github.com/magento/magento2/issues/24025)

<!-- ENGCOM-7037-->

* 缺少设置者 `additional_information` 已添加至 `OrderPaymentInterface`，可解决其模式声明与接受的属性之间的不一致问题。 _Antonino Bonumore在拉取请求中提交的修复 [26748](https://github.com/magento/magento2/pull/26748)_. [GitHub-26745](https://github.com/magento/magento2/issues/26745)， [GitHub-13222](https://github.com/magento/magento2/issues/13222)

### 分层导航

<!-- MC-31763-->

* 应用程序现在渲染 **是/否** 类别页面上的属性，条件 **在分层导航中使用：可过滤（包含结果）** （店面属性）已启用。

<!-- ENGCOM-6807-->

* 冗余 `\Magento\Sales\Model\Order\Email\Sender\ShipmentSender` 已被弃用，取而代之的是  `\Magento\Sales\Model\Order\Shipment\Sender\EmailSender`. _Adarsh Manickam在拉取请求中提交的修复 [26714](https://github.com/magento/magento2/pull/26714)_. [GitHub-14885](https://github.com/magento/magento2/issues/14885)

### 日志记录

<!-- MC-29636-->

* 现在，订单状态更改会按预期方式记录在 **系统** > **操作日志** > **报告**.

<!-- MC-29637-->

* 该应用程序现在会按预期在“管理操作”日志中记录销售装运操作。

<!-- MC-29892-->

* CMS页面保存操作现在记录在管理操作日志中。 以前，只记录查看操作。

<!-- MC-30618-->

* 在以下情况下，CMS页面上的保存操作现在会按预期记录在管理员操作日志中 **选择要记录的所有操作** 在管理操作日志记录选项卡上启用(**管理员** > **商店** > **配置** > **高级**)。

<!-- ENGCOM-7274-->

* CMS页面修改现在按预期记录在操作日志中。 MFTF现在涵盖此功能。  _Lukasz Bajsarowicz在拉取请求中提交的修复 [27597](https://github.com/magento/magento2/pull/27597)_. [GitHub-171](https://github.com/magento/magento2/issues/171)

### 媒体集

<!-- ENGCOM-6993-->

* 点击 **输入** 在媒体集中命名新文件夹后，现在会保存您所做的所有更改。 以前，单击 **输入** 而不使用鼠标进行选择 **确定** 导致所有更改丢失。  _修复了由Sergiy Vasiutynskyi在拉取请求中提交的错误 [27029](https://github.com/magento/magento2/pull/27029)_. [GitHub-26847](https://github.com/magento/magento2/issues/26847)

<!-- ENGCOM-7490-->

* 您现在可以在介质集下创建一个与主文件夹同名的子文件夹。 以前，无法以相同的名称保存子文件夹。 _Vadim Malesh在拉取请求中提交的修复 [27976](https://github.com/magento/magento2/pull/27976)_. [GitHub-1270](https://github.com/magento/adobe-stock-integration/issues/1270)

### 媒体存储

<!-- MC-32593-->

* `var/resource_config.json` 每当请求图像时，不再重新生成 `get.php`. 以前，每次调用时，都会重写此文件 `get.php`.

### New Relic

<!-- ENGCOM-6461-->

* Adobe Commerce `cron`作业名称现在按预期包含在NewRelic APM监控 — 事务中的事务跟踪中。 这包括 `cron` 从命令行执行的作业以及标准调度程序执行的作业。  _Lukasz Bajsarowicz在拉取请求中提交的修复 [25957](https://github.com/magento/magento2/pull/25957)_. [GitHub-22047](https://github.com/magento/magento2/issues/22047)

### 新闻稿

<!-- MC-31768-->

* 客户现在可以按预期订阅新闻稿。 以前，当客户尝试确认其订阅时，应用程序显示以下错误： `This is an invalid subscription confirmation code`.

<!-- ENGCOM-6525-->

* 现在，店面页脚的新闻稿输入字段的呈现方式与任何支持的浏览器相同。  _修复了拉取请求中由divyajyothi5321提交的错误 [26182](https://github.com/magento/magento2/pull/26182)_. [GitHub-26176](https://github.com/magento/magento2/issues/26176)

<!-- ENGCOM-6691-->

* 有关新闻稿订阅的店面消息现在按HTML中的预期呈现。 _Oleh Usik在拉取请求中提交的修复 [26455](https://github.com/magento/magento2/pull/26455)_. [GitHub-25162](https://github.com/magento/magento2/issues/25162)

### 订单

<!-- MC-33456-->

* 当网站显示设置指定应排除税时，订单汇总小计不再显示排除的税。 以前，当多个网站配置了不同的显示设置时，无论应用商店级别配置如何，都会使用服务器变量中定义的设置来存储数据。

### 支付方式

<!-- MC -->

* 第三方支付方法Authorize.Net、eWay、CyberSource、Braintree和Worldpay集成到核心代码中已移除。 商家应迁移到Commerce Marketplace上提供的官方扩展。

<!-- MC -->

* 不再支持重要欺诈防护的核心实施。 商家应迁移至 [显着扩展了欺诈和按存储容量使用计费保护功能](https://marketplace.magento.com/signifyd-module-connect.html) 在Commerce Marketplace上可用。

<!-- MC-32546-->

* 在以下情况下，您现在可以成功完成订单并返回商家的主页 **Website Payments Pro托管解决方案** 已配置。 以前，当您单击 **返回商家**，应用程序引发此错误： `Invalid Form Key. Please refresh the page`.

<!-- ENGCOM-6606-->

* 切换帐单地址不再导致JavaScript函数文本在店面结帐工作流的付款部分呈现。 _Chris Pook在拉取请求中提交的修复 [26378](https://github.com/magento/magento2/pull/26378)_. [GitHub-26375](https://github.com/magento/magento2/issues/26375)

<!-- ENGCOM-7223-->

* 现在，贷项通知单会在 **调整退款** “贷项通知单概览”字段。  _修复了由Sergiy Vasiutynskyi在拉取请求中提交的错误 [27343](https://github.com/magento/magento2/pull/27343)_. [GitHub-13851](https://github.com/magento/magento2/issues/13851)

<!-- ENGCOM-6524-->

* 您现在可以从 `quote_payment column additional_information` 保存报价后的表。 以前，保存报价后无法删除此信息，因为 `unsAdditionalInformation` 中的方法 `\Magento\Payment\Model\Info` 未正确初始化数据。  _Marco Oliveira在拉取请求中提交的修复 [26084](https://github.com/magento/magento2/pull/26084)_. [GitHub-26083](https://github.com/magento/magento2/issues/26083)

<!-- ENGCOM-6609-->

* 付款指示现在派生自从中发出订单的商店视图。 以前，从默认商店视图中使用付款指示，因为 `BeforeOrderPaymentSaveObserver` 方法已从默认商店视图中获取付款指示。 _由Karyna Tsymbal在拉取请求中提交的修复 [26399](https://github.com/magento/magento2/pull/26399)_. [GitHub-26332](https://github.com/magento/magento2/issues/26332)

<!-- ENGCOM-6953-->

* 现在，应用产品会从在具有多个商店的部署中下达订单的商店中收集显示在管理员以及发票和装运发票中的付款信息。 以前，应用程序从默认存储区获取付款信息。  _修复了Bartomiej Szubert在拉取请求中提交的错误 [26765](https://github.com/magento/magento2/pull/26765)_. [GitHub-17933](https://github.com/magento/magento2/issues/17933)

#### PayPal

<!-- MC-30498-->

* 应用程序现在会在客户每次点击时显示信息性错误消息 **使用PayPal付款** 在签出工作流中输入无效的送货地址后。 以前，应用程序仅在客户首次单击按钮时显示错误消息，而不会在后续单击时显示错误消息。

<!-- MC-30639-->

* 应用程序不再将订单的状态更改为 `Processing` 使用PayPal付款失败时，在结帐工作流的“付款复查”部分中显示付款信息。

<!-- MC-30864-->

* 您现在可以使用“现金流量链接”付款方法成功完成订单。 以前，由于订单状态保留在 `Pending` 支付状态，即使支付方式日志中的订单状态为 `Approved`.

<!-- MC-32494-->

* 使用PayPal Payflow Pro下达的订单现在设置为 `Suspected Fraud` 触发欺诈过滤器时的状态。

<!-- MC-33110-->

* 您现在可以将PayPal Express Checkout与任何受支持的信用卡结合使用。 以前，当您在使用PayPal Express结帐功能完成订单时单击信用卡按钮时，应用产品会挂起，并且您无法输入任何信用卡信息。

<!-- MC-33117-->

* PayPal Payflow Pro中的订单现在设置为 `Suspected Fraud` 触发欺诈过滤器时的状态。 以前，在申请方进行付款审批之前，PayPal上的付款交易记录状态未经验证。

<!-- MC-33294-->

* 现在，启用“网站限制”后，Payflow Pro可按预期工作。

<!-- MC-31196-->

* 现在，应用产品将通过PayPal Express Checkout成功处理订单，其中订单的发运地址指定了客户已人工输入文本字段（而不是从“发运”页面的下拉菜单中选择）的国家/地区。 以前，应用程序在订单复查页面上显示此错误： `Error 500: NOTICE: PHP message: PHP Fatal error: Uncaught Error: Call to a member function getId() on null in httpdocs/vendor/magento/module-paypal/Model/Api/Nvp.php:1527`. [GitHub-26698](https://github.com/magento/magento2/issues/26698)

<!-- MC-31573-->

* PayPal Pro支付方法现在可在Chrome 80浏览器中按预期工作。 此付款方法以前调用一个回调端点，该端点需要访问客户的会话 — 新的默认Chrome SameSite Cookie功能不允许访问。 [GitHub-26840](https://github.com/magento/magento2/issues/26840)

<!-- MC-31292-->

* 现在，如果启用了永久结帐购物车并且 **注销时清除持久性** 设置已设置为 **否**. 以前，应用程序会将您重定向到“登录”页面。

<!-- ENGCOM-6383-->

* 来自Paypal Express和Web Payments Pro的支付现在转移到 `Processing` 在处理开始后按预期状态。 以前，Paypal Web Payments Pro支付保留在 `Pending` 付款状态，即使付款信息位于 `Processing` 省/州。 _由拉取请求中的Azambon提交的修复 [25876](https://github.com/magento/magento2/pull/25876)_. [GitHub-25659](https://github.com/magento/magento2/issues/25659)

### 性能

<!-- MC-31499-->

* 客户数据部分失效逻辑已得到改进。 此版本引入了一种使所有客户部分数据失效的新方式，可避免在自定义版本时出现与本地存储有关的已知问题 `sections.xml` 无效处于活动状态。 (以前，当您具有自定义时，私有内容（本地存储）未正确填充 *etc/frontend/sections.xml* 操作无效。) 参见 [私有内容](https://developer.adobe.com/commerce/php/development/cache/page/private-content/#invalidate-private-content).

<!-- MC-31449-->

* 为提高进口速度，对客户账户进口进行了重构。

<!-- MC-23383 ENGCOM-7006-->

* 商家现在可以使用 [延迟加载](https://en.wikipedia.org/wiki/Lazy_loading) 以加载图像。 _由Timon de Groot在拉取请求中提交的修复 [27033](https://github.com/magento/magento2/pull/27033)_. [GitHub-27032](https://github.com/magento/magento2/issues/27032)

<!-- ENGCOM-6988-->

* 仪表板图表已迁移到 `chart.js` 库。  _修复了Bartomiej Szubert在拉取请求中提交的错误 [26923](https://github.com/magento/magento2/pull/26923). [GitHub-186](https://github.com/magento/community-features/issues/186)_

<!-- ENGCOM-6232-->

* 通过重构构建属性选项阵列的方式，提高了在包含许多产品属性(3,000 - 23000个选项)的大型目录上运行的操作的性能。 _Behnam Shayani在拉取请求中提交的修复 [25452](https://github.com/magento/magento2/pull/25452)_. [GitHub-20966](https://github.com/magento/magento2/issues/20966)

### 定价

<!-- ENGCOM-6647-->

* 应用程序现在可以保存并显示分层产品的正确价格，即使您已经多次编辑了产品。 以前，应用程序不会保存对产品价格进行的最后一次编辑。 _Ravi Chandra在拉取请求中提交的修复 [26162](https://github.com/magento/magento2/pull/26162)_. [GitHub-25195](https://github.com/magento/magento2/issues/25195)

<!-- ENGCOM-6914-->

* 现在，固定保存百分比和折扣保存百分比均可正确应用于订单的最终价格。 以前，应用程序在产品详细信息页面上显示不正确的层价格（固定和折扣）保存百分比。 _Sathish Subramanian在拉取请求中提交的修复 [26584](https://github.com/magento/magento2/pull/26584)_. [GitHub-26583](https://github.com/magento/magento2/issues/26583)

### 产品警报

<!-- MC-30255-->

* 向客户发送的有关可配置产品重新补充库存的库存警报电子邮件现在包含正确的产品价格。 以前，此电子邮件的产品价格为0。

<!-- MC-32873-->

* 现在，当用户的会话过期时，产品库存警报取消订阅生效。 以前，当您单击 **单击此处停止此产品的警报** 链接时，应用程序显示404错误。

<!-- MC-31979-->

* 现在，产品警报的取消订阅操作可按预期运行。 以前，当客户单击 **单击此处停止此产品的警报** 链接时，应用程序显示404错误。

### 产品视频

<!-- MC-23743-->

* 您现在可以使用REST更新YouTube视频(PUT `rest/V1/products/{SKU}`)。 以前，应用程序显示视频的缩略图，但当您单击 **播放** 按钮。 [GitHub-23194](https://github.com/magento/magento2/issues/23194)

### 报告

<!-- ENGCOM-6635-->

* 产品列表现在按SKU订购可配置产品，SKU按变体对可配置产品进行分组。 以前，报表会按将产品分组 `product_id`. _Lukasz Bajsarowicz在拉取请求中提交的修复 [25858](https://github.com/magento/magento2/pull/25858)_. [GitHub-25856](https://github.com/magento/magento2/issues/25856)

<!-- ENGCOM-6427-->

* 此 **管理员** > **报告** > **刷新统计信息** 现在显示表格 **更新时间= Null** 状态 **从不** 在 **已更新** 列而不是 **未定义**. _Eden Duong在拉取请求中提交的修复 [25932](https://github.com/magento/magento2/pull/25932)_. [GitHub-25931](https://github.com/magento/magento2/issues/25931)

<!-- ENGCOM-6925-->

* 低库存报表不再包含禁用的产品。 _Mohamed-Asar在拉取请求中提交的修复 [26862](https://github.com/magento/magento2/pull/26862)_. [GitHub-26838](https://github.com/magento/magento2/issues/26838)

<!-- ENGCOM-7110-->

* 应用程序现在显示以下项的准确值： **年初至今开始**  中的字段 **管理员**  >  **商店**  >  **配置**  >  **常规**  >  **报告**. _由Priya-V-Panchal在拉取请求中提交的修复 [27088](https://github.com/magento/magento2/pull/27088)_. [GitHub-27086](https://github.com/magento/magento2/issues/27086)

### 退货授权(RMA)

<!-- MC-24906-->

* 当您从店面成功创建订单和RMA时，应用程序不再显示错误。 以前，应用程序会按预期创建RMA，但也会显示以下错误：  `We can't create a return right now. Please try again later`.

<!-- MC-30181-->

* 店面订单退货中包括的跟踪链接现在按预期工作。 以前，当客户单击订单退货页上的发运跟踪链接时，应用产品显示以下错误： `PHP Fatal error: Uncaught Error: Call to a member function getTitle() on null in /app/z7kvt3uys6daq/var/view_preprocessed/pub/static/vendor/magento/module-shipping/view/frontend/templates/tracking/details.phtml:1`.

<!-- MC-30237-->

* 从管理员创建订单退货后，“退货”选项卡现在会按预期显示。

<!-- MC-34150-->

* 已从RMA电子邮件模板中删除不必要的字符串(`app/code/Magento/Rma/view/frontend/email/new.html`)。

### 审核

<!-- MC-29578-->

* 应用程序现在禁用 **提交审核** 用户单击一次该按钮后的按钮。 以前，应用程序在第一次单击后没有禁用此按钮，而是在用户单击 **提交审核** 按钮多次。

<!-- MC-31293-->

* 此 **管理员** > **报告** > **审核** > **按产品** 过滤器列表现在会按预期显示结果。 以前，当您尝试过滤此列表时，应用程序不显示任何结果。

<!-- ENGCOM-6938-->

* “等待审阅”菜单项现在按预期激活，日期为 **管理员** >  **营销** > **用户内容** > **待处理审阅**.  _Ravinder在拉取请求中提交的修复 [26230](https://github.com/magento/magento2/pull/26230)_. [GitHub-26229](https://github.com/magento/magento2/issues/26229)

### 奖励

<!-- MC-31459-->

* 现在，当订单返回至在多商店环境中运行的商店时，该应用程序会按预期退还奖励积分，其中为每个商店设置了不同的奖励积分费率。 以前，对于使用奖励积分购买的已退回订单，该应用程序没有按预期退款。

### 销售

<!-- MC-29426-->

* 现在，已完成的订单同时显示在支付系统和Adobe Commerce中。 以前，订单出现在支付系统中，但不出现在Adobe Commerce中。 [GitHub-25862](https://github.com/magento/magento2/issues/25862)

<!-- MC-30000-->

* 应用程序现在采用客户的默认送货地址。 以前，应用程序不会根据设置和 **与帐单地址相同** 未自动启用设置。

<!-- MC-30299-->

* 现在，应用产品可以正确计算包含折扣的订单退款。 以前，应用程序错误地计算了运费税和运费折扣，并且退回的总额与支付的总额不匹配。

<!-- MC-33165-->

* 现在，当新客户在多站点部署中创建订单时，应用程序会分配正确的组ID。 以前，应用程序应用默认客户组中的设置。

<!-- MC-31786-->

* 具有有限权限（包括查看贷项通知单、发票和发运的权限）的管理员现在可以按预期从“订单”页查看发票和发运。 以前，当受限管理员尝试查看订单时，应用程序会显示以下错误： `Something went wrong with processing the default view and we have restored the filter to its original state`.

<!-- MC-24023-->

* 当客户将一定数量的产品添加到其购物车时，该数量超过现有产品库存的一半，但不超过总库存时，应用程序不再显示错误。 以前，在这些情况下，应用程序会显示以下错误： `The requested qty is not available`. [Github-24365](https://github.com/magento/magento2/issues/24365)

<!-- ENGCOM-6910-->

* 当库存数量为1时，您现在可以从管理员成功将产品添加到购物车。 以前，应用程序不会将产品添加到购物车并显示以下消息： `The requested qty is not available`. _修复Serhii Petrychenko在拉取请求中提交的错误 [26650](https://github.com/magento/magento2/pull/26650)._ [GitHub-25675](https://github.com/magento/magento2/issues/25675)

<!-- ENGCOM-7090-->

* 当商店管理员尝试对自定义选项名称超过最大字符数的产品重新排序时，应用程序现在会显示信息性错误消息。 以前，在这些条件下，应用程序显示“报告”页面，而不是消息。 _Mudit Shukla在拉取请求中提交的修复 [26348](https://github.com/magento/magento2/pull/26348)_. [GitHub-26345](https://github.com/magento/magento2/issues/26345)

<!-- ENGCOM-6328-->

* 已重构销售订单地址信息编辑表单的布局，以符合管理员表单库惯例。 _修复Alexey Rakitin在拉取请求中提交的错误 [25699](https://github.com/magento/magento2/pull/25699)_. [GitHub-19805](https://github.com/magento/magento2/issues/19805)

<!-- ENGCOM-6007-->

* “ ”的“产品”部分上的复选框 **目录** > **类别** 页面现在可按预期工作。  _由Denis Kopylov在拉取请求中提交的修复 [22990](https://github.com/magento/magento2/pull/22990)_. [GitHub-22988](https://github.com/magento/magento2/issues/22988)

<!-- ENGCOM-6809-->

* 此 `getCustomer` 方法现在会返回customer对象，如中所定义 `phpdoc` 块。 以前，此方法返回 `NULL`、和 `phpdoc` 块未突出显示此方法可以返回的内容 `NULL`. _Fanis Strezos在拉取请求中提交的修复 [26423](https://github.com/magento/magento2/pull/26423)_. [GitHub-25268](https://github.com/magento/magento2/issues/25268)

<!-- ENGCOM-6492-->

* 当商家禁用  **管理员** > **存储**  >  **配置**  >  **销售**  >  **重新排序**  >  **允许订单**.  _Eden Duong在拉取请求中提交的修复 [26051](https://github.com/magento/magento2/pull/26051)_. [GitHub-25130](https://github.com/magento/magento2/issues/25130)

<!-- ENGCOM-6627-->

* `getPrice()` 现在，在Admin中设置订单的自定义价格时，方法会返回浮点数或空值，而不是字符串。  _由Andrii Chorniy在拉取请求中提交的修复 [26313](https://github.com/magento/magento2/pull/26313)_. [GitHub-25968](https://github.com/magento/magento2/issues/25968)

<!-- ENGCOM-6786-->

* 此 **省/市/自治区代码和标题** 列 **管理员** > **商店**  >设置>  **订单状态** 现在按预期显示状态而不是状态。  _Oleh Usik在拉取请求中提交的修复 [26569](https://github.com/magento/magento2/pull/26569)_. [GitHub-17847](https://github.com/magento/magento2/issues/17847)

<!-- ENGCOM-6936-->

* 在GB语言环境中创建时，PDF发票现在会捕获正确的购买日期。 _Eden Duong在拉取请求中提交的修复 [26701](https://github.com/magento/magento2/pull/26701)_. [GitHub-26675](https://github.com/magento/magento2/issues/26675)

### 销售规则

<!-- MC-30155-->

* `quote_item.applied_rule_ids` 在禁用购物车价格规则后，现在会按预期更新。 [GitHub-24526](https://github.com/magento/magento2/issues/24526)

<!-- MC-32229-->

* 当您尝试创建或编辑购物车价格规则时，应用程序现在会按预期显示类别树。 以前，在创建或编辑规则时在Condition部分中选择类别会导致JavaScript错误。

<!-- ENGCOM-6824-->

* 现在，当可配置产品首次添加到购物车时，应用程序会使用购物车价格规则正确计算购物车级别的固定折扣。 _Lachlan Turner在拉取请求中提交的修复 [26623](https://github.com/magento/magento2/pull/26623)_. [GitHub-26622](https://github.com/magento/magento2/issues/26622)

### 搜索 {#search-heading}

* Elasticsearch7.6.x现在是Adobe Commerce和Adobe Commerce的默认目录搜索引擎。 如果不安装Elasticsearch7.6.x，则无法安装或升级到版本2.4.0。已删除版本2.x代码的Elasticsearch。 Elasticsearch版本5.x和6.x已被弃用，不再受支持。 参见 [搜索引擎先决条件](../../../installation/prerequisites/search-engine/overview.md).

<!-- MC-23753-->

* 应用程序现在渲染 **&lt;** 和 **>** 个符号正确显示在店面目录搜索字符串中。

<!-- MC-25010-->

* 运行后，产品现在会在类别中按预期显示 `cron:run` 在部署中实施Elasticsearch。

<!-- MC-25254-->

* 该应用程序不再需要完全搜索重新索引，以便能够在店面上搜索新的产品属性。

<!-- MC-29545-->

* 现在，当您按字母顺序产品名称对包含捆绑产品的产品列表进行排序时，Elasticsearch会按预期工作。

<!-- MC-29951-->

* 在类别中筛选可配置产品时，筛选结果不再包含缺货选项。

<!-- MC-30131-->

* 现在，使用Elasticsearch从产品列表页面中选择所有产品，搜索结果中的所有产品都会按预期显示。 以前，应用程序不显示搜索结果。

<!-- MC-30201-->

* 现在，当您更改每页查看的搜索结果数时，Elasticsearch可以正确显示类别页中的结果。 以前，当您更改搜索结果页面上应显示的搜索结果数量时，应用程序会显示一个空白页，并出现以下错误： `"0":"SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near'`

<!-- MC-32430-->

* 价格排序现在可以正确用于缺货的可配置产品。

<!-- MC-25176-->

* 当客户在多网站部署中使用店面快速搜索时，应用程序不再引发异常。

<!-- ENGCOM-6842-->

* 当商家通过单击页脚上的搜索词选项打开搜索词页面时，应用程序不再显示警告 **营销** > **SEO和搜索** > **搜索词**.  _修复了拉取请求中由vishal-webkul提交的错误 [25246](https://github.com/magento/magento2/pull/25246)_. [GitHub-25245](https://github.com/magento/magento2/issues/25245)

<!-- ENGCOM-7289-->

* 在移动视图中运行Safari时，当您单击搜索输入框时，应用程序不再调整视区的大小。  _修复了由Pawe Tylek在拉取请求中提交的错误 [27603](https://github.com/magento/magento2/pull/27603). [GitHub-27506](https://github.com/magento/magento2/issues/27506)_

<!-- ENGCOM-6364-->

* Elasticsearch版本现在由管理员中的X.x表示法而不是X.0+表示法标识(**商店** >设置> **配置** > **目录** > **目录** > **目录搜索**)。 _由Andreas Mautz在拉取请求中提交的修复 [25838](https://github.com/magento/magento2/pull/25838)_. [GitHub-25674](https://github.com/magento/magento2/issues/25674)

### 配送

<!-- MC-32782-->

* 如果订购的产品之一是虚拟产品，您现在可以将订单发往多个地址。 以前，应用程序成功下物理产品的订单，但虚拟产品订单为空。

<!-- MC-29276-->

* 现在，该应用程序可以正确为发送到多个地址的订单应用固定金额的全车折扣。 以前，当客户使用带多个地址的结帐功能结帐订单时，会多次应用此类折扣。 [GitHub-25834](https://github.com/magento/magento2/issues/25834)

<!-- MC-29444-->

* 在创建购物车价格规则的过程中可用于选择配送方法的下拉列表现在仅包含有效值。 以前，此下拉列表包含空值或额外值。

<!-- MC-30186-->

* 应用程序现在将装运标签打印为 `.pdf` 选择时按预期显示文件 **打印送货标签** 从订单存档列表中的订单中的“操作”下拉列表中。 以前，应用程序显示404错误。

<!-- MC-31396-->

* 现在，当购物车包含来自免运费价格规则所包含类别的产品以及来自未包含在该规则中的类别的产品时，免运费价格规则仅影响相关产品。 以前，当购物车包含来自免运费类别以及价格规则中未包含的其他类别的产品时，免运费不适用于任何产品。

<!-- ENGCOM-6436-->

* 应用程序不再显示空白页，而是在下拉/多选框中显示所有装运承运人。 以前， `toOptionArray` 函数 `vendor/magento/module-shipping/Model/Config/Source/Allmethods.php` 已发生。 _由Marc Rodriguez在拉取请求中提交的修复 [25315](https://github.com/magento/magento2/pull/25315)_. [GitHub-13136](https://github.com/magento/magento2/issues/13136)

* 当客户创建将发运至多个地址的订单时，应用产品不再多次应用固定金额折扣。  _Mahesh Singh在拉取请求中提交的修复 [26419](https://github.com/magento/magento2/pull/26419)_. [GitHub-25834](https://github.com/magento/magento2/issues/25834)

<!-- ENGCOM-6523-->

* 插件 `Magento\Ups\Model\Carrier` 实施自定义的 `di.xml` 现在在开发人员模式下正常工作。 以前，应用程序引发此错误： `1 exception(s): Exception #0 (BadMethodCallException): Missing required argument $data of Magento\Ups\Model\Carrier`. _修复了Bartomiej Szubert在拉取请求中提交的错误 [26130](https://github.com/magento/magento2/pull/26130)_. [GitHub-25390](https://github.com/magento/magento2/issues/25390)

### Sitemap

<!-- MC-29362-->

* 现在，当您生成站点地图时，应用程序会按预期使用项目基本URL。

<!-- ENGCOM-6670-->

* 生成的站点地图现在包含主页的URL。 _修复了拉取请求中由deepaksnair提交的错误 [26445](https://github.com/magento/magento2/pull/26445)_. [GitHub-25761](https://github.com/magento/magento2/issues/25761)

### 暂存

<!-- MC-32342-->

* 仅在多站点部署中有限制访问一个网站的管理员现在可以预览该网站的计划更新。 以前，暂存预览默认使用默认存储，如果用户无权访问默认存储，则应用程序会引发异常。

<!-- MC-32736-->

* 编辑现有计划不再导致计划重复。 以前，当您编辑现有计划时，应用程序会复制该计划，当您尝试打开复制计划时，应用程序会引发错误。

<!-- MC-32432-->

* 在为一种或多种产品创建计划更新后，交叉销售产品现在按预期显示在查看和编辑购物车页面上。

### 存储

<!-- MC-25187-->

* 现在，当客户登录一个商店，将产品添加到购物车，然后在多商店部署中切换到新商店时，客户会话会按预期保留。 以前，当客户导航到第二家商店时，应用程序会注销客户并清空购物车。

<!-- ENGCOM-4781-->

* 应用程序现在会从删除的存储视图删除与删除的存储视图相关的记录 `sale_sequence_meta` 和 `sales_sequence_profile` 表按预期显示。 _修复了Bartomiej Szubert在拉取请求中提交的错误 [22296](https://github.com/magento/magento2/pull/22296)_. [GitHub-14958](https://github.com/magento/magento2/issues/14958)

<!-- ENGCOM-6869-->

* 现在，在具有不同基本URL的存储之间切换时，存储切换器会按预期工作。 以前，当客户使用商店切换器在各商店之间切换时，如果目标商店的基础URL与当前商店不同，则请求失败。 _Tobias Nilsson在拉取请求中提交的修复 [26548](https://github.com/magento/magento2/pull/26548)_. [GitHub-23755](https://github.com/magento/magento2/issues/23755)， [GitHub-26384](https://github.com/magento/magento2/issues/26384)

### 样本

<!-- MC-30294-->

* 商家现在可以使用以下工具成功将色板属性添加到产品中 **可视样本** 选项于 **商店** > **属性** > **产品** > **新建属性**. 以前，当您尝试打开新创建的样本属性时，会触发JavaScript错误。

<!-- ENGCOM-6750-->

* 现在，当客户为可配置产品选择新的样本选项时，最低广告价格会按预期发生变化。 _修复了由Sergiy Vasiutynskyi在拉取请求中提交的错误 [26241](https://github.com/magento/magento2/pull/26241)_. [GitHub-26240](https://github.com/magento/magento2/issues/26240)

<!-- ENGCOM-6685-->

* 当您选择新样本选项时，应用程序不再复制可配置产品的最低广告价格。 _修复了由Sergiy Vasiutynskyi在拉取请求中提交的错误 [26317](https://github.com/magento/magento2/pull/26317)_. [GitHub-26314](https://github.com/magento/magento2/issues/26314)

<!-- ENGCOM-6966-->

* 更正了“New Product Attribute”（新产品属性）页面的“Manage Swatch”（您的属性值）区域中下拉菜单的行为问题。  _Oleh Usik在拉取请求中提交的修复 [26090](https://github.com/magento/magento2/pull/26090)_. [GitHub-25910](https://github.com/magento/magento2/issues/25910)

### TargetRule

<!-- MC-31546-->

* 现在，店面中为产品显示的相关产品块会显示满足相关产品规则中定义的条件的产品。 以前，应用程序不显示任何相关产品。

### 税金

<!-- MC-29579-->

* 现在，当客户在结帐期间更改订单的目标国家/地区时，应用程序会按预期更新运费和价格。

<!-- MC-30546-->

* 现在，根据适用的购物车价格规则，按预期应用免运费。 以前，在计算订单是否符合免运费标准时，购物车价格规则不考虑税费。

<!-- MC-32402-->

* 编辑和保存时，应用程序不再引发错误 `NOT LOGGED IN` 客户组。

### 测试

>[!NOTE]
>
>**MFTF现在使用Google Authenticator执行启用了2FA的测试。 如果没有启用Google Authenticator的其他配置步骤，MFTF将无法与2.4.0配合使用**. 参见 [为双重身份验证(2FA)配置MFTF](https://devdocs.magento.com/guides/v2.4/security/two-factor-authentication.html#magento-functional-testing-framework).

<!-- ENGCOM-6585-->

* 测试和操作组中的硬编码URL已被替换为页面引用。 _修复了Lukasz Bajsarowicz在私有存储库合作伙伴magento2ee的拉取请求117中提交的错误_. [GitHub-26331](https://github.com/magento/magento2/issues/26331)

<!-- ENGCOM-7273-->

* 测试现在包含记录与CMS页面相关的管理员操作的任务。 _修复了Lukasz Bajsarowicz在私有存储库合作伙伴magento2ee的拉取请求172中提交的错误_. [GitHub-171](https://github.com/magento/magento2/issues/171)

<!-- ENGCOM-7040 7051-->

* 已修改无效的功能测试名称以遵循最佳实践。 _Lukasz Bajsarowicz在拉取请求中提交的修复 [27118](https://github.com/magento/magento2/pull/27118) 和私有存储库合作伙伴magento2ee中的pull request 151。 [GitHub-27117](https://github.com/magento/magento2/issues/27117)_

<!-- ENGCOM-7026-->

* Adobe Commerce `cron` 现在用于在创建测试数据后重新索引，并在适用的情况下， `cache:flush config` 替换 `cache:flush`. _Lukasz Bajsarowicz在拉取请求中提交的修复 [26990](https://github.com/magento/magento2/pull/26990)_. [GitHub-26989](https://github.com/magento/magento2/issues/26989)

<!-- ENGCOM-7421-->

* 验收测试现在遵循以下项的命名惯例： `Magento/Indexer` 和 `Magento/Backup` 模块。  _由Shankar Konar在拉取请求中提交的修复 [27515](https://github.com/magento/magento2/pull/27515)_. [GitHub-27503](https://github.com/magento/magento2/issues/27503)

<!-- ENGCOM-6791 6825-->

* 此 `AdminReorderWithCatalogPrice` 测试已重构，在CI验证过程中不再失败。 _修复了Lukasz Bajsarowicz在私有存储库合作伙伴magento2ee的拉取请求135中提交的错误_. [GitHub-26607](https://github.com/magento/magento2/issues/26607)

<!-- ENGCOM-6780 6795-->

* 此 `AdminAddingNewOptionsWithImagesAndPricesToConfigurableProduct` 和 `StorefrontApplyPromoCodeDuringCheckout` 测试已重构，在CI验证过程中不再失败。 _Lukasz Bajsarowicz在拉取请求中提交的修复 [26611](https://github.com/magento/magento2/pull/26611) 和拉取请求 [26614](https://github.com/magento/magento2/pull/26614)_. [GitHub-26612](https://github.com/magento/magento2/issues/26612)， [GitHub-26610](https://github.com/magento/magento2/issues/26610)

<!-- ENGCOM-6621-->

* 此 `DeleteProduct and DeleteCustomer Action Groups` 测试已重构，在CI验证过程中不再失败。 _Lukasz Bajsarowicz在拉取请求中提交的修复 [26407](https://github.com/magento/magento2/pull/26407)_. [GitHub-26396](https://github.com/magento/magento2/issues/26396)

<!-- ENGCOM-6608-->

* 此 `AdminMoveAnchoredCategoryTest.xml` 测试已重构，在CI验证过程中不再失败。 _Lukasz Bajsarowicz在拉取请求中提交的修复 [26395](https://github.com/magento/magento2/pull/26395)_. [GitHub-26396](https://github.com/magento/magento2/issues/26396)

#### 集成测试

<!-- ENGCOM-7143-->

* 集成测试中的连续请求不再失败。 以前，测试失败，因为请求对象在调度程序之间共享。 此 `resetRequest` 方法现在清空以下项的状态 `request`. _Lukasz Bajsarowicz在拉取请求中提交的修复 [27300](https://github.com/magento/magento2/pull/27300)_. [GitHub-27299](https://github.com/magento/magento2/issues/27299)

<!-- ENGCOM-7262-->

* 添加了其他集成测试，涵盖 `Magento_Customer` 电子邮件功能。 _Lukasz Bajsarowicz在拉取请求中提交的修复 [27606](https://github.com/magento/magento2/pull/27606)_. [GitHub-27607](https://github.com/magento/magento2/issues/27607)

#### PHP单元测试

<!-- ENGCOM-7435 7306-->

* PHP单元测试不再引发此致命错误： `Fatal error: Class Mock_CartExtensionInterface_0ba80a0b contains 2 abstract methods and must therefore be declared abstract or implement the remaining methods (Magento\Quote\Api\Data\CartExtensionInterface::getAmazonOrderReferenceId, Magento\Quote\Api\Data\CartExtensionInterface::setAmazonOrderReferenceId) in /var/www/html/vendor/phpunit/phpunit-mock-objects/src/Generator.php(264) : eval()'d code on line 1`. _修复了Lukasz Bajsarowicz在私有存储库合作伙伴magento2ee和 [27701](https://github.com/magento/magento2/pull/27701)_. [GitHub-27638](https://github.com/magento/magento2/issues/27638)

<!-- ENGCOM-7271-->

* 测试 `Offline_Payments` 现在与PHPUnit 8兼容。  _Cristiano Pacheco在提取请求中提交的修复 [27627](https://github.com/magento/magento2/pull/27627)_. [GitHub-27500](https://github.com/magento/magento2/issues/27500)

<!-- ENGCOM-7243 7284 7291-->

* 的单元测试 `Framework`， `AdminAnalytics`， `AdminNotification`、和 `AMPQ` 已针对PHPUnit 8进行更新。 _修复了由Ihor Sviziev在拉取请求中提交的错误 [27522](https://github.com/magento/magento2/pull/27522)， [27521](https://github.com/magento/magento2/pull/27521)， [27519](https://github.com/magento/magento2/pull/27519)， [27522](https://github.com/magento/magento2/pull/27522)_. [GitHub-27500](https://github.com/magento/magento2/issues/27500)

<!-- ENGCOM-6542-->

* 您现在可以运行 `\Magento\Downloadable\Test\Unit\Helper\DownloadTest` 单元测试，无需连接到互联网。  _由aleromano89在拉取请求中提交的修复 [26264](https://github.com/magento/magento2/pull/26264)_. [GitHub-23521](https://github.com/magento/magento2/issues/23521)

<!-- ENGCOM-6695-->

* 已添加单元测试 `app/code/Magento/Fedex/Model/Source/Generic.php`. _Sathish Subramanian在拉取请求中提交的修复 [26549](https://github.com/magento/magento2/pull/26549)_.

<!-- ENGCOM-7251 7283 7472-->

* `<magentoCron>` 已添加到多个测试，这会触发部分重新索引。 此更改解决了在涵盖的功能测试中创建误报的问题 `Magento_Bundle`， `CatalogImportExport`， `CatalogInventory`， `CatalogRule`， `Backend`， `Braintree`、和 `Captcha`. _Lukasz Bajsarowicz在拉取请求中提交的修复 [27322](https://github.com/magento/magento2/pull/27322)， [27323](https://github.com/magento/magento2/pull/27323)， [27321](https://github.com/magento/magento2/pull/27321)_. [GitHub-27320](https://github.com/magento/magento2/issues/27320)

<!-- ENGCOM-6844-->

* 所有不正确的用法 `<amOnPage>` 已替换为适当的 `<actionGroup>` 适用于测试中的管理员注销。 _修复了Lukasz Bajsarowicz在私有存储库合作伙伴magento2ee的拉取请求116中提交的错误_. [GitHub-26331](https://github.com/magento/magento2/issues/26331)

<!-- ENGCOM-6352-->

* 测试中的每个操作组已移至单独的文件以遵循MFTF最佳实践，并且已修订不一致的文件名。 以下模块的测试受到影响：

   * module-calog-permissions
   * module-share-catalog
   * module-catalog-event
   * module-banner
   * module-admin-gws
   * module-advanced-checkout
   * 模块交付
   * module-ui
   * 模块交付
   * module-checkout-address-search
   * module-sales
   * module-catalog
   * module-catalog-rule-staging
   * module-visual-merchandiser
   * 模块 — 客户

   _Lukasz Bajsarowicz在拉取请求中提交的修复 [25800](https://github.com/magento/magento2/pull/25800)， [26323](https://github.com/magento/magento2/pull/26323)， [26321](https://github.com/magento/magento2/pull/26321)， [26320](https://github.com/magento/magento2/pull/26320)， [26319](https://github.com/magento/magento2/pull/26319)， [26322](https://github.com/magento/magento2/pull/26322)， [25828](https://github.com/magento/magento2/pull/25828)， [26329](https://github.com/magento/magento2/pull/26329) （和拉取请求104、105、106、107、108、109、111、119、120、121位于私有存储库合作伙伴magento2ee中）_. [GitHub-22853](https://github.com/magento/magento2/issues/22853)

### 主题

<!-- MC-29804-->

* 我们已经解决了中的一个错误 `JsFooterPlugin.php` 这会影响动态块的显示。 以前，应用程序在您直接访问时显示此错误 `/banner/ajax/load/url`： `Uncaught TypeError: strpos() expects parameter 1 to be string, null given in`.

<!-- ENGCOM-6708-->

* 此 `i18n` 方法提供了将字符串添加到为模板加下划线的功能。  _修复了由Sergiy Vasiutynskyi在拉取请求中提交的错误 [26435](https://github.com/magento/magento2/pull/26435)_. [GitHub-18012](https://github.com/magento/magento2/issues/18012)

<!-- ENGCOM-6666-->

* 此 `section-config` 模块已重构。 此重构减少了由初始化模块之前第三方模块发出POST请求或直接请求客户数据所导致的错误 `data-mage-init`. _修复了Mateusz Krzeszowiak在拉取请求中提交的错误 [25764](https://github.com/magento/magento2/pull/25764)_. [GitHub-17125](https://github.com/magento/magento2/issues/17125)

<!-- ENGCOM-6924-->

* `LoadCssAsync` 已修复HTML格式错误。 _Sathish Subramanian在拉取请求中提交的修复 [26764](https://github.com/magento/magento2/pull/26764)_. [GitHub-26760](https://github.com/magento/magento2/issues/26760)

<!-- ENGCOM-7052-->

* 当您创建 `default.xml` 和 `catalog_product_view.xml` 文件作为创建新主题的一部分，应用程序会创建这些页面，或者按预期在日志文件中记录错误。 以前，应用程序将错误记录在 `vendor/magento/framework/View/Page/Config/Renderer.php` 文件。 _Vinh Le在拉取请求中提交的修复 [27026](https://github.com/magento/magento2/pull/27026)_. [GitHub-27009](https://github.com/magento/magento2/issues/27009)

### 翻译和区域设置

<!-- MC-24186-->

* 在以下情况下，内联翻译现在可在店面中正常工作： **管理员** > **商店** > **配置** > **高级** > **开发人员** > **翻译内联** > **已为店面启用** 设置。

<!-- MC-31663-->

* 为店面启用内联翻译后，现在可按预期工作。

<!-- ENGCOM-7064-->

* 产品URL密钥现在可按预期音译。 _修复了由DanieliMi在拉取请求中提交的错误 [26506](https://github.com/magento/magento2/pull/26506)_. [GitHub-26499](https://github.com/magento/magento2/issues/26499)

<!-- ENGCOM-6899-->

* 此 `es_US Spanish (United States)` 现在支持区域设置。 _Vinh Le在拉取请求中提交的修复 [26857](https://github.com/magento/magento2/pull/26857)_. [GitHub-26843](https://github.com/magento/magento2/issues/26843)

<!-- ENGCOM-6996-->

* 数字占位符计数和JavaScript代码占位符计数现在相同。 以前，JavaScript代码假定为0%，而数字占位符计数以%1开头。  _修复了拉取请求中由korostii提交的错误 [25359](https://github.com/magento/magento2/pull/25359)_. [GitHub-25243](https://github.com/magento/magento2/issues/25243)

<!-- ENGCOM-6557-->

* 您现在可以禁用产品详细信息页面的页面标题的翻译(`page.main.title`)，默认情况下处于启用状态。 _修复了Bartomiej Szubert在拉取请求中提交的错误 [26269](https://github.com/magento/magento2/pull/26269)_. [GitHub-7065](https://github.com/magento/magento2/issues/7065)

<!-- ENGCOM-7465-->

* 发票PDF中阿拉伯文和希伯来文的译文问题已得到解决。 _修复了由Ihor Sviziev在拉取请求中提交的错误 [27887](https://github.com/magento/magento2/pull/27887)_. [GitHub-25769](https://github.com/magento/magento2/issues/25769)

<!-- ENGCOM-6646-->

* 现在，按照预期和文档中的说明，在首次使用的基础上应用语言包继承顺序。  _修复了由Sergiy Vasiutynskyi在拉取请求中提交的错误 [26420](https://github.com/magento/magento2/pull/26420)_. [GitHub-8691](https://github.com/magento/magento2/issues/8691)

<!-- ENGCOM-6443-->

* 现在，当您在仅支持拉丁字母的区域设置中为文件夹名称输入非拉丁字符时，应用程序会显示此错误消息： `Please rename the folder using only Latin letters, numbers, underscores and dashes`. _Eden Duong在拉取请求中提交的修复 [25904](https://github.com/magento/magento2/pull/25904). [GitHub-25896](https://github.com/magento/magento2/issues/25896)_

<!-- ENGCOM-6539-->

* 的长度 `locale` 列 `directory_country_region_name` 已从8个增加到16个，以支持区域设置，例如  `zh_Hans_CN`. _修复了Bartomiej Szubert在拉取请求中提交的错误 [26268](https://github.com/magento/magento2/pull/26268)_. [GitHub-14001](https://github.com/magento/magento2/issues/14001)

### UI

<!-- MC-32547-->

* 您现在可以使用页面生成器将产品添加为按钮链接(**编辑内容** > **按钮链接**)。 以前，当您尝试选择产品时，应用程序会引发此错误： `Product with ID: XXXX doesn't exist`.

<!-- ENGCOM-7490-->

* “返回”按钮现在可以按预期从 **管理员** > **商店** > **订单状态** > **编辑订单状态**. _Vadim Malesh在拉取请求中提交的修复 [27976](https://github.com/magento/magento2/pull/27976)_. [GitHub-1270](https://github.com/magento/magento2/issues/1270)

<!-- ENGCOM-6692-->

* 当您使用箭头键将光标移动到 **文件名** Adobe Stock字段。 _Adarsh Manickam在拉取请求中提交的修复 [25991](https://github.com/magento/magento2/pull/25991)_. [GitHub-847](https://github.com/magento/magento2/issues/847)

<!-- ENGCOM-6414-->

* 此 **您的密码**  字段。 **管理员** > **系统** > **集成** 页面现在会按预期继承样式。 _Eduard Chitoraga在拉取请求中提交的修复 [25918](https://github.com/magento/magento2/pull/25918)_. [GitHub-25917](https://github.com/magento/magento2/issues/25917)

<!-- ENGCOM-6482-->

* 店面上的JavaScript验证器验证的输入内容也将通过管理员验证。 以前，JavaScript验证器在店面将换行符计为单个字符，但在服务器端， `\Magento\Catalog\Model\Product\Option\Type\maxCharacters` 将换行数计为两个字符。 _Grzegorz Bogusz在拉取请求中提交的修复 [26033](https://github.com/magento/magento2/pull/26033)_. [GitHub-25974](https://github.com/magento/magento2/issues/25974)

<!-- ENGCOM-6517-->

* 此 `subTitle` 使用更改模态标题时，不再擦除标记 `setTitle()` 呼叫。 以前，当您尝试创建包含标题和子标题的弹出窗口或自定义模式时，请使用更改标题 `setTitle()` 方法， `subTitle` 已被擦除。 _Andrea Parmeggiani在拉取请求中提交的修复 [26142](https://github.com/magento/magento2/pull/26142)_. [GitHub-26141](https://github.com/magento/magento2/issues/26141)

<!-- ENGCOM-6464-->

* 现在，管理员营销选项卡中的子菜单会按预期自动调整菜单项的长度。  您现在还可以水平滚动。  _修复了Pawel Tylek在拉取请求中提交的错误 [26034](https://github.com/magento/magento2/pull/26034)_. [GitHub-18687](https://github.com/magento/magento2/issues/18687)

<!-- ENGCOM-6519-->

* 表 `quote`  列 `customer_note` 现在使用类型 `text` 如预期。 以前，它使用类型 `varchar(255)`. _Ravi Chandra在拉取请求中提交的修复 [26160](https://github.com/magento/magento2/pull/26160)_. [GitHub-26155](https://github.com/magento/magento2/issues/26155)

<!-- ENGCOM-7153-->

* 更正了上的表标题的显示问题 **我的帐户**  > **通讯簿**  地址条目表。  _由Abrar Pathan在拉取请求中提交的修复 [27336](https://github.com/magento/magento2/pull/27336)_. [GitHub-27335](https://github.com/magento/magento2/issues/27335)

<!-- ENGCOM-5986-->

* 分层导航价格步骤中使用的货币符号现在基于预期的默认设置。  _修复了Bartomiej Szubert在拉取请求中提交的错误 [24815](https://github.com/magento/magento2/pull/24815)_. [GitHub-21684](https://github.com/magento/magento2/issues/21684)

<!-- ENGCOM-6324-->

* 白俄罗斯货币(BYR)的符号已更新为BYN。 _修复了Bartomiej Szubert在拉取请求中提交的错误 [25723](https://github.com/magento/magento2/pull/25723)_. [GitHub-24713](https://github.com/magento/magento2/issues/24713)

<!-- ENGCOM-6622-->

* 分辨率小于767像素的显示屏上，“目录”页面的“比较产品”部分现在按预期在移动视图中显示。 _Hitesh在拉取请求中提交的修复 [26418](https://github.com/magento/magento2/pull/26418)_. [GitHub-26416](https://github.com/magento/magento2/issues/26416)

<!-- ENGCOM-6376-->

* 现在，产品页面滚动在移动设备视图中可按预期工作。  _修复了Mateusz Krzeszowiak在拉取请求中提交的错误 [25385](https://github.com/magento/magento2/pull/25385)_. [GitHub-10518](https://github.com/magento/magento2/issues/10518)， [GitHub-21717](https://github.com/magento/magento2/issues/21717)

<!-- ENGCOM-6368-->

* 您现在可以按预期在移动设备视图中滚动浏览产品页面上的图库缩略图图像。 _修复由iGerchak在拉取请求中提交的错误 [25839](https://github.com/magento/magento2/pull/25839)_. [GitHub-21014](https://github.com/magento/magento2/issues/21014)

<!-- ENGCOM-6425-->

* 单击主题标题 **管理员**  > **内容** > **主题** 不再导致重复记录。 _Eden Duong在拉取请求中提交的修复 [25926](https://github.com/magento/magento2/pull/25926)_. [GitHub-25925](https://github.com/magento/magento2/issues/25925)

<!-- ENGCOM-6328-->

* “管理员帐单地址/送货地址”页面的布局已重构，以符合管理员表单的显示约定。 _修复Alexey Rakitin在拉取请求中提交的错误 [25699](https://github.com/magento/magento2/pull/25699)_. [GitHub-23481](https://github.com/magento/magento2/issues/23481)， [GitHub-19805](https://github.com/magento/magento2/issues/19805)

<!-- ENGCOM-6628 6593-->

* 现在，产品详细信息页面上的“添加到比较”链接在分辨率低于640像素的显示屏上的移动设备视图中正确呈现。 _修复了由Pawe Tylek在拉取请求中提交的错误 [26424](https://github.com/magento/magento2/pull/26424) 和特杰什·孔巴雷的拉取请求 [26365](https://github.com/magento/magento2/pull/26365)_. [GitHub-26364](https://github.com/magento/magento2/issues/26364)

<!-- ENGCOM-6607-->

* 此 **排序方式** 标签不再与 **购买者** “移动设备”视图中“类别”页面上的按钮。 _修复Andrii Kartavtsev在拉取请求中提交的错误 [26381](https://github.com/magento/magento2/pull/26381)_. [GitHub-25300](https://github.com/magento/magento2/issues/25300)

<!-- ENGCOM-7137-->

* 您现在可以通过启用  **使用默认值** 复选框。 _由Abel Truong在拉取请求中提交的修复 [27295](https://github.com/magento/magento2/pull/27295)_. [GitHub-27169](https://github.com/magento/magento2/issues/27169)

<!-- ENGCOM-6532-->

* 已更正的间距 **更新** 按钮和 **数量** 字段。  _Hitesh在拉取请求中提交的修复 [26234](https://github.com/magento/magento2/pull/26234)_. [GitHub-26227](https://github.com/magento/magento2/issues/26227)

<!-- ENGCOM-7032-->

* “通讯簿”页面上“其他地址条目”表的下边框颜色现在匹配 `thead` 和 `tbody` 边框颜色。 _修复了由Tejash Kumbhare在拉取请求中提交的错误 [26649](https://github.com/magento/magento2/pull/26649)_. [GitHub-26648](https://github.com/magento/magento2/issues/26648)

<!-- ENGCOM-7195-->

* 当用户单击模态叠加时，提示模态不再执行确认操作。 _Serhiy Zhovnir在拉取请求中提交的修复 [27399](https://github.com/magento/magento2/pull/27399)_.

### URL

<!-- ENGCOM-7112-->

* 类别存储库（save方法）已重构，这以前阻止您在更改类别URL键时创建唯一路径。 _修复了由Sergiy Vasiutynskyi在拉取请求中提交的错误 [27304](https://github.com/magento/magento2/pull/27304)_. [GitHub-14080](https://github.com/magento/magento2/issues/14080)

<!-- ENGCOM-7208-->

* 类别URL键逻辑的验证已得到改进。 _修复了由Sergiy Vasiutynskyi在拉取请求中提交的错误 [27412](https://github.com/magento/magento2/pull/27412)_. [GitHub-13689](https://github.com/magento/magento2/issues/13689)

### URL重写

<!-- MC-31147-->

* 在CMS页面上更改语言的客户现在可以成功导航到他们选择的商店视图。 以前，应用程序显示404错误。

<!-- ENGCOM-6997-->

* 现在，为您启用了类别路径包含的产品URL生成URL重写可按预期工作。 以前，在具有多个存储视图的部署中，应用程序有时会通过使用类别URL路径的默认值（而不是特定于存储的URL路径）来生成错误的URL重写。 _修复由Pieter Hoste在拉取请求中提交 [26784](https://github.com/magento/magento2/pull/26784)_. [GitHub-25124](https://github.com/magento/magento2/issues/25124)， [GitHub-11616](https://github.com/magento/magento2/issues/11616)

<!-- ENGCOM-6995-->

* 我们添加了检查，以防止在请求路径与目标路径相同时进行URL重定向。 _修复了Bartomiej Szubert在拉取请求中提交的错误 [26902](https://github.com/magento/magento2/pull/26902)_. [GitHub-20309](https://github.com/magento/magento2/issues/20309)

<!-- ENGCOM-6303-->

* 当URL具有尾随斜杠时，URL重写操作不再从URL中删除查询字符串。  _修复了由Alexey Arendarenko在拉取请求中提交的错误 [25603](https://github.com/magento/magento2/pull/25603)_. [GitHub-18717](https://github.com/magento/magento2/issues/18717)

### 增值税

<!-- ENGCOM-7458-->

* 更正了以下项的增值税验证URL [欧盟增值税编号](https://ec.europa.eu/taxation_customs/vies/checkVatService.wsdl).  _Shikha Mishra在拉取请求中提交的修复 [27886](https://github.com/magento/magento2/pull/27886)_. [GitHub-27874](https://github.com/magento/magento2/issues/27874)

### Visual Merchander

<!-- MC-31136-->

* 现在，将产品拖放到新位置时，“编辑类别”页面的行为与预期相同。 以前，将产品拖放到任何类别页面上时，都会将查看窗口重新定位到页面顶部。

### Web API框架

<!-- MC-29891-->

* 更正了POST问题 `/rest/default/async/bulk/V1/orders` 呼叫。

<!-- MC-30675-->

* 更正了POST问题 `/rest/default/async/bulk/V1/products` 呼叫。

<!-- ENGCOM-6945-->

* 此 `getList` 方法已重构以检索 `is_subscribed` 扩展属性。 以前，在通过API获取客户实体时，无法检索此属性。 _修复了拉取请求中由enriquei4提交的错误 [25311](https://github.com/magento/magento2/pull/25311)_. [GitHub-13252](https://github.com/magento/magento2/issues/13252)

<!-- ENGCOM-6500-->

* 通过以下方式更新客户信息 `/V1/customers/:id` 不再重置 `group_id` 不必要的。 以前，当您通过REST更新客户时，如果正文不包含客户组，则客户组将更改为1。 _由MaxRomanov4669在拉取请求中提交的修复 [25958](https://github.com/magento/magento2/pull/25958)_. [GitHub-14663](https://github.com/magento/magento2/issues/14663)

<!-- ENGCOM-6920-->

* 在Web API中使用服务合同中可空的getter时，不再引发反射错误。 现在，可以返回null和有效类型的方法不论顺序如何，均可正确运行。  _由Marco k̦ Pcke在拉取请求中提交的修复 [25806](https://github.com/magento/magento2/pull/25806)_. [GitHub-25656](https://github.com/magento/magento2/issues/25656)

<!-- ENGCOM-7075-->

* 您现在可以使用POST `/V1/guest-carts/:cartId/items` 以将产品添加到特定购物车。 以前，当您使用此调用时，应用程序会忽略 `cartId`. _Vadim Malesh在拉取请求中提交的修复 [27172](https://github.com/magento/magento2/pull/27172)_. [GitHub-14086](https://github.com/magento/magento2/issues/14086)

<!-- ENGCOM-7102-->

* 您现在可以使用 `PUT /V1/cmsPage/:id` 端点保存CMS页面标题而不更改其他字段的值。 _Vadim Malesh在拉取请求中提交的修复 [27237](https://github.com/magento/magento2/pull/27237)_. [GitHub-24704](https://github.com/magento/magento2/issues/24704)

<!-- ENGCOM-7011-->

* REST请求的结果分页现在很准确。 以前，从特定页面请求结果时(例如， `page_size` = 1和a `current_page` 值)，则调用会返回重复结果的最后一页，而不是信息性消息。  _Lukasz Bajsarowicz在拉取请求中提交的修复 [26988](https://github.com/magento/magento2/pull/26988)_. [GitHub-26986](https://github.com/magento/magento2/issues/26986)， [GitHub-8099](https://github.com/magento/magento2/issues/8099)

<!-- ENGCOM-6540-->

* GET的结果 `/V1/orders/items/{id}` 现在包含一个扩展属性元素，其中包含礼品消息数据。 _由Laura Folco在拉取请求中提交的修复 [25946](https://github.com/magento/magento2/pull/25946)_. [GitHub-19093](https://github.com/magento/magento2/issues/19093)

### 愿望清单

<!-- MC-29988-->

* 现在，当在存储视图级别启用并在全局级别禁用愿望清单时，愿望清单会按预期工作。 以前，设置这些后，将产品添加到愿望清单会导致404错误。

<!-- MC-30196-->

* 在包含多个愿望清单的部署中重命名愿望清单时，应用程序现在可以正确保存愿望清单并显示新的名称。 以前，应用程序继续显示前愿望清单名称。

<!-- MC-31948-->

* 现在，您可以在运行Internet Explorer 11.x的部署中从购物车导航和修改愿望清单。以前，您无法在此环境中创建、编辑或移动愿望清单。

<!-- ENGCOM-6518-->

* 我们改进了当客户尝试与超过允许的电子邮件地址共享其愿望清单时显示的错误消息。  _修复了拉取请求中由divyajyothi5321提交的错误 [26066](https://github.com/magento/magento2/pull/26066)_. [GitHub-26064](https://github.com/magento/magento2/issues/26064)

<!-- ENGCOM-6723-->

* 应用程序现在按中的预期显示“我的愿望清单”页面，显示分辨率大于768px且小于1023px。 _Hitesh在拉取请求中提交的修复 [26546](https://github.com/magento/magento2/pull/26546)_. [GitHub-26543](https://github.com/magento/magento2/issues/26543)

<!-- ENGCOM-7062-->

* 单击时生成的电子邮件 **共享愿望清单** 现在显示与愿望清单页面相同的产品图像。 _由Michael Bottens在拉取请求中提交的修复 [27125](https://github.com/magento/magento2/pull/27125). [GitHub-27124](https://github.com/magento/magento2/issues/27124)_

<!-- ENGCOM-6602-->

* 客户现在可以将属于分组产品的简单产品以及具有不同数量的相同简单产品添加到愿望清单。  _由MaxRomanov4669在拉取请求中提交的修复 [26258](https://github.com/magento/magento2/pull/26258)_. [GitHub-11209](https://github.com/magento/magento2/issues/11209)

### 所见即所得

<!-- ENGCOM-6275-->

* WYSIWYG图像上传程序现在使用 `pub/media/wysiwyg` 作为存储根目录。 以前，上传的 `pub/media` 作为其存储根，这使得最近对图像上传程序代码进行了更改后无法访问已上传的图像。 _修复由Pieter Hoste在拉取请求中提交 [24878](https://github.com/magento/magento2/pull/24878)_. [GitHub-22609](https://github.com/magento/magento2/issues/22609)

<!-- ENGCOM-7045-->

* Chrome浏览器上的TinyMCE4现在可按预期处理双字节字符。 以前，TinyMCE4无法在Chrome上正确处理双字节字符（例如中文字符）。 _西博和在拉取请求中提交的修复 [25454](https://github.com/magento/magento2/pull/25454)_. [GitHub-24637](https://github.com/magento/magento2/issues/24637)

## 已知问题 — 常规

**问题**：安装PHP 7.4.2的部署中会出现店面错误消息异常。 使用PHP 7.4.2部署2.4.0时，店面错误消息中的空格符号将替换为加(+)字符。 此错误是PHP 7.4.2的固有错误，Adobe Commerce无法更正此错误。 **解决方法**：我们建议使用其他版本的PHP 7.4.x。参见 [店面上显示原始消息数据](https://support.magento.com/hc/en-us/articles/360045804332)  知识库文章。 <!-- MC-34170-->

**问题**：商家无法从“管理创建包”页面将订购的产品添加到包中并保存包。 参见 [配送标签创建](https://support.magento.com/hc/en-us/articles/360046750171) 知识库文章。 此 **MC-35514-2.4.0-CE-composer.patch** 此问题的修补程序现在可从以下站点获得： [版本](https://magento.com/tech-resources/download). <!-- MC-35514-->

**问题**：应用程序在安装依赖于的API的第三方扩展时显示此错误消息 `Store` CLI命令中的模块： `The default website isn't defined. Set the website and try again`. **解决方法**：从Composer中删除对第三方扩展的依赖关系，安装Magento，然后安装第三方扩展。

**问题**：此 **将选择添加到我的购物车** 购物车底部的按钮不起作用。 **解决方法**：使用 **将选择添加到我的购物车** 按钮进行修改。 参见 [将选择添加到我的购物车按钮不起作用](https://support.magento.com/hc/en-us/articles/360045838312) 知识库文章。 <!-- MC-35313-->

**问题**：在为退货授权(RMA)创建配送标签后，商家无法与“退货”页面上的任何页面元素进行交互。 参见 [返回“编辑”页在创建装运标签时停止工作](https://support.magento.com/hc/en-us/articles/360046441312) 知识库文章。 此 **MC-35984-2.4.0-composer.patch** 此问题的修补程序现在可从以下站点获得： [版本](https://magento.com/tech-resources/download). <!-- MC-35984-->

**问题**：管理员无法按SKU将可配置产品添加到报价。 当管理员单击 **添加到报价** 按钮时，Quote Edit页仍处于加载状态，管理员无法保存其更改。 **解决方法**：没有用于编辑B2B报价的解决方法。  但是，您仍然可以通过从产品列表中选择产品来订购产品，而不是通过SKU添加它们。 参见 [B2B管理员无法将可配置产品添加到报价](https://support.magento.com/hc/en-us/articles/360046801971) 知识库文章。 <!-- MC-35513-->

**问题**：商家无法从管理员创建新订单，因为 **按SKU添加产品** 和 **添加产品**  启用JavaScript捆绑时，订单创建页面中缺少按钮。  **解决方法**：为部署禁用JavaScript捆绑包。 <!-- MC-36044-->

**问题**：应用程序 `404 not found` 客户在签出发往多个地址的订单时尝试删除奖励点时出错。 <!-- MC-35955-->

**问题**：编辑客户愿望清单中的可配置产品会导致以下意外行为：“配置产品”页面上出现意外字段，“配置产品”页面在单击后不会消失 **确定**. 应用程序还会显示此消息： `Please load Wish List item`. **解决方法**：重新加载“配置产品”页面。 <!-- MC-35617-->

**问题**：当订单列表跨越多个页面时，客户无法更改每页显示的订单数。 目前，当您导航到订单的最后一页并尝试更改每页显示的订单数时，应用产品会显示此消息： `You have placed no orders`. 参见 [订单显示错误](https://support.magento.com/hc/en-us/articles/360046802271) 知识库文章。  **解决方法**：重新打开“我的订单”页面将显示“订单”列表。 <!-- MC-34153-->

**问题**：直接单击 **出口税率** “添加新税则”页的按钮( **商店** > **税则**)不下载 `tax_rates.csv` 文件按预期显示。 **解决方法**：单击  **出口税率** 按钮。  参见 [出口税率不起作用](https://support.magento.com/hc/en-us/articles/360045850032)  知识库文章。 <!-- MC-35345-->

**问题**：此 **刷新** “管理客户活动”页面的“上次订购的项目”、“比较列表中的产品”和“最近比较的产品”部分中的按钮无法按预期工作。 目前，应用程序每次滚动页面 **刷新** 已单击按钮，但不显示产品名称。 参见 [刷新客户活动不起作用](https://magento.zendesk.com/hc/en-us/articles/360046091332) 知识库文章。 <!-- MC-35296-->

### B2B

**问题**：如果折扣代码在采购订单(PO)获得批准之前过期，则PO将继续显示折扣金额，但是一旦PO获得批准，订单金额将达到非折扣总额。 **解决方法**：安装 **B2B-709采购订单折扣修补程序** 此问题的修补程序，现在可从 **我的帐户** > **下载** 部分 `magento.com`.

**问题**：在多网站部署中升级到B2B 1.2.0期间应用程序出现异常。 时间 `setup:upgrade` 运行，此错误发生在 `PurchaseOrder` 模块： `Module Magento_PurchaseOrder: Unable to apply data patch Magento\PurchaseOrder\Setup\Patch\Data\InitPurchaseOrderSalesSequence for moduleMagento_PurchaseOrder`. **解决方法**：安装 **B2B-716向InitPurchaseOrderSalesSequence数据修补程序添加NonTransactionableInterface接口** 修补程序，该修补程序现在可从 **我的帐户** > **下载** 部分 `magento.com`.

## 已知问题 — VBE

### Amazon Pay

* **问题**：客户单击时，结账工作流中缺少付款方法 **返回到标准结帐** 使用Amazon Pay结账期间。  **解决方法**：刷新签出页面以显示缺少的方法。  <!-- BUNDLE-2661-->

* **问题**：应用产品在“付款方式”下拉列表中显示两个相同的Amazon Pay方式，在创建新的购物车价格规则时可以使用该方式。  <!-- BUNDLE-2685-->

### Braintree

* **问题**：当管理员尝试访问“Braintree结算报告”页时，应用程序显示错误(**管理员** > **报告** )。 目前，应用程序显示此消息： `An error has happened during application run. See exception log for details`. 参见 [无法加载Braintree结算报表](https://support.magento.com/hc/en-us/articles/360046798251) 知识库文章。 此 **BUNDLE-2683_SettlementReport.patch** 此问题的修补程序现在可从以下站点获得： [版本](https://magento.com/tech-resources/download). <!-- BUNDLE-2683-->

* **问题**：在启用了Venmo的部署中，商家无法为订单创建部分发票，并且 **为卡付款启用保险库** 设置已禁用。 目前，应用程序显示此错误： `The "vault_capture" command doesn't exist. Verify the command and try again`.  <!-- BUNDLE-2647-->

* **问题**：应用产品在“付款方法”下拉列表中显示两个相同的PayPal方法，在创建新的购物车价格规则时可以使用这两个方法。   <!-- BUNDLE-2686-->

* **问题**：应用程序打开时出错 **销售** > **Braintree虚拟终端**. 尽管表单包含损坏的UI元素，但它仍接受付款。 **解决方法**：保存正确的Braintree凭据，这将修复折叠的输入字段。 参见 [“Braintree虚拟终端”页已损坏](https://support.magento.com/hc/en-us/articles/360046800071)  知识库文章。 此 **BUNDLE-2670_VirtualTerminal.patch** 此问题的修补程序现在可从以下站点获得： [版本](https://magento.com/tech-resources/download). <!-- BUNDLE-2670-->

* **问题**：当客户在结账期间选择本地支付方式时，应用程序在以下国家/地区显示错误消息：比利时、荷兰、意大利、西班牙和波兰。  **解决方法**：忽略错误消息并继续付款。

### dotdigital

* **问题**：集成测试失败，并出现以下错误： `PHP Fatal error: Declaration of Dotdigitalgroup\Email\Test\Integration\Model\Sync\Importer\ImporterFailedTest::setUp() must be compatible with PHPUnit\Framework\TestCase::setUp(): void in /var/www/vendor/dotmailer/dotmailer-magento2-extension/Test/Integration/Model/Sync/Importer/ImporterFailedTest.php on line 36`. **解决方法**：此 **BUNDLE-2684 Dotdigital集成测试修补程序** 此问题的修补程序现在可从以下站点获得： [版本](https://magento.com/tech-resources/download). <!-- BUNDLE-2684-->

### 克拉尔纳

* **问题**：将保留为 **设计主题** Klarna On-Site Messaging (**管理员**  >  **商店**  >  **配置**  > **Klarna设置**)导致出现空白页。  **解决方法**：选择设计主题并保存。  <!-- BUNDLE-2623-->

### 顶点

* **问题**：应用程序显示  **地址验证** “签出”工作流的“送货”部分上的按钮，即使地址验证被禁用也是如此。 地址验证器不会重新检查更新的地址，并且当客户在首次输入错误地址之后输入正确的地址时，即使启用了地址验证，仍继续显示一条消息，指示地址无效。 **解决方法**：禁用顶点地址验证。 <!-- BUNDLE-2604-->

## 社区投稿

我们感谢更广泛的Magento Open Source界，并感谢他们对这一版本的贡献。 您可以通过以下方式了解社区对我们当前版本的贡献：

* 如果社区成员提供了此版本的修复，我们会在这些注释的修复问题部分中通过短语来标识修复， ”*社区成员提供的修复*“。

* 社区工程团队 [Magento参与者](https://magento.com/magento-contributors) 按月、季度和年维护最佳贡献个人和合作伙伴的列表。 在该参与者页面中，您可以单击链接，以访问他们在GitHub上合并的PR。

### 合作伙伴投稿

下表列出了合作伙伴的贡献。 此表列出了提出拉取请求的合作伙伴、外部拉取请求以及与其关联的GitHub问题编号（如果可用）。

{{$include /help/_includes/release-notes/engcomm-2-4-0-partner.md}}

### 个人投稿人

下表列出了来自社区成员的贡献。 此表列出了外部拉取请求、与其关联的GitHub问题编号（如果可用）以及促成拉取请求的社区成员。

{{$include /help/_includes/release-notes/engcomm-2-4-0-issues.md}}

### 系统要求

我们的技术栈栈是基于PHP和MySQL构建的。 有关更多信息，请参阅 [系统要求](../../../installation/system-requirements.md).

### 安装和升级说明

您可以使用Composer安装Adobe Commerce 2.4.0。

## 迁移工具包

数据迁移工具可帮助将现有Magento1.x存储数据转移到Magento2.x。此命令行界面包括验证、进度跟踪、日志记录和测试功能。 有关安装说明，请参阅 [安装数据迁移工具](https://experienceleague.adobe.com/docs/commerce-operations/tools/data-migration/basics/install.html). 考虑探索或参与 [数据迁移存储库](https://github.com/magento/data-migration-tool).

此 [代码迁移工具包](https://github.com/magento/code-migration) 帮助将现有Magento1.x存储扩展和自定义项传输到Magento2.x。命令行界面包括用于转换Magento1.x模块和布局的脚本。
