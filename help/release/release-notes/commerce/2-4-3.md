---
title: Adobe Commerce 2.4.3发行说明
description: 了解2.4.3 Adobe Commerce版本中的新增功能、增强功能、错误修复和已知问题。
source-git-commit: 4c3a5b6462668993dcfb0ecb9327a7ffc47ced44
workflow-type: tm+mt
source-wordcount: '15953'
ht-degree: 0%

---


# Adobe Commerce 2.4.3发行说明

Adobe Commerce 2.4.3引入了性能和安全性的增强功能以及显着的平台改进。 安全性增强包括扩展reCAPTCHA覆盖范围和包含内置速率限制。 核心编辑器依赖项和第三方库已升级到与PHP 8.x兼容的最新版本。

此版本包括370多项核心代码的新修复和33项安全增强功能。 Adobe Commerce 2.4.2发行说明中发现的所有已知问题已在此版本中修复。

{{bics}}

请参阅 [Adobe Commerce 2.4.2-p2发行说明](../security/2-4-2-p2.md) 有关Adobe Commerce 2.4.2-p2的信息。

## 其他发行信息

尽管这些功能的代码与季度版本捆绑在一起，但其中一些项目(例如B2B、Page Builder和Progressive Web Application(PWA)Studio)也是独立发布的。 这些项目的错误修复会在特定于项目的单独发行信息中进行记录，该信息可在每个项目的文档中找到。

## 应用MC-43048__set_rate_limits__2.4.3.patch以解决API速率限制问题

此修补程序为Web API无法处理数组中包含20个以上项的请求的问题提供了解决方案。 此问题会影响运行Magento Open Source2.4.3、Adobe Commerce 2.4.3或2.3.7-p1的部署。 这些版本中增加了内置速率限制，以防止拒绝服务(DoS)攻击，默认最大值设置为20。 此修补程序会将默认限制还原为较高值。 如果您怀疑您的存储区遇到DoS攻击，则Adobe建议将默认输入限制降低为较低值，以限制可请求的资源数量。 请参阅 [Web API无法处理数组中包含20个以上项的请求](https://support.magento.com/hc/en-us/articles/4406893342093) 知识库文章。

## 应用AC-384__Fix_Incomplative_PHP_Method__2.4.3_ce.patch以解决升级时出现的PHP致命错误

升级到Adobe Commerce 2.4.3期间可能发生以下致命错误：

```terminal
PHP Fatal error: Uncaught Error: Call to undefined function Magento\Framework\Filesystem\Directory\str_contains() in [...]/magento/vendor/magento/framework/Filesystem/Directory/DenyListPathValidator.php:74
```

此错误是由于使用 `str_contains` 函数，它是PHP 8.x函数。 Adobe Commerce 2.4.3不支持PHP 8.x。此修补程序将此函数替换为支持的PHP 7.x函数。 请参阅 [Adobe Commerce升级2.4.3、2.3.7-p1 PHP错误修补程序](https://support.magento.com/hc/en-us/articles/4408021533069-Adobe-Commerce-upgrade-2-4-3-2-3-7-p1-PHP-Fatal-error-Hotfix) 知识库文章。

## 应用 `AC-3022.patch` 继续提供DHL作为航运公司

DHL已引入模式版本6.2，并将在不久的将来弃用模式版本6.0。 Adobe Commerce 2.4.4及更早版本（支持DHL集成）仅支持版本6.0。部署这些版本的商户应适用 `AC-3022.patch` 尽早将DHL作为航运公司继续提供。 请参阅 [应用补丁程序以继续提供DHL作为运输承运人](https://support.magento.com/hc/en-us/articles/7707818131597-Apply-a-patch-to-continue-offering-DHL-as-shipping-carrier) 有关下载和安装修补程序的信息，知识库文章。

## 亮点

在此版本中查找以下亮点。

### 大量安全性增强

此版本包括33项安全修复和平台安全改进。 其中许多安全修复已支持到2.4.2-p2和2.3.7-p1。

#### 33项安全增强功能，可帮助关闭远程代码执行(RCE)和跨站点脚本(XSS)漏洞

迄今为止，尚未发生与这些问题相关的已确认攻击。 但是，某些漏洞可能会被利用来访问客户信息或接管管理员会话。 大多数这些问题要求攻击者首先获得对管理员的访问权限。 因此，我们提醒您采取一切必要步骤保护您的管理员，包括但不限于以下工作：IP， [双重身份验证](https://devdocs.magento.com/guides/v2.4/security/two-factor-authentication.html)，使用VPN，使用唯一位置，而不是 `/admin`，密码卫生良好。 请参阅 [Adobe安全公告](https://helpx.adobe.com/security/products/magento/apsb21-64.html) 以讨论这些修复的问题。

#### 其他安全增强功能

此版本的安全改进提高了对最新安全最佳实践的合规性，包括：

* A **新编辑器插件** 有助于防止依赖关系混淆，并识别与公共资源包存储库中内部资源包同名的恶意资源包。 请参阅 [Adobe版本新编辑器插件（含2.4.3版）](https://magento.com/blog/best-practices/adobe-releases-new-composer-plugin-magento-243-release) 博客文章。

* **速率限制功能现已内置于API中** 以防止拒绝服务(DoS)攻击。 Web API现在对客户端可请求的资源大小或数量施加限制（默认的最大值设置为20，并可根据业务需求将其配置为不同的值）。 请参阅 [速率限制](https://developer.adobe.com/commerce/webapi/get-started/api-security/) 有关配置这些限制的信息。 <!-- MC-35358-->

* **ReCAPTCHA覆盖范围已扩展** 要包括：

   * 通过ReCAPTCHA涵盖具有相应HTML页面的Web API。 （这不包括集成访问的Web API。） ReCAPTCHA覆盖可保护端点免受垃圾邮件攻击。 当使用OAuth的第三方集成服务访问Web API时，ReCAPTCHA被禁用。<!-- MC-34472-->

   * 下单店面页面和与付款相关的Web API。 默认情况下，这些页面的ReCAPTCHA保护处于禁用状态，并可从管理员中启用。 该覆盖增加了反暴力机制，以保护商店免受梳理攻击。

{{cve-notice}}

### 基础架构改进

此版本包含改进框架质量和以下功能区域的功能：

* 客户帐户

* 目录

* CMS

* OMS。

* 导入/导出

* 促销和定位

* 购物车和结帐

* B2B

* 暂存和预览

**现在支持PayPal Pay Later** 在包含PayPal的部署中。 此功能允许购物者以每两周分期付款的方式支付订单，而不是在购买时支付全部金额。 <!-- MC-40556-->

**新建 `use_application_lock` 索引模式**. 的 `use_application_lock` 模式允许您通过使用环境变量或通过配置 `app/etc/env.php` 文件。 启用此模式后，在失败后不再需要手动重置索引器。 请参阅 [将应用程序锁定模式用于重新索引进程](https://developer.adobe.com/commerce/php/development/components/indexing/#using-application-lock-mode-for-reindex-processes).

### 平台增强功能

版本2.4.3尚未与PHP 8.x兼容，但以下平台升级使我们更接近于将来与PHP 8.x的兼容性。

* 核心编辑器依赖项和第三方库已升级到与PHP 8.x兼容的最新版本。 <!-- MC-39514-->

* KnockoutJS库已升级到v3.5.1（最新版本）。 <!-- MC-40694-->

* 已删除已弃用的TinyMCE v3库。 的 `Magento_Tinymce3Banner` 与TinyMCE v3.x相关的模块和MFTF测试已从Adobe Commerce中删除。 <!-- MC-42199 42170 -->

* 2.4.3版已经过测试，确认与Redis 6.0.12兼容。 （版本2.4.x仍与Redis 5.x兼容。）

* 已将层叠库依赖项升级到与PHP 8.x兼容的版本。 从 `composer.json` 文件。 **Adobe Commerce 2.4.3使用Laminas 3.4.0**. <!-- MC-39513-->

### 性能增强

此版本包括增强功能，可缩短产品价格和目录规则索引器的索引时间。 商家现在可以从客户群组或共享目录中排除网站，这样可减少用于索引的记录数并缩短索引时间。

### 实时搜索

[实时搜索](https://docs.magento.com/user-guide/live-search/overview.html) 由Powered提供 [Adobe Sensei](https://www.adobe.com/sensei.html) 通过使用人工智能和机器学习算法对聚合的访客数据进行深入分析，提供直观的搜索体验。 请参阅 [实时搜索发行说明](https://experienceleague.adobe.com/docs/commerce-merchant-services/live-search/release-notes.html).

### GraphQL

此版本添加了对以下功能的GraphQL支持：

* **共享目录**<!-- PWA-1294-->

* **愿望清单**. 的 [addWishlistItemsToCart突变](https://devdocs.magento.com/guides/v2.4/graphql/mutations/add-wishlist-items-to-cart.html) 将项目从指定的愿望列表移动到客户购物车。 <!-- magento/partners-magento2ee#449-->

* **礼品登记处**. 涵盖的任务包括： <!-- PWA-1290-->

   * 使用 [giftRegistry查询](https://devdocs.magento.com/guides/v2.4/graphql/queries/gift-registry.html) 以返回客户礼品登记册的内容。

   * 搜索礼品登记表 [type](https://devdocs.magento.com/guides/v2.4/graphql/queries/gift-registry-type-search.html), [电子邮件](https://devdocs.magento.com/guides/v2.4/graphql/queries/gift-registry-email-search.html)或 [ID](https://devdocs.magento.com/guides/v2.4/graphql/queries/gift-registry-id-search.html).

   * [创建](https://devdocs.magento.com/guides/v2.4/graphql/mutations/create-gift-registry.html), [更新](https://devdocs.magento.com/guides/v2.4/graphql/mutations/update-gift-registry.html)或 [删除](https://devdocs.magento.com/guides/v2.4/graphql/mutations/remove-gift-registry.html) 礼品登记处。

   * [更新](https://devdocs.magento.com/guides/v2.4/graphql/mutations/update-gift-registry-items.html) 或 [删除](https://devdocs.magento.com/guides/v2.4/graphql/mutations/remove-gift-registry-items.html) 礼品登记处的物品。

   * [移动所有项目](https://devdocs.magento.com/guides/v2.4/graphql/mutations/move-cart-items-to-gift-registry.html) 从购物车到礼品登记处。 <!-- ENGCOM-9082 9087-->

   * [添加](https://devdocs.magento.com/guides/v2.4/graphql/mutations/add-gift-registry-registrants.html), [更新](https://devdocs.magento.com/guides/v2.4/graphql/mutations/update-gift-registry-registrants.html)或 [删除](https://devdocs.magento.com/guides/v2.4/graphql/mutations/remove-gift-registry-registrants.html) 礼品登记处的注册者。

   * [共享](https://devdocs.magento.com/guides/v2.4/graphql/mutations/share-gift-registry.html) 邀请者的礼物登记处。

* **可转让报价**. 请参阅 [`negotiableQuote`](https://devdocs.magento.com/guides/v2.4/graphql/queries/negotiable-quote.html) 和 [`negotiableQuotes`](https://devdocs.magento.com/guides/v2.4/graphql/queries/negotiable-quotes.html) 查询。 <!-- PWA-1292-->

   新的突变包括：

   * [`requestNegotiableQuote`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/request-negotiable-quote.html)

   * [`setNegotiableQuoteShippingAddresses`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/set-negotiable-quote-shipping-address.html)

   * [`updateNegotiableQuoteQuantities`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/update-negotiable-quote-quantities.html)

   * [`removeNegotiableQuoteItems`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/remove-negotiable-quote-items.html)

   * [`closeNegotiableQuotes`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/close-negotiable-quotes.html)

   * [`deleteNegotiableQuotes`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/delete-negotiable-quotes.html).

* **共享路由**. 的 [路由查询](https://devdocs.magento.com/guides/v2.4/graphql/queries/route.html) 和 [可路由接口](https://devdocs.magento.com/guides/v2.4/graphql/interfaces/routable-interface.html) 支持产品、类别和CMS页面上的路由请求。 的 `urlResolver` 查询已被弃用，其功能已被 `route` 查询。

请参阅 [GraphQL开发人员指南](https://devdocs.magento.com/guides/v2.4/graphql/) 以了解这些增强功能的详细信息。

### B2B

版本2.4.3引入了B2B v1.3.2。此版本包含多个错误修复。 请参阅 [B2B发行说明](https://experienceleague.adobe.com/docs/commerce-admin/b2b/release-notes.html).

### 页面生成器

页面生成器现在作为Magento Open Source中的捆绑扩展提供。 它现在是Adobe Commerce 2.4.3和Magento Open Source2.4.3的默认内容编辑工具。它可以用任何第三方模块替换WYSIWG编辑器。

页面生成器取代了以下管理区域中的TinyMCE编辑器：

* CMS页面
* CMS块
* 类别描述
* 产品描述

在TinyMCE中创建的所有内容都已作为HTML迁移到页面生成器中。

### PWA Studio

有关增强功能和错误修复的信息，请参阅 [PWA Studio版本](https://github.com/magento/pwa-studio/releases). 请参阅 [兼容性](https://developer.adobe.com/commerce/pwa-studio/integrations/adobe-commerce/version-compatibility/) 以获取PWA Studio版本及其兼容版本的列表。

### 升级兼容性工具

的范围 [升级兼容性工具](https://experienceleague.adobe.com/docs/commerce-operations/upgrade-guide/upgrade-compatibility-tool/overview.html) 已根据社区反馈进行了扩展。 加入我们的 [#upgrade-compatibility-tool](https://magentocommeng.slack.com/archives/C019Y143U9F) Slack渠道，以获得Adobe产品团队和社区的支持，并帮助指导工具的未来发展方向。

### 云托管服务更新

此版本包括对我们对Amazon Simple Storage Service(AWS S3)和Amazon Aurora云托管服务的支持的增强。 它为AWS ElastiCache、AWSElasticsearch和AWS Managed Queues(Rabbit MQ)提供认证支持。 (我们已测试了这些服务的功能、性能和与Adobe Commerce的集成。)

### Adobe Stock集成

此版本包括Adobe Stock集成v2.1.1。

### 供应商开发的扩展

有关此版本的功能和更改的更新，请参阅以下主题：

* [Amazon Pay](https://docs.magento.com/user-guide/payment/amazon-pay.html). Amazon Pay已弃用，并将在更高的2.4.x版本中删除。 版本2.4.3及更高版本将仅包含兼容性更新和主要错误修复。

* [Braintree](https://docs.magento.com/user-guide/payment/braintree.html)

* [dotdigital Engagement Cloud](../../../upgrade/modules/upgrade.md)

* [克拉纳](https://docs.magento.com/user-guide/payment/klarna.html)

* [顶点云](https://docs.magento.com/user-guide/tax/vertex.html)

* [Yotpo产品评论](../../../upgrade/modules/upgrade.md)

## 已修复的问题

我们修复了2.4.3核心代码中的数百个问题。

### 安装、升级、部署

<!-- MC-41154-->

* 的 `bin/magento setup:db:status` 命令现在会返回一条消息，指示成功升级后所有内容均为最新。 以前，应用程序会显示以下错误： `Declarative Schema is not up to date`.

<!-- MC-40031 -->

* 现在，当新可配置产品创建失败时，在重新加载表单时，配置值会保留。 以前，在表单重新加载期间值丢失，应用程序显示以下错误： `The value specified in the URL Key field would generate a URL that already exists`. [GitHub-32102](https://github.com/magento/magento2/issues/32102)

<!-- MC-37596-->

* 运行时，应用程序不再引发异常 `bin/magento setup:upgrade` 从使用Redis的Magento Open Source部署升级到Adobe Commerce。

<!-- MC-34453-->

* 将部署从Magento Open Source升级到Adobe Commerce后，之前创建的购物车价格规则现在会显示在“内容测试”功能板页面上。

<!-- ENGCOM-8508 -->

* 在Galera Cluster上运行的部署现在支持更多客户。 [GitHub-31038](https://github.com/magento/magento2/issues/31038)

<!-- ENGCOM-9036 MC-41938 -->

* 现在，在安装了 `—use-rewrites=0` 选项或 `web/seo/use_rewrites` 设置为0 in `core_config_data_table`. [GitHub-32100](https://github.com/magento/magento2/issues/32100)

<!-- ENGCOM-8451 -->

* 已更新 `sortOrder` 加载 `AsyncCssPlugin`. 应用程序现在会加载 `AsyncCssPlugin` 之前 `JsFooterPlugin`. [GitHub-30882](https://github.com/magento/magento2/issues/30882)

<!-- ENGCOM-8701 -->

* `Magento\Config\Model\Config\PathValidator` 现在可检查显示路径以确定某个元素是否存在，如果该元素具有配置路径，则会使用 `config.xml` 路径而不是进行验证。 [GitHub-27678](https://github.com/magento/magento2/issues/27678)

<!-- ENGCOM-8684 -->

* 现在，使用Grunt或通过服务器端编译来编译较少文件会产生相同的结果。 以前。 `.abs- styles`，以扩展其他 `.abs- styles` in `_extends.less`，使用Grunt编译时，无法正确输出。 这会导致生产部署与开发部署之间存在差异。 [GitHub-7231](https://github.com/magento/magento2/issues/7231)

### AdminGWS

<!-- MC-40703-->

* 管理员GWS现在使用 `int` 值 `website_id` 具有自定义权限的管理员在管理员集合中的SQL条件。

### Adobe Stock集成

<!-- MC-39754-->

* 应用程序现在会显示一条信息性消息和指向管理员的链接 **商店** > **配置** > **高级** > **系统** 搜索Adobe Stock页面上的 **API密钥（客户端ID）** 和 **客户端密钥** 未设置。 以前，应用程序会显示以下错误： `We couldn't find any records` 没有链接。

### 后端

<!-- MC-40389-->

* 具有受限访问权限的管理员（例如，只分配了一个网站的访问权限的管理员）无法再编辑设置为全局范围的类别。

<!-- MC-39037-->

* 生成的系统报告(**系统** > **支持** > **系统报告**)现已正确呈现。 以前，报表内容未对齐。

<!-- MC-30152 ENGCOM-8625-->

* 应用程序现在会关闭 **价格** 字段，如 **动态价格** 在捆绑产品创建期间启用了设置。 以前，当您从 **价格** 字段 **动态价格** 设置。 [GitHub-26214](https://github.com/magento/magento2/issues/26214)

<!-- MC-24840-->

* 在将应用程序配置为可从两个URL访问的部署中，如果管理员URL与默认的网站URL不同，则不再发生无限重定向。

### 捆绑产品

<!-- MC-41810-->

* 您现在可以使用 `addProductsToCart` 变异，用于将具有多个复选框选项的捆绑产品添加到购物车。

<!-- MC-41614-->

* 捆绑产品的价格索引现在使用临时表执行，这可避免锁定数据库表。 以前，应用程序使用物理表，这会导致表被锁定。

<!-- MC-41177 magento/magento2#32594-->

* 捆绑项目的价格现在可以设置为0.00。以前，当您将价格设置为0.00后返回到编辑页面时，该价格将返回其默认值。 [GitHub-32383](https://github.com/magento/magento2/issues/32383)

<!-- MC-40603-->

* 现在，包含捆绑产品的订单的订单详细信息显示捆绑产品的正确价格（如果在下单前价格已发生更改）。

<!-- MC-40035-->

* 捆绑产品库存状态现在会根据其子产品的库存状态进行更新。 以前，从产品中删除一个选项时，捆绑产品会显示为缺货，而捆绑产品具有两个具有相同SKU的选项。

<!-- MC-39276-->

* 管理员现在可以更改捆绑产品的 `Shipment Type` 属性。 以前，此属性始终使用 `Together` 值。

<!-- MC-38900-->

* GraphQL `setGuestEmailOnCart` 突变现在可以正确更新来宾电子邮件。 以前，报价和报价地址表未更新。

<!-- MC-37719-->

* 现在，通过REST API调用将子产品添加、删除或更新到捆绑产品中时，会触发按预期重新索引的操作。 以前，这些操作不会触发重新索引，因此，捆绑产品在执行手动重新索引之前不会更改其库存状态。

<!-- MC-35725 ENGCOM-8568-->

* 现在，应用程序可显示捆绑产品的正确价格范围和层价格。 [GitHub-30284](https://github.com/magento/magento2/issues/30284)

<!-- MC-35638-->

* 在捆绑选项的价格发生更改后，应用程序现在在购物车页面和结帐工作流的发运步骤中显示与预期相同的总价格。

<!-- MC-32617-->

* 现在，您可以通过从客户购物车访问捆绑产品来成功配置捆绑产品。 以前，“配置产品”页面从未完全加载，您无法保存设置。

<!-- MC-30317 ENGCOM-7141-->

* 商户现在可以在多商店部署的每个商店视图上为捆绑产品分配唯一价格。 网站特定的价格保存在 `catalog_product_bundle_selection_price` 表。 以前，即使在  **商店** > **配置** > **目录** > **目录** > **价格** > **目录价格范围** 设置为 `Website`. 中未保存任何特定于网站的价格 `catalog_product_bundle_selection_price`. [GitHub-12584](https://github.com/magento/magento2/issues/12584)

<!-- ENGCOM-8705 MC-38953-->

* 捆绑产品的发票现在显示关联的简单产品的正确数量， **动态定价** 已禁用。 以前，与捆绑产品关联的简单产品具有父产品的数量，而不是捆绑产品的数量。 [GitHub-30802](https://github.com/magento/magento2/issues/30802)

<!-- magento/magento2#30374 MC-36930-->

* 的 `updateProductsInWishlist` 突变现在可以成功更新属于希望列表中捆绑产品的项目。 以前，此变异不会更新希望列表项，而是删除该项，并创建一个新项，从而更改项ID。

<!-- MC-38575-->

* 您现在可以设置 `required_options` 和 `has_options` 使用创建或更新捆绑产品时的捆绑属性（如预期） `POST /V1/product/:sku` 端点。 以前，尽管已努力将这些自定义属性设置为1(1)，但仍将其设置为0（零）。

<!-- MC-38483-->

* 现在，暂存过程中包含以前缺失的捆绑产品数据。 这解决了当购物者从产品列表页面购买捆绑产品与直接从产品页面添加捆绑产品时，产品行为中不一致的问题。

### 缓存

<!-- ENGCOM-8554-->

* 的 `varnish6.vcl` 文件已更新，以绕过客户页面的缓存。

### 验证码

<!-- MC-41572-->

* 现在，CAPTCHA可正确验证购物者提供的数据，并且在购物者多次尝试使用PayPal Payflow Pro结账失败后，CAPTCHA字段会按预期显示。

<!-- MC-41281-->

* 验证码验证不再在结账工作流的付款页面上随机失败。

<!-- MC-41001-->

* 现在，在您超过失败的完成尝试次数后，应用程序会按预期显示CAPTCHA字段。 以前，尽管应用程序提示您再次尝试验证码验证挑战，但它不显示验证码字段。

<!-- MC-40359-->

* 现在，验证码可在结帐页面上按预期工作。 以前，购物者正确回答CAPTCHA挑战后，结账页面上的加载器将永远无法完成，而应用程序会显示以下错误： `captchaData[formId] is undefined`. （仅当购物者使用之前从中访问运行2.3.5-p1的部署的相同浏览器时，才会发生此错误。）

<!-- ENGCOM-8630-->

* `_.isEmpty()` 检查 `defaultCaptcha.js` 文件现已成功完成。 以前，这些检查未完成，因此升级后无法加载签出页面。 [GitHub-31641](https://github.com/magento/magento2/issues/31641)

### 购物车和结账

<!-- MC-41911-->

* 现在，在转换和更新购物车中的产品数量时，应用程序会考虑特定于区域设置的小数位置。

<!-- MC-41574-->

* 订单中不再忽略提供的客户名称以及送货地址。 以前，由于 `same_as_billing` 标记未保存在数据库中。

<!-- MC-40946-->

* 现在，在您编辑购物车中的产品时，礼品注册处的链接会按预期保留。 以前，当您单击 **更新购物车** 按钮。

<!-- MC-40696-->

* 消费者的所有队列消息 `quoteItemCleaner` 现在将其状态更改为 `complete` 如预期的那样，在删除了多个产品之后。 以前，此消费者只有一条消息将其状态更改为 `complete`，其余的状态更改为 `in progress`.

<!-- MC-40657-->

* 现在，仅当购物者单击 **下单** 按钮。 以前，每当购物者在结帐工作流中更改付款方法时，应用程序都会在“应用折扣代码”块中显示此消息： `The order wasn't placed. First, agree to the terms and conditions, then try placing your order again`.

<!-- MC-40271 magento/partners-magento2ee#476-->

* 现在，在从计划更新预览中将捆绑产品添加到购物车并单击购物车后，您会按照预期重定向到结帐页面。 [GitHub-447](https://github.com/magento/partners-magento2ee/issues/447)

<!-- MC-39581-->

* 如果购物者未能单击 **更新** 按钮并返回至发运步骤。

<!-- MC-39517  magento/partners-magento2ee#460-->

* 现在，当购物者添加无效产品数量并单击 **更新物料和数量** 按钮。 以前，应用程序升级了产品数量，并且未显示错误消息。 [GitHub-459](https://github.com/magento/partners-magento2ee/issues/459)

<!-- MC-37807 ENGCOM-8530-->

* 具有可自定义选项的产品 `(File)` 现在，在多送货结账流程中，可以按预期包含活动链接。 以前，此链接缺失。 [GitHub-31095](https://github.com/magento/magento2/issues/31095)

<!-- MC-37689-->

* 对于支持多种货币的商店，管理员购物车现在以正确的货币显示产品价格。 以前，价格会多次转换为指定货币 — 首先，将产品从店面添加到购物车时，然后再次，当订单随后向管理员呈现时。

<!-- MC-36703  magento/partners-magento2ee#439-->

* 现在，在管理员完成管理员从店面购物者创建的订单后，应用程序会按预期清空购物车。 以前，当客户在管理员完成订单后重新登录时，店面购物车仍包含订单内容。 [GitHub-30262](https://github.com/magento/magento2/issues/30262)

<!-- MC-35640-->

* 购物者现在可以将“最低广告价格”(MAP)超过其正常产品价格的产品添加到购物车。

<!-- MC-35289-->

* 现在，当购物者使用多个地址签出时，可以从结帐工作流中成功更改其帐单地址。

<!-- MC-29335-->

* 现在，来宾创建的所有付费付款交易记录均会保存到数据库中，并在管理员中按预期可见。 以前，数据库中只保存了少量并发订单，并且大多数订单因数据库锁导致的超时而丢失。 [GitHub-25862](https://github.com/magento/magento2/issues/25862)

<!-- MC-23989 magento/magento2#32251 -->

* 现在，当来宾将产品放入迷你购物车时，应用程序可正确显示包含特殊字符的内联欢迎消息。 以前，应用程序不会将产品添加到迷你购物车或显示欢迎消息。 [GitHub-32250](https://github.com/magento/magento2/issues/32250)

<!-- MC-41165-->

* 现在，启用店内投放后，结帐工作流的送货页面会成功加载。 以前，应用程序引发JavaScript错误，并且送货结帐页面未完全呈现。

<!-- ENGCOM-9006-->

* 添加了 `itemResolvers` 目录参数 `di.xml` 文件。 因此，如果禁用了可配置和分组的产品模块，则结帐不再中断。 [GitHub-30860](https://github.com/magento/magento2/issues/30860)

<!-- ENGCOM-8944-->

* 现在，应用程序在 **付款和送货信息** 部分。 [GitHub-30257](https://github.com/magento/magento2/issues/30257)

<!-- MC-39158 ENGCOM-8493-->

* 现在，当购物车包含具有多个选项的捆绑产品时，应用程序可正确应用购物车价格规则以及购物车级别的固定折扣。 以前，购物车价格规则未完全应用于订单。 [GitHub-30952](https://github.com/magento/magento2/issues/30952)

<!-- MC-40983 ENGCOM-8828-->

* 的 **添加到购物车** “类别列表”视图中的按钮现在可按预期工作。 [GitHub-32232](https://github.com/magento/magento2/issues/32232)

<!-- ENGCOM-8490-->

* 您现在可以使用POST `/V1/carts/mine/items` 向购物车中添加已分组产品的自定义数量。 [GitHub-26909](https://github.com/magento/magento2/issues/26909)

<!-- ENGCOM-8886-->

* 应用程序不再使用送货地址填充结帐工作流的帐单地址区域。 以前，当 **州/省** 帐单地址的字段为空，而送货地址和帐单地址不同，则应用程序会填充帐单地址 **州/省** 字段，其中包含送货地址中的信息。 [GitHub-31608](https://github.com/magento/magento2/issues/31608)

### 目录

<!-- MC-36787-->

* 批量更新 **启用数量增量** 和 **数量增量** 属性现在可以按预期工作。 [GitHub-29544](https://github.com/magento/magento2/issues/29544)

<!-- MC-41801-->

* 现在，您可以成功复制包含仅数字SKU的共享目录。 以前，当您尝试复制共享目录时，应用程序会抛出错误，因为 `\Magento\Catalog\Model\ProductIdLocator` 类在仅数值SKU中无法正常使用。

<!-- MC-41575-->

* 在您启用与管理员的最近产品同步后，应用程序不再引发JavaScript错误。 以前，应用程序显示此JavaScript错误： `Cannot read property 'status' of undefined`.

<!-- MC-41534-->

* 现在可以按预期应用自定义主题布局更新。 以前，会忽略自定义主题布局更新。

<!-- MC-41499-->

* 产品类别缓存现在按预期清除 `cron` 时段 `indexer_update_all_views` 执行。 以前，重新索引后“类别”页面上的产品计数不正确。

<!-- MC-41422-->

* 现在，当在商店视图的产品更新REST API请求中未指定属性时，属性值将保持不变。 以前，如果未指定属性，应用程序会将属性值重置为其默认范围值。

<!-- MC-41284-->

* 管理产品网格(管理员 **目录** > **产品**)现在会在按SKU过滤产品时显示正确的产品计数。

<!-- MC-40873-->

* 现在，在启用“类别权限”后，当产品添加到CMS页面时，应用程序会显示准确的库存状态，并阻止显示指定客户群组的价格。 以前，无论实际库存状态如何，所有产品都显示为无现货。

<!-- MC-40859-->

* “高级定价客户组价格”块价格输入字段现在的宽度最小为5位数。 以前，在低分辨率显示中，此字段中只显示两个符号。

<!-- MC-40825-->

* 现在，应用程序在删除产品后会成功删除产品媒体图像。 以前，产品媒体图像在成功删除产品后会保留在文件夹中。

<!-- MC-40811 magento/magento2#32042-->

* 现在，当您在“管理员”中创建或编辑产品，然后创建“计划设计更新”时，页面布局会按预期进行更新。 [GitHub-32007](https://github.com/magento/magento2/issues/32007)

<!-- MC-40773-->

* 现在，值为零的自定义产品属性可成功另存为空白。 以前，应用程序未将此值更新为空白。

<!-- MC-40736 ENGCOM-8789-->

* 自定义类别布局更新文件现在可以按预期应用于产品。 以前，更新文件句柄(`catalog_category_view_*`)与产品句柄不匹配。 [GitHub-27285](https://github.com/magento/magento2/issues/27285)

<!-- MC-40679-->

* 已对“管理产品”列表的“固定产品税(FPT)”列禁用排序。 以前，在FPT列排序后，无法重新加载产品页面。

<!-- MC-40443-->

* 现在，当每个网站上的匹配产品价格不同时，页面生成器产品小组件预览可以在多网站部署中按预期工作。

<!-- MC-40344 ENGCOM-8629-->

* 使用GET在产品搜索中按位置排序 `/rest/V1/products/?searchCriteria[filterGroups]` 现在按预期工作。 以前，产品收藏集没有字段 `position` 值。 [GitHub-31591](https://github.com/magento/magento2/issues/31591)

<!-- MC-40122-->

* 管理员用户现在可以在 **名称** 和 **SKU** 字段。 以前，应用程序会将多个空格折叠为一个空格。

<!-- MC-39869-->

* 当管理员上的可售数量为0时，产品现在在店面上显示为无现货。 以前，这些产品在店面上以库存形式列出，并且应用程序显示活动 **添加到购物车** 按钮。 [GitHub-31117](https://github.com/magento/magento2/issues/31117)

<!-- MC-39809-->

* 管理员现在可以添加具有可自定义选项的产品 `(File)` 从“管理客户”页面的“购物车”部分（“客户的活动”列），将“订购的项目”网格化。 以前，应用程序不会将项目添加到列表，因为该值在插入到中之前格式不正确 `\Magento\Catalog\Model\Product\Type\AbstractType::_prepareOptions`.

<!-- MC-39619-->

* 该应用程序不再提示购物者为仅具有一个选项的捆绑产品选择产品选项。

<!-- MC-39617-->

* 现在，在创建新小组件期间，应用程序会在布局更新（锚点类别和非锚点类别）中显示所有子类别。

<!-- MC-39481-->

* 的 `product` 当仅为一个商店视图更新产品名称时，查询不再覆盖多商店部署中所有商店视图的默认值。 [GitHub-31083](https://github.com/magento/magento2/issues/31083)

<!-- MC-39470 magento/magento2#31492-->

* Adobe Commerce会在您更改与管理员相关的产品、向上销售和交叉销售列表的每页值时，按预期更新总页面计数。 [GitHub-31059](https://github.com/magento/magento2/issues/31059)

<!-- MC-39444-->

* 管理员现在可以添加具有两个或多个可自定义选项的产品 `(File)` 订单。

<!-- MC-39140-->

* 当具有受限权限的管理员将产品小组件添加到“管理员”的CMS页面时，应用程序不再引发错误。 以前，当管理员单击 **保存** 按钮：  `We are sorry, an error has occurred while generating the content`.

<!-- MC-39134-->

* 现在将打开产品详细信息页面，其中包含日期可自定义的选项，该选项填充了上一订单中的日期 **使用JavaScript日历** 启用。 如果自定义日期选项值解析程序的值没有根据当前配置进行格式设置，则该值现在会回退到替代格式。 以前，自定义日期选项值为空。

<!-- MC-39104-->

* 现在，当产品无现货时，应用程序在购物车中只显示一个错误。 以前，应用程序显示冗余消息。 [GitHub-27469](https://github.com/magento/magento2/issues/27469)

<!-- MC-35717  magento/partners-magento2ee#427-->

* 管理员现在可以添加具有可自定义选项的产品 `(File)` 订单。 [GitHub-30285](https://github.com/magento/magento2/issues/30285)

<!-- MC-30625-->

* 现在，您无需指定 `type_id`. [GitHub-13639](https://github.com/magento/magento2/issues/13639)

<!-- MC-39024-->

* 现在，当REST时，可按预期在店面上提供组产品 `PUT /V1/products/:sku/links` 请求用于将新子产品与新组产品关联。 以前，产品在运行后未正确编入索引 `bin/magento cron:run`.

<!-- ENGCOM-9010 8947-->

* 您无法再使用 `NULL` SKU价值。 以前，您可以通过自定义导入器或直接在数据库中创建不带SKU值的产品，但当您尝试从管理员中编辑产品时，应用程序会引发错误。 [GitHub-27411](https://github.com/magento/magento2/issues/27411), [GitHub-32525](https://github.com/magento/magento2/issues/32525)

<!-- ENGCOM-8902-->

* 向简单产品添加所需的自定义选项将不再将其从父复合产品中删除，且不会发出警告。 应用程序现在会显示一则信息性警告，且不会保存产品。  以前，应用程序保存了产品更改且不显示警告。 [GitHub-30492](https://github.com/magento/magento2/issues/30492)

### 目录规则

<!-- MC-39896-->

* 的 `products` 现在，当目录价格规则应用于某个项目时，查询会返回当前值。 [GitHub-26738](https://github.com/magento/magento2/issues/26738)

<!-- ENGCOM-8367-->

* 以开头的临时表 `catalogrule_product__temp` 现在，当购物车或目录规则过期、禁用或变为不活动后重新索引失败时，将按预期删除。 [GitHub-22273](https://github.com/magento/magento2/issues/22273)

<!-- ENGCOM-8949-->

* 现在，时区的应用方式与 `\Magento\CatalogRule\Model\Indexer\IndexBuilder::reindexById` 和 `\Magento\CatalogRule\Model\Indexer\IndexBuilder::reindexByIds`. [GitHub-29549](https://github.com/magento/magento2/issues/29549)

### CMS内容

<!-- MC-41471-->

* 现在，在上传期间，当 **启用前端大小调整** 配置设置已启用。

<!-- MC-40663 ENGCOM-8883-->

* 修复了处理CMS页面保存控制器时出错的问题。 以前，当 `Error` 对象被抛在 `cms_page_prepare_save` 事件，应用程序将此对象传递到 `addExceptionMessage` 函数，因为此函数需要 `Exception`. 此问题已通过使用 `addErrorMessage` 函数。 [GitHub-30149](https://github.com/magento/magento2/issues/30149)

<!-- MC-33490 magento/partners-magento2ee#435 -->

* 现在，您可以从“CMS编辑页面层次结构”选项卡将新页面分配给多个节点。 以前，在尝试将页面分配给节点时会发生唯一的约束冲突。 [GitHub-363](https://github.com/magento/partners-magento2ee/issues/363)

### 可配置产品

<!-- MC-40719-->

* 单击产品的可配置选项后，应用程序将不再复制产品图像库中的产品缩略图。

<!-- MC-37418-->

* 现在，在您单击 **确定** 按钮。

<!-- MC-39878  magento/magento2#31472-->

* 现在，应用程序可以为只包含一个可配置产品的订单正确生成发票。 [GitHub-31143](https://github.com/magento/magento2/issues/31143)

<!-- ENGCOM-8673-->

* 购物者现在可以从非默认商店视图将可配置产品添加到购物车。 以前，当非默认商店视图上的购物者尝试添加可配置产品时，应用程序会显示以下错误： `Could not add item to cart. Please check required options and try again`. [GitHub-31660](https://github.com/magento/magento2/issues/31660)

### 内容安全策略CSP)

<!-- ENGCOM-8577-->

* 内容安全策略现在支持通过 `data: scheme`.

### cron

<!-- MC-30804-->

* 已对Cron清理查询进行了重构，以减少或消除以下性能问题： `cron` 作业仍处于挂起状态，MySQL查询速度越来越慢，CPU使用率也在上升。 [GitHub-26507](https://github.com/magento/magento2/issues/26507)

<!-- ENGCOM-8571-->

* `cronjobs` 已处于状态 `running` 超过24小时会自动更改为状态 `error`.  因此，该作业的新实例可以再次运行，当作业被错误地保留为状态时，您无需手动更改作业状态 `running`. 以前，如果 `cronjob` 被卡在状态 `running`，则应用程序会阻止同一作业的新实例启动，并且您必须手动更改作业状态。 [GitHub-8933](https://github.com/magento/magento2/issues/8933)

<!-- ENGCOM-8571-->

* `cron` 作业现在按预期完成，且不再引发此序列化错误。  `[Magento\Framework\DB\Adapter\DeadlockException]SQLSTATE[40001]: Serialization failure: 1213 Deadlock found when trying to get lock; try restarting transaction, query was: DELETE FROM cron_schedule WHERE (status = 'missed') AND (job_code in ('indexer_reindex_all_invalid', 'indexer_update_all_views', 'indexer_clean_all_changelogs')) AND (created_at < '2018-09-28 18:32:28')`. [GitHub-18409](https://github.com/magento/magento2/issues/18409)

<!-- ENGCOM-8571-->

* `indexer_update_all_views`  现在，cron作业在上一次失败后按预期运行。 失败的运行在 `cron_schedule schedule`，并且后续运行不会自动失败。 以前， `cron_schedule` 表中填充了待定作业，以及 `indexer_update_all_views` cron作业未运行。 [GitHub-23054](https://github.com/magento/magento2/issues/23054)

<!-- ENGCOM-8571-->

* `cron` 死锁不再由于 `cron` 尝试在组重叠的大型部署中设置锁定。 [GitHub-8933](https://github.com/magento/magento2/issues/8933)

<!-- ENGCOM-8571-->

* `cron` 死锁不再出现在 `cron_schedule` 仅用几个 `cron` 作业已运行。 [GitHub-22438](https://github.com/magento/magento2/issues/22438)

### 自定义客户属性

<!-- MC-41611-->

* 的 **州** “客户帐户”通讯簿中的字段现在作为加载，并且仍为下拉页面元素。 的 **提交** 按钮现在处于禁用状态，直到所有页面元素都完全加载为止。 以前，应用程序在将此字段作为下拉元素呈现之前，会将其作为文本框加载，购物者可以在文本字段中输入并保存值，这会在结帐期间导致错误。

<!-- MC-40906 magento/partners-magento2ee#509-->

* 现在，应用程序可以在店面和管理员订单页面上正确显示自定义客户地址属性。 以前，地址信息部分中缺少下拉属性的选定选项，而输入属性的值包含属性代码。 [GitHub-508](https://github.com/magento/partners-magento2ee/issues/508)

<!-- MC-40329-->

* 在上传文件时，当您在“管理员客户地址”字段中保存带有文件附件的客户地址属性时，应用程序不再引发错误。 由于控制器操作中缺少返回语句而发生此问题。 以前，应用程序会引发以下错误： `Something went wrong while saving the file`.

<!-- MC-39354-->

* RESTGET车API调用现在可为帐单地址和送货地址返回正确的自定义属性值。 以前，自定义地址属性在“我的帐户”店面页面和“管理员”的订单详细信息页面中显示不正确。

<!-- MC-24495-->

* 现在，应用程序已成功处理包含具有输入类型的客户地址属性的文件 `file (attachment)`. 以前，应用程序在上载附加的文件期间抛出此错误： `Something went wrong while saving the file`.

### 客户

<!-- MC-41216-->

* 现在，存储信用电子邮件会考虑选定的范围，并从正确的电子邮件地址发送。

<!-- MC-40579-->

* 现在，按帐户创建日期过滤会生成符合配置的时区设置并捕获所有相关创建帐户的结果。

<!-- MC-40502-->

* 如果之前已缓存数据，则客户网格过滤器现在为受限用户使用正确的网站选项。 以前，客户网格过滤器从缓存中检索到网站参数，并且为受限用户包含错误的数据。

<!-- MC-39189-->

* 当在多网站部署中删除一个网站时，应用程序不再在“管理员客户”页面上引发异常。 以前，当管理员尝试访问全面的客户列表时，应用程序不显示所有客户并显示此错误： `The website with id 2 that was requested wasn't found. Verify the website and try again`.

<!-- MC-38913-->

* 现在，具有权限的管理员可以从客户的帐户信息选项卡中，将客户重新分配给不同的网站。

<!-- MC-39852-->

* 现在，在创建输入类型为的客户地址属性时，您可以成功上传文件 `(File)`. 以前，当您尝试上传并保存文件时，应用程序会引发以下错误： `Something went wrong while saving the file`.

### 客户区段

<!-- MC-40999-->

* 现在，应用程序会根据客户区段在店面上按预期显示相关产品。 以前，当为特定客户区段创建相关产品规则时，应用程序不会显示此部分。

<!-- MC-40503-->

* 现在，当对来宾和已注册客户应用相应的客户区段时，会在其购物车中为已注册客户显示动态块。 以前，应用程序仅为来宾显示块。

<!-- MC-40385-->

* 现在，从管理员处下订单后，客户区段会自动更新。 以前，在创建管理员订单后，管理员用户必须通过导航到相关客户区段并单击 **刷新区段数据** 按钮。

<!-- MC-39490-->

* 应用程序现在在购物车中为相关客户区段中的所有客户显示动态块。 以前，即使客户区段包括来宾和注册客户，客人也看不到块。

<!-- MC-39464-->

* 使用 `Product was Ordered` 条件已得到解析。

<!-- MC-38895-->

* 添加了REST/SOAP API的客户区段事件观察器。 因此，如果通过REST/SOAP API下单时，区段中定义的标准与订单匹配，则客户区段现在会按预期自动更新。

<!-- MC-38346-->

* 为GraphQL请求添加了客户区段事件处理器。 以前，在购物车价格规则条件中使用客户区段时，购物车价格规则折扣不会应用到购物车。 [GitHub-371](https://github.com/magento/partners-magento2ee/issues/371)

### 目录

<!-- MC-39520-->

* 在结帐工作流的发送部分，当购物者输入无效的邮政编码时，应用程序不再引发异常。 [GitHub-23371](https://github.com/magento/magento2/issues/23371)

### 可下载

<!-- MC-35779-->

* 现在，当订单包含可下载产品和带有可下载选项的可配置产品时，应用程序会在新订单电子邮件中显示可下载产品的链接。 以前，应用程序显示指向独立可下载产品的链接，但不显示带有可下载选项的指向可配置产品的链接。

### 动态块（以前称为横幅）

<!-- MC-40327-->

* 现在，动态块仅在指定的页面上显示。 以前，如果未指定动态块，则应用程序会在所有页面上显示分配给小组件的所有横幅。

<!-- MC-39839-->

* 您现在可以保存包含空内容的动态块。

### EAV

<!-- MC-41756-->

* 客户地址属性日期值现在以四位数格式保存，而不是两位数格式保存。

### 电子邮件

<!-- MC-39757-->

* 管理员重置密码页面上的密码重置链接现在可以按预期工作。 以前，当使用自定义模板来重置管理员密码页面时，当管理员单击电子邮件中的链接时，应用程序会显示此消息： `Your password reset link has expired`. 之所以出现此情况，是因为自定义电子邮件模板包含的用户ID变量错误。

<!-- MC-41588-->

* 现在，在商店视图级别启用后，从管理员发送客户电子邮件会正常工作。 以前，在商店视图级别启用电子邮件通知设置（而不是全局级别）时，应用程序不会发送客户电子邮件。

<!-- MC-40950-->

* 现在，在并非所有网站都启用了异步电子邮件发送的多站点部署中，应用程序会按预期方式发送电子邮件。 以前，如果至少有一个网站禁用了此设置，则即使启用了该设置，也不会从任何网站发送电子邮件。 发票、发运和贷项通知单电子邮件存在类似问题。 但是，已成功发送订单评论、发票评论、发运评论和贷项通知单评论电子邮件。 [GitHub-31950](https://github.com/magento/magento2/issues/31950)

<!-- MC-34323 magento/partners-magento2ee#505-->

* 现在，在您从管理员共享礼品注册时，应用程序发送的电子邮件中包含指向注册位置的有效链接。 以前，获取此链接会导致404错误。 [GitHub-504](https://github.com/magento/partners-magento2ee/issues/504)

<!-- MC-30127 magento/magento2#31455-->

* 发票和发票PDF现在包括与预期相同的捆绑产品价格。 以前，发票PDF包含的捆绑产品价格不正确。 [GitHub-12856](https://github.com/magento/magento2/issues/12856)

<!-- ENGCOM-9021-->

* 已向电子邮件模板过滤器方法中添加字符串转换，以确保返回值为 `string`. 以前，当在未处于开发人员模式时捕获到异常时，应用程序会返回 `phrase` 对象。 这反过来又引发了致命 `Uncaught TypeError`. [GitHub-32671](https://github.com/magento/magento2/issues/32671)

<!-- ENGCOM-8807-->

* 现在，在启用异步发送时，会按预期方式发送订单确认电子邮件(**商店**  >  **配置**  >  **销售**  > **销售电子邮件**  >  **常规设置**  >  **异步发送**)。 [GitHub-31950](https://github.com/magento/magento2/issues/31950)

<!-- MC-18023 ENGCOM-9000-->

* 现在，当客户尝试从“联系我们”表单发送电子邮件时出现异常时，应用程序会按预期记录错误。 [GitHub-23645](https://github.com/magento/magento2/issues/23645)

### 框架

<!-- MC-41712-->

* 现在，将检查管理员中的父类是否有docblock批注以及原始类和继承的接口。 以前，由于未选中父类，因此在管理员中执行任何触发事件的与客户相关的操作时，都会导致错误。 应用程序在例外日志中记录了此错误： `report.CRITICAL: Method's return type must be specified using @return annotation.`.

<!-- MC-41192-->

* 在启用了Redis页面缓存的部署中停止Redis服务器时，应用程序不再引发致命错误。

<!-- MC-40739-->

* 申请现在遵循 **从备份中排除介质文件夹** 在启用备份时设置 `bin/magento config:set system/backup/functionality_enabled 1`. 以前，尽管有此设置，但仍会备份媒体文件夹，因为 `/magento` 双重//的格式不正确。

<!-- MC-40654 ENGCOM-8881-->

* 现在，应用程序可以按照管理员购物车页面的预期，翻译所有可翻译的字符串。 以前，翻译负载发生得太晚，并且跳过了订阅控制器操作预调度的所有观察者。 [GitHub-31849](https://github.com/magento/magento2/issues/31849)

<!-- MC-39776-->

* 现在，当 **以客户身份登录** “启用扩展”设置处于禁用状态。 以前，应用程序会引发JavaScript错误。

<!-- MC-39537-->

* 使用 `bin/magento setup:db-schema:split-sales` 移动数据库表现在可以按预期工作。 现在，可以正确创建并填充表格，以使用数据。 以前，由于检查表是否存在错误，因此应用程序引发 `SQLSTATE` 运行错误 `bin/magento setup:db-schema:split-sales`.

<!-- MC-39193-->

* 分支的子进程的异常处理 `ProcessManager` 已得到改进。 现在发生异常时，主进程退出，错误消息只显示一次。 以前，记录了多个索引器失败并显示了多条消息。 [GitHub-30622](https://github.com/magento/magento2/issues/30622)

<!-- MC-39132-->

* 全局Adobe Commerce插件(例如， `webapi_rest` 和 `graphql` )时，不会再为新的自定义区域类型触发 `di.xml` 此区域文件中不包含已注册的插件。

<!-- MC-38770-->

* 初始化期间发生的异常将不再缓存，并且现在会触发500响应代码。

<!-- MC-33179  magento/partners-magento2ee#431-->

* 商家现在可以按商店视图将图像分配或从目录事件中删除。 以前，在编辑目录事件时更改存储视图时， **删除图像** 复选框未激活，应用程序显示此错误： `Uncaught ReferenceError: toggleValueElements is not defined at HTMLInputElement.onclick`. [GitHub-364](https://github.com/magento/partners-magento2ee/issues/364)

<!-- ENGCOM-8232-->

* 最后一个处理程序合并到 `communication.xml` 文件不再覆盖所有之前创建的处理程序。 [GitHub-29528](https://github.com/magento/magento2/issues/29528)

### 一般修复

<!-- MC-41194-->

* 现在，应用程序在“我的产品评论”页面和最近评论的“我的帐户”页面上显示正确的星号数。 以前，应用程序仅将评论星形应用于第一次评论，而将页面上的其他评论留空。

<!-- MC-40653-->

* 标题中的帐户链接现在遵循WCAG标准。 以前，标头中的帐户链接包含重复的ID，这会导致WCAG验证失败。

<!-- MC-40528-->

* 应用程序现在以UTC时区的形式保存目录事件日期。 以前，应用程序会保存用户时区中的目录事件日期。

<!-- MC-39765-->

* 当来宾购物者使用无效地址时，应用程序不再引发系统日志生成的错误。 以前，应用程序会间歇性地显示此错误，而不是渲染页面： `No such entity with addressId`. [GitHub-15115](https://github.com/magento/magento2/issues/15115)

<!-- MC-39747-->

* 对于不支持的格式的图像，调整图像大小过程不再中止。 以前， `catalog:images:resize` 遇到不支持的图像格式，该过程已停止，应用程序显示此错误： `bin/magento catalog:images:resize Unsupported image format`.

<!-- ENGCOM-8925-->

* 向管理员添加了对徽标图像的WEBP和AVIF支持。 [GitHub-32495](https://github.com/magento/magento2/issues/32495)

<!-- MC-38156-->

* 您不能再更改 `media_gallery` 属性。 以前，当您更改 `media_gallery` 属性返回 `global`，应用程序引发错误。

<!-- MC-36818  magento/partners-magento2ee#470-->

* 作为计划更新添加的相关产品在更新结束日期后将不再显示在店面产品页面上。 [GitHub-469](https://github.com/magento/partners-magento2ee/issues/469)

<!-- MC-34489 magento/partners-magento2ee#491-->

* 现在，在您单击 **管理项目** “我的帐户礼品注册表”页和注册产品无现货。 以前，应用程序会引发以下错误： `Error: Call to a member function getId() …`. [GitHub-490](https://github.com/magento/partners-magento2ee/issues/490)

<!-- MC-33667-->

* 您现在可以按照预期将CMS页面从添加新页面页面添加到网站根层次结构。

<!-- MC-33499 magento/partners-magento2ee#446-->

* 现在，在选择实体类型后，过滤功能可在计划导出列表中按预期工作。 以前，筛选器不起作用，并且应用程序引发JavaScript错误。 [GitHub-361](https://github.com/magento/partners-magento2ee/issues/361)

<!-- MC-30084 ENGCOM-8674-->

* 现在，可以按照 `catalog/tmp/category` 目录 `catalog/category` 目录。 中的图像行 `media_storage_file_storage` 表格现在也正确 `directory_id`. [GitHub-11995](https://github.com/magento/magento2/issues/11995)

<!-- MC-24768-->

* 在将更改提交到CMS层次结构后，商家现在会按预期通知无效的缓存。 以前，应用程序在保存CMS层次结构时不会使缓存失效。

<!-- MC-24725-->

* 减少了对购物车购物车购物车部分的冗余AJAX请求。 以前，应用程序未正确加载购物车小计，这会再次触发购物车重新加载。

<!-- MC-23740-->

* 添加了对URL的验证，以防止将保留词包含在URL键中。 请参阅 [定义已知的统一资源标识符(URI)](https://tools.ietf.org/html/rfc5785)

<!-- ENGCOM-9037-->

* 在运行PHP 7.4的部署中，当 **生成“类别/产品”URL重写** 设置设置为 **否**，则购物者会尝试访问不存在的类别路径。 以前，应用程序会返回一个500错误，指出： `Trying to access array offset on value of type bool`. [GitHub-31984](https://github.com/magento/magento2/issues/31984)

<!-- MC-32257 magento/partners-magento2ee#507-->

* 现在，您可以成功地编辑某个产品，该产品是使用 **设计组和计划设计更新** 已删除群组。  以前，当您尝试编辑从该属性集创建的产品时，应用程序会引发致命错误。 [GitHub-44](https://github.com/magento/partners-magento2ee/issues/44)

<!-- ENGCOM-8901-->

* `nowdoc` 已更换 `heredoc` 在 `Magento_Backend` 存储切换器。 [GitHub-32262](https://github.com/magento/magento2/issues/32262)

<!-- ENGCOM-8539-->

* 现在，管理员在登录后会直接重定向到请求的管理员页面。  以前，当管理员登录时，会将他们重定向到“管理员”功能板（或任何配置为启动页面的页面），并且必须手动导航到其目标。 [GitHub-31042](https://github.com/magento/magento2/issues/31042)

<!-- ENGCOM-8685-->

* 向以下地区添加了阿根廷、玻利维亚、智利、厄瓜多尔、圭亚那、巴拉圭、秘鲁、苏里南和委内瑞拉区域 `directory_country_region` 表。 [GitHub-31169](https://github.com/magento/magento2/issues/31169)

<!-- ENGCOM-8505-->

* 在 `directory_country_region` 表。 [GitHub-31040](https://github.com/magento/magento2/issues/31040)

<!-- MC-30104 magento/magento2#31480 -->

* 现在，在出现异常时，消息会在MysqlMQ消息队列中标记为错误。 [GitHub-18140](https://github.com/magento/magento2/issues/18140)

<!-- ENGCOM-8579-->

* 现在，在为管理员贷项通知单和发票页加载税信息时，应用程序会引用正确的分类对象。 [GitHub-31197](https://github.com/magento/magento2/issues/31197)

<!-- MC-40346-->

* Royal Mail点击和放置集成现在可按预期工作。 以前，当您尝试激活其集成时，应用程序会引发此错误： `Sorry! Something went wrong. Please try again later`. [GitHub-28996](https://github.com/magento/magento2/issues/28996)

<!-- ENGCOM-8498-->

* 在URL中传递错误的发运、贷项通知单或发票ID时，应用产品现在会显示一则信息性错误消息。 以前，应用程序会引发致命错误。 [GitHub-30424](https://github.com/magento/magento2/issues/30424)

<!-- ENGCOM-8632-->

* 删除了静态文件位置中的递归。  应用程序现在显示404页面，而不是500错误。 以前，默认NGINX配置中的错误会导致无限递归。 [GitHub-31530](https://github.com/magento/magento2/issues/31530)

<!-- ENGCOM-8550-->

* 的名称 `cms_index_noroute.xml` 文件已更正为 `cms_noroute_index.xml`. [GitHub-31300](https://github.com/magento/magento2/issues/31300)

<!-- ENGCOM-8516-->

* 的 `.editorconfig` 已重构文件以更正自动格式 `db_schema_whitelist.json` 文件。 [GitHub-31171](https://github.com/magento/magento2/issues/31171)

<!-- ENGCOM-9018-->

* 调整浏览器窗口的大小不再触发重复的绑定放大镜事件。 [GitHub-30788](https://github.com/magento/magento2/issues/30788)

<!-- ENGCOM-8722-->

* 筛选时，应用程序不再引发SQL异常 `Magento\Users\Model\ResourceModel\Users\Collection` by `user_id`. [GitHub-31216](https://github.com/magento/magento2/issues/31216)

### 礼品卡

<!-- MC-40412-->

* 在取消礼品卡时，将按照预期从礼品卡中删除待定付款费用。 以前，应用程序在 `cron` 在删除礼品卡后运行。

<!-- MC-37658-->

* 现在，购物者通过多个地址签出时，可以从“复查订单”页面的订单中删除礼品卡。 以前，当购物者选择礼品卡并单击该卡片后，应用程序不会从订单中删除该礼品卡 **删除**.

<!-- MC-34407-->

* 现在，当您在将礼品卡添加到购物车后更改礼品卡的值时，应用程序会在购物车中显示礼品卡的新价格。

<!-- MC-32651-->

* 价格范围验证逻辑已添加到礼品卡创建页面。 以前，管理员可以创建一个值超过最大值的信息卡。 [GitHub-493](https://github.com/magento/partners-magento2ee/issues/493)

<!-- MC-32638979 magento/partners-magento2ee#40851-->

* 的 `addRequisitionListItemsToCart` 当请求不包含的值时，查询现在会按预期返回自定义礼品卡的数量 `allow_open_amount`.

<!-- MC-32373-->

### 礼物邮件

<!-- MC-38655-->

* 的 `setGiftOptionsOnCart` 变异现在可以正确创建礼品信息。 [GitHub-388](https://github.com/magento/partners-magento2ee/issues/388)

### 礼品登记

<!-- MC-33057 magento/partners-magento2ee#467-->

* **事件日期** 现在，在创建或编辑礼品注册表期间，店面和管理员上的值相同。 以前，每次您编辑并保存礼品登记表时，应用程序都会调整 **事件日期** 在店面和管理员上都往后走一天。 [GitHub-466](https://github.com/magento/partners-magento2ee/issues/466)

<!-- MC-32587  magento/partners-magento2ee#511-->

* 该应用程序不再在礼品登记处显示禁用的产品。 以前，如果产品在添加到礼品注册表后被禁用，则当购物者访问注册表时，应用程序会显示此消息： `Error: Call to a member function getId() …`. [GitHub-510](https://github.com/magento/partners-magento2ee/issues/510)

### 礼品包装

<!-- MC-38260-->

* 现在，可按预期翻译商店视图的礼品包装标签。

<!-- MC-36749-->

* 现在，礼品包装按预期应用于将发运到多个地址的订单。

<!-- MC-34820-->

* 现在，在所有产品都被删除后，应用程序会从购物车中取消礼品包装费。

<!-- MC-32259 magento/partners-magento2ee#500-->

* 现在，当贷项通知单包含礼品包装和可配置产品费用时，贷项通知单总计是正确的。 以前，礼品包装税额并不总是包含在贷项通知单合计中。 [GitHub-34](https://github.com/magento/partners-magento2ee/issues/34)

### Google Analytics

<!-- ENGCOM-8450-->

* 在启用Google Analytics后，当管理员尝试在店面上加载页面时，应用程序不再引发错误。 适用于的CSP条目 `connect-src` 已添加，以允许AJAX请求访问www.google-analytics.com。 [GitHub-30880](https://github.com/magento/magento2/issues/30880)

### Google标签管理器

<!-- MC-39072-->

* 启用Google Tag Manager后，结帐工作流付款页面上账单地址的UI组件现在可正确使用报价地址。 以前，付款页面上发生JavaScript错误。

### GraphQL

<!-- MC-41885-->

* GraphQL `products` 现在，查询会返回属性选项，这些选项的排序顺序与属性编辑页面上使用的排序顺序相同。

<!-- MC-41473-->

* 对 `{ category(id: 2){ children { name children { name } } } }` GraphQL请求现在包含正确排序的类别树。

<!-- MC-41030-->

* 的 `CartItemPrices` 对象现在包含新的GraphQL字段 `fixed_product_taxes`，可返回应用于购物车项目的固定产品税数组。 以前，应用于购物车项目的固定产品税不会包含在购物车查询中。

<!-- MC-40920-->

* 现在，对GraphQL的空请求将引发响应代码200，而不是500。 以前，GraphQL解析器在生成查询结果之前引发异常。

<!-- MC-40867 magento/partners-magento2ee#532 -->

* 的 `applyRewardPointsToCart` 突变现在更新了购物车的总计，以准确反映所扣回的奖励积分值。 [GitHub-486](https://github.com/magento/partners-magento2ee/issues/486)

<!-- MC-40379-->

* 当使用GraphQL链接追加销售产品时，GraphQL响应中不再包含已禁用的产品。

<!-- MC-40262-->

* 商家现在可以使用GraphQL `setShippingAddressesOnCart` 方法来设置在来宾结帐被禁用时购物车的帐单和送货地址。

<!-- MC-39508-->

* 的 `categoryList` 查询在上包含多个片段时不再引发异常 `CategoryTree` 对象。 [GitHub-31086](https://github.com/magento/magento2/issues/31086)

<!-- MC-38995-->

* GraphQL `product` 查询现在可返回正确的客户组价格。

<!-- MC-38822-->

* GraphQL `products` 现在，查询响应会根据产品属性位置对聚合进行排序。

<!-- ENGCOM-8462-->

* 当产品和类别URL后缀包含空值时，应用程序在GraphQL查询期间不再引发类型错误。 [GitHub-30909](https://github.com/magento/magento2/issues/30909)

<!-- magento/magento2#31164-->

* 的 `CustomizableDateValue` 对象现在包含 `type` 属性。 其值是可设置为DATE、DATE_TIME或TIME的枚举。

<!--  magento/partners-magento2ee#421-->

* 的 [`dynamicBlocks` 查询](https://devdocs.magento.com/guides/v2.4/graphql/queries/dynamic-blocks.html) 返回与指定过滤器匹配的动态块的内容。

<!-- ENGCOM-8603-->

* POST `V1/products/special-price-delete` 请求现在仅删除具有指定 `store_id` 如预期。 以前，调用会从所有商店中删除指定SKU的所有特价。 [GitHub-25907](https://github.com/magento/magento2/issues/25907)

<!--  magento/partners-magento2ee#280 -->

* 修复了 `country_code` 属性 `createGiftRegistry` 变异。

<!-- magento/partners-magento2ee#280 -->

* 修复了 `giftRegistryUid` 属性 `updateGiftRegistryItems` 变异。

<!-- magento/partners-magento2ee#280 -->

* 添加了额外的检查，以防止 `updateGiftRegistryRegistrants` 变异，用于将随机人作为注册者添加到礼品登记处。

<!-- magento/magento2#31380 -->

* 的 `addConfigurableProductsToCart` 现在，突变会返回指定产品的正确缩略图。 以前，会返回父产品的缩略图。

<!-- ENGCOM-8477-->

* 的 `products` 在为将来日期设置特殊价格期限时，查询不再公开产品的特殊价格。 [GitHub-30210](https://github.com/magento/magento2/issues/30210), [GitHub-29631](https://github.com/magento/magento2/issues/29631)

<!-- magento-engcom/magento2ee#576-->

* 的 `customer` 查询响应现在包含 `total_giftcard` 属性 `OrderTotal` 对象。

<!-- MC-41084 ENGCOM-9042 -->

* 更正了导致 `products` 查询，以返回有关没有层定价集的项目的价格层的错误信息。 [GitHub-32279](https://github.com/magento/magento2/issues/32279)

### 图像

<!-- MC-38951-->

* 现在，在使用POST创建或更新捆绑产品时，可以按预期设置required_options和has_options捆绑属性 `/V1/product/:sku` 端点。 以前，尽管已努力将这些自定义属性设置为1(1)，但仍将其设置为0（零）。

### 导入/导出

<!-- MC-41576-->

* 现在，“导出页面实体属性”网格中产品实体的类别ID筛选器可按预期工作。

<!-- MC-41439 ENGCOM-9005-->

* 现在，当所有子产品都无现货时，分组的产品库存状态会按预期更新为无现货。 [GitHub-32647](https://github.com/magento/magento2/issues/32647)

<!-- MC-41184-->

* 现在，当通过导入更新子产品库存状态时，可配置的产品库存状态会按预期自动更新。 以前，当通过导入更新子产品库存状态时，不会自动更新产品库存状态。

<!-- MC-41151-->

* 现在，您可以在计划导出中保存空值。 以前，应用程序会在创建或保存导出后更新空过滤器值。 两者兼有 `no` 和 `not specified` 值在数据库中以零表示，值为 `not selected` 由 `no`.

<!-- MC-41092-->

* 现在，导出流程在导出产品、库存来源和客户实体时会考虑用户角色范围。 以前，导出过程忽略用户角色范围，这允许导出专用用户角色导出实体。

<!-- MC-40943-->

* 应用产品现在将产品税分类设置为 `None` 如果产品是通过 `tax_class_name` 值 `None` 或 `0`. 以前，如果 `product tax_class_name` was `None` 在CSV文件中，应用程序创建了一个新税类 `None`，其中重复了现有税种。 如果 `product tax_class_name` wher `0` 在CSV文件中，应用程序忽略了该值，并且产品税分类在导入后没有更改。

<!-- MC-40898-->

* 管理员现在可以成功更改 `name` 捆绑产品的 `bundle_values` 从管理员。 以前，在您从管理员更改名称后，应用程序会在店面上将产品显示为无现货。 产品还会与同一SKU合并到单个捆绑包选项部分。

<!-- MC-40333-->

* 现在，应用程序在导出客户数据时会考虑用户范围。 以前，当您尝试导出客户时，应用程序会从所有网站导出客户数据。

<!-- MC-40305-->

* 现在，在CSV文件导入期间，应用程序会按照预期删除向上销售、交叉销售和相关产品之间的产品关系 `__EMPTY__VALUE__` 在CSV文件中指定。

<!-- MC-40012-->

* 导出许多客户的自定义地址数据(管理员 **系统** > **导出**)不再定期导致内存错误。 以前，在导出自定义地址数据时，应用程序尝试加载所有客户数据，这会导致内存耗尽，并且应用程序引发了分配内存失败错误。

<!-- MC-39977-->

* 在默认的CSV导入过程中，将不再导入重复的层价格。 以前，缺少验证以阻止导入重复的层价格，当出现重复的层价格时，商家无法保存产品。 商家在尝试计划产品更改时也看到了此错误： `SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry…`.

<!-- MC-39609  magento/magento2#31397-->

* 现在，所有产品图像都会在导入过程中进行验证。 以前，当产品具有多个图像时，应用程序仅验证第一个图像。 [GitHub-28236](https://github.com/magento/magento2/issues/28236)

<!-- MC-39483-->

* 现在，您可以按照导入期间的预期从客户地址中删除区域。 以前，在导入具有空区域的客户地址时，分配的区域不会发生更改。

<!-- MC-38810-->

* 现在，将JSON或HTML内容作为其他产品属性的产品可正确导出到CSV文件。 以前，CSV文件在错误的字段中包含重叠的数据字符串。

### 索引

<!-- MC-39718 ENGCOM-8567-->

* 进程管理器现在在子进程失败时退出，并出现错误。 以前，如果传递给Process Manager的函数数（例如索引器维度）低于 `MAGE_INDEXER_THREADS_COUNT` 环境变量。 [GitHub-30964](https://github.com/magento/magento2/issues/30964)

<!-- MC-39272-->

* 现在，当使用RESTPUT链接产品时，产品可按预期在店面搜索结果中提供 `/V1/products/:sku/links` 将索引器模式设置为 **保存时更新**.

<!-- MC-38310 magento/magento2#32693-->

* 当索引器模式设置为 **保存时更新**. [GitHub-370](https://github.com/magento/partners-magento2ee/issues/370)

<!-- ENGCOM-8890-->

* 现在，删除不包含产品的禁用类别对目录搜索和类别平面索引表没有影响。 以前，删除不活动类别会触发完全重新索引。 [GitHub-23297](https://github.com/magento/magento2/issues/23297)

<!-- ENGCOM-8599 8474-->

* 自定义索引器现在可以对订阅使用不同的实体列名称。 以前，数据库触发器使用索引器上次设置为的列名称 **按计划更新** 而不是指定的索引器。 [GitHub-21853](https://github.com/magento/magento2/issues/21853)

<!-- ENGCOM-8887-->

* 应用程序不再发送AJAX请求以重新加载客户数据部分(`Magento_Customer/js/section-config`)不受请求影响。 [GitHub-31948](https://github.com/magento/magento2/issues/31948)

<!-- MC-39569-->

* 在添加、删除或重新排序类别中的产品后，以下索引器不再失效： `catalog_category_product` 和 `catalogsearch_fulltext` （及其家属）。 以前，这些意外移除操作会触发站点的完全重新索引。 现在，在这些情况下，当未启用平面目录时，将阻止完全重新索引。

### 基础架构

<!-- MC-41445-->

* 依赖项 `pelago/emogrifier` 已从版本3.1.0更新到5.0.0。此更新导致对 `Magento\Email\Model\Template\Filter` 类。 更改的代码在电子邮件模板渲染期间执行。 请参阅 [BIC引用](https://developer.adobe.com/commerce/php/development/backward-incompatible-changes/reference/).

<!-- MC-42212-->

* 更正了 `\Magento\CatalogInventory\Model\Indexer\Stock\CacheCleaner::getCategoryIdsByProductIds` 阻止保存新产品。

<!-- MC-42199-->

* 已删除已弃用的TinyMCE v3库。 的 `Magento_Tinymce3Banner` 与TinyMCE v3.x相关的模块和MFTF测试已从Adobe Commerce中删除。

<!-- MC-41497-->

* 应用程序不再引发 `Invalid header value detected` 当购物者输入包含法语变音符号（如“é”、“è”）的电子邮件地址时，“联系我们”窗体上出现错误。 应用程序现在将用户名中的UTF-8字母转换为ASCII编码。 以前，UTF-8字母在电子邮件地址的唯一部分中不会转换为ASCII编码。

<!-- MC-39947-->

* 将插件添加到父类后，应用程序不再引发PHP错误。 [GitHub-31291](https://github.com/magento/magento2/issues/31291)

<!-- ENGCOM-9012-->

* 更新了以下模块的README.md文件： `Magento_Msrp`, `Magento_MsrpConfigurableProduct`, `Magento_MsrpGroupedProduct`, `Magento_Multishipping`, `Magento_MysqlMq`. [GitHub-32577](https://github.com/magento/magento2/issues/32577)

<!-- magento/partners-magento2ee#501-->

* `phpcpd` 已更新到v6.0.3，以兼容PHP 8。

<!-- ENGCOM-9073-->

* `ramsey/uuid` 已更新，以与PHP 8.0兼容。 [GitHub-31777](https://github.com/magento/magento2/issues/31777), [GitHub-826](https://github.com/magento/magento2-functional-testing-framework/issues/826)

<!-- ENGCOM-8997-->

* `colinmollenhour/php-redis-session-abstract` 已更新到v1.4.4，以兼容PHP 8。 [GitHub-32709](https://github.com/magento/magento2/issues/32709)

<!-- ENGCOM-8527-->

* 更正了 `phpstan.neon` 文件。 [GitHub-31239](https://github.com/magento/magento2/issues/31239)

<!-- ENGCOM-8668-->

* 已删除对过时资产的使用 `$_isScopePrivate` 代码库中。 [GitHub-30506](https://github.com/magento/magento2/issues/30506)

<!-- ENGCOM-8551-->

* 页面布局不再在中进行硬编码  `Magento\Widget\Block\Adminhtml\Widget\Instance\Edit\Chooser\Container`.  因此， `getPageLayouts()` 函数现在会按照预期返回不同模块声明的页面布局的实际列表。 以前，它只返回硬编码的布局。 [GitHub-31168](https://github.com/magento/magento2/issues/31168)

<!-- ENGCOM-8509-->

* 的 `composer.lock` 文件已更新至最新版本的编码标准。 [GitHub-31152](https://github.com/magento/magento2/issues/31152)

<!-- ENGCOM-9015 -->

* 添加了对 `web-token/jwt-framework` 包到 `magento/module-jwt-framework-adapter`. [GitHub-32578](https://github.com/magento/magento2/issues/32578)

<!-- ENGCOM-9019 -->

* 被动监听器已添加到 `fotorama.js` 用于改进灯塔量度得分的库。 [GitHub-31140](https://github.com/magento/magento2/issues/31140)

<!-- ENGCOM-9014 -->

* 更新了Google Analytics模块的README.md文件。 [GitHub-32616](https://github.com/magento/magento2/issues/32616)

<!-- ENGCOM-8375 -->

* 进程管理器现在可以正确处理分支进程中的异常。 主进程现在退出，应用程序现在只显示一次错误消息。 此外，现在在主进程中抛出分支进程的例外时，也会处理这些例外。 以前，应用程序记录了多个索引器故障并显示了多个错误消息。  [GitHub-30622](https://github.com/magento/magento2/issues/30622)

<!-- ENGCOM-8544 -->

* 将插件添加到父类后，应用程序不再引发错误。 ( `optionsProvider` 参数现在在声明之后 `getContentIdentities` in `Assest.php`.) 以前，应用程序会引发以下错误：  `Error: Cannot instantiate interface Magento\Framework\Data\OptionSourceInterface`. [GitHub-31291](https://github.com/magento/magento2/issues/31291)

<!-- ENGCOM-8549 -->

* 正在执行 `Magento\Framework\Filesystem\Io\Ftp::ls()` 现在，在空文件夹中会按预期返回空数组。 以前，应用程序会引发此异常： `Invalid argument supplied for foreach() in vendor/magento/framework/Filesystem/Io/Ftp.php…`. [GitHub-31288](https://github.com/magento/magento2/issues/31288)

<!-- ENGCOM-8791 -->

* 的 `update` “角色”和“规则”的方法在 `app/code/Magento/Authorization/Model/Role.php`. [GitHub-30756](https://github.com/magento/magento2/issues/30756)

<!-- ENGCOM-8946 -->

* 更正了SameSite Cookie参数的连接。 以前，附加了 `lex` 后缀为 `value`, `domain`和其他参数。 [GitHub-26377](https://github.com/magento/magento2/issues/26377), [GitHub-32440](https://github.com/magento/magento2/issues/32440)

<!-- ENGCOM-8698 ENGCOM-9034 -->

* `allure-framework/allure-phpunit` 已在整个代码库中升级到v1.3.1。 以前，应用程序会显示以下错误：  `Warning: Use of undefined constant GLOB_BRACE - assumed 'GLOB_BRACE' (this will throw an Error in a future version of PHP) in /var/www/html/src/vendor/allure-framework/allure-phpunit/src/Yandex/Allure/Adapter/AllureAdapter.php:74.` [GitHub-24635](https://github.com/magento/magento2/issues/24635)

<!-- ENGCOM-8783 -->

* 现在，在运行错误时，应用程序会显示更多信息错误 `bin/magento` 命令。 以前，应用程序不显示任何错误消息，或显示缺少信息的消息。 [GitHub-32786](https://github.com/magento/magento2/issues/32786)

<!-- ENGCOM-8953 -->

* 的 `ArrayIterator` PHP对象已更新，可在PHP 7.4中按预期工作。 [GitHub-32088](https://github.com/magento/magento2/issues/32088)

<!-- ENGCOM-8469 -->

* 当客户尝试在没有运输承运人的情况下完成订单时，应用程序不再引发错误。 而是会显示结帐页面和此消息： `Sorry, no quotes are available for this order at this time`. 以前，应用程序显示空白结帐页面，并在例外日志中记录此消息： `array_keys() expects parameter 1 to be array, null given`. [GitHub-30830](https://github.com/magento/magento2/issues/30830)

<!-- ENGCOM-8557 -->

* 应用程序不再将每个Cookie记录为单独的上下文。 的 `$_COOKIE` 数组也已转换为字符串。 以前，由于每个Cookie都记录为单独的上下文，因此当Cookie数量超过50时，应用程序会记录以下消息： `Unable to send the cookie. Maximum number of cookies would be exceeded`. [GitHub-31334](https://github.com/magento/magento2/issues/31334)

### 发票

<!-- ENGCOM-8472 -->

* 在管理员中创建新发票时， **的电子邮件副本** 复选框现在可按预期工作。 以前，如果在中启用了发送发票电子邮件的全局设置，则会忽略此复选框 **销售电子邮件**. 它现在与发运和贷项通知单创建页面一致，且运行方式与相同。 [GitHub-28511](https://github.com/magento/magento2/issues/28511)

### 媒体集

<!-- MC-41728-->

* `bin/magento media-gallery:sync` 现在，处理缺少XMP信息的PNG图像时，会按预期失败。

<!-- ENGCOM-8814-->

* 中的条目 `catalog_product_entity_media_gallery` 在删除相关产品时，表会按预期删除。 [GitHub-17727](https://github.com/magento/magento2/issues/17727)

<!-- ENGCOM-8945-->

* 现在，在启用JavaScript缩小后，可以在媒体库中更新图像详细信息。 以前，未保存图像详细信息，并且应用程序显示以下错误： `TypeError: Cannot read property 'call' of undefined in jquery.validate`. [GitHub-31633](https://github.com/magento/magento2/issues/31633)

### MFTF

有关新增功能和MFTF核心错误修复，请参阅 [功能测试框架Changelog](https://github.com/magento/magento2-functional-testing-framework/blob/develop/CHANGELOG.md).

<!-- ENGCOM-8496-->

* 的 `magento indexer:reindex` 和 `cache:flush` 和 `AdminReindexAndFlushCache` 已从测试中删除操作组，以改进以下模块的执行： `Bundle`, `Catalog`, `CatalogRule`, `CatalogRuleConfigurable`, `CatalogUrlRewrite`, `Downloadable`, `Indexer`, `Paypal`和 `Sales`. [GitHub-31031](https://github.com/magento/magento2/issues/31031)

<!-- ENGCOM-8562-->

* `AdminSubmitCategoriesPopupActionGroup` 已添加到测试中，以防止测试失败。 [GitHub-31251](https://github.com/magento/magento2/issues/31251)

<!-- ENGCOM-8562-->

* 测试已通过 `StorefrontCheckQuickSearchStringActionGroup` 和 `StorefrontAssertProductNameOnProductMainPageActionGroup` （现有操作组）。 [GitHub-31251](https://github.com/magento/magento2/issues/31251)

#### 重构测试

为缩短执行时间，已对以下测试进行了重构：

`AddOutOfStockProductToCompareListTest`  <!-- ENGCOM-8547-->

`AdminApplyTierPriceToProductWithPercentageDiscountTest` <!-- ENGCOM-8522-->

`AdminCheckingCreditMemoTotalsTest` <!-- ENGCOM-8606-->

`AdminCheckDashboardWithChartsTest` <!-- ENGCOM-8897-->

`AdminConfigDefaultProductLayoutFromConfigurationSettingTest`  <!-- ENGCOM-8891-->

`AdminCreateInvoiceTest` <!-- ENGCOM-8581-->

`AdminCreateOrderAddProductCheckboxTest` <!-- ENGCOM-8492-->

`AdminMassOrdersCancelCompleteAndClosedTest` <!-- ENGCOM-8538-->

`AdminMassOrdersCancelProcessingAndClosedTest`  <!-- ENGCOM-8670-->

`AdminMassOrdersHoldOnCompleteTest`  <!-- ENGCOM-8897-->

`AdminMassOrdersHoldOnPendingAndProcessingTest`  （已弃用的替换项） `AdminMassOrdersHoldOnPendingAndProcessingTest`) <!-- ENGCOM-8669-->

`AdminMassOrdersUpdateCancelPendingOrderTest` <!-- ENGCOM-8602-->

`AdminMassProductPriceUpdateTest` <!-- ENGCOM-8587-->

`AdminMassUpdateProductAttributesMissingRequiredFieldTest` <!-- ENGCOM-8511-->

`AdminOrdersReleaseInUnholdStatusTest`  <!-- ENGCOM-8592—-->

`AdminPanelIsFrozenIfStorefrontIsOpenedViaCustomerViewTest`  <!-- ENGCOM-8601-->

`AdminSortingByWebsitesTest`  <!-- ENGCOM-8583-->

`AdminUpdateSimpleProduct` <!-- ENGCOM-8536-->

`AdminUpdateSimpleProductWithRegularPriceInStockEnabledFlatTest`  <!-- ENGCOM-8533-->

`AdminValidateShippingTrackingNumberTest`  <!-- ENGCOM-8593-->

`CancelOrdersInOrderSalesReportTest`  <!-- ENGCOM-8591-->

`ProductsQtyReturnAfterOrderCancelTest` <!-- ENGCOM-8506-->

`StorefrontConfigurableProductBasicInfoTest`  <!-- ENGCOM-8711-->

#### 操作组

在这些测试中，重复操作已被替换为操作组：

`AdminCheckConfigurableProductPriceWithDisabledChildProductTest`  <!-- ENGCOM-8574-->

`AdminConfigurableProductCreateTest` <!-- ENGCOM-9013-->

`AdminConfigurableProductRemoveAnOptionTest` <!-- ENGCOM-9038-->

`AdminCreateProductDuplicateUrlkeyTest` <!-- ENGCOM-9007-->

`AdminCreateSimpleProductNegativePriceTest` <!-- ENGCOM-900-->

`AdminCreateSimpleProductZeroPriceTest`  <!-- ENGCOM-9040-->

`AdminCreateVirtualProductFillingRequiredFieldsOnlyTest` <!-- ENGCOM-9003-->

`AdminUpdateSimpleProductWithRegularPriceInStockDisabledProductTest` <!-- ENGCOM-9002-->

`AdminUpdateSimpleProductWithRegularPriceInStockNotVisibleIndividuallyTest`  <!-- ENGCOM-9011-->

`AdminUpdateSimpleProductWithRegularPriceInStockVisibleInCatalogOnlyTest`  <!-- ENGCOM-9041-->

#### 新操作组

`AdminClearFiltersOnGridActionGroup` <!-- ENGCOM-8604-->

`AdminClickAddNewPageOnPagesGridActionGroup`  <!-- ENGCOM-8613-->

`AdminClickInsertWidgetActionGroup` <!-- ENGCOM-8614-->

`AdminClickRefundOfflineOnNewMemoPageActionGroup` <!-- ENGCOM-8580-->

`AdminFillAccountInformationOnCreateOrderPageActionGroup` <!-- ENGCOM-8495-->

`AdminGoToOrderStatusPageActionGroup`  <!-- ENGCOM-8615-->

`AdminOpenCMSPagesGridActionGroup`<!-- ENGCOM-8682-->

`AdminSelectAttributeSetOnEditProductPageActionGroup` <!-- ENGCOM-8566-->

`AssertAdminProductIsAssignedToCategoryActionGroup`  (按SKU替换过滤“产品网格”并单击第一行（以缩短测试执行时间） <!-- ENGCOM-8535 8534-->

`AssertLinkActionGroup` <!-- ENGCOM-8457-->

`AssertStorefrontCartDiscountActionGroup` <!-- ENGCOM-8431-->

`ClickPlaceOrderActionGroup` <!-- ENGCOM-8671-->

`SaveCmsPageActionGroup` <!-- ENGCOM-8683-->

`StorefrontAssertProductNameIsNotOnProductMainPageActionGroup` <!-- ENGCOM-8562-->

`StorefrontGuestCheckoutProceedToPaymentStepActionGroup` <!-- ENGCOM-8582-->

`StorefrontHoverProductOnCategoryPageActionGroup` <!-- ENGCOM-8575-->

`StorefrontSelectCustomizeAndAddToTheCartButtonActionGroup` <!-- ENGCOM-8573-->

#### 已删除的操作组

<!-- ENGCOM-8525 8558 8608 8546 8695 8889 8681 8627 8714-->

* 已删除  `CliIndexerReindexActionGroup` （或更改了值），以缩短 `Backend`, `Bundle`, `BundleImportExport`, `Catalog`, `CatalogRule`, `CatalogSearch`, `Checkout`, `Downloadable`,  `Elasticsearch`,  `Elasticsearch6`,  `Indexer`, `LayeredNavigation`,  `LoginAsCustomer`,  `Newsletter`, `Sales`, `SalesRule`, `Search`, `Store`,  `Swatches`, `UrlRewrite`, `Weee`和 `Wishlist`模块。

<!-- ENGCOM-8893 8951 8893 9001 8715 8724 8721 8843-->

* 已删除 `CliCacheFlushActionGroup` 从 `Catalog`, `CatalogUrlRewrite`, `Checkout`, `Config`, `ConfigurableProduct`,`Contact`, `Cookie`, `CurrencySymbol`, `Customer`, `Downloadable`, `Elasticsearch`, `Elasticsearch6`, `Fedex`, `Indexer`, `LayeredNavigation`,`LoginAsCustomer`, `Msrp`, `Multishipping`, `Sales`, `Swatches`, `Translation`, `UrlRewrite`, `Vault`, `Weee`和 `Wishlist` 模块。

### 新闻稿

<!-- ENGCOM-8948 MC-40885-->

* 应用程序不再向在新闻稿队列创建与新闻稿发送之间的时间段内取消订阅了新闻稿的客户发送新闻稿电子邮件。 [GitHub-32116](https://github.com/magento/magento2/issues/32116)

<!-- ENGCOM-8675-->

* 应用程序现在执行新闻稿启用设置(**商店**  >  **设置**  >  **配置**  >  **客户**  >  **新闻稿**  >  **常规选项**)。 以前，这些设置始终从多商店部署中的默认范围中进行检索。 [GitHub-31188](https://github.com/magento/magento2/issues/31188)

<!-- ENGCOM-8551-->

* REST调用GET `/V1/customers/search` 现在，可以为订阅了多个新闻稿的客户返回正确的信息。 [GitHub-31168](https://github.com/magento/magento2/issues/31168)

<!-- ENGCOM-8817-->

* 缓存订阅状态已从Newsletter插件中删除。 [GitHub-19345](https://github.com/magento/magento2/issues/19345)

### 订购

<!-- MC-40963-->

* 现在，在将部分开票订单的商店信用退回到客户帐户时，应用产品可正确计算已开票的客户余额。

<!-- ENGCOM-8710-->

* 现在，当应用程序保存已退还的客户余额时，它会按预期保存已修改的订单。 [GitHub-393](https://github.com/magento/partners-magento2ee/issues/393)

### 付款方法

<!-- MC-41525-->

* 现在，应用程序会启用付款块 `frontend` 无论从哪个区域发送电子邮件。 (现在，模拟为 `frontend` )。 以前，付款块会呈现在发送电子邮件的区域。 因此，无论是通过管理员还是REST API触发销售电子邮件，资产的URL都会尝试从错误区域(`webapi_rest` 或 `adminhtml`)。

<!-- MC-40810-->

* 现在，应用程序会将可下载产品的链接发送到在结帐期间指定的电子邮件地址。 以前，当来宾购物者使用PayPal Express Checkout并输入不同的电子邮件地址来提交订单和结帐时，应用程序会将可下载的产品链接发送到第一个地址。

<!-- MC-38051-->

* 在支持多种货币的部署中，应用程序现在在“付款方法”页面上显示可用商店信用的准确值。

<!-- MC-37820-->

* 现在，当来宾购物者在结账期间将订单的送货地址更改为其他国家/地区时，付款方法列表会按预期进行更新。 以前，更改帐单地址不会触发对可能付款方法的更新。

#### PayPal

<!-- MC-39895-->

* 购物者现在可以成功签出PayPal Payflow Pro订单，该订单的送货地址包含特殊字符。 以前，申请拒绝支付这些订单。

<!-- MC-39861-->

* 现在，在使用PayPal成功付款后，购物者将被重定向回订单成功页面。 以前，由于会话数据丢失，购物者会被重定向到空白页面。

### 性能

<!-- MC-41647-->

* 管理员SKU在大型目录上搜索的性能已得到改进。 查询优化程序提示现在会在查询执行期间强制使用索引。

<!-- MC-41440-->

* 的性能 `catalog_product_alert` `cron` 在大型表（数百万行）上运行的进程已得到改进。 以前， `catalog_product_alert` 已加载所有产品警报，这会导致内存不足异常。

<!-- ENGCOM-8752-->

* 当仅需要一个编辑页面才能呈现管理员表单时，应用程序不再加载所有CMS页面。  现在，这些页面的加载速度更快。 [GitHub-30936](https://github.com/magento/magento2/issues/30936)

<!-- ENGCOM-8510-->

* 中的数值 `WHERE IN` 表达式现在会转换为数字，而不是字符串，这会提高某些版本的MariaDB中的查询性能。 [GitHub-31135](https://github.com/magento/magento2/issues/31135)

* 的 `use_application_lock` 模式允许您通过使用环境变量或通过配置 `app/etc/env.php` 文件。 启用此模式后，在失败后不再需要手动重置索引器。 未启用此模式时，在失败后必须手动重置索引器。 请参阅 [将应用程序锁定模式用于重新索引进程](https://developer.adobe.com/commerce/php/development/components/indexing/#using-application-lock-mode-for-reindex-processes).

### 定价

<!-- MC-41767-->

* 现在，当购物者更新店面上的产品数量时，应用产品会使用分组价格正确地更新产品的价格。 [GitHub-32669](https://github.com/magento/magento2/issues/32669)

<!-- MC-39282-->

* 现在，在为产品分配了层价和 `Magento\Framework\Api\ExtensibleDataObjectConverter` 用于转换产品数据。 以前， `Magento\Framework\Api\ExtensibleDataObjectConverter` 在保存产品时，使用将产品数据转换为数组，应用程序未保存产品，并显示以下错误： `Notice: Undefined index: price in app/code/Magento/Catalog/Model/Product/Type/Price.php on line 382.`

<!-- MC-36811-->

* 计划价格更新现已应用于购物车中已有的产品。 [GitHub-356](https://github.com/magento/partners-magento2ee/issues/356)

<!-- MC-24693-->

* 现在，在启用数量增量且小数库存小于1时，按预期将层价格应用于产品。 以前，最低层价格数量设置为1。

### 产品视频

<!-- MC-39755-->

* 您现在可以使用 **添加视频** 按钮（管理员） **目录** > **产品**)连续添加多个视频。 以前，视频字段会保留上一个视频的详细信息。

<!-- MC-40817-->

* 现在，在移动设备上可以按预期方式进入产品页面上产品视频的全屏模式。 以前，进入全屏模式会导致视频在退出全屏模式之前暂停。

<!-- MC-39759-->

* 导航箭头按钮(**下一个** 和 **上一版**)现在可在店面产品视频中按预期显示。

<!-- MC-40463-->

* 商家现在可以使用 **插入视频** 按钮。 以前，应用程序显示404错误。 [GitHub-31753](https://github.com/magento/magento2/issues/31753)

### 报价

<!-- MC-39531-->

* 的 `/V1/guest-carts/examplecartid/items` 调用现在会返回请求的存储视图。 以前，它会返回存储中的第一个存储视图，而不是请求的存储视图。

<!-- MC-33893 ENGCOM-8992-->

* 发票发送现可配置。 以前，发票发送不可配置，应用程序始终在创建发票后发送发票。 发票电子邮件和订单电子邮件均在一名观察员的范围内发送。 现在，订单电子邮件和发票电子邮件的发送由单独的观察者负责。 [GitHub-27656](https://github.com/magento/magento2/issues/27656)

### 报告

<!-- MC-40998-->

* 现在，您可以在云基础架构项目的Adobe Commerce上查看和下载所有系统报表。 以前，您无法下载日志、数据、设计或存储的系统报告。

<!-- MC-39737-->

* 管理员的上次审核日期 **报表** > **评论** > **按产品** 现在显示正确的审阅日期。 以前，应用产品会显示产品创建日期而不是审阅日期。

### 退货授权(RMA)

<!-- MC-41866-->

* RMA `resolution` 属性字段值时，属性不再按需要显示 `required` 设置为 **否**.

<!-- MC-41808-->

* 您现在可以从管理员中选择多个退货订单。 以前，应用程序在您单击 **提交** 选择多个返回后，从“操作”下拉菜单中选择“关闭”。

<!-- MC-41759-->

* 在您使用REST API更改返回状态后，应用程序现在会按照预期向客户发送电子邮件通知。

<!-- MC-39981  magento/partners-magento2ee#442 -->

* 现在，应用程序会根据管理员客户返回网格中的过滤器值过滤记录。 以前，应用程序会将您定向到“管理所有客户”页面，然后单击 **重置过滤器** 按钮也会重定向到此页面。 [GitHub-436](https://github.com/magento/partners-magento2ee/issues/436)

### 评论

<!-- MC-40116-->

* 现在，“我的帐户”页面的“审阅详细信息”部分中可以正确计算产品审阅评级星级。

<!-- MC-39763-->

* 产品查看详细信息页面的“平均产品评级”和“产品评级”部分现在可以正确呈现。 以前，应用程序计算店面评级时未设置审核ID，并且产品审核模板未正确呈现。

<!-- MC-36149-->

* 的 **首先查看此产品** 现在，在管理员批准审核后，链接会按预期更改为审核计数。

<!-- ENGCOM-8501 MC-30270-->

* 现在，管理员可以按预期对产品编辑页面的“产品审阅”部分中的产品审阅进行排序。 [GitHub-30270](https://github.com/magento/magento2/issues/30270)

<!-- MC-41003  magento/magento2#32259-->

* 现在，在管理员批准并从与存储不同的域保存审阅后，将使用正确的存储ID保存审阅。 [GitHub-17510](https://github.com/magento/magento2/issues/17510)

### 奖励

<!-- MC-41159-->

* 现在，在从系统中删除下订单的客户之后，商家可以完全或部分使用奖励点取消下单。

<!-- MC-40037-->

* 商家现在可以从购物车价格规则中删除奖励点数。 以前，商家试图 **奖励积分** 在创建购物车价格规则时，将保留奖励点数量的上一个值为0。

<!-- MC-39890-->

* 现在，当管理员批准了多个审阅后，产品审阅的奖励点将与相关网站关联 **营销** > **待审** 网格。 以前，奖励积分不会显示在店面上，也未关联到管理员中的相关网站。

<!-- MC-39820-->

* 现在，当购物者通过多个地址签出时，应用程序会更新付款方法列表，这些地址可以支票或取消支票 **存储点数（奖励点数）** 选项。

### 销售

<!-- MC-39796-->

* 管理员用户现在可以在 **允许延交** 设置已启用(**商店** > **配置** > **目录** > **库存** > **产品库存选项**)。 以前，应用程序会引发错误。

<!-- MC-42280-->

* 现在，当姓氏以空格结尾时，购物者可以在“订单和退货”页面上找到订单。

<!-- MC-41438-->

* 现在，当购物车价格规则应用了100%折扣，并且该订单也需缴纳目录产品和折扣税，并且符合免费运送条件时，将使用正确的总计创建发票。 以前，订单的价格正确，但发票没有。 [GitHub-30853](https://github.com/magento/magento2/issues/30853)

<!-- MC-40384-->

* 按日期筛选订单现在可返回准确的结果。 以前，在按订单日期过滤订单时，应用程序不会返回在00:00 UTC之后下达的订单。

<!-- MC-40030-->

* 现在，贷项通知单网格在 **网站** 范围用于 **价格** 属性。

<!-- MC-40013 ENGCOM-8781-->

* 重新加载“管理员创建新订单”页面后，“付款方式”单选按钮在结账工作流的“付款和送货信息”部分不再消失。 [GitHub-32106](https://github.com/magento/magento2/issues/32106)

<!-- MC-39891-->

* 阿拉伯文文本现在可以正确显示在发票中。

<!-- MC-39864-->

* 现在，对于根据将PayPal Payment Pro部署为付款网关的商店中的订单或发票计算的部分贷项通知单税总额，应用产品将正确计算这些贷项通知单的部分贷项通知单税总额。 以前，对于具有多张发票的订单，应用产品会为贷项通知单中的部分发票取消核销该订单的全部税。

<!-- MC-39521 ENGCOM-8528-->

* 向客户发送新订单电子邮件时，应用程序不再创建随机数据库死锁。 以前，由于应用程序保存了整个对象及其相关对象，而不是更新的SQL列，因此会发生死锁。 应用程序显示此类型的错误： `SQLSTATE[40001]: Serialization failure: 1213 Deadlock found when trying to get lock; try restarting transaction`. [GitHub-31090](https://github.com/magento/magento2/issues/31090)

<!-- MC-39353-->

* 现在，“店面订单详细信息”页显示正确的已发运产品数量。 以前，产品数量不正确，因为呈现的“订单发运”页的模板 **发运数量** as `int`. 此名称已更改为 `float`.

<!-- MC-39026-->

* 在 **发票的电子邮件副本** 复选框。 以前，应用程序会向 **客户** 和 **将发票电子邮件副本发送到**. [GitHub-28511](https://github.com/magento/magento2/issues/28511)

<!-- MC-38973-->

* 从管理员为现有客户创建新订单时，应用程序不再为客户帐户创建重复的地址条目。 的 **在通讯簿中保存** 复选框已重命名为 **添加到通讯簿** 现在，默认情况下，和未在管理员中选中。

<!-- MC-38834-->

* 应用程序现在使用中上传的徽标 **HTML打印视图的徽标** 设置购物者从其帐户打印订单时。 以前，应用程序会显示LUMA徽标，而不是上传的徽标。

<!-- MC-38625-->

* 现在，当物品计数超过20时，店面上订单项目的寻呼机会按预期工作。 以前，寻呼机会考虑子产品，并且总计数不正确。

<!-- MC-23915 ENGCOM-8713-->

* 现在，应用产品在“订单”页和“贷项通知单”页网格上显示小计和发运及处理值的正确货币符号。 [GitHub-22662](https://github.com/magento/magento2/issues/22662)

<!-- ENGCOM-8486-->

* 现在，使用Safari的管理员可以成功地将产品添加到管理员的订单中。 以前，当管理员单击 **添加选定产品以进行订购** 按钮，应用程序会显示旋转加载图标，并且页面已挂起。 [GitHub-30265](https://github.com/magento/magento2/issues/30265)

### 销售规则

<!-- MC-40671-->

* 应用程序现在将购物车价格规则与 **最大数量折扣应用于** 或 **折扣数量步骤（购买X）** 条件。 以前，如果购物车价格规则包含 **最大数量折扣应用于** 或 **折扣数量步骤（购买X）** 在应用另一个购物车价格规则后，总折扣会减少到为 **最大数量折扣应用于** 或 **折扣数量步骤（购买X）** 乘以产品价格。

<!-- MC-39827-->

* 现在，优惠券报表可准确反映在实施拆分数据库的部署中的优惠券活动。

<!-- MC-39477-->

* 包含条件“类别”的购物车价格规则 **IS NOT** 现在可按预期应用于未分配给类别但已分配其父产品的可配置子/简单产品。

<!-- MC-39034-->

* GraphQL `cart` 在将优惠券应用于订单后，查询现在会返回购物车计费步骤的正确总计。

### 搜索

<!-- MC-41138-->

* 类别页面不再包含这些重复的HTML元素ID: `modes-label`, `mode-list`, `toolbar-amount`, `sorter`, `limiter`.

<!-- MC-40981-->

* 部分单词搜索结果不再包含意外或不相关的匹配项，并且搜索在店面和管理员上会生成一致的结果。 现在，应用程序使用不同的分析器，而不用对部分字搜索设置调整器。 以前，搜索结果显示的产品中不包含搜索关键词。 （默认分析器以前包含一个调整器，并且由于搜索时使用了同一分析器进行部分字搜索，因此搜索结果可能会产生意外或不相关的匹配。）

<!-- MC-40715-->

* 如果搜索查询包含多个词，并且产品名称配置为不可搜索，则快速搜索现在会返回结果。 以前，如果产品名称配置为不可搜索，则应用程序会对包含多个词语的搜索查询引发查询异常。

<!-- MC-40672-->

* 搜索结果现在包括 `weight` 属性（将其配置为可搜索）。

<!-- MC-40409-->

* 在您查看启用了Elasticsearch的空类别页面时，应用程序不再引发错误。 它而是会按预期呈现页面并显示一则信息性消息。 以前，空全文索引会在类别页面上触发异常。

<!-- MC-40376-->

* 现在，如果购物者开始搜索后在搜索字段外单击，则搜索字段自动完成功能可按预期工作。 现在，当购物者继续键入内容时，自动完成建议将重新显示。 以前，应用程序不显示自动完成建议，并且在搜索框中单击不会使搜索建议再次可见（尽管键入其他字母会显示）。

<!-- MC-34217-->

* 现在，在“高级搜索”中根据产品的完整或部分SKU搜索产品会返回预期的产品。

<!-- MC-31395-->

* 分层的导航过滤器现在可显示准确的产品计数。 以前，Elasticsearch中的产品计数值不会按目录权限进行过滤。

<!-- MC-23881 ENGCOM-8618-->

* Elasticsearch在类别URL页面参数超过分页时不再引发错误。 [GitHub-23843](https://github.com/magento/magento2/issues/23843)

<!-- MC-24033  magento/magento2#3274-->

* 您现在可以将自定义Elasticsearch字段映射器添加到 `Magento\Elasticsearch\Model\Adapter\FieldMapper\Product\FieldProvider\FieldName\Resolver\CompositeResolver`. [GitHub-24350](https://github.com/magento/magento2/issues/24350)

<!-- ENGCOM-9029 MC-24026-->

* 开发人员现在可以更改Elasticsearch映射。 以前，在默认映射中发送到Elasticsearch服务器的动态模板是硬编码的，这会阻止开发人员在Elasticsearch任何与自定义模块关联的额外数据时进行索引。 [GitHub-24363](https://github.com/magento/magento2/issues/24363)

<!-- ENGCOM-8464 -->

* 禁用搜索建议后，搜索字段（表单微型搜索）现在可按预期工作。 [GitHub-30584](https://github.com/magento/magento2/issues/30584)

### 装运

<!-- MC-41464-->

* 现在，当购物者在使用多个地址结账期间删除产品后导航回购物车页面时，应用程序会按预期更新送货价格。

<!-- MC-41343-->

* 当购物车中的某些物品符合免费装运的条件时，应用产品现在会显示正确的调整的装运价格。 以前，当购物车中符合免费送货条件的部分项目时，应用程序不会调整送货价格，而是向购物者显示完整的送货价格。

<!-- MC-41186-->

* 现在，受限于特定网站的管理员可以为同一网站上的订单创建装运。 以前，当管理员没有默认存储视图的权限，尝试发运在存储视图中下达的管理员有权访问的订单时，应用程序会引发此异常： `Notice: Undefined offset: 1 in /app/code/Magento/Catalog/Model/Product/Attribute/Backend/GroupPrice/AbstractGroupPrice.php on line 293`.

<!-- MC-41069-->

* 在确定订单是否符合免费DHL装运条件时，应用产品现在考虑相关购物车价格规则折扣。

<!-- MC-40702 ENGCOM-8728-->

* 在以非基本货币下单时，发运标签现在会按照预期使用基本货币，而不是支持多种货币的商店的订单货币。 [GitHub-31891](https://github.com/magento/magento2/issues/31891)

<!-- MC-40678 magento/magento2#31925-->

* 现在，当购物者在离开多送货页面后在结帐期间返回购物车页面时，应用程序会显示正确的订单小计。 [GitHub-31889](https://github.com/magento/magento2/issues/31889)

<!-- MC-40541 magento/magento2#31841 -->

* 在管理订单创建期间编辑帐单信息不再更改具有不同默认送货地址和帐单地址的客户的送货信息。 [GitHub-31786](https://github.com/magento/magento2/issues/31786)

<!-- MC-37385 ENGCOM-8578-->

* 应用程序不再取消检查 **附加注释** 复选框（购物者单击时） **获取送货方法和价格** ，并在从管理员创建订单时选择发运方法。 [GitHub-30256](https://github.com/magento/magento2/issues/30256)

<!-- MC-36425-->

* 购物者现在可以使用“返回浏览器”按钮返回至“选择发运方法”页面，同时签出具有多个地址的订单。 以前，应用程序显示损坏的“选择发运方法”页。 [GitHub-30268](https://github.com/magento/magento2/issues/30268)

<!-- MC-40021 ENGCOM-8983-->

* 现在，当购物者在“发货至多个地址”页上更改数量并单击浏览器“返回”按钮后，产品数量保持预期不变。 [GitHub-31956](https://github.com/magento/magento2/issues/31956)

<!-- ENGCOM-9096-->

* 在结帐期间应用购物车价格规则时，单价装运方法费用不再为零。 [GitHub-21832](https://github.com/magento/magento2/issues/21832)

<!-- ENGCOM-8537-->

* 当商户尝试使用DHL发送订单时，应用程序不再引发错误 **创建送货标签** 复选框，并且产品名称包含unicode字符。 以前，应用程序在请求创建标签时会显示此错误： `The response is in wrong format`. [GitHub-31032](https://github.com/magento/magento2/issues/31032)

<!-- ENGCOM-8952 -->

* 在多站点部署中，您可以成功地从管理员处下订单， `United States` 在一个网站上启用，`Disable all countries` 在其他网站上启用默认范围。 以前，应用程序未下订单并显示以下错误： `Please check the shipping address information. "regionId" is required. Enter and try again`. [GitHub-30577](https://github.com/magento/magento2/issues/30577)

### 暂存

<!-- MC-39807-->

* 计划块更新功能现在可以在实施Fastly的部署中按预期工作。 以前，应用程序不会更新块内容，因为Fastlycache标记没有失效，并且Fastly继续提供过时的内容。

<!-- MC-41142-->

* 现在，当分配给多个网站商店视图时，购物车价格规则暂存预览会加载到相应的网站中。 以前，无论分配的网站如何，购物车价格规则暂存预览都会加载到默认商店视图中。

<!-- MC-40916-->

* 现在，在计划更新结束后，非默认商店视图中产品的特殊价格将按预期设置为默认值。

<!-- MC-40850  magento/partners-magento2ee#489-->

* 现在，在创建具有结束日期的未来暂存更新后，商家可以从可下载产品页面成功保存包含链接样本的可下载产品。 以前，应用程序未保存产品并显示以下消息： `The downloadable sample isn't related to the product. Verify the link and try again`. [GitHub-488](https://github.com/magento/partners-magento2ee/issues/488)

<!-- MC-40734-->

* 在预览类别的计划更新期间，应用程序不再执行包含所有产品ID的大型数据库查询。 相反，类别过滤器会应用于产品收藏集，以生成临时表格，用于暂存类别预览。 以前，应用程序会将所有产品插入到临时表格中以进行暂存预览，这会降低性能。

<!-- MC-40714-->

* 的 `Magento_SalesRuleStaging` 从2.3.x升级期间，模块不再触发错误。

<!-- MC-40697-->

* 现在，在您查看计划更新时，应用程序会显示包含正确数据的目录规则条件。 以前，如果您查看了使用条件创建的计划更新，则应用程序不会显示条件或显示的条件，但数据不正确。

<!-- MC-40604-->

* 的 **使用默认值** 在更新之前，在取消选中计划更新后，产品的复选框会保持选中状态。

<!-- MC-40588 magento/partners-magento2ee#463-->

* 目录价格规则现在可以按预期应用于属性值未定义的产品。 以前，通过目录价格规则创建的折扣不会应用于具有未定义属性的产品。 [GitHub-461](https://github.com/magento/partners-magento2ee/issues/461)

<!-- MC-40283-->

* 现在，在具有不同时区内存储的多网站部署中，目录规则可以按预期工作。 以前，应用程序一次在所有网站上应用或停用目录规则。

<!-- MC-40054-->

* 在为特定网站创建计划更新时，将不再删除层价。

<!-- MC-39784 magento/partners-magento2ee#475-->

* 现在，在创建具有结束日期的未来暂存更新后，您可以从“可下载产品”页面保存产品。 以前，应用程序未保存产品并显示以下消息： `The downloadable link isn't related to the product. Verify the link and try again`. [GitHub-474](https://github.com/magento/partners-magento2ee/issues/474)

### 存储

<!-- MC-40538-->

* 应用程序不再处理 `0` 显示商店主页时的空值。 以前，应用程序在请求路径开始时将整数值视为存储ID，这会对SEO产生意想不到的影响。

<!-- MC-40313  magento/magento2#31970-->

* 插件 `\Magento\Framework\App\ActionInterface` 在 `lib/internal/Magento/Framework/App/Action/Plugin` 已删除，以遵循以下准则：应使用插件来自定义另一个模块中某个模块的行为。 [GitHub-28050](https://github.com/magento/magento2/issues/28050)

<!-- MC-24772-->

* 现在，当您尝试选择 `Website` 默认 `Store View` 在网站创建期间禁用： `Please enable your Store View before using this Web Site as Default`. 以前，网站崩溃，应用程序不显示警报。

### 税

<!-- MC-39571-->

* 现在，在验证最低订单金额时，应用产品将考虑隐藏税。

<!-- MC-38025 ENGCOM-8612-->

* 现在，当购物者导航回其购物车并在将捆绑产品添加到购物车后继续结帐时，应用程序会按预期显示固定产品税(FPT)。 [GitHub-30250](https://github.com/magento/magento2/issues/30250)

<!-- MC-37657 magento/magento2#31850-->

* 应用程序现在会预填充 **增值税号** 管理员为现有客户创建订单时，“管理员”新订单页的“地址信息”部分的帐单地址和送货地址的输入字段，其中保存了增值税编号。 [GitHub-31846](https://github.com/magento/magento2/issues/31846)

<!-- ENGCOM-8617 magento-engcom/magento2ee#558-->

* 应用程序现在显示 **增值税号** 字段 `customer/create_account/vat_frontend_visibility` 启用。 [GitHub-31326](https://github.com/magento/magento2/issues/31326)

### 测试

<!-- MC-41393-->

* 测试环境已升级到Redis 6.0.12。

<!-- ENGCOM-8529-->

* 已删除 `CacheCleaner::cleanAll();` 集成测试。 [GitHub-31074](https://github.com/magento/magento2/issues/31074)

<!-- ENGCOM-8898-->

* 为此方案添加了测试：管理员用户在客户订阅排队的新闻稿时可以编辑客户帐户。 [GitHub-30645](https://github.com/magento/magento2/issues/30645)

<!-- ENGCOM-8484-->

* 删除了 `cache:flush` 用于缩短测试执行时间的命令 `Catalog`, `CatalogUrlRewrite`和 `LoginAsCustomer` 模块。 [GitHub-31056](https://github.com/magento/magento2/issues/31056)

<!-- ENGCOM-8499-->

* 已删除冗余参数，并将POST更改为 `\Magento\Logging\Model\ProcessorTest::testLoggingProcessorLogsActionShipping`.

### 主题

<!-- MC-41474-->

* 当 **将JS代码移至页面底部** 设置(**存储** > **配置** > **高级** > **开发人员** > **JavaScript设置**)和cookie都已启用： `The store will not work correctly in the case when cookies are disabled`.

<!-- MC-40982-->

* 标题中的帐户链接现在遵循WCAG标准。 以前，标头中的帐户链接包含重复的ID，这会导致WCAG验证失败。

<!-- MC-40278-->

* 现在，应用程序优先考虑商店徽标图像的存储配置而不是布局配置。 以前，徽标图像的大小是固定的，不会因商店而异。

<!-- MC-35227-->

* 现在，应用程序在使用标准Adobe Commerce主题的店面页面上始终如一地显示页面元素。 以前，并非所有样式都应用在空白主题中，因此并非所有页面元素都显示在使用此主题的页面中。 （例如，“我的订单”页面搜索字段中不存在放大镜图标。）

### 翻译和区域设置

<!-- MC-23553 ENGCOM-8839-->

* 配置内联翻译后，添加到字符串的括号不再进行转义。 以前， `escapeHtmlAttr` 方法将括号转换为HTML实体代码。 [GitHub-32000](https://github.com/magento/magento2/issues/32000)

<!-- ENGCOM-8694-->

* 管理员中的不可翻译短语现在可以翻译。 （此拉取请求有助于继续努力使所有管理员字符串可本地化。） [GitHub-11175](https://github.com/magento/magento2/issues/11175)

<!-- ENGCOM-8584-->

* 模板中用于管理存储的付款方法的文本字符串(**我的帐户**  >  **存储的付款方法** )现在可翻译。 [GitHub-31211](https://github.com/magento/magento2/issues/31211)

<!-- MC-30798 ENGCOM-8717-->

* 从管理员发送的订单电子邮件现在使用商店区域设置，而不是与管理员帐户关联的区域设置。 [GitHub-26521](https://github.com/magento/magento2/issues/26521)

### UI

<!-- MC-41784-->

* 现在，管理员页脚会显示正确的产品版本。

<!-- MC-41067-->

* 现在，在管理员发运创建过程中，源的分页按预期显示。

<!-- MC-40240-->

* 现在，当您使用自定义日期属性筛选产品，并且管理员用户区域设置为 `en_GB`.

<!-- MC-39279-->

* 现在，iOS设备上的产品页面图像库放大镜中可以按预期使用捏合缩放手势。

<!-- MC-38787-->

* 管理员产品网格搜索结果的分页现在从第1页开始，每次搜索的分页均按预期进行。

<!-- MC-38423-->

* 解决缩放后购物车显示异常的问题。 以前，缩放此页面时显示元素会重叠。

<!-- MC-38235 magento/partners-magento2ee#492 -->

* “管理员邀请”页面（“管理员”）上的选项卡存在对齐问题 **营销** > **私人销售** > **邀请**)已解决。 以前，客户接受的邀请的选项卡显示方式未对齐。 [GitHub-333](https://github.com/magento/partners-magento2ee/issues/333)

<!-- MC-38226 magento/magento2#32008-->

* 现在，在PayPal Express Checkout的结帐过程中显示的订单审核页面已成功加载。 以前，模板包含未使用的 **更新投放方法** 按钮，该按钮仅在页面渲染期间被脚本部分隐藏。 [GitHub-32006](https://github.com/magento/magento2/issues/32006)

<!-- MC-37941 magento/magento2#31892-->

* 现在，当存在较长的评级名称时，产品页面“客户评论”部分中的星级和评论文本会有适当的间隔。 [GitHub-31890](https://github.com/magento/magento2/issues/31890)

<!-- MC-37688-->

* 选项现在按预期显示在“存档发票”、“发运”和“贷项通知单”页的“活动”下拉列表中。

<!-- MC-23729  magento/magento2#31549-->

* 现在，当 `datetime` 组件 `timeOnly` 选项设置为 **是**. [GitHub-23157](https://github.com/magento/magento2/issues/23157)

<!-- ENGCOM-8514 -->

* 现在，在“管理员”上创建新小组件后，您可以删除布局更新 **内容** > **小组件**.  [GitHub-29936](https://github.com/magento/magento2/issues/29936)

<!-- ENGCOM-8502 MC-35716-->

* 的 **删除布局更新** 按钮现在可在您从管理员添加的任何布局中按预期工作 **内容** > **小组件**. 以前，在添加多个布局时，此按钮不适用于除第一个选定布局之外的任何其他布局。 [GitHub-30286](https://github.com/magento/magento2/issues/30286)

<!-- ENGCOM-8524 -->

* 现在，应用程序使用布局文件中设置的页面标题作为客户帐户编辑文件的浏览器页面标题。 以前， `Magento\Customer\Controller\Account\Edit` 控制器操作强制将页面标题值 `Account Information`. [GitHub-30724](https://github.com/magento/magento2/issues/30724)

<!-- ENGCOM-8896 8826-->

* 允许商家在显示和隐藏密码之间进行切换的复选框已添加到以下页面：
   * 客户登录
   * 客户注册
   * 客户编辑（更改密码部分）
   * 客户设置新密码 [GitHub-31557](https://github.com/magento/magento2/issues/31557)

<!-- ENGCOM-8545 -->

* 删除了网格单元格中冗余的标题，当管理员在更改属性集后将产品添加到分组的产品集时，该标题会显示。 [GitHub-30911](https://github.com/magento/magento2/issues/30911)

<!-- ENGCOM-8895 -->

* 应用程序现在显示 `DateRange` 过滤 **客户**  >  **登录** 页面。 以前，应用程序会显示 `Text` 过滤器。 [GitHub-30328](https://github.com/magento/magento2/issues/30328)

<!-- ENGCOM-9009 -->

* JavaScript已从模板文件中删除，并移入单独的文件中，以减少管理页面上的渲染问题。 以前，在启用了缩小HTML的部署中，管理页面无法正确呈现。 应用程序显示以下错误： `An error has happened during application run. See exception log for details`. [GitHub-32454](https://github.com/magento/magento2/issues/32454)

<!-- ENGCOM-9044 -->

* 的 `dropdownDialog` 小组件现在只加载可拖动和可调整大小的内容 `jquery-ui` 它需要的块。 以前，它会加载大量不必要的代码，从而夸大加载时间并降低性能。 [GitHub-32810](https://github.com/magento/magento2/issues/32810)

### URL重写

<!-- MC-41550-->

* 现在，在通过批量更新将产品分配到网站后，将按预期生成多站点部署中特定网站的产品URL重写。

<!-- MC-40780 magento/magento2#32598-->

* 现在，当 **使用默认值** 已为父类别启用URL键的复选框。 以前，在层级中移动类别会导致错误 `url_path` 值。 [GitHub-16202](https://github.com/magento/magento2/issues/16202)

<!-- MC-40371-->

* 应用程序现在会更新 `url_path` 在类别层次结构中移动类别时分配给所有商店范围的类别。 以前，在层级中移动类别会导致错误 `url_path`.

<!-- MC-39463-->

* 现在，使用自定义URL从管理员创建的URL重定向可以成功运行。 以前，GraphQL会缓存来自GraphQL的响应 `urlResolver` 查询并在URL重写更新后返回旧值。

<!-- MC-38931  magento/magento2#31106-->

* 现在，当产品从网站中删除时，产品URL重写会按预期删除。 [GitHub-24184](https://github.com/magento/magento2/issues/24184)

<!-- ENGCOM-8719 -->

* 添加了 `main_table` 引用 `store_id` 在 `addStoreFilter` 函数 `app/code/Magento/UrlRewrite/Model/ResourceModel/UrlRewriteCollection.php` 收藏集。 以前，在 `join` 会添加到另包含 `store_id` 列。 [GitHub-31853](https://github.com/magento/magento2/issues/31853)

<!-- ENGCOM-8894 -->

* 的 `PUT /V1/products/:sku` 现在，REST端点会按照预期重新生成产品URL重写。 以前，端点会重新生成产品 `url_key` 值，但不会重写URL。 [GitHub-30316](https://github.com/magento/magento2/issues/30316)

### 用户

<!-- MC-40777  magento/magento2#31998-->

* 您现在可以保存有效的新用户角色（管理员） **系统** > **权限** > **用户角色**) `Catalog` 选定树排除 `Edit Product Design` ( **目录** > **库存** > **产品** > **编辑产品设计**)。 以前，应用程序不会保存此角色中用户所做的产品更改，并显示以下错误： `Not allowed to edit the product's design attributes`. [GitHub-31973](https://github.com/magento/magento2/issues/31973)

<!-- MC-38442-->

* 现在，在为新管理员生成电子邮件时，应用程序会使用正确的自定义电子邮件模板。 以前，应用程序使用旧的默认模板，该模板忽略了管理员的名字和姓氏。

<!-- MC-38122-->

* 现在，在向新用户发送电子邮件时，应用程序会使用正确的电子邮件模板。 以前，即使选择了自定义模板，应用程序也会使用默认模板。

### 版本CMS

<!-- MC-39953-->

* 现在，在您更改CMS页面布局后，应用程序会将正确的主题应用到该页面。 以前，在您保存布局更改后，无论将哪个主题分配给页面，应用程序都会将分配的主题更改为Luma。

<!-- MC-40431-->

* 现在，具有受限角色的管理员可以成功添加、更新或复制他有权访问的分配给层次结构节点的页面。 以前，应用程序在这些情况下会引发致命错误。

### 视频

<!-- MC-42059 ENGCOM-9039-->

* 现在，在启用和使用高级JavaScript捆绑后，产品库中会按预期提供视频。 [GitHub-32501](https://github.com/magento/magento2/issues/32501)

<!-- ENGCOM-8532-->

* 属于可配置产品的简单产品的YouTube视频现在可按预期工作。 以前，图像是按ID而不是位置排序。 因此，某些视频被视为图像。 [GitHub-29690](https://github.com/magento/magento2/issues/29690)

### Visual Sticler

<!-- MC-40797-->

* 使用Visual Sticler加载“管理员”类别页面的性能已得到改进。 加载管理员类别页面不再生成大型数据库查询。

### Web API框架

<!-- MC-41758-->

* 目录API现在可以通过添加新值和删除旧值来正确更新产品的自定义选项值。 以前，API不会删除旧值。

<!-- MC-34431-->

* POST `/V1/guest-carts/:cartId/billing-address` 现在，地址ID将返回为整数，而不是字符串。

### 网站限制

<!-- MC-38516-->

* 现在，在提示购物者登录之前，购物者会被重定向到他们尝试访问的页面。 以前，在启用了网站限制且限制模式设置为 **私人销售：仅登录**&#x200B;时，购物者会被重定向到商店主页。

### 构件

<!-- MC-39128-->

* 管理员现在可以删除小组件的所有布局更新。 以前，当小组件进行了多次布局更新时，管理员只能删除第一个布局。

<!-- MC-39107-->

* 单击 **添加到购物车** 按钮不再导致页面重新加载。 以前，单击 **添加到购物车** 按钮时，该按钮会导致当前页面在产品添加到购物车之前重新加载。

<!-- MC-23590-->

* TinyMCE中的CMS层级节点链接小组件现在可以在 **锚点自定义文本** 字段中，此值为空。

### 愿望列表

<!-- MC-40651 ENGCOM-8769-->

* 在单击 **编辑项目** 按钮。 [GitHub-32119](https://github.com/magento/magento2/issues/32119)

<!-- MC-40417-->

* 现在，当您使用希望列表中的可自定义文件选项更新产品时，应用程序会显示正确的产品价格。 以前，应用程序显示的产品价格错误，并且未显示指向已上传文件的链接。

<!-- MC-39060-->

* 对于具有多个愿望清单的客户，愿望清单中的产品总数现在与愿望清单中的项目数匹配。 以前，无现货产品会包含在总产品计数中。

<!-- MC-36779 magento/magento2#31110-->

* 现在，应用程序在将产品添加到订单后，会将其从愿望列表中删除。 [GitHub-30260](https://github.com/magento/magento2/issues/30260)

<!-- MC-34456 ENGCOM-8816-->

* 购物者现在可以从愿望清单将相关产品添加到其购物车。 以前，当购物者单击 **全选** 相关产品部分的链接。 [GitHub-32274](https://github.com/magento/magento2/issues/32274)

## 已知问题

**问题**: _禁用reCAPTCHA时出现JavaScript错误_. 如果在结帐时禁用了reCAPTCHA，则会继续结帐，但应用程序会显示 `Uncaught TypeError` 控制台日志中出错。  此问题将在以后的版本中修复。 <!-- MC-42589 42649-->

**问题**: _内容安全策略错误_. 店面在控制台日志中显示以下错误： `The Content-Security-Policy directive frame-ancestors does not support the source expression unsafe-inline`. 店面性能不受影响。 <!-- MC-42613-->

**问题**: _礼品卡金额的PayPal信用显示异常_. 启用PayPal信用并配置多个礼品卡金额后，如果购物者更改礼品卡值的金额，则店面不会更新分期付款的金额。 此问题的修复将包含在Adobe Commerce 2.4.4和Magento Open Source2.4.4中。<!-- MC-42499 AC-344-->

**问题**:  _的&#x200B;**按顺序添加**按钮对于由SKU添加到购物车的产品不起作用_.  当您单击 **按顺序添加** 按钮： `An error has happened during application run`. 产品未添加到购物车。 **解决方法**:使用添加产品功能。 <!-- AC-345-->

**问题**:GraphQL `category` 和 `categoryList` 查询忽略确定共享目录中类别是隐藏还是显示的类别权限。 店面当前显示已分配或未分配到共享目录的所有类别。 这会影响Adobe Commerce 2.4.3部署，这些部署实施了已启用B2B共享目录的PWA店面。 <!-- MC-42528-->

## 社区贡献

我们感谢更广泛的Magento Open Source群体，并感谢他们对本稿的贡献。

社区工程团队 [Magento参与者](https://magento.com/magento-contributors) 按月、季度和年维护排名最前的参与个人和合作伙伴列表。 在该“参与者”页面中，您可以在GitHub上跟踪指向其合并PR的链接。

### 合作伙伴贡献

下表重点介绍了合作伙伴的贡献。 此表列出了提供拉取请求、外部拉取请求以及与其关联的GitHub问题编号（如果可用）的合作伙伴。

{{$include /help/_includes/release-notes/engcomm-2-4-3-partner.md}}

### 个人参与者贡献内容

下表列出了社区成员的贡献内容。 此表列出了外部拉取请求、与其关联的GitHub问题编号（如果可用），以及贡献拉取请求的社区成员。

{{$include /help/_includes/release-notes/engcomm-2-4-3-issues.md}}

### 系统要求

我们的技术堆栈构建在PHP和MySQL上。 有关更多信息，请参阅 [系统要求](../../../installation/system-requirements.md).

### 安装和升级说明

您可以使用 [编辑器](../../../installation/composer.md).

## 迁移工具包

数据迁移工具可帮助将现有Magento1.x存储数据传输到Magento2.x。此命令行界面包括验证、进度跟踪、日志记录和测试功能。 有关安装说明，请参阅 [安装数据迁移工具](../../../tools/data-migration-tool/install.md). 考虑探索或为 [数据迁移存储库](https://github.com/magento/data-migration-tool).

的 [代码迁移工具包](https://github.com/magento-commerce/code-migration) 帮助将现有Magento1.x存储扩展和自定义项传输到Magento2.x。命令行界面包含用于转换Magento1.x模块和布局的脚本。
