---
title: Magento Open Source2.4.6发行说明
description: 了解2.4.6Magento Open Source版本中的新增功能、增强功能、错误修复和已知问题。
hide: true
hidefromtoc: true
source-git-commit: 2b4cd408fbd33d33c9760c3baec0dc2501a45d61
workflow-type: tm+mt
source-wordcount: '8456'
ht-degree: 0%

---


# Magento Open Source2.4.6发行说明

Magento Open Source2.4.6引入了对PHP 8.2的支持。PHP 8.1仍得到完全支持，但对PHP 7.4的支持已被删除。 它包括显着的性能与可扩展性增强。 已优化用于批量购物车操作和类别树渲染响应的GraphQL操作。

此版本包括质量修复和增强功能。 核心编辑器依赖项和第三方库已升级到与PHP 8.2兼容的最新版本。

{{bics}}

## 其他发行信息

虽然这些功能的代码与Magento Open Source核心代码的发行版本捆绑在一起，但其中几个项目也单独发布。 每个项目的文档中都提供了特定于项目的单独发行信息，其中记录了这些项目的错误修复。

## Magento Open Source2.4.6亮点

在此版本中查找以下亮点。

### 安全性增强

此版本包括八项安全修复和平台安全改进。 此安全修补程序已反向移植到Magento Open Source2.4.4-p1和Magento Open Source2.3.7-p4。

到目前为止，尚未发生任何与这些问题相关的已确认攻击。 但是，可能会攻击某些漏洞以访问客户信息或接管管理员会话。 这些问题中的大多数要求攻击者首先获得对管理员的访问权限。 因此，我们提醒您采取一切必要步骤保护您的管理员，包括但不限于以下工作：

* IP列入允许列表
* [双重身份验证](https://devdocs.magento.com/guides/v2.4/security/two-factor-authentication.html)
* 使用VPN
* 使用唯一位置，而不是 `/admin`
* 良好的密码卫生

参见 [Adobe安全公告](https://helpx.adobe.com/security/products/magento/apsb22-38.html) ，以了解有关这些已修复问题的最新讨论。

#### 其他安全增强功能

此版本的安全改进改进了与最新安全最佳实践的符合性，包括：

* 通过对网格视图、批量操作和导出中的操作进行更具体的审核，填补了管理操作日志中的空白。 <!-- AC-1553 -->

* 在支付处理期间发生意外错误时，reCAPTCHA验证在结账期间不再失败。 [GitHub-35093](https://github.com/magento/magento2/issues/35093) <!-- AC-2642 -->

* **新的系统配置，可在管理员用户更改其电子邮件时要求确认电子邮件**. 为了减少站点漏洞，添加了一个新的系统配置设置（默认情况下禁用），以便在管理员用户更改其电子邮件时要求确认电子邮件： **[!UICONTROL Stores]** > **[!UICONTROL Settings:Configuration]** > **[!UICONTROL Customers]** > **[!UICONTROL Customer Configuration]** > **[!UICONTROL Account Information Options]** > **[!UICONTROL Require email confirmation if an email has been changed]**. 启用此选项后，每当管理员用户更改其电子邮件地址时，应用程序都会请求电子邮件确认。 以下模块受此更改影响： `Magento_Customer`. <!-- AC-3064 -->

### 平台增强功能

Magento Open Source2.4.6引入了对PHP 8.2的支持。PHP 8.1仍得到完全支持。 <!-- AC-6598 -->

PHP 7.4支持已从此版本中删除。 无法在PHP 7.4上运行Magento Open Source。

Magento Open Source现在支持：

* Composer 2.2.x.已删除编辑器1.x。 <!-- AC-2839 -->

* Redis 7.0.x。尽管与Redis 6.2的兼容性仍然存在，我们建议将此版本与Redis 7.0.x一起部署，因为Redis 6.2的生命周期有望在2024年结束。 <!-- AC-6606 -->

* 现在支持将OpenSearch作为Magento Open Source内部部署和云部署的默认搜索引擎。 它支持作为独立的Magento Open Source搜索引擎。 此版本支持OpenSearch v2.x，并已通过OpenSearch 2.5测试。尽管与OpenSearch 1.x的兼容性仍然存在，但我们建议将此版本与OpenSearch 2.x一起使用。您可以在Cloud和内部部署上安装并运行Magento Open Source和Magento Open Source2.4.6以及OpenSearch 2.x [搜索引擎先决条件](https://experienceleague.adobe.com/docs/commerce-operations/installation-guide/prerequisites/search-engine/overview.html). <!-- AC-449 3555 -->

* Elasticsearch8.x <!-- AC-6597 -->

* MariaDB 10.6（LTS版本）。 此版本仍与MariaDB 10.4兼容，但我们建议升级到MariaDB 10.6。 <!-- AC-6921 -->

#### 其他升级和更换

* DHL模式已从v6.2迁移到v10.0。 <!-- AC-3023-->

* 已过时的JavaScript库已更新为其最新版本，并且已删除过时的依赖项。 这些更改向后兼容。 <!-- AC-2036-->

* PHP 7.4兼容性已从Commerce和Magento Open Source代码库中移除。 <!-- AC-2841-->

* Symfony依赖项已升级到新的LTS版本。 依赖关系包括：<!-- AC-2656-->

   * `friendsofphp/php-cs-fixer`
   * `symfony/console`
   * `symfony/event-dispatcher`
   * `symfony/finder`
   * `symfony/process`
   * `web-token/jwt-framework`

* `jquery-migrate` 已从Commerce和Magento Open Source代码库中移除。 [GitHub-21406](https://github.com/magento/magento2/issues/21406) <!-- AC-1199 -->

* 已升级 `jQuery/fileUpload` 库升级到v10.32。 <!-- AC-2658-->

* 已从代码库中移除了已达到生命周期结束的Zend框架(ZF1)组件。 参见 [与向后兼容的更改会突出显示](https://developer-stage.adobe.com/commerce/php/development/backward-incompatible-changes/highlights/).<!-- AC-1512 -->

* Laminas依赖关系已更新为支持PHP 8.2。 <!-- AC-7019-->

* 此 `laminas/laminas-dependency-plugin` 已删除编辑器插件。 [GitHub-36515](https://github.com/magento/magento2/issues/36515) <!-- AC-7100-->

* 已替换 `Zend_Filter` 替换为 `laminas/laminas-filter`. <!-- AC-5922-->

* 已升级 `web-token/jwt-framework` 到v3.0.5。 （最新版本） <!-- AC-3772-->

* 已升级 `allure-framework/allure-phpunit` 到v2.x。 <!-- AC-2660-->

* 已升级 `Chart-js` 库到v3.9.1 <!-- AC-2661-->

### 辅助功能更新

此版本的重点在于在Venia(PWA)上创建更易感知、可操作、可理解和强大的店面体验。 这些增强功能包括：

<!-- AC-2479-->

* 的可视文本标签 **[!UICONTROL Sign in]** 按钮现在与其可访问名称匹配。 （最佳实践建议UI元素的辅助功能名称以可见的标签文本开头。）

<!-- AC-2481 2492-->

* 描述性可访问名称已添加到整个店面的按钮中。

<!-- AC-2488-->

* 口头描述标签已添加到 **[!UICONTROL Has Video]** 复选框。

<!-- AC-2787-->

* 仅使用键盘的用户现在可以访问店面上的所有页面功能。 以前，购物者无法仅通过按键访问子导航链接。


### Adobe Commerce与Adobe IMS集成

以下Adobe IMS模块已与Adobe Commerce和Magento Open Source核心代码分离，现在打包为单独的metapackage：

* `adobe-ims`
* `adobe-ims-api`
* `admin-adobe-ims`

新 `adobe-ims-metapackage` v2.2.0与Adobe Commerce 2.4.6和Magento Open Source2.4.6捆绑在一起。此版本中未更改任何功能。<!-- CABPI-505-->

### Braintree

<!-- BUNDLE-3107-->

* 此 **[!UICONTROL Pay Later]** 意大利和西班牙的按钮和横幅（报文）已启用Braintree。

<!-- BUNDLE-3109-->

* 启用了PayPal Vault的PayLater消息传送。

<!-- BUNDLE-3140-->

* 添加了欺诈防护和ACH Web挂接。 在Braintree中做出风险决策时会触发欺诈防护Web挂接。 当ACH支付的状态更新为 `settled` 或 `settlement decline`.

<!-- BUNDLE-3141-->

* 添加了LPM（本地支付方式）Web挂接。

### GraphQL

GraphQL性能增强包括：

**改进了查询启用了类别权限的类别时的响应时间**. 在启用了类别权限且包含许多客户组或共享目录的类别中查询产品时，响应时间已缩短。 支持此性能提升的代码更改包括： <!-- B2B-2179 2404 2329-->

* GraphQL解析程序操作已得到优化。
* 数据提供程序不再为正在处理的每个新产品重新设置运行时缓存的数据，这改进了性能。 <!-- B2B-2452-->
* 已在GraphQL解析程序中优化产品权限处理。 产品权限现在改为按产品应用于产品收藏集。  <!-- B2B-2404-->
* 已优化在共享目录中读取的权限 `addProductsToCart` 突变。 <!-- B2B-2424-->
* 产品权限已通过产品内联片段进行优化。 <!-- B2B-2459-->

**优化了类别树渲染的性能**. 此 `categoryList` 查询已经过优化，可支持具有大量类别的客户。 使用此查询来搜索包含最多五个级别嵌套子类别的1500多个类别的商家将会注意到性能提升。 通过删除不必要的方法调用、改进类别树的缓存和递归加载类别数据，改进了通过重构代码加载类别子级的方法。  支持此性能提升的代码更改包括： <!-- B2B-2484 2469 2472-->

* 类别模型的自定义属性元数据获取已得到改进。 <!-- B2B-2463-->
* 类别ID提取已得到改进，并且 `getChildren` 通话次数已减少。 <!-- B2B-2464-->
* 类别子项加载已得到改进。<!-- B2B-2469-->

**缩短批量购物车操作查询响应时间**. 当添加多达500种简单且可配置的产品时， add product mutance已得到优化，以提高查询性能。 捆绑包产品不受影响。 优化的突变包括 `addProductsToCart`， `addConfigurableProductsToCart`， `addDownloadableProductsToCart`， `addSimpleProductsToCart`， `addVirtualProductsToCart`，`addWishlistItemsToCart`、和 `updateCartItems`. <!-- B2B-2331 2423-->

**客户查询现在支持订单排序**. 此 `orders` 的输出对象 `customer` 查询现在包含排序字段。 您现在可以按订单编号或创建日期以及升序或降序对订单进行排序。 <!-- AC-6903-->

新的变异：

`deleteCustomer` <!-- AC-2879-->

请参阅 [GraphQL开发人员指南](https://developer.adobe.com/commerce/webapi/graphql/) 以了解有关这些增强功能的详细信息。

### 页面生成器

Page Builder v.1.7.3与Magento Open Source2.4.6兼容。

### PWA Studio

PWA Studiov.13.0.x与Magento Open Source2.4.6兼容。它包括多项增强功能，可提高可访问性。 有关错误修复的信息，请参见 [PWA Studio版本](https://github.com/magento/pwa-studio/releases). 参见 [版本兼容性](https://developer.adobe.com/commerce/pwa-studio/integrations/adobe-commerce/version-compatibility/) 有关PWA Studio版本及其兼容的Adobe Commerce核心版本的列表。


## 修复的问题

我们已在Magento Open Source2.4.6核心代码中修复了数百个问题。

### 安装、升级、部署

<!-- ACP2E-1168-->

* 在具有多个区域设置和网站的标准或紧凑部署期间，静态内容部署不再超时或失败。

<!-- ACP2E-923-->

* 运行静态内容部署时，压缩策略不再导致对外部域的无效引用(`bin/magento set:static-content:deploy -f --strategy compact`)。

<!-- AC-5994-->

* 正在执行 `bin/magento setup:di:compile -vvv` (或使用 `-v` 或 `-vv` options)现在返回有关失败的信息性消息。 [GitHub-35391](https://github.com/magento/magento2/issues/35391)

<!-- AC-5973-->

* 运行时，Magento Open Source不再引发以下异常 `bin/magento setup:upgrade` 已在运行数据迁移工具的部署中的命令： `PHP Fatal error:  Declaration of Migration\Logger\Logger::addRecord(int $level, string $message, array $context = []): bool must be compatible with Monolog\Logger::addRecord(int $level, string $message, array $context = [], ?Monolog\DateTimeImmutable $datetime = null): bool in /var/www/html/vendor/magento/data-migration-tool/src/Migration/Logger/Logger.php on line 34`. [GitHub-35604](https://github.com/magento/magento2/issues/35604)

<!-- AC-5970-->

* 此 `setup:db:status` 在运行MySQL 8.0.29的环境中，命令不再失败。以前，命令输出错误地指出声明性模式已过时。 [GitHub-35671](https://github.com/magento/magento2/issues/35671)

<!-- AC-1377-->

* 此 `composer install` 命令不再覆盖 `.gitignore` 文件。 [GitHub-32888](https://github.com/magento/magento2/issues/32888)

<!-- AC-6671-->

* 正在运行 `bin/magento sampledata:remove` 在Alpine Linux上升级后删除示例数据不再失败，并出现以下错误： `Undefined constant "MagentoHackathon\Composer\Magento\Deploystrategy\GLOB_BRACE`. [GitHub-36062](https://github.com/magento/magento2/issues/36062)


<!-- AC-6933-->

* `bin/magento setup:upgrade` 现在在首次执行后成功执行 `composer install --no-dev`. [GitHub-36351](https://github.com/magento/magento2/issues/36351)

<!-- AC-6796-->

* 异常和异常栈栈跟踪条目现在包含在中 `var/log/exception.log`. [GitHub-36054](https://github.com/magento/magento2/issues/36054)

<!-- AC-2681-->
现在，当您使用命令行设置没有密码的Redis连接时，Magento Open Source会引发参数验证错误。


### 辅助功能

<!-- AC-6678 6679 6677-->

* 此 **[!UICONTROL Proceed to Checkout]**， **[!UICONTROL Review Order]**、和 **[!UICONTROL Place Order]** 现在，对于键盘输入，签出工作流中的按钮可按预期工作。

<!-- AC-2485-->

* 使用时按钮的焦点视觉指示 **[!UICONTROL TAB]** 或 **[!UICONTROL SHIFT + TAB]** 在页面控件中导航现在可按预期工作。


#### 屏幕阅读器

<!-- AC-2498-->

* 订单历史记录页面的屏幕阅读器现在可以读取正确的图像描述。

屏幕阅读器现在宣布：

* 搜索结果中按预期找到的项目总数 <!--- AC-3522-->
* 用户使用键盘控件成功登录时的登录用户名 <!--- AC-6477-->
* 产品搜索结果页眉现在可以读取的正确值 `<title>` 元素 <!--- AC-2489-->
* 输入字段是否为必填字段 <!--- AC-2494-->
* 更正折叠元素的当前状态（折叠和展开） <!--- AC-2487-->
* 用户单击“ ”后刷新页面内容时 **[!UICONTROL Create an account]** 按钮 <!---AC-6676-->


### 捆绑产品

<!-- ACP2E-906-->

* 现在，通过API更新特定商店视图的捆绑产品不会覆盖同一捆绑产品的其他商店视图数据。 以前，捆绑产品选项标题会被其他商店视图的第一个选项标题覆盖。

<!-- AC-3769-->

* 现在，可以从管理员中成功筛选捆绑产品 **[!UICONTROL Catalog]** > **[!UICONTROL Products]** 使用荷兰语言环境时。 以前，当您尝试过滤时，Magento Open Source显示此错误 `Type: Bundle Product`： `Something went wrong with processing the default view and we have restored the filter to its original state`. [GitHub-35704](https://github.com/magento/magento2/issues/35704)

<!-- ACP2E-1038-->

* 当捆绑产品的特殊价格超过1000时，产品网格不再抛出异常。 以前，当您按SKU搜索产品或导航到 **[!UICONTROL Catalog]** > **[!UICONTROL Products]**，Magento Open Source引发此错误： `Non Numeric value encountered`. [GitHub-36284](https://github.com/magento/magento2/issues/36284))

<!-- ACP2E-1220-->

* 对于包含捆绑包和简单产品的订单，其贷项通知单和发票PDF中的列现在可以正确呈现。 以前，列会扭曲或不对齐。

<!-- ACP2E-1315-->

* 在 `BundleProduct` 片段， `items.options.product` 对象按预期包含数据。 以前，对象在某些情况下可能为null。

<!-- AC-6548-->

* 在以下情况下，包选项的小数数量现在可以正确呈现 **[!UICONTROL Quantity uses decimals]** 已启用。 以前，只渲染量的整数部分，而不渲染小数部分。 例如，数量1.5呈现为1.0。 [GitHub-35964](https://github.com/magento/magento2/issues/35964)

<!-- B2B-2453-->

* GraphQL响应现在仅返回所查询存储区范围内的捆绑产品选项。

<!-- B2B-2455-->

* 对于未分配给类别但属于捆绑或分组产品的产品选项的产品，现在响应中将返回以下值： **[!UICONTROL Allow Category Browsing]** 为发送查询的客户启用了配置设置。

### 缓存

<!-- ACP2E-134-->

* 订单履行后不再刷新全页缓存，除非订购的产品没有库存。 以前，每当创建发运时，就会清除类别的缓存。

<!-- ACP2E-1321-->

* 现在，配置二级缓存并部分收回远程数据后，数据缓存成功。 以前，仅刷新数据缓存而不刷新这些数据的哈希后，当存在数据哈希时，不会保存新缓存。

<!-- B2B-2471-->

* 已更正中的缺陷 `CatalogUrlResolverIdentity` 和 `CmsUrlResolverIdentity` 防止了缓存。 这会影响多个请求上的路由查询缓存。

### 购物车和结账


<!-- ACP2E-965-->

* 现在，当购物车包含最小数量的简单产品时，购物者可以向购物车中添加其他商品。

<!-- ACP2E-964-->

* 现在，用于检索购物车数据的REST API调用会返回相同的 `grand_total` 和 `base_grand_total` 当存储货币和基本货币相同时的值。 [GitHub-34649](https://github.com/magento/magento2/issues/34649)

<!-- ACP2E-962-->

* 的导出值 **[!UICONTROL Maximum Qty Allowed in Shopping Cart]** 现在与管理员配置设置中设置的默认值匹配。

<!-- ACP2E-889-->

* Magento Open Source现在可以正确计算带有发运折扣的订单退款总计。

<!-- ACP2E-876-->

* Google ReCAPTCHA现在可按预期处理店面订单。 以前，当购物者首次尝试下订单之前未首次选择Google ReCAPTCHA时，Magento Open Source会显示这些错误： `ReCaptcha validation failed, please try again` 和 `No such cart with id = ID`.

<!-- AC-2338-->

* 现在，验证码图像刷新遵循管理员配置设置，并且不会在禁用设置时触发。 以前，无论设置是启用还是禁用，只要付款方式发生更改，就会触发刷新。 [GitHub-34855](https://github.com/magento/magento2/issues/34855)

<!-- ACP2E-479-->

* 当购物者更改购物车页上的产品数量而未更新购物车，然后尝试导航到下一页时，Magento Open Source现在按预期显示确认弹出窗口，然后将购物者重定向到下一页。

<!-- AC-5987-->

* 现在，购物者可以在管理员减少购物车中的产品数量后，减少购物车的产品数量。 以前，当购物者尝试减少产品数量时，Magento Open Source会引发以下错误： `The requested qty is not available`. [GitHub-35780](https://github.com/magento/magento2/issues/35780)

<!-- AC-6744-->

* 当多装运结帐期间产品数量超过配置的最大值时，Magento Open Source不再在JavaScript控制台中引发错误。 Magento Open Source现在改为显示信息性错误消息。 [GitHub-36184](https://github.com/magento/magento2/issues/36184)

<!-- ACP2E-1276-->

* 当购物者使用键盘上的向下箭头键更改产品数量时，购物车页面上的商品数量不再表示为负数。 [GitHub-36299](https://github.com/magento/magento2/issues/36299)

<!-- ACP2E-1232-->

* 在更改购物者所属的客户组后，购物者无法再向购物车中添加现在不允许的类别中的产品。 当权限配置设置发生更改时，Magento Open Source现在会检查特定类别的客户组权限访问权限。

<!-- ACP2E-926-->

* 在管理员创建订单之前，客户购物车不再清空，如果订单被取消或放弃，购物车内容现在可以恢复。 现在，仅在创建订单后，才会从购物车中删除项目。 以前，每当管理员用户尝试在管理员管理购物车页面上创建订单时，购物车都会被清空。

<!-- AC-6939-->

* 现在，迷你购物车会在您运行后显示正确的产品图像 `bin/magento catalog:image:resize`. 以前，所有图像都替换为默认的产品占位符图像。 [GitHub-35535](https://github.com/magento/magento2/issues/35535)

<!-- AC-2376-->

* 当送货地址包含扩展属性时，现在可以成功完成签出。 以前，Magento Open Source引发此错误： `Object of class Magento\Quote\Api\Data\AddressExtension could not be converted to string`. [GitHub-34202](https://github.com/magento/magento2/issues/34202)

<!-- AC-2793-->

* 此 `addBundleProductsToCart` 如果必需的产品选项没有值，则query不再向报价添加产品。 [GitHub-25676](https://github.com/magento/magento2/issues/25676)

<!-- B2B-2458-->

* Magento Open Source现在，当 `addProductsToCart` 将产品添加到购物车时权限不足，查询失败。

<!-- ACP2E-1242-->

* 使用快速订购添加的产品数量超过可用库存时，Magento Open Source不再在购物车页面上引发错误。


### 购物车价格规则

<!-- AC-2242-->

* 在规则创建期间设置的购物车价格规则免运费选项现在会按预期应用于订单。 以前，在创建规则期间应用的免运费选项会在结账期间被忽略，并且应用规则时不允许使用免运费。 [GitHub-35013](https://github.com/magento/magento2/issues/35013)

<!-- ACP2E-1074-->

* 此 `discount_percent` 列 `sales_order_item` 当未设置物料折扣数量或物料折扣数量大于或等于订单物料数量时，产品的表现在按预期填充折扣百分比。 以前，在将此产品应用购物车价格规则时，不会填充此列。

### 目录

<!-- ACP2E-1181-->

* 产品列表小组件不再为登录购物者显示不正确或缓存的价格。 主页小部件中显示的价格现在与购物者的地址匹配，并在购物者更新地址时更新。 以前，浏览器缓存不会根据客户组税则更新主页上的产品价格。

<!-- ACP2E-1007-->

* 现在，“比较产品”列表功能在多网站部署中可以正确运行，并且取决于网站。

<!-- ACP2E-900-->

* 当您重新加载产品详细信息页面时，Magento Open Source不再显示上一页的数据。 以前，在重新加载产品详细信息页面时，来自第一个选项卡的数据会与新加载的数据合并一秒。

<!-- ACP2E-816-->

* 现在，可以按预期在移动设备的主菜单中展开具有子类别的类别。 以前，购物者无法打开或扩展移动部署中具有子类别的类别。 [GitHub-35329](https://github.com/magento/magento2/issues/35329)

<!-- ACP2E-789-->

* 现在，当产品被分配给新网站或商店时，类别列表会按预期更新。 以前，产品价格索引器不会标记为无效，并且随后会在上重新触发。 `cron` 按预期运行。 因此，价格指数表中缺少该产品的价格条目，而且该价格条目未显示在新的商店或网站上。

<!-- AC-6395-->

* 现在，在以下情况下，店面库存计数是准确的： **[!UICONTROL Display Out of Stock Products]** 已启用配置设置。 [GitHub-35899](https://github.com/magento/magento2/issues/35899)

<!-- AC-6384-->

* 当以下条件出现时，类别页面不再为空： **[!UICONTROL Allow All Products Per Page]** 设置已启用。 [GitHub-35900](https://github.com/magento/magento2/issues/35900)

<!-- AC-6330-->

* 此 **[!UICONTROL Display Out of Stock Products]** 现在，配置选项在启用时可按预期工作。 以前，在管理员中启用此选项后，所有产品在店面中都显示为缺货。 [GitHub-35898](https://github.com/magento/magento2/issues/35898)

<!-- ACP2E-1306-->

* 现在，按布尔属性对产品排序可按预期工作。 [GitHub-36390](https://github.com/magento/magento2/issues/36390)

<!-- ACP2E-1206-->

* 目录价格规则折扣不再应用于固定价格的自定义产品选项，而是仅应用于产品的原始价格。

<!-- AC-6810-->

* 目录价格规则现在会考虑所选范围，并且仅适用于其属性具有匹配规则的选项值的网站的产品。 以前，该规则不会考虑多站点部署中的选定范围。 [GitHub-36049](https://github.com/magento/magento2/issues/36049)

<!-- ACP2E-891-->

* 现在，当购物者从“我的购物车”页面修改可配置产品时，会在产品详细信息页面中预先选择样本选项“颜色”和“大小”属性。 (jQuery 3.x版本现在支持 `swatchRenderer` 构件名称，现为驼峰式大小写。) 以前，不会预先选择样本选项。

<!-- ACP2E-1361-->

* 现在，当客户订阅了价格下降警报后，将通知客户产品价格下降。 以前，由于应用程序级别的缓存，并非总是会发送价格下降通知。

<!-- ACP2E-1348-->

* 基于具有的SKU的目录规则 **[!UICONTROL is not one of]** 完成情况现在按预期工作。

<!-- AC-729-->

* Magento Open Source不再错误地基于类别路径假定一个类别是另一个类别的父级。 [GitHub-32464](https://github.com/magento/magento2/issues/32464)

### 可配置产品


<!-- ACP2E-1083-->

* 当管理员用户手动将产品添加到已分配了许多简单产品的可配置产品时，Magento Open Source不再引发错误。 以前，Magento Open Source显示此错误： `Something went wrong with processing the default view and we have restored the filter to its original state`.

<!-- AC-2877-->

* 在禁用延期交货的部署中，购物者不能再将可销售量为0的可配置产品添加到购物车中。 现在Magento Open Source表示产品缺货。 [GitHub-35319](https://github.com/magento/magento2/issues/35319)

<!-- AC-2678-->

* 现在，通过从不同的商店视图导入具有多个选项的可配置产品来创建新产品，会按预期生成第一个产品的精确副本。 以前，在具有多个商店视图和区域设置的部署中，新产品可配置选项的排序顺序不正确，标题未转换为新商店视图的区域设置。 [GitHub-35200](https://github.com/magento/magento2/issues/35200)

<!-- AC-535-->

* 现在，所有缺货子产品的可配置产品在店面显示为缺货。

<!-- AC-6852-->

* 可配置的产品SKU和产品名称现在可以准确显示。 以前，将属性组移动到产品详细信息组上方后，名称和SKU显示为未定义 **[!UICONTROL Stores]** > **[!UICONTROL Attribute set]**. [GitHub-36309](https://github.com/magento/magento2/issues/36309)


### 优惠券

<!-- ACP2E-1053-->

* 管理优惠券代码工作流中添加了验证逻辑，以便在生成优惠券时强制实施优惠券代码设置。 以前，优惠券代码生成会忽略 **[!UICONTROL Code Length]** 设置时间 **优惠券数量** 值大于2500。

<!-- ACP2E-1029-->

* 现在，当使用PayPal Express付款方式结帐期间应用奖励优惠券时，会按预期将奖励积分添加到客户帐户。

<!-- ACP2E-1225-->

* 现在，当购物车价格规则将权重作为条件时，您可以在创建管理员订单期间应用优惠券代码。 以前，如果未为产品选择其他字段，则不会设置优惠券代码。 [GitHub-36271](https://github.com/magento/magento2/issues/36271)

<!-- ACP2E-1223-->

* 您现在可以按多个购物车价格规则筛选优惠券报表。 [GitHub-36272](https://github.com/magento/magento2/issues/36272)

<!-- AC-2812-->

* 现在，当管理员用户按下时，将应用并保存自定义选项 **[!UICONTROL Enter]** 配置具有自定义选项的产品时。 以前，您可以选择选项并将产品添加到订单，但选项未保存，并且系统会提示管理员用户重新选择产品选项。 [GitHub-35284](https://github.com/magento/magento2/issues/35284)

<!-- AC-6688-->

* 优惠券代码现在可以成功导出到Excel XML。 以前，生成的文件不包含所有选定的优惠券代码，但仅包含每个页面选择器中选定的项目数。[GitHub-36073](https://github.com/magento/magento2/issues/36073)


### cron

<!-- ACP2E-1243-->

* 此 `catalog_index_refresh_price` cron作业现在已成功执行。 以前，Magento Open Source在cron执行期间记录此错误： `report.ERROR: Cron Job catalog_index_refresh_price has an error: SQLSTATE[HY093]: Invalid parameter number: number of bound variables does not match number of tokens`.

### 货币

<!-- ACP2E-1012-->

* 在店面和管理产品价格中增加了自定义货币符号和价格之间缺少的空间。 添加了适当的条件和正则表达式以允许使用货币符号的自定义NBSP。 例如，IDRx 105.00以前显示为IDRx105.00。


### 电子邮件


<!-- ACP2E-1063-->

* 从管理员创建订单后，Magento Open Source不再向客户发送重复的电子邮件。

<!-- ACP2E-1200-->

* 在以下情况下，将不再发送管理员订单电子邮件： **[!UICONTROL Email order confirmation]** 设置已禁用。 [GitHub-36256](https://github.com/magento/magento2/issues/36256)

<!-- ACP2E-1151-->

* 对于具有自定义选项的产品，图像选项不再显示为贷项通知单、订单确认和发票客户电子邮件(默认HTML)中的模板标记。

### 框架


<!-- AC-6385-->

* 管理员用户现在可以成功打开管理员 **[!UICONTROL Store]** > **[!UICONTROL Configuration]** 页面（当中没有国家/地区时） **欧洲联盟国家** 设置(**[!UICONTROL Stores]** > **[!UICONTROL Configuration]** > **[!UICONTROL General]** > **[!UICONTROL Country options]** > **[!UICONTROL European Union Countries]**)。 以前，当管理员用户尝试打开此页时，Magento Open Source引发此错误： `TypeError: explode(): Argument #2 ($string) must be of type string, null given in /var/www/php/folder/vendor/magento/module-config/ViewModel/CountryFilter.php:46`. [GitHub-35901](https://github.com/magento/magento2/issues/35901)

<!-- AC-6361-->

* `jquery.cookie` 依赖项现在可以与JavaScript依赖项正常配合使用。 以前，不能将别名用于 `jquery/jquery.cookie`. [GitHub-35913](https://github.com/magento/magento2/issues/35913)

<!-- AC-3226-->

* 此 `bin/magento i18n:collect-phrases` 命令现在包含 `<title>` 导出的CSV文件中的文本。 [GitHub-35462](https://github.com/magento/magento2/issues/35462)

<!-- AC-6841-->

* `Magento\Framework\Code\Reader\ArgumentsReader::getParentCall()` 现在支持命名的构造函数参数。 您现在可以通过按名称设置参数来调用函数。

<!-- magento/magento2/pull/35567-->

* Magento Open Source不再错误地基于类别路径假定一个类别是另一个类别的父类别。 以前，当两个类别相邻，并且一个类别ID以另一个类别的类别ID开头时，Magento Open Source会假定这些类别具有相同的父类别。 [GitHub-32464](https://github.com/magento/magento2/issues/32464)

<!-- ACP2E-1287-->

* 错误现在按预期记录在 `exception.log` 文件。 以前，尽管错误会记录在 `system.log` 文件，错误未登录 `var/log/exception.log`.

<!-- AC-3758-->

* 商家现在可以指定自定义外部SMTP提供商。 [GitHub-26104](https://github.com/magento/magento2/issues/26104)

<!-- AC-3752-->

* 现在，您可以在运行Magento Open Source2.4.3-p2的部署中按预期重新授权OAuth集成。 以前，重新授权失败，出现以下错误： `The attempt to post data to consumer failed due to an unexpected error. Please try again later`. Magento Open Source还尝试解密未加密的值。 [GitHub-35313](https://github.com/magento/magento2/issues/35313)

<!-- ACP2E-1201-->

* 正确的 `rowId` 现在，当类别为 `urlKey` 为具有子类别的类别保存。 以前是错的 `categoryId` 在保存类别时传递 `URLKey`.

<!-- ACP2E-981-->

* 产品属性代码 `event` 已添加到保留的产品属性代码列表，可消除与使用店面中使用此名称的属性相关的错误。 以前，在以下情况下，应用程序会在产品详细信息和搜索/产品列表页面上引发此错误： `event` 已使用：  `report.CRITICAL: Error: Call to a member function getStatus() on string in /home/mer33515/public_html/ee24develop/magento2ee/app/code/Magento/CatalogEvent/Observer/ApplyIsSalableToProduct.php:23`.

<!-- AC-5985-->

* 现在，订购期间出现的店面验证错误消息会一致地显示。 以前，消息出现、折叠然后再次出现。 [GitHub-35651](https://github.com/magento/magento2/issues/35651)

<!-- AC-2943-->

* AMQP使用者不再因已弃用而失败 `trim()` 在运行PHP 8.1的部署中起作用。以前，当AMQP使用者在安装后启动时，Magento Open Source引发此错误： `Deprecated Functionality: trim(): Passing null to parameter #1 ($string) of type string is deprecated in .../vendor/magento/framework-amqp/Config.php on line 143`. [GitHub-35380](https://github.com/magento/magento2/issues/35380)

<!-- AC-2882-->

* 此 `getFilteredTimerIds` 方法现在可按预期工作。  类 `Magento\Framework\Profiler\Driver\Standard\Stat` 现已与PHP 8.1兼容。以前，在调用此方法时，Magento Open Source会引发异常。 [GitHub-35307](https://github.com/magento/magento2/issues/35307)

<!-- AC-2784-->

* 已移除对的依赖项 `imagemin-svgo` 库。

<!-- AC-2058-->

* 现在，当第一个注释以开头时，缩小模板流程可成功处理连续注释 `//`. [GitHub-34880](https://github.com/magento/magento2/issues/34880)

<!-- AC-2241-->

* 更正了由发出的数据库查询 `BundleGraphQl` 返回此错误的模块： `"debugMessage": "Notice: Undefined offset: 16 in vendor/magento/module-bundle-graph-ql/Model/Resolver/Options/Collection.php on line 130"`.[GitHub-34991](https://github.com/magento/magento2/issues/34991)


### 常规修复


<!-- ACP2E-1068-->

* Magento Open Source现在，当管理员用户选择 **[!UICONTROL Last 24 Hours]** 选项。 以前，Magento Open Source显示的时间范围不正确。 发生这种情况是因为数据库的时区保持不变。

<!-- ACP2E-1066-->

* 现在可以为整数和小数数量生成贷项通知单。 以前，仅支持整数数量。

<!-- ACP2E-1001-->

* 类型的客户邮政编码输入验证规则 **仅限数值** 现在可在 **[!UICONTROL Edit Customer Address]** 字段(**[!UICONTROL Store]** > **[!UICONTROL Attribute]** > **[!UICONTROL Customer Address]**)。 以前，保存客户地址信息时不会进行邮政编码验证。

<!-- ACP2E-873-->

* 现在，全球共享的客户帐户拥有的地址，这些地址根据当前网站的允许国家/地区列表进行验证并成功保存。 以前，这些帐户是根据客户注册网站中允许的国家/地区进行错误验证的。

<!-- AC-3167-->

* 在以下情况下，不再显示CMS页面层次结构中的痕迹导航 **[!UICONTROL Enable Hierarchy Functionality]** 已禁用。 以前，会显示痕迹导航，当购物者点击时，显示的是404页。 [GitHub-35513](https://github.com/magento/magento2/issues/35513)

<!-- AC-2567-->

* 通过管理员从所有网站中删除产品不再导致以下错误： `SQLSTATE[42000]: Syntax error or access violation`. [GitHub-35133](https://github.com/magento/magento2/issues/35133)

<!-- AC-2235-->

* 现在，超过最大登录失败尝试次数的客户可以在密码重置后登录。 [GitHub-34981](https://github.com/magento/magento2/issues/34981)

<!-- AC-2020-->

* 现在，当管理员用户添加新元素时，动态行组件会按预期运行。 以前，将新的简单产品添加到分组产品时，行组件的行为不正确。 [GitHub-34850](https://github.com/magento/magento2/issues/34850)

<!-- magento/magento2/pull/35598-->

* 更正了中的拼写错误和语法错误 `app/code/Magento/Backend/etc/menu.xsd` 文件。

<!-- magento/magento2/pull/35818-->

* 此 `app/code/Magento/Authorization/README.md` 文件已更新，以准确描述表创建。

<!-- magento/magento2/pull/35940-->

* 此 `recordLogin` 方法已更新，可在用户模型上设置登录值，并将正确的值保留在 `logdate` 和 `lognum` 字段 `admin_user` 表格。 以前，不会记录更新后管理员用户的登录尝试。

<!-- magento/magento2/pull/35990-->

* GitHub问题模板已转换为开发人员体验问题和功能请求的问题表单。

<!-- ACP2E-961-->

* 此 `Is required` 现在，可以按照管理员客户编辑表单的网站范围正确实施客户属性。

<!-- ACP2E-895-->

* 此 **[!UICONTROL Grid Filter Condition Type]** 当满足以下条件时，客户属性和客户地址属性的字段不再显示在属性编辑页面上 **[!UICONTROL Use in Filter Option]s** 设置已禁用。

<!-- AC-6020-->

* 现在，如果商家在创建产品时未能输入可选的SKU属性值，则Magento Open Source会显示信息性错误消息。 以前，当属性为可选属性时，应用程序会引发此异常： `Deprecated Functionality: trim(): Passing null to parameter #1 ($string) of type string is deprecated in /var/www/html/mg244/project-community-edition/vendor/magento/module-eav/Model/Entity/AbstractEntity.php on line 932`. [GitHub-35810](https://github.com/magento/magento2/issues/35810)

<!-- ACP2E-716-->

* 此 **[!UICONTROL Show my quotes]** 筛选 **[!UICONTROL My Quotes]** 页面现在可按预期工作。 以前，筛选结果包括其他管理员用户的引号。


### GraphQL


<!-- AC-1730-->

* `Types` 在GraphQL代码中实施多个接口的接口现在可以用 `&` 签名和 `,` 根据GraphQL `@doc`规范。

<!-- ACP2E-885-->

* 此 `setShippingAddressesOnCart` 突变现在支持将数字区域代码设置为 `region`. 以前，此变异对数字区域代码值不起作用。

<!-- ACP2E-1237-->

* 此 `products` 现在，查询仅返回与指定范围关联的审核。 以前，查询会返回来自所有商店的审核。

<!-- ACP2E-882-->

* 现在，在GraphQL请求期间会遵循类别权限。

<!-- AC-1805-->

* 此 `customer` 查询现在筛选具有指定的订单 `from` 和 `to` 正确范围。 [GitHub-31537](https://github.com/magento/magento2/issues/31537)

<!-- AC-5984-->

* 此 `product` 现在，查询在聚合中返回正确的类别数据。 以前， `attribute_code.category_uid` 返回值 `category_id` 而不是 `category_uid`.

<!-- AC-6084-->

* 此 `customerOrders` 查询不再引发 `\"model\" value should be specified`错误。 [GitHub-35852](https://github.com/magento/magento2/issues/35852)

<!-- ACP2E-894-->

* 此 `customer` 查询现在根据范围筛选订单。 现在，您可以指定查询是应按商店、网站还是全局筛选订单。

<!-- ACP2E-1172-->

* `categoryList` 现在，会返回锚定和未锚定父类别的准确产品计数。 新 `is_anchor` 已将属性添加到类别集合选定列列表。 以前，请求返回0个产品计数。 [GitHub-36300](https://github.com/magento/magento2/issues/36300)

<!-- AC-2500-->

* 此 `generateCustomerTokenAsAdmin` 现在，在创建令牌以登录到多存储部署中的非默认存储区时，变异按预期工作。 [GitHub-35084](https://github.com/magento/magento2/issues/35084)

<!-- AC-1731-->

* 此 `createEmptyCart` 现在，使用过期的令牌时，突变会按预期引发异常。 [GitHub-26112](https://github.com/magento/magento2/issues/26112)

<!-- AC-1965-->

* 购物车查询错误消息已提供更多信息。 [GitHub-34546](https://github.com/magento/magento2/issues/34546)

<!-- AC-2798-->

* `products` 查询回应汇总数据现在包含价格类型属性的正确值 `attribute_code` 和 `label`. [GitHub-28878](https://github.com/magento/magento2/issues/28878)

<!-- AC-6685-->

* 此 `products` 当数据库前缀具有非null值时，查询会按预期返回类别信息。 以前，它返回 `Internal server error`. [GitHub-36117](https://github.com/magento/magento2/issues/36117)

<!-- AC-1003-->

* 更正了的返回类型 `getCustomerIsGuest` 方法。 [GitHub-29529](https://github.com/magento/magento2/issues/29529)

<!-- B2B-2221-->

* 此 `Magento\CatalogGraphQl\Plugin\DesignLoader` 插件已重构。

<!-- B2B-2379-->

* 现在，当购物车由GraphQL突变初始化时，购物车重新加载只会按预期触发一次。 以前，购物车加载会触发针对库存库存的不必要的购物车重新验证，这会在每次加载购物车时消耗大量资源。

<!-- AC-1726-->

* 添加了 `gift_message` 键入到 `OrderItemInterface`. [GitHub-29418](https://github.com/magento/magento2/issues/29418)

<!-- AC-2454-->

* GraphQL响应中返回的产品选项现在仅包括用户所属的目录中的产品。 如果用户属于共享目录，则仅返回共享目录中的产品。 如果用户是访客或未包含在自定义共享目录中，则仅返回公共目录中的产品。


### Google ReCAPTCHA

<!-- AC-3179-->

* 中出现了reCAPTCHA错误 `var/log/exception.log` Google V3 reCAPTCHA管理员登录的文件已解析，不会记录任何错误消息。 以前，管理员用户配置其配置文件时，每隔几秒会引发一次以下错误 **[!UICONTROL Configuration]** > **[!UICONTROL Security]** > **[!UICONTROL Google reCAPTCHA Admin Panel]** 设置： `main.ERROR: Can not resolve reCAPTCHA parameter. {"exception":"[object] (Magento\Framework\Exception\InputException(code: 0): Can not resolve reCAPTCHA parameter. at /home/xxxxxxx/public_html/vendor/magento/module-re-captcha-ui/Model/CaptchaResponseResolver.php:25)"} []`. [GitHub-34975](https://github.com/magento/magento2/issues/34975)


### 图像

<!-- ACP2E-905-->

* 更新了PDF发票单的徽标大小建议。


### 导入/导出


<!-- ACP2E-957-->

* 导入与现有产品具有相同数字URL密钥的产品，但没有其终端字母字符，当 **产品URL后缀** 在管理员中，被设置为空。

<!-- AC-6588-->

* 此 `bin/magento app:config:import`命令现在可以成功导入 `config.php` 文件(当它包含 `cron` 表达式。 以前，导入失败，并出现以下错误： `Import failed: Notice: Trying to access array offset on value of type null in [..]/vendor/magento/module-config/Model/Config/Backend/Currency/Cron.php on line 66`. [GitHub-31428](https://github.com/magento/magento2/issues/31428)

<!-- ACP2E-1289-->

* 使用AWS S3作为远程存储时，完全导出现在可以正常工作。 以前，由于上传的文件大小，导出失败。

<!-- ACP2E-982-->

* 现在，当CSV文件中缺少库存数据列时，产品状态可正确导入。 以前，在产品导入后，会自动为产品分配默认来源，其数量设置为零，并且当CSV文件中缺少库存数据列时，其状态会列为缺货。

<!-- ACP2E-841-->

* 现在，如果导入包含100多条记录，则导入提前定价值将为新记录和更新的记录提供正确的计数。 以前，导入成功消息会提供错误的计数。

<!-- ACP2E-984-->

* 现在，导出的CSV文件包含以多种语言保存的类别名称的正确路径。 已为类别集合添加商店ID。 以前，导出的文件包含不同语言的混合路径，而不是从默认商店视图派生的类别路径。

<!-- ACP2E-1319-->

* 现在，通过导入在特定商店视图中更新产品的自定义选项已成功完成。 以前，如果将与产品相关的行拆分为多个批次，则会引发内部服务器错误。

<!-- AC-6926-->

* 此 `Fixer.io` 导入服务现在按预期工作。 现在已成功导入汇率。 [GitHub-36010](https://github.com/magento/partners-magento2ee/issues/36010)

### 索引

<!-- ACP2E-1296-->

* 现在，当目录包含的捆绑产品未分配给任何网站时，价格重新索引会成功运行。 以前，运行产品价格指数时出现以下错误： `Warning: Undefined array key <bundel product id > in vendor/magento/module-bundle/Model/ResourceModel/Indexer/Price/DisabledProductOptionPriceModifier.php on line 117`. [GitHub-35796](https://github.com/magento/magento2/issues/35796)

### 基础架构

<!-- AC-5972-->

* 与第三方的问题 `colinmollenhour/php-redis-session-abstract` 模块和PHP 8.1已解析。 [GitHub-35634](https://github.com/magento/magento2/issues/35634)


### 订购

<!-- ACP2E-998-->

* 现在，安装脚本中传递的订单前缀已正确添加到订单ID中。

<!-- ACP2E-790-->

* 现在，当订单包含具有长自定义文本值的产品时，订单详细信息页面会成功加载。 以前，不加载订单详细信息页面，并且 `sales_order_item.product_options` 如果产品包含文本自定义选项的长值，则列未正确存储。

<!-- AC-3178-->

* 部分退款的订单的店面订单状态现在准确。 以前，当应用部分退款时，订单在发运后仍处于处理状态。 [GitHub-35528](https://github.com/magento/magento2/issues/35528)

<!-- AC-3031-->

* 客户组现在准确地表示为 **未登录** 访客用户创建的订单。 以前，访客订单摘要中的客户组为空，这会影响确认电子邮件和订单导出。 [GitHub-35440](https://github.com/magento/magento2/issues/35440)

<!-- AC-2811-->

* 状态 **[!UICONTROL Closed]** 在发出贷项通知单并退款客户后，现在会按预期分配给虚拟订单。 以前，虚拟产品显示为 **[!UICONTROL Complete]** 在“状态”下拉列表中，但是 **[!UICONTROL Closed]** 从管理员添加注释时，订单页脚会出现注释。 [GitHub-35283](https://github.com/magento/magento2/issues/35283)

<!-- AC-6641-->

* 客人现在可以订购数量小于1的产品，产品数量现在严格按照 `float`. 以前，由于产品数量被严格键入为 `int`，产品数量小于一的订单失败，并显示以下消息： `Some of the products are disabled`. [GitHub-36060](https://github.com/magento/magento2/issues/36060)

<!-- ACP2E-1313-->

* 现在，在以下情况下，运费退款计算正确： **[!UICONTROL Apply discount on prices]** 配置选项设置为 **[!UICONTROL including taxes]**.

<!-- ACP2E-1199-->

* 现在，在存档订单后，发票、发运和贷项通知单网格会异步更新。

<!-- ACP2E-1194-->

* 重复订单不再因并发的相同GraphQL请求而产生。 现在，为避免创建重复订单，报价最多可锁定10秒，第二个请求会失败，并出现以下错误： `The cart isn't active` 或 `The order has already been placed and is currently processing`. 此锁定值可通过di配置 `Magento\Quote\Model\PlaceOrderMutex` 类 `lockWaitTimeout` 参数。 [GitHub-36274](https://github.com/magento/magento2/issues/36274)

<!-- ACP2E-860-->

* 公司属性值现在按预期显示在结帐工作流的帐单和送货地址部分中。 以前，公司属性无法在订单详细信息页面上正确显示，因为在订单创建期间存储设置不正确。 仅当满足以下条件时，属性值才会正确存储 **显示公司** 属性已设置为 **[!UICONTROL optional]** 对象 **主网站** 在多存储部署中。

<!-- ACP2E-1117-->

* 此 `customer_address_id` 在以下情况下，新账单地址的值现在会按预期设置 **[!UICONTROL My billing and shipping address are the same]** 复选框处于选中状态。 在设置送货地址的客户地址ID之前，还引入了一个附加条件来标识帐单地址是否与送货地址相同。

<!-- AC-6057-->

* 订单投放的并发问题已得到解决。 以前，如果两个来自不同浏览器的订单同时或几乎同时下达，则会为两个订单分配相同的订单ID。 [GitHub-35833](https://github.com/magento/magento2/issues/35833)

<!-- AC-6908-->

* 现在，在启用异步索引的情况下为免费产品下自动开具发票的订单可正常工作。 不会将任何条目添加到 `sales_order_grid or sales_invoice_grid` 这些订单的表。 以前，Magento Open Source引发异常，因为应用程序尝试在放置订单期间为网格编制索引，而不是依赖 `cron`. [GitHub-36334](https://github.com/magento/magento2/issues/36334)


### 支付方式


<!-- ACP2E-862-->

* 对于在送货和帐单地址中指定的国家/地区免除COD后，店面结账工作流中不再呈现COD支付方式。 以前，未实施此功能的管理员配置设置。

<!-- AC-1119-->

* 如果购物者未保存令牌，则管理员订单创建工作流的“付款”部分中将不再显示保管库付款信息。 [GitHub-33954](https://github.com/magento/magento2/issues/33954)

<!-- AC-2688-->

* 在购物车价格规则应用折扣后，自定义价格不再翻倍。 [GitHub-35154](https://github.com/magento/magento2/issues/35154)

<!-- ACP2E-1120-->

* 现在，当使用“零小计结帐”付款方式下达订单时，新订单挂起状态会按预期处理。

<!-- ACP2E-1121-->

* 现在，在通过GraphQL使用PayPal Express为访客购物者创建订单时，会遵循访客电子邮件设置。 以前，电子邮件地址集会被在PayPal帐户中设置的电子邮件地址覆盖。


#### Braintree


<!-- BUNDLE-3186-->

* 现在，订单ID已添加到支付交易记录的结算请求中。

<!-- AC-3030-->

* 当商家单击时，Magento Open Source不再引发以下错误 **[!UICONTROL Reports]** > **[!UICONTROL Braintree Settlement]**： `Error: Undefined constant Braintree\PaymentInstrumentType::ANDROID_PAY_CARD in /var/www/html/vendor/paypal/module-braintree-core/Ui/Component/Report/Listing/Column/PaymentType.php:49`. [GitHub-35434](https://github.com/magento/magento2/issues/35434)

<!-- BUNDLE-3043-->

* 此 `customerPaymentTokens` 当管理员的保险库关闭时，查询不再返回Braintree令牌。

<!-- BUNDLE-3107-->

* 此 **[!UICONTROL Pay Later]** 已为意大利和西班牙启用按钮和横幅。

<!-- BUNDLE-3137-->

* 启用Braintree付款方式后，管理员用户现在可以创建订单或重新排序。 以前，Magento Open Source引发此错误： `report.CRITICAL: Error: Call to a member function getMethodInstance() on null in /app/vendor/paypal/module-braintree-core/Block/Form.php:174`.

<!-- BUNDLE-3139-->

* Braintree现在，在启用BraintreePayPal并且 **[!UICONTROL Enable Card Payments]** 已禁用。 以前，进度条从未解析，并且Magento Open Source显示此控制台错误： `adapter.js:66 Uncaught TypeError: Cannot read properties of undefined (reading 'clientToken')at Object.getClientToken (adapter.js:66:66)`. [GitHub-35961](https://github.com/magento/magento2/issues/35961)

<!-- BUNDLE-3140 3141-->

* 实施了欺诈防护、自动清算行支付和本地支付方法Web挂钩。 欺诈防护Web挂接仅在Braintree中做出风险决策时触发。 只有在ACH支付更新至 `settled` 或 `settlement decline`.

<!-- BUNDLE-3143-->

* 此 **[!UICONTROL Tagline]** 和 **[!UICONTROL Layout]** 配置字段已从所有页面中删除 **[!UICONTROL PayPal]** 按钮。

<!-- ACP2E-1229-->

* 当购物者更新其帐单地址时，Braintree保管库付款方式选项在结账工作流中保持选中状态。 以前，当购物者取消选择 **[!UICONTROL My billing and shipping address are the same]** 按钮。

<!-- BUNDLE-3184-->

* 现在，在以下情况下，PayPal交易传递行项目： **[!UICONTROL Send Line Items]** 配置设置从管理员启用。

<!-- BUNDLE-3187-->

* ACH支付方式的验证逻辑 **[!UICONTROL Account Number]** 字段现在支持4到17位文本。

<!-- BUNDLE-3043-->

* 此 `customerPaymentTokens` 从管理员关闭保管库时，查询不再返回Braintree令牌。

<!-- BUNDLE-3137-->

* 启用Braintree付款方式后，管理员用户现在可以为客户创建订单或重新排序。 以前，Magento Open Source引发此错误： `report.CRITICAL: Error: Call to a member function getMethodInstance() on null in /app/vendor/paypal/module-braintree-core/Block/Form.php:174`

<!-- BUNDLE-3139-->

* 现在，购物者可以在店面使用Braintree支付方式，店面为 **[!UICONTROL Enable Card Payments]** 已被禁用。 以前，Magento Open Source引发此JavaScript错误： `_adapter.js:66 Uncaught TypeError: Cannot read properties of undefined (reading 'clientToken')at Object.getClientToken (adapter.js:66:66).`


#### 性能

<!-- ACP2E-1028-->

* 在对大型目录进行部分重新索引期间，价格索引器现在会按预期删除已过时的数据。 以前，重新索引过程会在替换过期记录之前删除这些记录，这会导致产品偶尔从店面中暂时消失。 [GitHub-35616](https://github.com/magento/magento2/issues/35616)

<!-- ACP2E-963-->

* 性能 `bin/magento/setup:upgrade` 命令已得到改进。 以前，此命令会重新创建数据库触发器，这会导致在命令执行期间出现严重的停机。 此外，索引器未恢复为计划模式并保持保存模式。 [GitHub-33386](https://github.com/magento/magento2/issues/33386)

<!-- ACP2E-1016-->

* 现在，按API更新层价格的执行速度更快。 以前，不必要更新层价格 `SELECT` 查询，在将许多客户组分配给产品时，这些查询会延迟执行。

<!-- ACP2E-1307-->

* 已优化包含目录小部件产品列表的页面的加载。 以前，直接从数据库加载非全局属性。

### 报告

<!-- ACP2E-1104-->

* “订单总计”报表 **起始日期** 和 **到** 现在，从日期选取器中选择日期后，日期可正确显示。

<!-- BUNDLE-3147-->

* 此 `ANDROID_PAY_CARD` 中的常量 `Braintree/Ui/Component/Report/Listing/Column/PaymentType.php` 已替换 `GOOGLE_PAY_CARD`. 这可解决Braintree报表中的问题。

### 审核

<!-- ACP2E-1214-->

* 对特定范围具有受限访问权限的管理员用户现在可以按预期删除产品评审。

### 角色

<!-- ACP2E-1277-->

* 添加了缺失的ACL **[!UICONTROL Stores]** > **[!UICONTROL Configuration]** > **[!UICONTROL Services]** > **[!UICONTROL OAuth]**. 以前，在设置角色权限时，无法定义对此OAuth配置设置的访问权限。


### 搜索

<!-- ACP2E-989-->

* 现在，当满足以下条件时，可在引号中搜索字符串： **[!UICONTROL Minimum Terms to Match]** 已启用配置设置。 以前，Magento Open Source引发此错误： `{"error":{"root_cause":[{"type":"parsing_exception","reason":"[match_phrase] query does not support [minimum_should_match]' ...`.

<!-- ACP2E-877-->

* 此 **注册点** 现在，在订单创建过程中，销售订单客户网格上的客户记录搜索过滤器可按预期工作。

<!-- ACP2E-783-->

* 多词查询的搜索建议质量已得到改进。

<!-- AC-6768-->

* 在以下情况下，搜索结果现在包含所有可用产品的缺货选项输出 **[!UICONTROL Display Out Of Stock Products]** 已启用 [GitHub-36055](https://github.com/magento/magento2/issues/36055)


### 配送

<!-- ACP2E-670-->

* 当免运费购物车规则设置为仅匹配购物车中的部分项目时，可以正确计算FedEx、USPS和UPS的运费。

<!-- AC-937-->

* 当订单总额小于符合免费发运条件的指定最小订单金额时，“管理发运”页面不再显示免费发运选项。 [GitHub-33697](https://github.com/magento/magento2/issues/33697)

<!-- AC-838-->

* Magento Open Source现在向管理员客户致敬 **[!UICONTROL Show Company]** 显示送货或客户地址时的配置设置。 禁用此设置后，送货公司将不再包含在送货、客户地址或数据库订单记录中。 以前，尽管设置被禁用，仍会显示该信息。 [GitHub-33729](https://github.com/magento/magento2/issues/33729)

<!-- magento/magento2/pull/35631-->

* 在估计装运时，删除了对报价的多余的保存操作。

<!-- magento/magento2/pull/35817-->

* `storeId` 范围现在直接从应用 `$request->getStoreId()` 以确保在管理员用户创建报价时不会丢失范围。 以前，当使用第三方模块从管理员处创建报价时，有时会出现送货方法问题。

<!-- ACP2E-1304-->

* 现在，将为以下产品生成对SEO友好的URL： `url_key` 设置将在存储视图级别被覆盖。 以前，类别产品URL不会重定向到SEO友好的URL。

<!-- ACP2E-1196-->

* 对运输成本应用折扣时，Magento Open Source不再引发最小订单金额错误。

<!-- ACP2E-1190-->

* 现在，在对装运应用折扣后应用税时，可以正确计算装运退款。

<!-- ACP2E-910 AC-3182-->

* 通过GraphQL请求购物车的所有适用促销 `cart` 查询会一起返回。 促销活动包括行项目折扣、购物车规则/折扣、优惠券、礼品卡和商店信用。 [GitHub-35545](https://github.com/magento/magento2/issues/35545)

<!-- AC-2363-->

* 此 `setShippingMethodsOnCart` 突变现在返回所选配送方法的值，包括税费。 [GitHub-31206](https://github.com/magento/magento2/issues/31206)

<!-- AC-1096-->

* 现在，GraphQL响应中会按预期传递唯一的送货ID，并且订单的送货详细信息会发送到GraphQL查询的多个地址。

### 税金


<!-- AC-3201-->

* 此 **[!UICONTROL Display Zero Tax Subtotal]** 现在，配置设置可按预期应用于提供多种配送方法的部署中的订单。 以前，在选择配送方式之前，即使禁用了此设置，结账期间购物车页面上也会显示零税字段。 [GitHub-35561](https://github.com/magento/magento2/issues/35561)

<!-- AC-3157-->

* Magento Open Source现在可以在运行PHP 8.1的部署中的storefront category页面上显示已分组的含税产品。以前，Magento Open Source不显示产品列表，并引发此异常： `main.CRITICAL: Exception: Deprecated Functionality: ucfirst(): Passing null to parameter #1 ($string) of type string is deprecated in /var/www/m24/vendor/magento/module-tax/Pricing/Render/Adjustment.php on line 188 in /var/www/m24/vendor/magento/framework/App/ErrorHandler.php:61`. [GitHub-35500](https://github.com/magento/magento2/issues/35500)

<!-- ACP2E-1258-->

* 商家不能再将计划的更新移动到包含相同规则ID的其他更新。 以前，当更新移动到包含相同规则ID的其他更新时，购物车价格规则的计划更新会创建重复的计划。

<!-- ACP2E-1295-->

* 现在，当没有与客户地址关联的VAT ID时，自动客户组分配起作用。 如果地址不含增值税ID，则被视为属于非增值税注册客户，而Magento Open Source会将客户组更改为非增值税组。 以前，何时 **[!UICONTROL Enable Automatic Assignment to Customer Group]** 启用，则不会自动将客户帐户分配给 `customerGroup` 从客户帐户中删除VAT ID的时间。

<!-- ACP2E-493-->

* 现在，在暂存预览模式下，将为暂存目录规则显示正确的动态块。 以前，会显示不相关的动态块。

<!-- ACP2E-1080-->

* 在结帐期间应用多项发运时，发票和贷项通知单的“税务汇总”部分现在可以正确显示多项税。

<!-- ACP2E-1076-->

* 当含税订单小计以及固定产品税额超过购物车页面上的购物车规则条件时，不再应用折扣。 以前，即使总计超过购物车规则条件，也会应用折扣。

<!-- ACP2E-913-->

* `VAT_ID` 现在可以在结帐时通过GraphQL请求为访客添加。


### 测试

<!-- ACP2E-1171-->

* 修复了不同版本的单元测试错误 `ICU` 和 `libxml` 库。

<!-- ACP2E-1134-->

* 开发人员现在可以指示系统在特定的存储视图中执行数据夹具。 新的可选参数 `scope` 接受 `string` 对应于存储夹具别名的属性。

<!-- ACP2E-1133-->

* 添加了使用可选功能生成数据夹具的多个实例的功能 `count` 参数。

<!-- AC-6860-->

* 已删除非本机 `array_first` 函数来自MFTF框架中的开发依赖关系。

### 翻译和区域设置

<!-- ACP2E-912-->

* 现在，内联翻译可正确处理特殊字符，包括位于SCRIPT标记中的短语中的扩展Unicode字符。 以前，在使用内联翻译时，日语字符在编辑的脚本中呈现不正确。

<!-- ACP2E-844-->

* 此 `ñ` 产品名称中的字符现在可转换为 `n` 在URL密钥生成期间。

<!-- AC-3499-->

* 运行的输出 `bin/magento i18n:collect-phrases` 现在包含邮件模板翻译 `depend` 结构如预期。 [GitHub-35449](https://github.com/magento/magento2/issues/35449)

<!-- ACP2E-1135-->

* 现在，可直接在产品页面属性集（组合框）中输入日语字符。 以前，在MacOS上运行Firefox浏览器时，直接在此组合框中输入日语字符会导致字符更改或删除。 此 `textInput` HTML属性可以更好地处理所有浏览器中的日语字符转换，它已经取代了 `Value` 和 `valueUpdate` 属性。

<!-- ACP2E-1238-->

* 此 `getOptions` 方法现在可以正确提取 `price` 基于存储视图的属性标签值。 以前， `price` 在GraphQL操作期间，因不正确的存储视图而翻译了属性。


### UI


<!-- ACP2E-1018-->

* 现在，网站特定的货币按预期用于“管理产品”网格中的“特殊价格”、“成本”和“MSRP”列。 以前，当按商店视图筛选以表示特殊价格时，管理目录产品网格中不显示正确的货币符号。

<!-- ACP2E-980-->

* 产品自定义选项的拖放功能现在可按预期工作。 现在，当可自定义选项网格中有多个页面可用时，您可以将可自定义选项从一个页面移动到另一个页面。

<!-- ACP2E-866-->

* 管理员仪表板图表现在按预期显示从当前日历年年初到当前日期的YTD时间间隔。 以前，日期范围包括超过12个月。

<!-- AC-3088-->

* 添加了storefront主页中缺少的默认favicon。 [GitHub-35493](https://github.com/magento/magento2/issues/35493)

<!-- ACP2E-1025-->

* 管理员现在成功显示每个管理员用户的最新登录日期。 以前，当管理员用户首次登录管理员时，管理员用户网格上显示一个空的登录日期值。


<!-- AC-3762-->

* 预览电子邮件模板功能(**[!UICONTROL Marketing]** > **[!UICONTROL Communications]** > **[!UICONTROL Email Templates]**)现在可以正确显示模板。 以前，预览图像会被截断。 [GitHub-35697](https://github.com/magento/magento2/issues/35697)

<!-- magento/magento2/pull/35656-->

* 添加了 `new-shipping-address-modal` 类以支持设置新送货地址模式的样式。

<!-- magento/magento2/pull/35738-->

* 在下面添加了信息性文本 `Search Weight` 属性 `Storefront Properties` 管理员输入字段 **[!UICONTROL Stores]**  > [!UICONTROL Attributes] > **[!UICONTROL Product]**.

<!-- ACP2E-1323-->

* 现在，电子邮件预览在单独的选项卡中打开，而不是在弹出窗口中打开，这样可以更全面地查看电子邮件内容。 以前，电子邮件内容被截断。

<!-- ACP2E-1299-->

* 用户角色网格（管理员）的过滤器功能 **[!UICONTROL System]** > **[!UICONTROL Permissions]** > **[!UICONTROL User roles]** > **[!UICONTROL Administrators]**)现在可按预期工作。 数组值现在单独处理。 以前，当您尝试在此网格中输入查询时，Magento Open Source引发此控制台错误，并且页面未加载： `Uncaught TypeError: Cannot read properties of null`. [GitHub-35993](https://github.com/magento/magento2/issues/35993)

<!-- ACP2E-328-->

* 在通过REST API创建客户时，添加了属性值的验证。 现在，如果提供了无效的属性值，创建过程将失败。 以前，无法验证性别，因为性别不是必填字段。 在创建客户期间，传入的性别值保存在 `customer_entity` 表格。

<!-- ACP2E-1105-->

* 现在，结账期间添加的地址将保持其预期格式。 以前，会忽略空白行。

<!-- ACP2E-897-->

* 更改产品网格的列网格视图以及为自定义视图选择新列不再触发“选择所有网格列”操作。 以前，列框消失，并选中或取消选中网格中的产品。 [GitHub-36302](https://github.com/magento/magento2/issues/36302)

<!-- ACP2E-1245 1405-->

* 管理员用户现在可以成功清除管理员已完成任务日志。 以前，管理员显示以下错误： `Something went wrong`. [GitHub-36255](https://github.com/magento/magento2/issues/36255)

<!-- AC-7525-->

* 主题标题设置 `Welcome Text` 现在可以包含单引号字符。 以前，Magento Open Source引发此JavaScript错误： `Uncaught SyntaxError: Unable to process binding "ifnot: function(){return customer().fullname }"`.

### URL重写

<!-- ACP2E-808-->

* 将产品可见性更改为 **[!UICONTROL Not Visible Individually]** 在全局所有存储视图作用域中，现在只删除未覆盖visibility属性的存储视图的URL重写。 通过这种方式更改产品可见性也会为所有商店视图(包括已覆盖URL键属性（但不包括可见性设置）生成URL重写。 以前，当可见性设置更改时，不会应用URL重写规则。

### Web API框架

<!-- ACP2E-1207-->

* REST API `DELETE /rest/V1/products/:sku/media/:entryId` 现在，如果图像未从产品中删除，则返回错误消息，因为该图像已分配给其他商店视图中的角色。 以前，即使未成功删除图像，API也会返回成功的响应。

<!-- ACP2E-1155-->

* 商家现在可以使用REST API为总金额为零的订单创建贷项通知单。 以前，Magento Open Source显示此错误： `The order does not allow a credit memo to be created. The credit memo's total must be positive. We can't create a credit memo for the invoice/order`.

<!-- ACP2E-1136-->

* 使用REST API更改产品的网站分配后，“管理员产品编辑”页面现在可准确反映产品分配。 [GitHub-36281](https://github.com/magento/magento2/issues/36281)

<!-- ACP2E-863-->

* 在批量REST API请求更新产品期间，多选属性无法再包含重复的选项ID。 以前，在发送批量API请求以更新产品时，您可以为多选属性设置重复的选项ID。 当该多选属性配置为包含在分层导航中时，EAV索引失败 `Duplicate entry` 错误。

<!-- ACP2E-778-->

* 购物车中的产品名称现在会按预期使用指定的商店视图的值。 以前，购物车中的产品名称始终在REST API购物车响应中返回默认商店视图值。

<!-- AC-5986-->

* 现在可以使用REST API更新购物车项目自定义选项值。 [GitHub-35768](https://github.com/magento/magento2/issues/35768)

<!-- AC-1330-->

* 超过20个的大量API请求 `sourceItems` 现在，在启用了清单的部署中成功完成。

<!-- ACP2E-1044-->

* 修复器货币服务现在与通过ApiLayer生成的密钥一起按预期工作，并且正确导出汇率。 以前，当商家尝试通过管理员导入汇率时，Magento Open Source会引发错误。

<!-- ACP2E-726-->

* 您现在可以使用REST API `/rest/V1/bulk?searchCriteria[filter_groups]` 请求按搜索条件查询批量操作。 以前，返回以下错误： `report.CRITICAL: Report ID: webapi-624bbb1db96c4; Message: Item (Magento\AsynchronousOperations\Model\Operation) with the same ID "0" already exists.`

<!-- magento/magento2/pull/36147-->

* 现在，使用管理基本价格API在管理员和店面目录搜索页面上正确更新了产品价格。 [GitHub-33767](https://github.com/magento/magento2/issues/33767)


### 愿望清单


<!-- ACP2E-1013-->

* 现在，购物者可以在登录后将产品添加到愿望清单。 以前，由于登录后表单键验证出现问题，随添加到愿望清单请求一起提交的表单键无效。

<!-- ACP2E-341-->

* 来宾客户通过确认电子邮件确认其帐户后，产品现在会按预期从产品列表和查看页面添加到愿望清单。 以前，产品在帐户确认后不会添加到愿望清单。

<!-- ACP2E-1175-->

* 此 `addProductsToWishlist` 现在，当购物者尝试将项目添加到愿望列表（该产品具有无效值）时，查询会返回信息性错误消息 `select` 自定义选项。 以前，下拉自定义选项值的服务器验证缺失，导致数据库中的值无效。 因此，终结点返回此内部服务器错误： `GraphQL endpoint returns Internal server error with "Call`.


## 社区投稿

我们感谢更广泛的Magento Open Source界，并感谢他们对这一版本的贡献。

社区工程团队 [Magento参与者](https://magento.com/magento-contributors) 按月、季度和年维护最佳贡献个人和合作伙伴的列表。 在该参与者页面中，您可以单击链接，以访问他们在GitHub上合并的PR。

### 合作伙伴投稿

下表列出了合作伙伴的贡献。 此表列出了提出拉取请求的合作伙伴、外部拉取请求编号以及与其关联的GitHub问题编号（如果可用）。

{{$include /help/_includes/release-notes/engcomm-2-4-6-partner.md}}

### 个人投稿人

下表列出了来自社区成员的贡献。 此表列出了提出拉取请求的社区成员、外部拉取请求编号以及与其关联的GitHub问题编号（如果可用）。

{{$include /help/_includes/release-notes/engcomm-2-4-6-issues.md}}

## 系统要求

我们的技术栈栈是基于PHP和MySQL构建的。 有关更多信息，请参阅 [系统要求](../../../installation/system-requirements.md).

## 安装和升级说明

您可以使用安装Magento Open Source2.4.6 [Composer](../../../installation/composer.md).
