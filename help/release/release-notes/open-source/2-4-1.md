---
title: Magento Open Source2.4.1发行说明
description: 了解2.4.1Magento Open Source版本中的新增功能、增强功能、错误修复和已知问题。
source-git-commit: 4c3a5b6462668993dcfb0ecb9327a7ffc47ced44
workflow-type: tm+mt
source-wordcount: '14729'
ht-degree: 0%

---


# Magento Open Source2.4.1发行说明

Magento Open Source2.4.1引入了性能和安全性增强功能。 安全增强包括对 `SameSite` 属性，并为支付相关和订单相关API端点以及下单店面页面添加了CAPTCHA保护。

此版本包括对2.4.0中包含的核心质量的所有改进、对核心代码的150多项新修复，以及15项安全增强功能。 它包括我们的社区成员解决的近300个GitHub问题。 这些社区贡献的内容包括对核心代码进行细微清理，以及在GraphQL中进行重大增强。

2.4.0中识别的所有已知问题已在此版本中修复。

{{bics}}

## 安全修补程序可用

商家现在无需应用完整的季度版本（例如2.4.0-p1）提供的数百项功能修复和增强功能，即可安装对时间敏感的安全修复。 修补程序2.4.0.1（编辑器包2.4.0-p1）是一个安全修补程序，它为之前的季度版本2.4.0中已识别的漏洞提供了修补程序。应用于2.4.0版本的所有修补程序都包含在此安全修补程序中。 (A) *热修复* 对解决特定问题或错误的已发布版本进行了修复。)

有关安全修补程序的一般信息，请参阅 [引入新的安全修补程序版本](https://community.magento.com/t5/Magento-DevBlog/Introducing-the-New-Security-Patch-Release/ba-p/141287). 有关下载和应用安全修补程序（包括修补程序2.3.5-p2）的说明，请参阅 [快速启动本地安装](../../../installation/composer.md). 安全修补程序仅包含安全错误修复，而不包含完整修补程序中包含的其他安全增强功能。

## 应用 `AC-3022.patch` 继续提供DHL作为航运公司

DHL已引入模式版本6.2，并将在不久的将来弃用模式版本6.0。 Adobe Commerce 2.4.4及更早版本（支持DHL集成）仅支持版本6.0。部署这些版本的商户应适用 `AC-3022.patch` 尽早将DHL作为航运公司继续提供。 请参阅 [应用补丁程序以继续提供DHL作为运输承运人](https://support.magento.com/hc/en-us/articles/7707818131597-Apply-a-patch-to-continue-offering-DHL-as-shipping-carrier) 有关下载和安装修补程序的信息，知识库文章。

## 其他发行信息

尽管这些功能的代码与季度发行版捆绑在一起，但其中一些项目(例如，Progressive Web Application(PWA)Studio)也是独立发布的。 这些项目的错误修复会在特定于项目的单独发行信息中进行记录，该信息可在每个项目的文档中找到。

## 亮点

在此版本中查找以下亮点。

### 大量安全性增强

此版本包括超过15项安全修复和平台安全改进。 所有安全修复都已支持到2.4.0-p1和2.3.6。

#### 超过15项安全增强功能，可帮助关闭远程代码执行(RCE)和跨站点脚本(XSS)漏洞

迄今为止，尚未发生与这些问题相关的已确认攻击。 但是，某些漏洞可能会被利用来访问客户信息或接管管理员会话。 大多数这些问题要求攻击者首先获得对管理员的访问权限。 因此，我们提醒您采取一切必要步骤保护您的管理员，包括但不限于以下工作：IP， [双重身份验证](https://devdocs.magento.com/guides/v2.4/security/two-factor-authentication.html)，使用VPN，使用唯一位置，而不是 `/admin`，密码卫生良好。 请参阅 [可用于Magento的安全更新](https://helpx.adobe.com/security/products/magento/apsb20-59.html) 以讨论这些修复的问题。

#### 其他安全增强功能

此版本的安全改进包括：

* **验证码** 已在以下产品领域添加了保护：

   * 将订单放在店面页面和REST和GraphQL端点 <!-- MC-36067-->
   * 与支付相关的REST和GraphQL端点。<!-- MC-36064-->

   默认情况下，会禁用这些其他页面的验证码保护。 可以在管理员上启用该功能，其方式与CAPTCHA涵盖的其他页面相同。 此保护已作为一种反暴力机制添加，以保护商店免受梳理攻击。 请参阅 [验证码](https://docs.magento.com/user-guide/stores/security-captcha.html).

* **支持Cookie的SameSite属性**. 为支持新Cookie分类系统的Google Chrome实施，已更新处理Cookie的应用程序类以支持 `SameSite` cookie属性。 此属性设置为 `Lax` 默认情况下，可以显式覆盖。 <!-- MC-35389-->

* **增强的安全扫描工具**. Adobe与 [乐观的安全性](https://sansec.io/)是防止数字窃取的领头羊，将其包含8700个威胁签名的数据库集成到安全扫描工具中。 这种合作关系将允许商家通过主动检测恶意软件和减少误报来实时分析其网站的安全状态。 商户可通过访问https://account.magento.com/scanner注册该工具。 有关更多信息，请参阅 [使用增强的安全扫描工具保护店面](https://magento.com/blog/magento-news/secure-your-storefront-enhanced-magento-security-scan-tool) 博客文章。

{{cve-notice}}

### 基础架构改进

此版本包含对核心质量的增强，这改进了框架的质量以及这些功能领域：客户帐户、目录、CMS、OMS、导入/导出、促销和定位、购物车和结账，以及暂存和预览。

### 性能改进

* **减少Redis与Magento之间的网络传输大小**. 现在，插件列表配置是在执行 `bin/magento di:compile` 命令。 此配置信息将根据范围写入生成的元数据文件夹。 以前，此信息存储在缓存中。 由此产生的性能改进包括减少网络高速缓存大小和许多方案的执行时间。<!-- MC-31617-->

* **增强了消息队列用户性能**. 三种新配置设置支持减少消费者队列CPU消耗。 这些可选参数可增强对用户的控制并保存服务器资源。 请参阅 [配置消息队列](https://developer.adobe.com/commerce/php/development/components/message-queues/configuration/) 对 `maxIdleTime`, `sleep`和 `onlySpawnWhenMessageAvailable` 参数。

* **缩短了执行时间** 表示 `bin/magento` 中。

### Adobe Stock集成

此版本包括Adobe Stock集成v2.1.0。

### 新媒体集

新媒体集现在默认在管理员中启用。 商家现在可以对媒体库中的图像执行以下操作：

* 批量删除图像
* 通过识别店面未使用的重复图像和图像来优化媒体存储
* 按图像在中使用的店面区域过滤图像，包括产品和类别内容以及CMS块
* 使用图像元数据
   * 查看上传到媒体库的图像中的元数据
   * 编辑图像元数据（标题、描述和关键词）
   * 按图像的元数据搜索图像

### GraphQL

此版本为以下功能添加了GraphQL覆盖：

* **产品评论**. 客人和客人可以撰写产品评论。 客户可以检索其产品审阅历史记录。 请参阅 [创建产品审阅](https://devdocs.magento.com/guides/v2.4/graphql/mutations/create-product-review.html) 和 [productReviewRatingsMetadata查询](https://devdocs.magento.com/guides/v2.4/graphql/queries/product-review-ratings-metadata.html) 有关检索有关审阅基础结构的信息的信息。<!-- MC-32349-->

* **礼品选项**. 所有客人和客人都可以在订单上添加礼品。 客户还可以在订单中添加礼品包装、礼品收据和打印卡。 请参阅 [`setGiftOptionsOnCart` 突变](https://devdocs.magento.com/guides/v2.4/graphql/mutations/set-gift-options.html) 和 [`updateCartItems` 突变](https://devdocs.magento.com/guides/v2.4/graphql/mutations/update-cart-items.html)<!-- MC-32345-->

* **订单历史记录**. 所有客户都可以查看其订单历史记录的详细信息，包括发票、发运和退款。<!-- MC-20635-->

* **添加到购物车**. 的 [`addProductsToCart` 突变](https://devdocs.magento.com/guides/v2.4/graphql/mutations/add-products-to-cart.html) 用于向活动购物车添加任何类型的产品。 我们建议使用此突变而不是单用途突变，例如 `addSimpleProductsToCart`. _Yaroslav Rogoza在拉取请求中提交的修复 [27914](https://github.com/magento/magento2/pull/27914)_. [GitHub-28524](https://github.com/magento/magento2/issues/28524)  <!-- MC-21513-->

* **存储的付款方法**. 已登录的客户现在可以将付款详细信息(包括Braintree信用卡和PayPalBraintree)存储在我的帐户中。

* **在Magento Open Source中支持愿望清单**. 您可以 [添加项目](https://devdocs.magento.com/guides/v2.4/graphql/mutations/add-products-to-wishlist.html) 到 [更新项目](https://devdocs.magento.com/guides/v2.4/graphql/mutations/update-products-in-wishlist.html) 和 [删除项目](https://devdocs.magento.com/guides/v2.4/graphql/mutations/remove-products-from-wishlist.html) 愿望清单上。

* **改进了客户帐户管理**. 我们已将 [`createCustomerV2`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/create-customer-v2.html) 和 [`updateCustomerV2`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/update-customer-v2.html) 为管理客户账户而进行突变。 这些新的突变需要与 `createCustomer` 和 `updateCustomer` 突变。 要更改客户的电子邮件地址，请使用 [`updateCustomerEmail`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/update-customer-email.html) 变异。

* **支持Payflow Pro Vault**. 为 [Payflow Pro Vault](https://devdocs.magento.com/guides/v2.4/graphql/payment-methods/payflow-pro-vault.html) 付款方式。 _由Oleh Usik在拉取请求中提交的修复 [28821](https://github.com/magento/magento2/pull/28821)_. [GitHub-28520](https://github.com/magento/magento2/issues/28520)

* 更新了GraphQL [`storeConfig` 查询](https://devdocs.magento.com/guides/v2.4/graphql/queries/store-config.html) 以包含新的客户配置设置。 _由Oleh Usik在拉取请求中提交的修复 [27876](https://github.com/magento/magento2/pull/27876)_. [GitHub-28521](https://github.com/magento/magento2/issues/28521)

* 添加了 [`requestPasswordResetEmail` 突变](https://devdocs.magento.com/guides/v2.4/graphql/mutations/request-password-reset-email.html)，这会触发所提供电子邮件地址的密码重置电子邮件。 _由Oleh Usik在拉取请求中提交的修复 [27876](https://github.com/magento/magento2/pull/27876)_. [GitHub-28521](https://github.com/magento/magento2/issues/28521)

* **Klarna GraphQL**. 在 [克拉纳的支付方式](https://devdocs.magento.com/guides/v2.4/graphql/payment-methods/klarna.html) 和 [`createKlarnaPaymentsSession`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/create-klarna-payments-session.html)

请参阅 [GraphQL开发人员指南](https://devdocs.magento.com/guides/v2.4/graphql/) 以了解这些增强功能的详细信息。

### PWA Studio

PWA Studiov8.0.0引入了新功能和增强功能：

* 对维尼亚风格指南进行了更新，该指南适用于设计令牌、排版规则、颜色、核心组件和页面布局。 <!-- PWA-519 419-->

* 改进了Venia迷你购物车体验 <!-- PWA-236-->

* 在Venia店面上支持多个区域设置和本地化内容 <!-- PWA-295-->

* 对Venia店面的“我的账户”体验进行了多项改进 <!-- PWA-247-->

请参阅 [兼容性](https://developer.adobe.com/commerce/pwa-studio/integrations/adobe-commerce/version-compatibility/) 以获取PWA Studio版本及其兼容版本的列表。 有关增强功能和错误修复的信息，请参阅 [PWA Studio版本](https://github.com/magento/pwa-studio/releases).

### 功能测试框架

MFTF 3.1.0现已可用。 请参阅 [功能测试框架Changelog](https://github.com/magento/magento2-functional-testing-framework/blob/develop/CHANGELOG.md).

### 供应商开发的扩展

有关此版本的功能和更改的更新，请参阅以下文章：

* [Amazon Pay](https://docs.magento.com/user-guide/payment/amazon-pay.html)

* [Braintree](https://docs.magento.com/user-guide/payment/braintree.html)

* [dotdigital Engagement Cloud](https://docs.magento.com/user-guide/marketing/dotdigital/engagement-cloud.html)

* [克拉纳](https://docs.magento.com/user-guide/payment/klarna.html)

* [顶点云](https://docs.magento.com/user-guide/tax/vertex.html)

* [Yotpo产品评论](https://docs.magento.com/user-guide/marketing/yotpo-reviews-intro.html)

## 已修复的问题

我们修复了2.4.1核心代码中的数百个问题。

### 安装、升级、部署

<!-- MC-36113-->

* 使用依赖于CLI命令中存储模块API的第三方扩展进行安装不再失败。 以前，应用程序会显示以下错误消息： `The default website isn't defined. Set the website and try again`. 这是2.4.0中的已知问题。

<!-- MC-33273-->

* `bin/magento setup:di:compile` 不再引发致命错误。 以前，应用程序在您第一次运行此命令时抛出错误，但第二次执行会导致成功编译。

<!-- MC-34429-->

* 在 `Magento\Framework\Encryption\Encryptor`.

<!-- MC-36231-->

* 现在，当运行后未部署某些主题时，应用程序会显示一则信息性错误消息 `bin/magento setup:static-content:deploy`. 以前，当部署成功完成但并非部署了所有包时，应用程序不会显示错误。 如果通过启用并行处理来执行命令，并且每个主题需要更多的时间来部署，然后达到指定的最大执行时间，则此命令可以成功完成，尽管主题未部署。

<!-- MC-35001-->

* 的 **使用默认** 用于Klarna支付的复选框(**商店** > **配置** > **销售** > **付款方法** > **克拉纳**)现在在网站范围发生更改时仍按预期进行检查。

<!-- MC-33788-->

* 升级不再导致Galera群集突然失败。 以前，Galera群集在升级后立即重新索引后突然退出。 升级期间，将更改索引表，并将引擎从 `MEMORY` to `InnoDB`. 此时，这些表的内容在Galera群集的节点之间变得不同步。 [GitHub-25334](https://github.com/magento/magento2/issues/25334)

<!-- MC-34254-->

* 禁用PageBuilder模块不再影响产品页面的渲染。 以前，在禁用模块时，产品页面上的自定义布局会消失，并且应用程序会显示一个空白页面。

<!-- ENGCOM-7219-->

* 您现在可以使用 `bin/magento sampledata:deploy` 在使用编辑器安装Magento Open Source后，按预期部署示例数据。 以前，应用程序会引发以下错误： `Git installations must deploy sample data from GitHub; see [Clone sample data Git repositories](../../../installation/sample-data/git-repositories.md) for more information`. _由Andrii Beziazychnyi在拉取请求中提交的修复 [27481](https://github.com/magento/magento2/pull/27481)_. [GitHub-19481](https://github.com/magento/magento2/issues/19481)

<!-- ENGCOM-7459-->

* 通过消除不必要的加载，提高了店面性能 `Datepicker` 组件。 _由Mateusz Krzeszowiak在拉取请求中提交的修复 [27860](https://github.com/magento/magento2/pull/27860)_. [GitHub-28823](https://github.com/magento/magento2/issues/28823)

<!-- ENGCOM-7265-->

* 正在执行 `bin/magento setup:upgrade` 不再显示有关缓存的无关信息。 _修复了由Sathish Subramanian在拉取请求中提交的问题 [27567](https://github.com/magento/magento2/pull/27567)_. [GitHub-27091](https://github.com/magento/magento2/issues/27091)

<!-- MC-17959 ENGCOM-7629-->

* 正在运行 `bin/magento config:show <vendor_module>/general/value` 现在返回 `0` 或空字符串（如预期）。 以前，返回 `Configuration for path: "vendor_module/general/value" doesn't exist`. _修复了Vadim Malesh在拉取请求中提交的问题 [28549](https://github.com/magento/magento2/pull/28549)_. [GitHub-23290](https://github.com/magento/magento2/issues/23290)

<!-- ENGCOM-7853-->

* `bin/magento setup:static-content:deploy --language=all` 现在，部署在店面上使用的所有语言以及在未设置语言参数时由管理员用户配置的所有语言。 (`en_US` 默认情况下始终部署。) _由Anton Evers在拉取请求中提交的修复 [28922](https://github.com/magento/magento2/pull/28922)_. [GitHub-29218](https://github.com/magento/magento2/issues/29218)

<!-- ENGCOM-7883-->

* 禁用“备份”功能后，应用程序不再显示“备份”菜单。 _由Eden Duong在拉取请求中提交的修复 [29222](https://github.com/magento/magento2/pull/29222)_. [GitHub-29280](https://github.com/magento/magento2/issues/29280)

<!-- ENGCOM-7987-->

* 目录图像帮助程序初始化现在使用产品模型，而不是 `DataObject`. _由jmonteros422在拉取请求中提交的修复 [29435](https://github.com/magento/magento2/pull/29435)_. [GitHub-1711](https://github.com/magento/adobe-stock-integration/issues/1711)

<!-- MC-37226-->

* 管理员用户现在可以保存空 **客户令牌生命周期（小时）** 字段（管理员） **商店**  >  **配置**  >  **服务**  >  **OAuth**  >  **访问令牌到期**)。 [GitHub-29502](https://github.com/magento/magento2/issues/29502)

<!-- ENGCOM-7724 -->

* 的 **为旧URL创建永久重定向** 现在，对于类别，默认情况下设置处于禁用状态。 _修复了Vadim Malesh在拉取请求中提交的问题 [28752](https://github.com/magento/magento2/pull/28752)_. [GitHub-24922](https://github.com/magento/magento2/issues/24922)

### Adobe Stock集成

<!-- ENGCOM-7776-->

* 现在，在清除过滤器后，Adobe Stock图像网格中的图像会正确对齐。 _由Nazar Klovanych在拉取请求中提交的修复 [28366](https://github.com/magento/magento2/pull/28366)_. [GitHub-824](https://github.com/magento/adobe-stock-integration/issues/824), [GitHub-972](https://github.com/magento/adobe-stock-integration/issues/972)

<!-- ENGCOM-7709 -->

* 的 **在** “Adobe Stock图库图像详细信息”页面的字段现在可准确识别图像是否与产品关联。 _由Nazar Klovanych在拉取请求中提交的修复 [28798](https://github.com/magento/magento2/pull/28798)_. [GitHub-1474](https://github.com/magento/adobe-stock-integration/issues/1474)

<!-- ENGCOM-7873 -->

* `\Magento\MediaGallery\Model\ResourceModel\Keyword\SaveAssetsKeywords::execute` 现在，在编辑图像详细信息时删除关键字标签时，会删除参数中未指定的关键字的链接，并插入新链接。 _由jmonteros422在拉取请求中提交的修复 [29207](https://github.com/magento/magento2/pull/29207)_. [GitHub-1391](https://github.com/magento/adobe-stock-integration/issues/1391)

<!-- ENGCOM-7981 -->

* 的 `Login failed` 当商家单击 **许可证** 对于之前保存的未授权Adobe Stock图像，不再包含HTML标记。 _修复由Yolouiese在拉取请求中提交 [29398](https://github.com/magento/magento2/pull/29398)_. [GitHub-1684](https://github.com/magento/adobe-stock-integration/issues/1684)

<!-- ENGCOM-7976 -->

* 单击 **在** 图像详细信息页面的部分现在会显示一个网格，其中显示了按图像过滤的所有实体。 此外，还可以正确设置和显示资产过滤器。 以前，应用程序不会在 **应用的过滤器** 中。 _由Nazar Klovanych在拉取请求中提交的修复 [29367](https://github.com/magento/magento2/pull/29367)_. [GitHub-1694](https://github.com/magento/adobe-stock-integration/issues/1694)

<!-- ENGCOM-7976 -->

* 应用程序不再显示 **在** 图像“详细信息”页面的部分。 _由Nazar Klovanych在拉取请求中提交的修复 [29367](https://github.com/magento/magento2/pull/29367)_. [GitHub-1699](https://github.com/magento/adobe-stock-integration/issues/1699)

<!-- ENGCOM-7976 -->

* 更正了添加新图像标记时出现的超过最大字符数的显示问题。 _由Nazar Klovanych在拉取请求中提交的修复 [29367](https://github.com/magento/magento2/pull/29367)_. [GitHub-1702](https://github.com/magento/adobe-stock-integration/issues/1702)

<!-- ENGCOM-7976 -->

* 现在，可以使用图像详细信息上的资产过滤器，按预期检查资产 **在** 中。 _由Nazar Klovanych在拉取请求中提交的修复 [29367](https://github.com/magento/magento2/pull/29367)_. [GitHub-1704](https://github.com/magento/adobe-stock-integration/issues/1704)

<!-- ENGCOM-7976 -->

* 有关不同实体使用的图像的信息(例如， `page` 和 `category`)现已在图像详细信息页面中列出更正。 _由Nazar Klovanych在拉取请求中提交的修复 [29367](https://github.com/magento/magento2/pull/29367)_. [GitHub-1747](https://github.com/magento/adobe-stock-integration/issues/1747)

<!-- ENGCOM-8006-->

* 当媒体集被禁用时，当商家尝试保存具有其关联图像的产品时，应用程序不再引发异常。 _由Nazar Klovanych在拉取请求中提交的修复 [29492](https://github.com/magento/magento2/pull/29492)_. [GitHub-1750](https://github.com/magento/adobe-stock-integration/issues/1750)

<!-- ENGCOM-8019-->

* 现在，单击媒体集中某个图像的“在中使用”部分中的链接，即会打开按图像过滤的实体网格。 以前，图像标题不会显示在网格的已应用过滤器部分中。 _由Nazar Klovanych在拉取请求中提交的修复 [29429](https://github.com/magento/magento2/pull/29429)_. [GitHub-1694](https://github.com/magento/adobe-stock-integration/issues/1694)

<!-- ENGCOM-8019-->

* 现在，当您在媒体库中连续编辑多个图像时，应用程序可正确添加标记。 _由Nazar Klovanych在拉取请求中提交的修复 [29429](https://github.com/magento/magento2/pull/29429)_. [GitHub-1755](https://github.com/magento/adobe-stock-integration/issues/1755)

<!-- ENGCOM-8015-->

* 现在，在商家删除标签并保存图像详细信息后，应用程序会删除Adobe Stock图像的标签。 以前，在刷新页面之前不会删除标记。 _由Honeymay Louiese Ignacio在拉取请求中提交的修复 [29400](https://github.com/magento/magento2/pull/29400)_. [GitHub-1703](https://github.com/magento/adobe-stock-integration/issues/1703)

### Amazon Pay

* Amazon Pay现在会在呈现付款选项之前检查用户是否已登录。

* 已解决多重身份验证和放弃购物车的问题。

* Amazon付现在可以正确填充 `store name` （在电子邮件和其他显示位置中）。  如果 **存储名称** 字段，则扩展将检索存储的默认名称（即您在“管理员”中为存储提供的名称）。

* 已解决拒绝方案的本地化/翻译问题。 显示的文本不再总是使用英语。

### 捆绑产品

<!-- MC-36281-->

* 当您尝试在安装了Inventory但 `Magento_InventoryBundleProduct` 模块被禁用。

<!-- MC-34261-->

* 现在，应用程序可以正确计算包含捆绑产品的订单的离线退款。

<!-- MC-24363-->

* 现在，当为简单产品分配层价时，迷你购物车会显示捆绑产品的正确价格。 [GitHub-22807](https://github.com/magento/magento2/issues/22807)

<!-- ENGCOM-7499-->

* 商家现在可以为捆绑产品创建贷项通知单，以便提供退款，而无需退货。 以前，应用程序会引发错误。 _Dzung Nguyen在拉取请求中提交的修复 [27455](https://github.com/magento/magento2/pull/27455)_. [GitHub-23440](https://github.com/magento/magento2/issues/23440)

<!-- ENGCOM-7655-->

* 当购物者在未选择所需选项的情况下将捆绑产品添加到其购物车时，应用程序不再显示冗余验证消息。 _Dzung Nguyen在拉取请求中提交的修复 [27455](https://github.com/magento/magento2/pull/27455)_. [GitHub-23440](https://github.com/magento/magento2/issues/23440)

<!-- ENGCOM-7985 -->

_由Michał Derlatka在拉取请求中提交的修复 [29256](https://github.com/magento/magento2/pull/29256)_. [GitHub-26110](https://github.com/magento/magento2/issues/26110)

### 缓存

<!-- MC-36096-->

* 现在，本地缓存存储将保留在 **商店** > **配置** > **常规** > **Web** > **默认Cookie设置**. 以前，Cookie的过期日期硬编码为一天，这会使其与此设置不同步。 因此，欢迎消息在预期的持续时间内未保留回访客户信息。

<!-- ENGCOM-7780-->

* 对页面缓存的调用数 `config` 已经减少。 _Lukasz Bajsarowicz在拉取请求中提交的修复 [28992](https://github.com/magento/magento2/pull/28992)_. [GitHub-29159](https://github.com/magento/magento2/issues/29159)

<!-- ENGCOM-7073-->

* 清漆不再抛出 `Connection reset by peer` 按计划重新索引大型目录时出错。 _由Matthew O&#39;Loughlin在拉取请求中提交的修复 [26256](https://github.com/magento/magento2/pull/26256)_. [GitHub-8815](https://github.com/magento/magento2/issues/8815)

<!-- MC-29069-->

* 在“管理员”中编辑产品后，不再清除无关产品的完整页面缓存。 [GitHub-25670](https://github.com/magento/magento2/issues/25670)

### 购物车和结账

<!-- ENGCOM-7950-->

* 直接SQL查询已被数据提供程序取代，这改进了签出性能。 _Lukasz Bajsarowicz在拉取请求中提交的修复 [29376](https://github.com/magento/magento2/pull/29376)_. [GitHub-29453](https://github.com/magento/magento2/issues/29453)

<!-- MC-36252-->

* 比较中的产品和最近比较的产品列表现在可以按预期工作。 以前，当扩展比较列表时，应用程序不显示产品，即使部分指示列表包含产品也是如此。

<!-- MC-35329-->

* 的 **删除** 按钮 **按SKU添加到购物车** 客户 **管理购物车** 现在，当选择多行时，页面会按预期工作。

<!-- MC-34999-->

* 当您尝试按SKU订购产品时，如果输入的位数与有效的SKU匹配，但这些位数的大小写不同，则应用程序不再引发错误。 以前，在 **我的帐户** > **按SKU订购** 与有效SKU不完全匹配时，应用程序抛出错误。

<!-- MC-25042-->

* 现在，如果客户的送货地址位于“允许国家/地区”列表上标识的国家/地区，且该列表仅包含该国家/地区，则在结账时默认会选择该客户的送货地址。 以前，应用程序未选择默认地址，并显示以下错误消息： `Please specify a regionId in shipping address`.

<!-- MC-24043-->

* 商户现在可以启用 **核销发运金额** 的“操作”选项卡中 **营销** > **购物车价格规则** > **添加新规则** when **整个购物车的固定金额折扣** 的次数。 [GitHub-24422](https://github.com/magento/magento2/issues/24422)

<!-- MC-23992-->

* 当购物者在开始结账后尝试取消设置持久性Cookie，然后导航到店面主页时，应用程序不再引发异常。 以前，购物者单击 **不是你？** 链接时，应用程序会引发此异常： `The shipping address is missing. Set the address and try again`. [GitHub-24218](https://github.com/magento/magento2/issues/24218)

<!-- MC-33899-->

* 现在，当客户将缺货产品添加到购物车时，应用程序会显示一则添加到购物车的成功消息。 以前，添加了产品，但应用程序未显示成功消息。

<!-- MC-35989-->

* 现在，在为结帐工作流中的付款步骤显示的表单中，可按预期包含自定义地址属性。

<!-- MC-36060-->

* 的 **州/省/地区** 输入框现在按预期启用 **我的帐户** > **通讯簿** > **添加新地址**.

<!-- ENGCOM-7746-->

* 现在，折扣按预期在 **核销发运金额** 启用。 _由Andrii Kalinich在拉取请求中提交的修复 [28839](https://github.com/magento/magento2/pull/28839)_. [GitHub-26723](https://github.com/magento/magento2/issues/26723)

<!-- ENGCOM-7752-->

* 已重构支持关闭迷你购物车的代码，以删除 `closeSidebar` 函数。 已将相应的点击绑定添加到 `[data-action="close"]` 元素。 _修复了拉取请求中由lumn提交的问题 [28906](https://github.com/magento/magento2/pull/28906)_. [GitHub-29161](https://github.com/magento/magento2/issues/29161)

<!-- ENGCOM-7585-->

* 新 **在购物车页面上显示“清除购物车”按钮** 配置设置提供对显示 **清除购物车** 按钮。 默认情况下，此设置处于禁用状态。 _Pavlo Sydorenko在拉取请求中提交的修复 [27917](https://github.com/magento/magento2/pull/27917)_. [GitHub-28705](https://github.com/magento/magento2/issues/28705)

<!-- ENGCOM-7457-->

* 验证已添加到结帐工作流中的电话字段。 _由Oleh Usik在拉取请求中提交的修复 [27537](https://github.com/magento/magento2/pull/27537)_. [GitHub-28800](https://github.com/magento/magento2/issues/28800)

<!-- ENGCOM-5629-->

* 现在，当购物车包含可下载产品时，如果 **可共享** 和 **如果购物车包含可下载项目，则禁用来宾结账** 设置处于禁用状态。 _由Rani Priya在拉取请求中提交的修复 [23972](https://github.com/magento/magento2/pull/23972)_. [GitHub-23971](https://github.com/magento/magento2/issues/23971)

<!-- ENGCOM-7949-->

* 现在，当购物者从客户帐户侧栏将产品添加到其购物车时，应用程序显示的成功消息包含指向购物者购物车的链接。 _修复了Ajith在拉取请求中提交的问题 [27977](https://github.com/magento/magento2/pull/27977)_. [GitHub-29097](https://github.com/magento/magento2/issues/29097)

<!-- ENGCOM-7825-->

* 现在，应用程序会为结帐工作流上的前缀下拉选项菜单默认选择一个空值。 _修复了Vadim Malesh在拉取请求中提交的问题 [28238](https://github.com/magento/magento2/pull/28238)_. [GitHub-18823](https://github.com/magento/magento2/issues/18823)

<!-- ENGCOM-8004-->

* 现在，在您从购物车中删除多个项目时，应用程序显示的弹出消息可准确描述您选择要删除的实体的数量和类型。 _由Nazar Klovanych在拉取请求中提交的修复 [29490](https://github.com/magento/magento2/pull/29490)_. [GitHub-1749](https://github.com/magento/adobe-stock-integration/issues/1749)

<!-- MC-36418-->

* 客户用户完成结帐后，应用程序现在会显示客户注册表单。

<!-- MC-35607-->

* 现在，自定义客户地址属性字段在店面结帐工作流中按预期显示。

<!-- ENGCOM-7793-->

* 现在，应用程序会在结帐期间为活动报价检索当前客户组。 以前，应用程序使用的是首次将产品添加到购物车时处于活动状态的客户组，如果该客户组在结帐前被删除，则应用程序会引发错误。 _由康斯坦丁在拉取请求中提交的修复 [28902](https://github.com/magento/magento2/pull/28902)_. [GitHub-29327](https://github.com/magento/magento2/issues/29327)

### 目录

<!-- MC-31068-->

* 现在，应用程序会在结帐前从购物车中删除已禁用的产品。 以前，当购物者在结帐完成前将禁用的产品添加到购物车时，应用程序从购物车中删除了禁用的产品，但产品仍保留在报价中，购物者无法结帐。 [GitHub-26680](https://github.com/magento/magento2/issues/26680)

<!-- MC-30624-->

* 该应用程序现在可以按预期对畅销产品进行排序。 以前，产品计数和排序结果的分页都不正确。 [GitHub-25955](https://github.com/magento/magento2/issues/25955)

<!-- ENGCOM-7292-->

* 现在，购物者可以通过单击比较产品侧栏中的产品名称来打开产品的详细信息页面。 _由Eduard Chitoraga在拉取请求中提交的修复 [27451](https://github.com/magento/magento2/pull/27451)_. [GitHub-21101](https://github.com/magento/magento2/issues/21101)

<!-- ENGCOM-7513-->

* `children_count` 现在，当管理员删除类别时，值保持正数。 以前，当管理员删除类别时， `children_count` 其余类别为负数。 _修复了由Vitaliy Prokopov在拉取请求中提交的问题 [28044](https://github.com/magento/magento2/pull/28044)_. [GitHub-27969](https://github.com/magento/magento2/issues/27969)

<!-- MC-34314-->

* 应用程序现在使用默认选项(**配置** > **Web** > **默认布局** > **默认产品布局**) `page_layout` 属性。 以前，未应用您选择的默认值。

<!-- MC-34258-->

* 您现在可以成功地对库存产品库存执行成批活动。 以前，当您尝试对库存产品库存执行成批操作时，应用产品会显示空白页。 如果您在开发人员模式下对应用程序执行此操作，则应用程序会引发以下错误： `Notice: Undefined offset: 32000 in /Users/kodithuw/sites/m23inventory/inventory/InventoryCatalogAdminUi/view/adminhtml/templates/catalog/product/edit/action/inventory.phtml on line 24`.

<!-- MC-32552-->

* 单击时显示的记录总数 **添加产品** 将产品添加到目录类别时，“产品”选项卡上的“产品”选项卡将不再根据产品排序顺序进行更改。

<!-- ENGCOM-7854 -->

* 的 `{products(filter: {sku: {eq: "some sku"}}) {…}` 查询现在会返回已转换为预期货币的值。 以前， `price_tiers.final_price.value` 以基本货币显示特殊价格。 _由Petkovsi Marjan在拉取请求中提交的修复 [28890](https://github.com/magento/magento2/pull/28890)_. [GitHub-26121](https://github.com/magento/magento2/issues/26121)

### 清理

<!-- ENGCOM-7281-->

* 更正了“管理员销售订单”网格复选框的未对齐问题。 _修复由Tu Nguyen在拉取请求中提交 [27642](https://github.com/magento/magento2/pull/27642)_. [GitHub-27633](https://github.com/magento/magento2/issues/27633)

<!-- ENGCOM-7723-->

* 更正了销售订单地址保存处理程序中发运地址ID Getter中的错误拼写。 _由康斯坦丁在拉取请求中提交的修复 [28810](https://github.com/magento/magento2/pull/28810)_. [GitHub-28982](https://github.com/magento/magento2/issues/28982)

<!-- ENGCOM-7745-->

* 更正了 `getRegionNameExpresion` 方法名称到 `getRegionNameExpression`. _由Pierre Grimaud在拉取请求中提交的修复 [28832](https://github.com/magento/magento2/pull/28832)_. [GitHub-28829](https://github.com/magento/magento2/issues/28829)

<!-- ENGCOM-7657-->

* 冗余 `init` 方法 `app/code/Magento/AdvancedPricingImportExport/Model/Import/AdvancedPricing/Validator/Website.php` 和 `app/code/Magento/AdvancedPricingImportExport/Model/Import/AdvancedPricing/Validator/TierPriceType.php`. _由Oleh Usik在拉取请求中提交的修复 [28650](https://github.com/magento/magento2/pull/28650)_. [GitHub-29009](https://github.com/magento/magento2/issues/29009)

<!-- ENGCOM-7698-->

* `localStorage` polyfill已从 `base` to `frontend`. _修复了Ihor Sviziev在拉取请求中提交的问题 [28749](https://github.com/magento/magento2/pull/28749)_. [GitHub-28900](https://github.com/magento/magento2/issues/28900)

<!-- ENGCOM-7753-->

* 更新了Adobe Commerce徽标，并删除了主README文件中多余的空格 `magento/magento2` 存储库。 _拉取请求中由Rafael Cora Gomesr̻提交的修复 [28891](https://github.com/magento/magento2/pull/28891)_. [GitHub-29056](https://github.com/magento/magento2/issues/29056)

<!-- ENGCOM-7771-->

* 不必要 `overflowed` 类已从迷你购物车侧栏小组件中删除。 _修复了拉取请求中由lumn提交的问题 [28963](https://github.com/magento/magento2/pull/28963)_. [GitHub-29160](https://github.com/magento/magento2/issues/29160)

<!-- ENGCOM-7658-->

* 已更正“发运”页中错误的CSS选择器。 _修复由Tu Nguyen在拉取请求中提交 [28639](https://github.com/magento/magento2/pull/28639)_. [GitHub-29261](https://github.com/magento/magento2/issues/29261)

<!-- ENGCOM-7680-->

* 的 `lib/internal/Magento/Framework/App/Request/Http.php` 通过优化逻辑和删除冗余变量分配以及过度使用函数中的返回，简化了文件。 _由Chris Snedaker在拉取请求中提交的修复 [28608](https://github.com/magento/magento2/pull/28608)_. [GitHub-29381](https://github.com/magento/magento2/issues/29381)

<!-- ENGCOM-7925-->

* 的 `bin/magento module:status` 命令现在接受多个模块名称作为参数。 _Chandru Rajendran在拉取请求中提交的修复 [28250](https://github.com/magento/magento2/pull/28250)_. [GitHub-29344](https://github.com/magento/magento2/issues/29344)

<!-- ENGCOM-7983-->

* 修复了的类描述中的错误 `\Magento\Downloadable\Block\Sales\Order\Email\Items\Downloadable`. _由Benjamin Rosenberger在拉取请求中提交的修复 [29451](https://github.com/magento/magento2/pull/29451)_. [GitHub-29470](https://github.com/magento/magento2/issues/29470)

<!-- ENGCOM-7993-->

* 的 `TierPriceManagement` 类已进行重构以删除冗余代码。 _Lukasz Bajsarowicz在拉取请求中提交的修复 [29202](https://github.com/magento/magento2/pull/29202)_. [GitHub-29477](https://github.com/magento/magento2/issues/29477)

<!-- ENGCOM-7830-->

* `autoload.php` 已进行重构，以提高可读性和返回速度。 _修复了Vitaliy Ryaboy在拉取请求中提交的问题 [28923](https://github.com/magento/magento2/pull/28923)_. [GitHub-29527](https://github.com/magento/magento2/issues/29527)

### CMS内容

<!-- MC-35971-->

* 现在，选定默认存储视图的“层次结构”选项卡会按预期显示选定的父页面。

<!-- ENGCOM-7602-->

* 当新存储视图包含的CMS页面与其他存储视图中的页面具有相同的URL键时，应用程序在创建存储视图期间不再引发错误。 _修复了Vadim Malesh在拉取请求中提交的问题 [28421](https://github.com/magento/magento2/pull/28421)_. [GitHub-28357](https://github.com/magento/magento2/issues/28357)

### 可配置产品

<!-- MC-33523-->

* “可配置产品编辑当前变体”列表的分页问题已得到纠正。

<!-- MC-33406-->

* 当购物者为可配置产品选择选项时，应用程序不再更新“相关产品”价格框。 以前，每当购物者为可配置产品选择了选项时，应用程序都会更新价格框。

<!-- MC-29882-->

* 现在，应用程序在“管理员创建订单”页面上通过可自定义的选项显示可配置产品的正确价格。 如预期，显示的价格是子产品价格和自定义选项价格的总和。 以前，应用程序只显示自定义选项价格。 [GitHub-25766](https://github.com/magento/magento2/issues/25766)

<!-- MC-33745-->

* 现在，在应用购物车价格规则后，订单摘要会显示正确的折扣金额。 以前，规则在计算发运折扣时未正确四舍五入金额。

<!-- MC-33765-->

* 现在，通过具有受限范围的管理员帐户创建的管理员用户帐户可以按照预期创建具有属性的可配置产品。 以前，应用程序会引发以下错误： `Notice: Undefined index: value_index in 23develop/app/code/Magento/ConfigurableProduct/Helper/Product/Options/Factory.php on line 101`.

<!-- ENGCOM-7787-->

* 使用POST时，应用程序不再引发验证错误 `/V1/products` 到可配置产品(使用 `int` 值0。 以前，应用程序会引发以下错误： `Product with id "%1" does not contain required attribute "%2"."` _修复了Vadim Malesh在拉取请求中提交的问题 [29001](https://github.com/magento/magento2/pull/29001)_. [GitHub-13210](https://github.com/magento/magento2/issues/13210)

<!-- ENGCOM-7214-->

* 不再将父产品的配置选项属性分配给新可配置产品的 `size` 属性。 _修复由Abel Truong在拉取请求中提交 [27339](https://github.com/magento/magento2/pull/27339)_. [GitHub-26449](https://github.com/magento/magento2/issues/26449)

### Cookie

<!-- ENGCOM-7156-->

* 应用程序现在最多创建一个 `mage-translation-file-version` 和 `mage-translation-storage` 每个会话的cookie。 _修复了Ihor Sviziev在拉取请求中提交的问题 [27364](https://github.com/magento/magento2/pull/27364)_. [GitHub-27355](https://github.com/magento/magento2/issues/27355)

### cron

<!-- MC-35884-->

* 消息队列用户配置已扩展，新参数有助于控制用户并保存服务器资源，并且可能会降低用户队列CPU消耗：

   * `maxIdleTime` 定义队列中新消息的最长等待时间（以秒为单位）。
   * `sleep` 在检查队列中是否有新消息可用之前，指定睡眠时间（以秒为单位）。
   * `onlySpawnWhenMessageAvailable` 标识仅当相关队列中存在可用消息时是否应生成消费者。 默认情况下，在全局范围内为所有用户启用此设置，但可以按每个用户进行配置。

<!-- ENGCOM-7863-->

* `cron` 表达式，如  `3/10 * * * *` 现在已按预期计划。 _由Anton Evers在拉取请求中提交的修复 [28930](https://github.com/magento/magento2/pull/28930)_. [GitHub-29240](https://github.com/magento/magento2/issues/29240)

<!-- ENGCOM-7193-->

* `sales_clean_quotes` 不再同时加载所有过期的引号。 以前，应用程序因同时加载所有过期的引号而失败，并出现此致命错误： `PHP Fatal error: Allowed memory size of 2147483648 bytes exhausted (tried to allocate 20480 bytes) in /path/to/magento2/vendor/magento/framework/Model/AbstractModel.php on line 359`,

### CSS

<!-- ENGCOM-7678-->

* 当 **关键CSS** 启用。 _修复由Tu Nguyen在拉取请求中提交 [28480](https://github.com/magento/magento2/pull/28480)_. [GitHub-26498](https://github.com/magento/magento2/issues/26498)

<!-- MC-24981-->

* 现在，服务器端LESS编译器在运行时会按预期导入所有远程CSS文件 `bin/magento setup:static-content:deploy -f`. 以前，应用程序未导入远程文件并引发错误。 [GitHub-25119](https://github.com/magento/magento2/issues/25119)

### 客户

<!-- MC-33679-->

* 管理员客户地址中的区域名称现在可以按预期进行翻译。

<!-- MC-36226-->

* 的 **州/省** 现在，字段会按照“编辑地址”页面(**我的帐户** > **通讯簿**)。

<!-- MC-34655-->

* 当客户单击 **提交** 按钮多次显示在整个店面中，且已为其启用不可见的reCAPTCHA。 以前，多次单击此按钮会导致与以下类似的内部错误： `Internal error: Make sure you are using reCaptcha V3 api keys`.

<!-- MC-33522-->

* 现在，从管理员中保存已删除的客户只会生成错误消息。 以前，应用程序会显示一个空白页面并生成一个包含此字符串的报表： `"0":"No such entity with customerId = 3","1":"#1 Magento\\Customer\\Model CustomerRegistry->retrieve() called at [app\/code\/Magento\/Customer\/Model\/ResourceModel\/CustomerRepository.php:340"`.

<!-- MC-33357-->

* 现在，当管理员尝试保存其帐户刚刚被删除的客户的地址时，应用程序会按预期显示一条错误消息。 以前，应用程序会显示一个空白消息框。

<!-- MC-33150-->

* 为保持一致性，已编辑结帐工作流和通讯簿中地址字段的标签。

<!-- ENGCOM-7244 -->

* 如果前端标签的值不为空，则它们现在回退到存储标签。 以前，客户属性使用默认前端标签。 _修复由Toan Nguyen在拉取请求中提交 [27064](https://github.com/magento/magento2/pull/27064)_. [GitHub-27063](https://github.com/magento/magento2/issues/27063)

<!-- ENGCOM-7147 -->

* 的 `sortOrder`已更正布局XML中的链接数。 以前，此顺序会颠倒并使用降序顺序。 _修复由Tu Nguyen在拉取请求中提交 [27340](https://github.com/magento/magento2/pull/27340)_. [GitHub-27162](https://github.com/magento/magento2/issues/27162)

### 目录

<!-- MC-32271-->

* 现在，“州/省”下拉菜单的格式在管理员中是一致的。

### dotdigital

* 当订单包含的产品SKU在目录中不再存在时，订单同步不会再失败。

* Web分析数据中不再包含空的产品类别。

* Web行为跟踪现在适用于具有特定主题配置的商户。 新的回退选择器将解决此问题。

* 使用cron运行客户同步时，订阅者状态数据字段不再包含空值。 （应用程序模拟可解决此问题。）

* 现在，当网络数字帐户在默认级别启用但主网站已禁用时，通讯簿映射可按预期工作。

* 现在，对于包含加号(“+”)的电子邮件地址，会生成优惠券（使用外部动态内容URL生成优惠券）。

* 联系人在 `last_subscribed_at` 值为null。

* 已解决影响早期版本的升级错误（从4.5.2开始）。

* 修复了4.5.3中引入的在准备用户导出时使用方法获取用户状态受到影响的回归问题。

* 已同步订阅者的总数（显示在日志和屏幕中）现已正确计算。

### 可下载

<!-- MC-35026-->

* “我的可下载产品”区域现在可显示已购买的可下载产品的链接，这些产品是按预期分组的产品的一部分。

<!-- MC-34262-->

* 单击可下载产品的 **示例** 按钮，现在可以按预期下载示例。 以前，单击 **示例**，应用程序显示以下错误： `The product that was requested doesn't exist. Verify the product and try again`.

<!-- ENGCOM-7757-->

* 购物者现在可以下载无现货的可下载产品的样本。 以前，当购物者尝试下载示例时，应用程序会打开一个新选项卡，但没有显示信息消息或开始下载过程。 _修复了Vadim Malesh在拉取请求中提交的问题 [28898](https://github.com/magento/magento2/pull/28898)_. [GitHub-23638](https://github.com/magento/magento2/issues/23638)

<!-- ENGCOM-7796-->

* 购物者尝试为可下载产品设置送货地址时，应用程序显示的例外消息已得到改进。 _由Michał Derlatka在拉取请求中提交的修复 [28904](https://github.com/magento/magento2/pull/28904)_. [GitHub-26107](https://github.com/magento/magento2/issues/26107)

<!-- ENGCOM-7715 -->

* 产品的 `stock_item` 在使用RESTPUT调用更新时，会更新数据，并且可下载的产品链接和示例会按预期保留 `stock_item` 值。 以前，在产品更新后，产品不再包含指向下载内容的链接。 _修复了Vadim Malesh在拉取请求中提交的问题 [28799](https://github.com/magento/magento2/pull/28799)_. [GitHub-21811](https://github.com/magento/magento2/issues/21811)

<!-- MC-29905-->

* 现在，当客户为只包含可下载产品的订单设置送货地址时，应用程序会显示一条信息更丰富的消息。

### 电子邮件

<!-- MC-32789-->

* 如果客户电子邮件在创建订单后发生更改，则应用程序现在会向正确的客户电子邮件发送有关订单更改的电子邮件通知。

<!-- MC-36015-->

* 发送给客户的订单更新电子邮件现在包含正确的订单状态。 以前，如果订单状态从 `processing` 订单电子邮件未反映状态更改。

<!-- MC-34107-->

* 在来宾结账期间，应用程序不再显示有关现有帐户的误导性消息。 以前，当来宾导航到结帐页面，然后导航回发运页面时，应用程序会显示以下错误： `You already have an account with us. Sign in or continue as guest`.

<!-- MC-33905-->

* 现在，自定义电子邮件模板加载的元素与本机默认电子邮件模板相同。 以前，缺少某些元素，包括变量值。

<!-- ENGCOM-7576-->

* 已从电子邮件预览模板中删除了不必要的CSS。 _修复由Tu Nguyen在拉取请求中提交 [27828](https://github.com/magento/magento2/pull/27828)_. [GitHub-27543](https://github.com/magento/magento2/issues/27543)

<!-- ENGCOM-7177-->

* 已删除电子邮件模板中与页脚已显示的文本重复的文本。 _由Paweł Tylek在拉取请求中提交的修复 [27356](https://github.com/magento/magento2/pull/27356)_. [GitHub-28433](https://github.com/magento/magento2/issues/28433)

<!-- ENGCOM-7506-->

* 产品警报电子邮件现在从订阅警报的商店发送。 以前，此电子邮件始终从默认商店发送。 _修复由Maciej Pawłowski在拉取请求中提交 [26534](https://github.com/magento/magento2/pull/26534)_. [GitHub-28968](https://github.com/magento/magento2/issues/28968)

<!-- ENGCOM-7815-->

* 副本 `customer.name` 变量已从电子邮件模板中删除。 _由Paweł Tylek在拉取请求中提交的修复 [29054](https://github.com/magento/magento2/pull/29054)_. [GitHub-29087](https://github.com/magento/magento2/issues/29087)

<!-- MC-33700-->

* 您现在可以创建一个电子邮件模板，以通过  `Content-Type: "text/plain"`. 以前，应用程序会忽略模板中指定的内容类型。 _修复由twoonesixdigital在拉取请求中提交 [26474](https://github.com/magento/magento2/pull/26474)_. [GitHub-26471](https://github.com/magento/magento2/issues/26471)

### 框架

<!-- MC-35893-->

* 的 **一天中发送数据的时间** 管理员的字段 **商店** > **配置** >常规> **高级报表** 页面现已正确呈现。

<!-- MC-34153-->

* 现在，当“订单”列表跨多个页面时，购物者可以更改每页显示的订单数。 以前，当购物者导航到订单的最后一页并尝试更改每页显示的订单数时，应用程序会显示以下消息： `You have placed no orders`. 这是2.4.0的已知问题。

<!-- MC-35020-->

* 现在，您可以在实施2级缓存时将产品添加到类别中。

<!-- MC-29755-->

* `X-Magento-Tags` 标头不再超过HTTP规范所允许的大小。 以前，包含许多产品的类别页面会返回 `X-Magento-Tag` 标头导致503错误。

<!-- MC-34257-->

* `sales_order_shipment_track_save_commit_after` 现在，在您使用REST API创建装运时按预期触发。

<!-- MC-33898-->

* 现在，当 `di compile` 因不存在的依赖关系而失败。 以前，显示的消息未识别发生异常的类。

<!-- MC-32929-->

* 当Redis使用所有允许的内存时，应用程序不再引发以下致命错误： `report.CRITICAL: OOM command not allowed when used memory > 'maxmemory'.`

<!-- MC-18021-->

* 现在，购物者可在 `Persistent` 模块被禁用。 [GitHub-14486](https://github.com/magento/magento2/issues/14486)

### 一般修复

<!-- MC-36048-->

* 在管理员中对产品排序(**商店** > **属性** > **产品**)现在会显示符合您的搜索标准的所有产品。 以前，应用程序不显示记录，要对记录进行排序，您必须导航到搜索结果的第一页。

<!-- MC-36343-->

* 中URL周围不必要的引号和转义 `tracking.phtml` 已被删除。

<!-- MC-35998-->

* 的 `var/log/system.log` 现在，当用户尝试访问静态目录下的非现有资源文件时，并且启用了SCD OnDemand和生产模式时，会显示更准确的消息。 应用程序现在记录404错误。 以前，应用程序记录的消息与在开发人员模式下发生错误时记录的消息相同。

<!-- ENGCOM-7286-->

* JavaScript缩小功能现在可以正常使用。 缩小文件解析程序不再将变量泄漏到全局范围。 以前， `ctx`, `origNameToUrl`和 `baseUrl` 窗口下的变量被泄露。 _由Mateusz Krzeszowiak在拉取请求中提交的修复 [27622](https://github.com/magento/magento2/pull/27622)_. [GitHub-28110](https://github.com/magento/magento2/issues/28110)

<!-- ENGCOM-7532-->

* 现在，在调试阻止创建对象的错误时，应用程序将打印并记录原始异常消息。 以前，只记录消息。 _Marvin Hinz在拉取请求中提交的修复 [26572](https://github.com/magento/magento2/pull/26572)_. [GitHub-26550](https://github.com/magento/magento2/issues/26550)

<!-- ENGCOM-7577-->

* 改进了提交数据库更改后执行回调的操作。 以前，如果一个回调失败但出现异常，则所有回调都会失败。 _修复了由Alok Patel在拉取请求中提交的问题 [27134](https://github.com/magento/magento2/pull/27134)_. [GitHub-28167](https://github.com/magento/magento2/issues/28167)

<!-- ENGCOM-7447-->

* 未定义依赖关系的模块的混合不再引发此错误： `TypeError: Cannot read property 'map' of null`. _由Mateusz Krzeszowiak在拉取请求中提交的修复 [27690](https://github.com/magento/magento2/pull/27690)_. [GitHub-28340](https://github.com/magento/magento2/issues/28340)

<!-- ENGCOM-7299-->

* 现在，只有在 `localStorage` 或 `sessionStorage` 不可用。 _由Mateusz Krzeszowiak在拉取请求中提交的修复 [27619](https://github.com/magento/magento2/pull/27619)_. [GitHub-28381](https://github.com/magento/magento2/issues/28381)

<!-- ENGCOM-7610-->

* 现在，当购物者更改第二个或后续结果页面中每个页面显示的结果数时，多页面店面订单列表会按预期运行。 以前，当购物者更改了 **我的帐户** > **我的命令** 列表： `You have placed no orders`. _修复了Vadim Malesh在拉取请求中提交的问题 [28417](https://github.com/magento/magento2/pull/28417)_. [GitHub-28488](https://github.com/magento/magento2/issues/28488)

<!-- ENGCOM-7565-->

* 已弃用 `addWarning` 方法已被替换为 `addWarningMessage` 方法。 _由kishorekumarkesavan在拉取请求中提交的修复 [28264](https://github.com/magento/magento2/pull/28264)_. [GitHub-28308](https://github.com/magento/magento2/issues/28308)

<!-- ENGCOM-7588-->

* 使用 `bin/magento` 命令行命令现在与要求和编码标准一致。 _Lukasz Bajsarowicz在拉取请求中提交的修复 [28351](https://github.com/magento/magento2/pull/28351)_. [GitHub-28376](https://github.com/magento/magento2/issues/28376)

<!-- ENGCOM-7511-->

* 保存属性 `backend_type = static` 不再删除 `frontend_class` 字段。 _由jiten-patel在拉取请求中提交的修复 [27369](https://github.com/magento/magento2/pull/27369)_. [GitHub-27051](https://github.com/magento/magento2/issues/27051)

<!-- ENGCOM-7462-->

* 不必要的代码和 `responsive.js` 已从主题加载的文件中删除。 _由Mateusz Krzeszowiak在拉取请求中提交的修复 [27617](https://github.com/magento/magento2/pull/27617)_. [GitHub-28811](https://github.com/magento/magento2/issues/28811)

<!-- ENGCOM-7856-->

* 验证已添加到 **符号数** 字段。 _由Eden Duong在拉取请求中提交的修复 [29199](https://github.com/magento/magento2/pull/29199)_. [GitHub-29198](https://github.com/magento/magento2/issues/29198)

<!-- ENGCOM-7999-->

* 现在，RSS馈送可正确加载。 以前，馈送不会第一次加载，不过它会在页面刷新时按预期加载。 _修复了Vadim Malesh在拉取请求中提交的问题 [29455](https://github.com/magento/magento2/pull/29455)_. [GitHub-25211](https://github.com/magento/magento2/issues/25211)

<!-- MC-35550-->

* 现在，在购物者重新登录时，会按预期方式续订过期的永久会话。

<!-- MC-35230-->

* 在中设置的密码生命周期 **商店** > **配置** > **高级** > **管理员** 现在很荣幸。 以前，如果您单击 **忘记密码？** 提示重置密码时，您可以绕过密码重置。

<!-- MC-34369-->

* 现在，优惠券代码仅应用于指定的产品。 以前，应用程序会将优惠券代码应用于购物车中的所有产品。 [GitHub-28246](https://github.com/magento/magento2/issues/28246)

<!-- MC-35008-->

* 在发生库存或价格更新时，将不再重新设置购物车到期设置。 以前，当购物车设置为在24小时后过期，并且发生库存更新或价格更新时，索引器会填充 `updated_at table`，以重新设置到期时间。

<!-- MC-33313-->

* 当管理员将具有活动购物车的客户分配给客户组时，应用程序不再引发致命错误。

<!-- ENGCOM-7834 -->

* 从 **开发人员工具**  >  **网络**  运行Chrome浏览器时，产品页面上的 `toolbar.js` 两次。 _由Paweł Tylek在拉取请求中提交的修复 [28838](https://github.com/magento/magento2/pull/28838)_. [GitHub-25934](https://github.com/magento/magento2/issues/25934)

<!-- ENGCOM-7420-->

* 现在，应用程序会将管理员用户的ACL角色ID添加到产品类别树缓存ID中。 这将限制具有有限范围的管理员可以按预期查看的类别树。 _修复了由quangdo-aligent在拉取请求中提交的问题 [27429](https://github.com/magento/magento2/pull/27429)_. [GitHub-28306](https://github.com/magento/magento2/issues/28306)

### GraphQL

<!-- ENGCOM-7661 7662 7559 MC-35646 32345-->

* 购物者在结帐期间可以选择礼品消息选项。 GraphQL现在包含不同类型购物车项目的礼品消息选项。 请参阅 [`setGiftOptionsOnCart` 突变](https://devdocs.magento.com/guides/v2.4/graphql/mutations/set-gift-options.html) 和 [`updateCartItems` 突变](https://devdocs.magento.com/guides/v2.4/graphql/mutations/update-cart-items.html). Oleh Usik在拉取请求中提交的修复(_F) [28519](https://github.com/magento/magento2/pull/28105), [27956](https://github.com/magento/magento2/pull/27956), [28072](https://github.com/magento/magento2/pull/28072), [28072](https://github.com/magento/magento2/pull/28072). [GitHub-28519](https://github.com/magento/magento2/issues/28519)

<!-- ENGCOM-7508 -->

* 客人和客人可以撰写产品评论。 客户还可以检索其产品审阅历史记录。 请参阅 [创建产品审阅](https://devdocs.magento.com/guides/v2.4/graphql/mutations/create-product-review.html) 和 [productReviewRatingsMetadata查询](https://devdocs.magento.com/guides/v2.4/graphql/queries/product-review-ratings-metadata.html) 有关检索有关审阅基础结构的信息的信息。 _由Eduard Chitoraga在拉取请求中提交的修复 [27882](https://github.com/magento/magento2/pull/27882)_. [GitHub-28523](https://github.com/magento/magento2/issues/28523)

<!-- ENGCOM-7968 -->

* 的 [`addProductsToCart` 突变](https://devdocs.magento.com/guides/v2.4/graphql/mutations/add-products-to-cart.html) 用于向活动购物车添加任何类型的产品。 我们建议使用此突变而不是单用途突变，例如 `addSimpleProductsToCart`. _Yaroslav Rogoza在拉取请求中提交的修复 [27914](https://github.com/magento/magento2/pull/27914)_. [GitHub-28524](https://github.com/magento/magento2/issues/28524)

<!-- MC-34187-->

* 新 `availableStores` 查询会返回同一网站下可用的多个存储的配置属性列表（基于当前存储）。 它不会公开网站列表。 请参阅 [`availableStores` 查询](https://devdocs.magento.com/guides/v2.4/graphql/queries/available-stores.html). _修复由Dmitriy Gallyamov在拉取请求中提交 [28794](https://github.com/magento/magento2/pull/28794)_. [GitHub-28569](https://github.com/magento/magento2/issues/28569)

<!-- ENGCOM-7512 -->

* GraphQL现在只使用授权令牌来检索用户类型及其ID。 以前，GraphQL使用活动客户的Cookie在授权令牌为空时检索此信息。 _由Alexander Taranovsky在拉取请求中提交的修复 [27373](https://github.com/magento/magento2/pull/27373)_. [GitHub-28040](https://github.com/magento/magento2/issues/28040)

<!-- ENGCOM-7839 32949-->

* 我们已将 [`createCustomerV2`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/create-customer-v2.html) 和 [`updateCustomerV2`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/update-customer-v2.html) 为管理客户账户而进行突变。 这些新的突变需要与 `createCustomer` 和 `updateCustomer` 突变。 要更改客户的电子邮件地址，请使用 [`updateCustomerEmail`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/update-customer-email.html) 变异。 _由Michał Derlatka在拉取请求中提交的修复 [28888](https://github.com/magento/magento2/pull/28888)_. [GitHub-28570](https://github.com/magento/magento2/issues/28570)

<!-- ENGCOM-7750 -->

* 的 `updateCustomer` 变异不再允许您设置无效 `INT` 值 `gender` 参数。 _由Alexander Taranovsky在拉取请求中提交的修复 [28487](https://github.com/magento/magento2/pull/28487)_. [GitHub-28481](https://github.com/magento/magento2/issues/28481)

<!-- ENGCOM-7663 -->

* 您可以使用 `subscribeEmailToNewsletter` 使客户订阅时事通讯的突变。 请参阅 [`subscribeEmailToNewsletter` 突变](https://devdocs.magento.com/guides/v2.4/graphql/mutations/subscribe-email-to-newsletter.html). _由Alexander Taranovsky在拉取请求中提交的修复 [27586](https://github.com/magento/magento2/pull/27586)_. [GitHub-27337](https://github.com/magento/magento2/issues/27337)

<!-- ENGCOM-7216 -->

* 删除了 `setShippingMethodsOnCart` 变异解析器。 _由Alexander Taranovsky在拉取请求中提交的修复 [27349](https://github.com/magento/magento2/pull/27349)_. [GitHub-28262](https://github.com/magento/magento2/issues/28262)

<!-- ENGCOM-7638 -->

* 为 `Please provide Email of sender` 与关联的错误 `sendEmailToFriend` 变异。 _由Alexander Taranovsky在拉取请求中提交的修复 [28034](https://github.com/magento/magento2/pull/28034)_. [GitHub-28138](https://github.com/magento/magento2/issues/28138)

<!-- ENGCOM-7743 34485-->

* 的 `products` 查询现在可按预期返回默认商店视图的产品属性选项标签。 以前，此查询会返回为管理员设置的产品属性选项标签。 _修复由Dmitriy Gallyamov在拉取请求中提交 [28647](https://github.com/magento/magento2/pull/28647)_. [GitHub-28568](https://github.com/magento/magento2/issues/28568)

<!-- ENGCOM-7743 -->

* 自定义属性聚合现在返回特定于存储的选项值。 _修复由Dmitriy Gallyamov在拉取请求中提交 [28647](https://github.com/magento/magento2/pull/28647)_. [GitHub-28572](https://github.com/magento/magento2/issues/28572)

<!-- ENGCOM-7707 -->

* 现在，产品聚合中返回的价格间隔只能是数字（不允许使用通配符）。 _修复由Dmitriy Gallyamov在拉取请求中提交 [28745](https://github.com/magento/magento2/pull/28745)_. [GitHub-28628](https://github.com/magento/magento2/issues/28628)

<!-- ENGCOM-7729 -->

* 的 `categoryList` 使用片段时，查询现在可返回正确的响应。 _由Ulzii在拉取请求中提交的修复 [28710](https://github.com/magento/magento2/pull/28710)_. [GitHub-28584](https://github.com/magento/magento2/issues/28584)

<!-- ENGCOM-7732 7733-->

* GraphQL产品搜索现在会考虑配置的类别权限。 以前，产品搜索会忽略 **启用** 设置(**商店**  >  **配置**  >  **目录**  >  **目录** > **类别权限**)。 _由Petkovsi Marjan在拉取请求中提交的修复 [28757](https://github.com/magento/magento2/pull/28757) 并在专用存储库中提取请求271`partners-magento2ee`_. [GitHub-28563](https://github.com/magento/magento2/issues/28563)

<!-- MC-31084-->

* 您现在可以使用 `addSimpleProductToCart` 购物车中的其他物品无现货时。 以前，应用程序会返回以下错误： `Some of the products are out of stock`. [GitHub-26683](https://github.com/magento/magento2/issues/26683)

* 默认GraphQL `Category` 方法现在按照预期的类别位置排序。 _由Derrik Nyomo在拉取请求中提交的修复 [29301](https://github.com/magento/magento2/pull/29301)_. [GitHub-104](https://github.com/magento/catalog-storefront/issues/104)

* 在Magento Open Source中添加了对愿望列表的支持。 您可以 [添加项目](https://devdocs.magento.com/guides/v2.4/graphql/mutations/add-products-to-wishlist.html) 到 [更新项目](https://devdocs.magento.com/guides/v2.4/graphql/mutations/update-products-in-wishlist.html) 和 [删除项目](https://devdocs.magento.com/guides/v2.4/graphql/mutations/remove-products-from-wishlist.html) 愿望清单上。 _由Eduard Chitoraga在拉取请求中提交的修复 [28205](https://github.com/magento/magento2/pull/28205)_. [GitHub-28551](https://github.com/magento/magento2/issues/28551)

* 我们已将 [`createCustomerV2`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/create-customer-v2.html) 和 [`updateCustomerV2`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/update-customer-v2.html) 为管理客户账户而进行突变。 这些新的突变需要与 `createCustomer` 和 `updateCustomer` 突变。 要更改客户的电子邮件地址，请使用 [`updateCustomerEmail`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/update-customer-email.html) 变异。

* 为 [Payflow Pro Vault](https://devdocs.magento.com/guides/v2.4/graphql/payment-methods/payflow-pro-vault.html) 付款方式。 _由Oleh Usik在拉取请求中提交的修复 [28821](https://github.com/magento/magento2/pull/28821)_. [GitHub-28520](https://github.com/magento/magento2/issues/28520)

* 更新了GraphQL [`storeConfig` 查询](https://devdocs.magento.com/guides/v2.4/graphql/queries/store-config.html) 以包含新的客户配置设置。 _由Oleh Usik在拉取请求中提交的修复 [27876](https://github.com/magento/magento2/pull/27876)_. [GitHub-28521](https://github.com/magento/magento2/issues/28521)

* 添加了 [`resetPassword` 突变](https://devdocs.magento.com/guides/v2.4/graphql/mutations/reset-password.html). _由Oleh Usik在拉取请求中提交的修复 [27876](https://github.com/magento/magento2/pull/27876)_. [GitHub-28521](https://github.com/magento/magento2/issues/28521)

* 添加了 [`resetPassword` 突变](https://devdocs.magento.com/guides/v2.4/graphql/mutations/reset-password.html). _由Oleh Usik在拉取请求中提交的修复 [27876](https://github.com/magento/magento2/pull/27876)_. [GitHub-28521](https://github.com/magento/magento2/issues/28521)

* 添加了 [`requestPasswordResetEmail` 突变](https://devdocs.magento.com/guides/v2.4/graphql/mutations/request-password-reset-email.html)，这会触发所提供电子邮件地址的密码重置电子邮件。 _由Oleh Usik在拉取请求中提交的修复 [27876](https://github.com/magento/magento2/pull/27876)_. [GitHub-28521](https://github.com/magento/magento2/issues/28521)

* 在 [克拉纳的支付方式](https://devdocs.magento.com/guides/v2.4/graphql/payment-methods/klarna.html) 和[`createKlarnaPaymentsSession`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/create-klarna-payments-session.html)

### 图像

<!-- ENGCOM-7691-->

* HTML缩略图图像的标记已得到改进。 _修复由Tu Nguyen在拉取请求中提交 [28642](https://github.com/magento/magento2/pull/28642)_. [GitHub-29468](https://github.com/magento/magento2/issues/29468)

### 导入/导出

<!-- MC-35479-->

* 的 `error_report.csv` 现在可下载包含内容的文件，该文件可在 `var/import_history/` 目录。 以前，导入后不会生成此文件。

<!-- ENGCOM-7616-->

* 现在，使用CSV文件导入产品会生成 `error_report.csv` 文件。 以前，应用程序会生成文件，但会在导入完成后将其删除。 _修复了Vadim Malesh在拉取请求中提交的问题 [28460](https://github.com/magento/magento2/pull/28460)_. [GitHub-28420](https://github.com/magento/magento2/issues/28420)

<!-- ENGCOM-7673-->

* 在整个代码库中删除了冗余类导入。 _由Oleh Usik在拉取请求中提交的修复 [28696](https://github.com/magento/magento2/pull/28696)_. [GitHub-29012](https://github.com/magento/magento2/issues/29012)

<!-- MC-33730-->

* 现在，应用程序已成功导入包含未定义区域的国家/地区区域的客户地址。 以前，应用程序会引发以下错误： `Please enter a valid region`.

<!-- MC-33277-->

* 现在，当商家在计划新导出时选择实体类型时，应用程序将加载正确的实体属性集。

<!-- MC-32956-->

* 产品在 `catalog_category_product` 现在，当管理员在“管理员”中创建产品并将其分配到类别时，表会按预期进行更新。 以前，新产品的位置始终分配0个值。

<!-- MC-34939-->

* 现在，已成功从管理员导出客户数据，并且导出数据网格会按预期显示客户数据。 以前，在导出过程中发生与内存分配相关的错误。

<!-- MC-34657-->

* 现在，导入的CSV文件会按照预期捕获相关产品信息。 以前，首次导入CSV文件时，无法始终上传相关产品信息。

<!-- MC-37424-->

* 删除了 `AdvancedPricing.php`. [GitHub-29531](https://github.com/magento/magento2/issues/29531)

### 索引

<!-- ENGCOM-7073-->

* `Magento_CacheInvalidate` 现在，在执行 `PURGE`. `sendPurgeRequest` 已重构以处理标记数组，而不是要求调用方使用 `implode()`. _由Matthew O&#39;Loughlin在拉取请求中提交的修复 [26256](https://github.com/magento/magento2/pull/26256)_. [GitHub-26255](https://github.com/magento/magento2/issues/26255)

<!-- MC-30568-->

* 共享索引器现在显示 **有效** 跑完 `bin/magento indexer:status` 重新索引之后。 以前，共享索引器具有 **无效** 完全重新索引后的状态。

### 基础架构

<!-- MC-37243-->

* 在运行PHP 7.4.9的部署中加载目录和产品页面时不再出现问题。 以前，当您尝试加载目录和产品页面时，应用程序会引发此错误： `There has been an error processing your request. Exception printing is disabled by default for security reasons`. [GitHub-29502](https://github.com/magento/magento2/issues/29502)

<!-- ENGCOM-7994-->

* 现在，在生产模式下呈现布局时发生的所有例外都记录在例外日志文件(`var/report`)。 以前，应用程序在系统日志中记录这些消息是严重问题。

<!-- ENGCOM-7154-->

* 由于 `ipcre.backtrack_limi`t和 `pcre.recursion_limit` 约1000000。 _由Mateusz Krzeszowiak在拉取请求中提交的修复 [27270](https://github.com/magento/magento2/pull/27270)_. [GitHub-26026](https://github.com/magento/magento2/issues/26026)

<!-- ENGCOM-7483-->

* 拦截器的发电已得到改进。 `} else {` 从截获器中删除了语句，以及 `array_map` 已更换 `foreach`. _Lukasz Bajsarowicz在拉取请求中提交的修复 [27902](https://github.com/magento/magento2/pull/27902)_. [GitHub-28383](https://github.com/magento/magento2/issues/28383)

<!-- ENGCOM-7651-->

* 现在，在整个类中创建数组时保持一致(`app/code/Magento/Sales/Model/Order/Pdf/Items/Invoice/DefaultInvoice.php`)。 _修复了由Nathan de Graaf在拉取请求中提交的问题 [28515](https://github.com/magento/magento2/pull/28515)_. [GitHub-28795](https://github.com/magento/magento2/issues/28795)

<!-- ENGCOM-7484-->

* 插件已从框架中迁移出来，以遵循禁止Framework命名空间中的插件的最佳实践。 _Lukasz Bajsarowicz在拉取请求中提交的修复 [27965](https://github.com/magento/magento2/pull/27965)_. [GitHub-27962](https://github.com/magento/magento2/issues/27962)

<!-- ENGCOM-7778-->

* 您现在可以使用 `UrlFilterApplier` 对产品应用过滤器的组件，`cms_page`和 `cms_block` 网格。 _由Gabriel da Gama在拉取请求中提交的修复 [28932](https://github.com/magento/magento2/pull/28932)_. [GitHub-1501](https://github.com/magento/adobe-stock-integration/issues/1501)

<!-- ENGCOM-7713-->

* 应用程序不再引发 `Undefined class constant` 生成侦听器时出错。 _由Vova Yatsyuk在拉取请求中提交的修复 [28797](https://github.com/magento/magento2/pull/28797)_. [GitHub-28981](https://github.com/magento/magento2/issues/28981)

<!-- ENGCOM-7523-->

* 现在，当您使用已在使用的名称保存集成时，当应用程序引发集成异常时，表单数据会保留。 _由Aditya Yadav在拉取请求中提交的修复 [26660](https://github.com/magento/magento2/pull/26660)_. [GitHub-28143](https://github.com/magento/magento2/issues/28143)

<!-- ENGCOM-7756-->

* 应用程序不再截断 `X-Forwarded-For` 头到32个字符。 _修复了Ihor Sviziev在拉取请求中提交的问题 [27221](https://github.com/magento/magento2/pull/27221)_. [GitHub-28693](https://github.com/magento/magento2/issues/28693)

<!-- ENGCOM-7820-->

* 现在，使用自定义管理域时，用于检查重定向是否为内部重定向的逻辑在“管理员”中可正确工作。 以前，此逻辑存在问题，导致许多管理员重定向到默认商店的主页。 _修复了Vadim Malesh在拉取请求中提交的问题 [29066](https://github.com/magento/magento2/pull/29066)_. [GitHub-28943](https://github.com/magento/magento2/issues/28943)

<!-- ENGCOM-7758-->

* 的问题 `styles-old.less` 文件已被删除，且linting不再标识错误。 _修复由Tu Nguyen在拉取请求中提交 [28895](https://github.com/magento/magento2/pull/28895)_. [GitHub-24004](https://github.com/magento/magento2/issues/24004)

<!-- ENGCOM-7781-->

* `NonComposerComponentRegistration.php` 已重构。 _修复了Vitaliy Ryaboy在拉取请求中提交的问题 [28975](https://github.com/magento/magento2/pull/28975)_. [GitHub-29308](https://github.com/magento/magento2/issues/29308)

<!-- ENGCOM-7926-->

* `ResourceConnection.php` 已重构以提高类可读性。 _Lukasz Bajsarowicz在拉取请求中提交的修复 [29341](https://github.com/magento/magento2/pull/29341)_. [GitHub-29389](https://github.com/magento/magento2/issues/29389)

<!-- ENGCOM-7910-->

* 内置Web服务器的README文件已更新，包含所有Elasticsearch参数。 _Yevheni Dumskyi在拉取请求中提交的修复 [29300](https://github.com/magento/magento2/pull/29300)_. [GitHub-29299](https://github.com/magento/magento2/issues/29299)

<!-- ENGCOM-7814-->

* 的 `Magento\CmsUrlRewrite\Plugin\Cms\Model\Store\View::aftersSave` 插件现在可按预期返回值。 以前，此插件不返回值，因此，保存存储视图会导致错误。 _由Pieter Hoste在拉取请求中提交的修复 [29035](https://github.com/magento/magento2/pull/29035)_. [GitHub-29034](https://github.com/magento/magento2/issues/29034)

<!-- ENGCOM-7566-->

* 为 `DataObject`:

   * 支持的新扩展 `get/set/has/uns` 魔术方法(使用 `__call`)
   * 支持SessionManager，它将所有调用转发到DataObject容器
   * 扩展的测试覆盖面
   * 更新了过滤错误检查的测试
   * 将PHPStan检查级别从0增加到1。 _修复由Oleksandr Kravchuk在拉取请求中提交 [27905](https://github.com/magento/magento2/pull/27905)_. [GitHub-28303](https://github.com/magento/magento2/issues/28303)

<!-- ENGCOM-7906-->

* `ScopeConfigInterface` 现在可以超过字符串。 限制 `magentoConfigFixture` “仅”字符串是上一拉取请求的意外结果，且已还原。 _由Kristof、Fooman在拉取请求中提交的修复 [29305](https://github.com/magento/magento2/pull/29305)_. [GitHub-29345](https://github.com/magento/magento2/issues/29345)

<!-- ENGCOM-8000-->

* 的 `convertConfigTimeToUtc` 方法不再由于向错误的参数发送而引发致命错误 `Phrase` 构造函数。 _Kos Rafał在拉取请求中提交的修复 [29483](https://github.com/magento/magento2/pull/29483)_. [GitHub-29525](https://github.com/magento/magento2/issues/29525)

<!-- ENGCOM-7962 -->

* 现在，价格过滤器可在 `Magento\Backend\Block\Widget\Grid\Column\Filter\Price::getCondition` 和 `Magento\Backend\Block\Widget\Grid\Column\Filter\Price::getValue()` 返回包含索引的数组 `from` 或 `to` 字符串数据。 以前，应用程序会引发以下错误： `Notice: A non well formed numeric value encountered in vendor/magento/module-backend/Block/Widget/Grid/Column/Filter/Price.php on line 197`. _Nikita Sarychev在拉取请求中提交的修复 [29214](https://github.com/magento/magento2/pull/29214)_. [GitHub-29213](https://github.com/magento/magento2/issues/29213)

<!-- ENGCOM-7911 -->

* 添加了扩展点，以支持将HTML添加到类别页面。 这会更正由先前拉取请求引入的错误。 _由Gerchak在拉取请求中提交的修复 [29291](https://github.com/magento/magento2/pull/29291)_. [GitHub-29286](https://github.com/magento/magento2/issues/29286)

### 分层导航

<!-- MC-25043-->

* 分层的导航侧栏现在显示具有两个选项的布尔属性(**是**/**否**)和匹配的产品计数。 以前，分层导航不会返回 **否** 选项。

<!-- ENGCOM-7493-->

* 色板分层导航过滤器现在与整个Magento Open Source中使用的标准过滤器一致。 _由Bartłomiej Szubert在拉取请求中提交的修复 [28015](https://github.com/magento/magento2/pull/28015)_. [GitHub-28011](https://github.com/magento/magento2/issues/28011)

### 记录

<!-- ENGCOM-7692-->

* 现在，当部署仅处于开发人员模式时，将记录所有损坏的引用错误。 以前，在生产模式下的部署也记录了一个错误，该错误会导致错误日志膨胀。 _由Bartłomiej Szubert在拉取请求中提交的修复 [28735](https://github.com/magento/magento2/pull/28735)_. [GitHub-26504](https://github.com/magento/magento2/issues/26504)

### 媒体集

<!-- ENGCOM-8014-->

* 媒体集配置UI（管理员） **商店**  >  **配置**  >   **高级**  >  **系统** )已重新组织。 _由Shankar Konar在拉取请求中提交的修复 [29433](https://github.com/magento/magento2/pull/29433)_. [GitHub-28011](https://github.com/magento/adobe-stock-integration/issues/1738)

<!-- ENGCOM-7972 -->

* 添加了测试以涵盖 **在中使用** 媒体库中图像的链接。 _由Nazar Klovanych在拉取请求中提交的修复 [29392](https://github.com/magento/magento2/pull/29392)_. [GitHub-1969](https://github.com/magento/adobe-stock-integration/issues/1693)

### MFTF

<!-- ENGCOM-7963 -->

* 的 `AdminSubmitAdvancedInventoryFormActionGroup` , `AdminClickOnAdvancedInventoryLinkActionGroup`和  `AdminSetStockStatusConfigActionGroup` 现在，根据最佳实践，在测试中使用操作组。 _修复了Oleh USIA在拉取请求中提交的问题 [29386](https://github.com/magento/magento2/pull/29386)_. [GitHub-29420](https://github.com/magento/magento2/issues/29420)

<!-- ENGCOM-7964 -->

* `SearchProductGridByKeywordActionGroup` 现在用于在产品网格中进行搜索。 _由Oleh Usik在拉取请求中提交的修复 [29385](https://github.com/magento/magento2/pull/29385)_. [GitHub-29434](https://github.com/magento/magento2/issues/29434)

<!-- ENGCOM-7915 -->

* `AdminCategoriesClickDoneButtonOnPopupActionGroup` 现在用于单击 **完成** 中。 _由Oleh Usik在拉取请求中提交的修复 [28989](https://github.com/magento/magento2/pull/28989)_. [GitHub-29380](https://github.com/magento/magento2/issues/29380)

<!-- ENGCOM-7529 -->

* `LoginToStorefrontActionGroup` 现在用于替换用于存储客户前端登录的一系列操作。 _修复了由Sathish Subramanian在拉取请求中提交的问题 [28113](https://github.com/magento/magento2/pull/28113)_. [GitHub-28165](https://github.com/magento/magento2/issues/28165)

<!-- ENGCOM-7590 -->

* `AdminUpdateCustomURLRewritesPermanentTest` 已进行重构，以符合MFTF最佳实践。 _Kate Kyzyma在拉取请求中提交的修复 [28361](https://github.com/magento/magento2/pull/28361)_. [GitHub-28393](https://github.com/magento/magento2/issues/28393)

<!-- ENGCOM-7343 -->

* 测试名称已更改，以符合MFTF惯例。 _由Evgeny Levinsky在拉取请求中提交的修复 [27839](https://github.com/magento/magento2/pull/27839)_. [GitHub-28305](https://github.com/magento/magento2/issues/28305)

#### 新操作组

<!-- ENGCOM-7991 -->

* `StorefrontCheckoutClickNextButtonActionGroup` _由Oleh Usik在拉取请求中提交的修复 [29472](https://github.com/magento/magento2/pull/29472)_. [GitHub-29539](https://github.com/magento/magento2/issues/29539)

<!-- ENGCOM-7857 -->

* `AdminProductFormSaveActionGroup`_由Oleh Usik在拉取请求中提交的修复 [29142](https://github.com/magento/magento2/pull/29142)_. [GitHub-29292](https://github.com/magento/magento2/issues/29292)

<!-- ENGCOM-7928 -->

* `AdminSaveCategoryActionGroup` _由Oleh Usik在拉取请求中提交的修复 [28993](https://github.com/magento/magento2/pull/28993)_. [GitHub-29388](https://github.com/magento/magento2/issues/29388)

<!-- ENGCOM-7790 -->

* `AdminProductGridSectionClickFirstRowActionGroup` _由Oleh Usik在拉取请求中提交的修复 [29000](https://github.com/magento/magento2/pull/29000)_. [GitHub-29295](https://github.com/magento/magento2/issues/29295)

<!-- ENGCOM-7591 -->

* `AdminProductFormCategoryExistInCategoryListActionGroup` 和 `AdminProductFormCategoryNotExistInCategoryListActionGroup` _由Alexander Steshuk在拉取请求中提交的修复 [28287](https://github.com/magento/magento2/pull/28287)_. [GitHub-28392](https://github.com/magento/magento2/issues/28392)

<!-- ENGCOM-7867 -->

* `AdminExpandCategoryTreeActionGroup` _由Oleh Usik在拉取请求中提交的修复 [29133](https://github.com/magento/magento2/pull/29133)_. [GitHub-29289](https://github.com/magento/magento2/issues/29289)

<!-- ENGCOM-7881 -->

* `AdminTaxRateGridOpenPageActionGroup` _由Oleh Usik在拉取请求中提交的修复 [29007](https://github.com/magento/magento2/pull/29007)_. [GitHub-29281](https://github.com/magento/magento2/issues/29281)

<!-- ENGCOM-7868 -->

* `AdminNavigateNewCustomerActionGroup` _由Oleh Usik在拉取请求中提交的修复 [29134](https://github.com/magento/magento2/pull/29134)_. [GitHub-29287](https://github.com/magento/magento2/issues/29287)

#### 新测试

<!-- ENGCOM-7600 -->

* 添加了将CMS页面删除为管理员用户的测试。 _修复了由Dmitry Tsymbal在拉取请求中提交的问题 [28112](https://github.com/magento/magento2/pull/28112)_. [GitHub-28202](https://github.com/magento/magento2/issues/28202)

* 添加了 `StorefrontShareCustomerWishlistActionGroup` 测试客户希望列表是否与无效的电子邮件地址共享。 希望列表共享的现有测试(`StorefrontShareWishlistEntityTest`)进行了重构。 `StorefrontCustomerShareWishlistActionGroup` 已弃用。

<!-- ENGCOM-7682 -->

* 添加了测试以检查 **仅X左阈值** 配置设置。 _由Oleh Usik在拉取请求中提交的修复 [27549](https://github.com/magento/magento2/pull/27549)_. [GitHub-28755](https://github.com/magento/magento2/issues/28755)

### 新闻稿

<!-- MC-34714-->

* 使用导出新闻稿的订阅者列表 `EXCEL XML` 现在，选项会导致导出所有行（如预期）。 以前，导出的数据只包含页面分页值，而不包含所有行。

<!-- ENGCOM-7522-->

* Newsletter订阅电子邮件现在使用与其他Newsletter相关电子邮件相同的HTML标记。 _由Paweł Tylek在拉取请求中提交的修复 [27357](https://github.com/magento/magento2/pull/27357)_. [GitHub-28165](https://github.com/magento/magento2/issues/28165)

<!-- ENGCOM-7788-->

* 添加了将新闻稿订阅者删除为管理员用户的测试。 _修复了由Dmitry Tsymbal在拉取请求中提交的问题 [28972](https://github.com/magento/magento2/pull/28972)_. [GitHub-29032](https://github.com/magento/magento2/issues/29032)

<!-- ENGCOM-7739-->

* 为配置语句中不允许使用选项的来宾添加了新闻稿订阅测试。 此测试取代已弃用 `VerifyRegistredLinkDisplayedForGuestSubscriptionNoTest` 和 `StorefrontCreateNewSubscriberActionGroup`. _修复了由Dmitry Tsymbal在拉取请求中提交的问题 [28872](https://github.com/magento/magento2/pull/28872)_. [GitHub-29039](https://github.com/magento/magento2/issues/29039)

### 订单数

<!-- ENGCOM-7858-->

* 的 `GetAssetIdByContentFieldInterface` 及其实施 `MediaContent` 模块现在允许Adobe Stock集成扩展 `MediaGallery` 过滤功能。 _由Gabriel da Gama在拉取请求中提交的修复 [29058](https://github.com/magento/magento2/pull/29058)_. [GitHub-1464](https://github.com/magento/magento2/issues/1464)

<!-- ENGCOM-7885-->

* 的 `CustomerAddressId` 现在，新创建客户的值将用引号进行验证。 _由Andrii Kalinich在拉取请求中提交的修复 [29139](https://github.com/magento/magento2/pull/29139)_. [GitHub-28793](https://github.com/magento/magento2/issues/28793)

<!-- ENGCOM-7798-->

* 总计为零的贷项通知单的订单状态现在为 `Closed`. 以前，应用程序将其订单状态报告为 `Complete`. _由Andrii Kalinich在拉取请求中提交的修复 [29023](https://github.com/magento/magento2/pull/29023)_. [GitHub-22762](https://github.com/magento/magento2/issues/22762)

### 付款方法

<!-- MC-34363-->

* 现在，应用程序会显示一条消息，提示您在单击时输入强制信用卡数据 **提交** ，但未输入有效的付款信息。 以前，当付款输入字段无效且页面变得不活动时，Braintree卡验证器不会引发错误。

<!-- MC-33494-->

* 现在，您可以更改从管理员为帐户中存储了信用卡(Braintree)的客户创建的订单的发运方法。 以前，当您选择其他发运方法时，未选择存储的卡，并且应用程序未下订单。

#### PayPal

<!-- MC-33879-->

* 现在，结帐工作流的“订单复查”页通过结帐期间发运方法已更改的Braintree订单显示PayPal的正确发运金额。 以前，当客户在结帐工作流的“PayPal订单复查”页上更改发运方法时，应用程序不会使用正确的方法更新订单总额。

<!-- MC-34152-->

* 商家现在可以成功取消使用PayPal授权的订单。 以前，应用程序未取消订单并显示以下错误： `Declined: 10601-Authorization has expired`.

<!-- MC-33330-->

* 在您取消订单时，应用程序不再清空您的购物车，方法是在完成另一订单后关闭PayPal付款弹出窗口。

### 性能

* 三种新配置设置支持减少消费者队列CPU消耗。 这些可选参数可增强对用户的控制并保存服务器资源。 请参阅 [配置消息队列](https://developer.adobe.com/commerce/php/development/components/message-queues/configuration/) 对 `maxIdleTime`, `sleep`和 `onlySpawnWhenMessageAvailable` 参数。

<!-- MC-31617-->

* 现在，插件列表配置是在执行 `di:compile` 命令。 此配置信息将根据范围写入生成的元数据文件夹。 以前，此信息存储在缓存中。 最终的性能改进包括：

   * 网络缓存大小已减小
   * 许多方案的执行时间已得到改进。

<!-- ENGCOM-7290-->

* 应用程序现在可按需加载相应的滑块小组件，这改进了页面加载。 触控滑块小组件自定义已移至单独的文件，因此只能在兼容的设备上加载。 现在，仅当页面上实际使用范围绑定时，才会加载相应的滑块小组件类型。 _由Mateusz Krzeszowiak在拉取请求中提交的修复 [27616](https://github.com/magento/magento2/pull/27616)_. [GitHub-28807](https://github.com/magento/magento2/issues/28807)

<!-- MC-33107-->

* 多个同时订购的结帐性能已得到改进。

<!-- MC-25062-->

* 当导入进程执行批量插入并且重新索引进程同时执行从选定范围中的大型插入时，不再出现死锁。 以前，应用程序会显示以下错误： `PDOException: SQLSTATE[40001]: Serialization failure: 1213 Deadlock found when trying to get lock`. [GitHub-8933](https://github.com/magento/magento2/issues/8933)

### 评论

<!-- MC-33405-->

* 的唯一键 `entity_pk_value-entity_type-store_id` 已添加到 `review_entity_summary` 表，用于防止为同一产品ID(`entity_pk_value`)。 以前，由于缺少唯一键，导致同一产品ID和SQL错误出现重复行。

### 销售

<!-- MC-35675-->

* 应用程序不再分配状态 `Complete` 开具发票后需要零付款的订单。

<!-- MC-35888-->

* 现在，由REST API生成的“新发运”电子邮件包含与从管理员手动创建的发运相同的发运和客户信息。 以前，此电子邮件不包含客户名称、跟踪信息、订购的产品和其他订单信息。

<!-- MC-35837-->

* 现在，在管理员加载或自定义电子邮件时，来宾用户名在与发票和发运相关的电子邮件中按预期可见。

<!-- MC-35707-->

* PDF发票现已转换为下订单的商店视图语言。 以前，PDF发票是使用管理员语言翻译的。

<!-- MC-35858-->

* 您现在可以按预期从贷项通知单页面发出退款。 [GitHub-29014](https://github.com/magento/magento2/issues/29014)

<!-- MC-35353-->

* 现在，店面订单页面上显示的本地化区域名称已正确翻译。 以前，区域名称不基于指定的区域设置，除非在“管理员”中对其进行编辑。

<!-- MC-35633-->

* 通过POST创建的发运 `/rest/V1/shipment` 端点现在可以正确更新订单。 以前，应用产品创建了发运，但发运状态仍处于处理状态。

<!-- ENGCOM-7639 -->

* 贷项通知单现在显示从下单的商店范围派生的付款方法。 以前，贷项通知单会按默认存储范围的定义显示名称。 _修复了由Ledian Hymetllari在拉取请求中提交的问题 [27582](https://github.com/magento/magento2/pull/27582)_. [GitHub-27570](https://github.com/magento/magento2/issues/27570)

### 搜索

<!-- MC-31304-->

* 您现在可以使用QuickSearch从“管理员客户”视图中按属性搜索产品。 以前，目录搜索结果页面上发生异常。

<!-- MC-32518-->

* 添加产品属性后，应用程序现在会按预期在类别页面上显示可配置产品。

<!-- MC-33952-->

* Elasticsearch结果现在包含每个存储视图的属性选项的正确值。 如果 `Dropdown` 或 `Multiple Select` 属性在非默认存储视图中的选项值与在默认存储视图中的选项值不同，现在，Elasticsearch会为该值编制索引，或在结果中返回具有该值的产品。 以前，Elasticsearch不会将该值编入索引，也不会在结果中返回具有该值的产品。

<!-- MC-35013-->

* 现在，在使用SKU的高级搜索中，按SKU进行搜索可以按预期方式工作。Elasticsearch 以前，当您尝试按SKU搜索时，应用程序会显示以下错误消息： `We can't find any items matching these search criteria. Modify your search`.

<!-- ENGCOM-7222-->

* 高级搜索不再允许购物者过滤负价格。 _修复了由Rohan Hapani在拉取请求中提交的问题 [27359](https://github.com/magento/magento2/pull/27359)_. [GitHub-27358](https://github.com/magento/magento2/issues/27358)

<!-- ENGCOM-7917-->

* 现在，范围值会在“新同义词组”窗体中按预期重置。 _修复了由Sathish Subramanian在拉取请求中提交的问题 [29206](https://github.com/magento/magento2/pull/29206)_. [GitHub-28947](https://github.com/magento/magento2/issues/28947)

### 装运

<!-- MC-34734-->

* 现在，应用程序在升级后可以正确计算装运表费率。 以前，发运表费率是根据净价格计算的，净价格不包括增值税。

<!-- MC-33737-->

* 现在，对于指定FedEx作为发运方法的订单，应用产品在结帐工作流中以正确的币种显示发运费率。

<!-- MC-33267-->

* UPS发运的订单的多页发运标签PDF现在显示正确的计数。

<!-- MC-35514-->

* “创建包”页面的JavaScript组件问题已得到解决。 以前，应用程序不显示 **创建送货标签** 复选框，则无法为现有订单创建送货标签。

### Sitemap

<!-- ENGCOM-7924-->

* 中的站点地图 `robots.txt` 现在特定于存储。 _修复了Vadim Malesh在拉取请求中提交的问题 [29331](https://github.com/magento/magento2/pull/29331)_. [GitHub-28901](https://github.com/magento/magento2/issues/28901)

<!-- MC-34617-->

* 编码值现在可在 `sitemap.xml` 文件。 以前，当您在产品名称或图像标题中包含编码字符时，生成的站点地图无效。

### 存储

<!-- MC-35853-->

* 删除之前创建的存储视图不再导致使用拆分数据库配置的部署出错。 以前，应用程序会引发异常。

<!-- MC-32634-->

* 您现在可以导出 `config.php` 和一个网站中的默认网站代码，以便在多网站部署的第二个网站上安装和配置应用程序。 以前，默认存储和视图在导出后消失，并且在店面上发生错误。

### Swagger

<!-- ENGCOM-7720-->

* 您现在可以使用Swagger生成客户令牌。 以前，在输入有效的客户访问信息时，Swagger不会生成响应代码，应用程序会显示以下错误： `The account sign-in was incorrect or your account is disabled temporarily. Please wait and try again later`. _修复了Vadim Malesh在拉取请求中提交的问题 [28822](https://github.com/magento/magento2/pull/28822)_. [GitHub-27098](https://github.com/magento/magento2/issues/27098)

### 色板

<!-- ENGCOM-7845-->

* 现在，当购物者点击时，具有样本的可配置产品会显示层定价 **编辑** 在购物车中。 以前，应用程序在结帐前不会在购物车中显示层价。 _修复了由Sathish Subramanian在拉取请求中提交的问题 [29137](https://github.com/magento/magento2/pull/29137)_. [GitHub-28270](https://github.com/magento/magento2/issues/28270)

<!-- MC-33147-->

* 现在，应用程序可根据可配置产品变体的预期显示层价格。

### 税

<!-- MC-36049-->

* 在商家将产品从产品的属性集中取消分配后，应用产品不再在产品的店面上显示固定产品税属性。

### 测试

<!-- ENGCOM-7874-->

* 已在单元测试中修复PHPUnit 9错误。 _由Anton Evers在拉取请求中提交的修复 [29244](https://github.com/magento/magento2/pull/29244)_. [GitHub-29329](https://github.com/magento/magento2/issues/29329)

<!-- ENGCOM-7995-->

* 为批准具有过期时间的折扣的采购订单添加了单位测试，将全额下单，而不会更新采购订单总数。 _Joan He在拉取请求中提交的修复 [18](https://github.com/magento/partners-magento2-infrastructure/pull/18)_. [GitHub-204](https://github.com/magento/partners-magento2b2b/issues/204)

<!-- ENGCOM-8003-->

* `SynchronizeFilesInterface` 现已通过集成测试。 _由jmonteros422在拉取请求中提交的修复 [29493](https://github.com/magento/magento2/pull/29493)_. [GitHub-1742](https://github.com/magento/magento2/issues/1742)

<!-- ENGCOM-8009-->

* 函数已添加到 `\Magento\TestFramework\TestCase\WebapiAbstract` 这样，测试人员就可以比较测试中预期结果和实际结果的大型嵌套数组，并可以忽略实际结果中不相关的键。 _由Jekabs在拉取请求中提交的修复 [29458](https://github.com/magento/magento2/pull/29458)_. [GitHub-29498](https://github.com/magento/magento2/issues/29498)

<!-- ENGCOM-7887 -->

* 更正了预期值与 `app/code/Magento/Newsletter/Test/Unit/Model/SubscriptionManagerTest.php`. _Lukasz Bajsarowicz在拉取请求中提交的修复 [29271](https://github.com/magento/magento2/pull/29271)_. [GitHub-29283](https://github.com/magento/magento2/issues/29283)

<!-- ENGCOM-7142 -->

* 解决了运行连续测试时静态属性的序列化和取消序列化问题。 _Pavel Bystritsky在拉取请求中提交的修复 [26175](https://github.com/magento/magento2/pull/26175)_. [GitHub-28319](https://github.com/magento/magento2/issues/28319), [GitHub-29313](https://github.com/magento/magento2/issues/29313)

<!-- ENGCOM-7886 -->

* 使用 `ObjectManager` 在单元测试中，已用新关键字替换了在测试期间实例化类。 _Lukasz Bajsarowicz在拉取请求中提交的修复 [29272](https://github.com/magento/magento2/pull/29272)_. [GitHub-29346](https://github.com/magento/magento2/issues/29346)

<!-- ENGCOM-7593 -->

* 为 `updateCustomer` 变异：出生日期无效、电子邮件地址无效和客户姓氏空白。 _由Alexander Taranovsky在拉取请求中提交的修复 [28304](https://github.com/magento/magento2/pull/28304)_. [GitHub-28394](https://github.com/magento/magento2/issues/28394)

<!-- MC-30844-->

* 的 `ApiFunctional TestFramework` GraphQL客户端现在可以正确解析标头。 [GitHub-26425](https://github.com/magento/magento2/issues/26425)

### 主题

<!-- MC-34397-->

* 现在，在用户代理规则中添加的主题会在您运行时按预期受到影响 `bin/magento catalog:images:resize`. 以前，只有分配给商店的主题在 `bin/magento catalog:images:resize` 运行。

### 翻译和区域设置

<!-- MC-20372-->

* 当管理员更改 **日期** 字段，或在管理区域设置为中文或日语时保存。 [GitHub-24696](https://github.com/magento/magento2/issues/24696)

<!-- ENGCOM-7829-->

* 应用程序现在检查区域(前端或 `adminhtml`)。 以前，对 `POST /V1/integration/admin/token` 启用内联翻译时，凭据不正确，导致在API响应中错误消息周围包含内联翻译标记。 _由Zach Nanninga在拉取请求中提交的修复 [28856](https://github.com/magento/magento2/pull/28856)_. [GitHub-28656](https://github.com/magento/magento2/issues/28656)

<!-- ENGCOM-7536-->

* 保加利亚地区已加入 `directory_country_region` 表。 _由Nikola Lardev在拉取请求中提交的修复 [27957](https://github.com/magento/magento2/pull/27957)_. [GitHub-28215](https://github.com/magento/magento2/issues/28215)

<!-- ENGCOM-7535-->

* 管理员上的标题和按钮 **客户**  >  **添加新地址** 和 **编辑产品**  >  **高级库存** 现在可以翻译模式。 _修复了由Sathish Subramanian在拉取请求中提交的问题 [28174](https://github.com/magento/magento2/pull/28174)_. [GitHub-28201](https://github.com/magento/magento2/issues/28201)

<!-- ENGCOM-7521-->

* FPT一词现在可在管理员中翻译  **商店**  > **配置**  > **销售**  > **税**  > **固定产品税**. _修复了Vadim Malesh在拉取请求中提交的问题 [28108](https://github.com/magento/magento2/pull/28108)_. [GitHub-5477](https://github.com/magento/magento2/issues/5477)

<!-- ENGCOM-7631 -->

* 的 **船到此** 已更改结帐工作流发运地址模式上的按钮标签，以匹配用于其他按钮的驼峰式大小写。 现在，此用例与翻译文件中使用的用例相匹配。 以前，由于大小写不匹配，因此未翻译此标签。 _由WK在拉取请求中提交的修复 [28547](https://github.com/magento/magento2/pull/28547)_. [GitHub-28685](https://github.com/magento/magento2/issues/28685)

### UI

<!-- ENGCOM-7514-->

* 现在，在显示隐私和Cookie策略页面时，页脚中的隐私和Cookie策略链接会显示为活动链接。 _修复了由Sathish Subramanian在拉取请求中提交的问题 [28004](https://github.com/magento/magento2/pull/28004)_. [GitHub-27985](https://github.com/magento/magento2/issues/27985)

<!-- MC-36260-->

* 修复了与您从管理员中选择的订单关联的发票的“发票注释”文本区域中光标未对齐的问题 **销售** > **订单数**.

<!-- MC-36044-->

* 此时将显示“创建新订单”页面 **按SKU添加产品** 和 **添加产品** 按钮。

<!-- MC-35974-->

* 现在，当选定产品的产品评级可用时，应用程序会正确显示“编辑审阅”页面。

<!-- MC-35475-->

* 现在，在运行Safari的iPhone上，应用程序可正确显示管理员客户编辑页面。

<!-- MC-35370-->

* 更正了“创建新订单”页面上不必要的滚动。

<!-- MC-35345-->

* 直接单击 **出口税率** “添加新税则”页(**商店**  >  **税则**)现在下载 `tax_rates.csv` 文件。 以前，商户必须单击 **出口税率** 按钮。 这是2.4.0中的已知问题。

<!-- MC-35313-->

* 的 **将选择添加到购物车** 按钮现在可按预期工作。 这是2.4.0中的已知问题。

<!-- MC-35296-->

* 的 **刷新** 按钮 **最近查看的产品** 现在，客户活动页面的部分可按预期工作。 以前，单击 **刷新**，则未刷新产品列表，并且页面已滚动。

<!-- MC-35412-->

* 现在，应用程序在的“条件”选项卡上正确显示用于选择客户出生日期的日历图标 **客户** > **区段** > **添加区段**.

<!-- MC-35658-->

* 当购物者在Internet Explorer 11.x上滚动浏览此页面时，结账工作流的结账摘要部分不再闪烁。

<!-- MC-34602-->

* 现在，应用程序可在店面类别页面上正确显示按SKU排序的小组件。 以前，未呈现此小组件的HTML代码，且应用程序不显示 **加载SKU列表** 链接。

<!-- MC-37444-->

* 已使用 `this.disabled(true)` 不再显示在店面上。 [GitHub-29098](https://github.com/magento/magento2/issues/29098)

<!-- ENGCOM-7264-->

* 现在，应用程序可在移动设备视图中正确显示最近查看的产品小组件。 _修复由Tu Nguyen在拉取请求中提交 [27572](https://github.com/magento/magento2/pull/27572)_. [GitHub-27058](https://github.com/magento/magento2/issues/27058)

<!-- ENGCOM-7575-->

* 现在，从管理员更改产品的位置会反映在店面的产品位置。 _Oleg Aleksin在拉取请求中提交的修复 [28150](https://github.com/magento/magento2/pull/28150)_. [GitHub-28149](https://github.com/magento/magento2/issues/28149)

<!-- ENGCOM-7507-->

* 现在，登录表单样式与空白主题中其他表单的样式一致。 已删除为容器控件换行输入字段设置宽度的不必要样式。 _修复由Tu Nguyen在拉取请求中提交 [28084](https://github.com/magento/magento2/pull/28084)_. [GitHub-28059](https://github.com/magento/magento2/issues/28059)

<!-- ENGCOM-7578-->

* 的 **确定** 迷你购物车删除产品确认弹出窗口中的按钮现在可以按预期工作。 _修复由Tu Nguyen在拉取请求中提交 [28083](https://github.com/magento/magento2/pull/28083)_. [GitHub-27095](https://github.com/magento/magento2/issues/27095)

<!-- ENGCOM-7456-->

* 在页面加载期间，产品库元素不再闪烁。 _由Mateusz Krzeszowiak在拉取请求中提交的修复 [27871](https://github.com/magento/magento2/pull/27871)_. [GitHub-28339](https://github.com/magento/magento2/issues/28339)

<!-- ENGCOM-8007-->

* 现在，控制字段宽度的CSS类将按预期在整个管理员中应用于“开始时间”元素。 _由Shankar Konar在拉取请求中提交的修复 [29511](https://github.com/magento/magento2/pull/29511)_. [GitHub-29496](https://github.com/magento/magento2/issues/29496)

<!-- ENGCOM-7992-->

* “条款和条件”文本标签现在可以正确显示较长的文本字符串。 _由Bartłomiej Szubert在拉取请求中提交的修复 [29413](https://github.com/magento/magento2/pull/29413)_. [GitHub-24060](https://github.com/magento/magento2/issues/24060)

<!-- ENGCOM-7967-->

* 为了准确起见，订单失败页面的标题已重写。 以前，当购物者取消订单时，应用程序会显示一个具有此标题的页面： `We received your order!`. _由Angelo Romano在拉取请求中提交的修复 [29410](https://github.com/magento/magento2/pull/29410)_. [GitHub-29416](https://github.com/magento/magento2/issues/29416)

<!-- ENGCOM-7770-->

* 已取消订单查看页面上已取消的项目总数现在可以在已取消订单查看页面上正确识别。 以前，此字段被标记为 **应付总额**. _Madhu Rajawat在拉取请求中提交的修复 [27516](https://github.com/magento/magento2/pull/27516)_. [GitHub-26191](https://github.com/magento/magento2/issues/26191)

<!-- ENGCOM-7579 -->

* 现在，“创建可配置产品”页面上的切换按钮可按预期工作。 _修复由Tu Nguyen在拉取请求中提交 [28032](https://github.com/magento/magento2/pull/28032)_. [GitHub-22702](https://github.com/magento/magento2/issues/22702)

<!-- ENGCOM-7579 -->

* 现在，“高级属性属性”页面上的“高级属性”属性块图标可按预期执行。 _修复由Tu Nguyen在拉取请求中提交 [28032](https://github.com/magento/magento2/pull/28032)_. [GitHub-26022](https://github.com/magento/magento2/issues/26022)

<!-- ENGCOM-7619 -->

* 现在，当您尝试保存新模块的配置设置时，系统配置页面的“管理员”部分将展开，以按预期显示必填字段。 _由Bartłomiej Szubert在拉取请求中提交的修复 [28285](https://github.com/magento/magento2/pull/28285)_. [GitHub-26427](https://github.com/magento/magento2/issues/26427)

<!-- ENGCOM-7826 -->

* 当模式设置为 `inside`. _由Sean van Zuidam在拉取请求中提交的修复 [29077](https://github.com/magento/magento2/pull/29077)_. [GitHub-29076](https://github.com/magento/magento2/issues/29076)

<!-- ENGCOM-7010 -->

* 更正了当购物者在页脚的订阅字段中输入了无效电子邮件地址时导致的不连续较长的输入字段宽度。 _修复了Dipesh Rangani在拉取请求中提交的问题 [27106](https://github.com/magento/magento2/pull/27106)_. [GitHub-27099](https://github.com/magento/magento2/issues/27099)

<!-- ENGCOM-7972 -->

* 安 `Uncaught ReferenceError` 添加新标记并将鼠标光标移动到开发控制台上时，该控制台中不再显示错误。 _由Nazar Klovanych在拉取请求中提交的修复 [29392](https://github.com/magento/magento2/pull/29392)_. [GitHub-1700](https://github.com/magento/magento2/issues/1700)

### URL重写

<!-- MC-34483-->

* 将商店视图移动到其他网站不再重置URL。 以前，应用程序错误地重新生成了CMS和产品URL重写。

<!-- MC-33028-->

* 现在，当将存储视图分配给其他存储时，应用程序会按预期保留现有的目录URL重写。 以前，应用程序会删除特定于存储的URL重写。

### 清漆

<!-- ENGCOM-7761-->

* 重新启动清漆不再导致503错误。 _修复了Ihor Sviziev在拉取请求中提交的问题 [28137](https://github.com/magento/magento2/pull/28137)_. [GitHub-24353](https://github.com/magento/magento2/issues/24353)

### 保管库

<!-- MC-34674-->

* 当 **保存以供日后使用** 复选框。

### Web API框架

<!-- MC-35838-->

* 具有多个网站的商户现在可以使用REST API创建和更新产品，同时保留图像和图像角色继承。 以前，当商家使用REST API创建和更新产品，并更新产品以用于商店视图时，系统会为该商店视图加载并保存默认图像角色。 因此，在更新后，存储视图图像角色不再继承默认范围。

<!-- MC-36419-->

* 当资源权限允许访问时，未限定范围的集成用户帐户现在可以通过REST API访问资源。

<!-- MC-35975-->

* 搜索标准筛选器现在可以按预期方式对创建可配置产品期间使用的产品属性使用。 [GitHub-29126](https://github.com/magento/magento2/issues/29126)

<!-- ENGCOM-7785 -->

* 现已验证客户组ID以进行POST `/rest/V1/customers` 请求。 以前，当您使用的是无效的 `group_id` 在这些请求中。 _修复了Vadim Malesh在拉取请求中提交的问题 [28903](https://github.com/magento/magento2/pull/28903)_. [GitHub-28064](https://github.com/magento/magento2/issues/28064)

<!-- ENGCOM-7611 -->

* 默认情况下，不会为匿名REST调用创建PHP会话。 以前，即使不必要，也会启动会话。 _修复由Maciej Pawłowski在拉取请求中提交 [26032](https://github.com/magento/magento2/pull/26032)_. [GitHub-7213](https://github.com/magento/magento2/issues/7213)

<!-- ENGCOM-7612 -->

* 使用各种REST端点更新包含自定义选项的订单不再删除自定义选项信息。 以前， `info_buyRequest` 被删除。 _修复了Vadim Malesh在拉取请求中提交的问题 [28483](https://github.com/magento/magento2/pull/28483)_. [GitHub-22431](https://github.com/magento/magento2/issues/22431)

<!-- ENGCOM-7665 -->

* 使用GET `V1/customers/me` 现在荣誉 **共享客户帐户** 设置（管理员） **商店** >  **配置**  >  **客户**  >  **客户配置**  > **帐户共享选项**)检索用户信息时。 _Pavel Bystritsky在拉取请求中提交的修复 [28213](https://github.com/magento/magento2/pull/28213)_. [GitHub-26089](https://github.com/magento/magento2/issues/26089)

<!-- ENGCOM-7563 -->

* 与地址相关的扩展属性可以设置为数据数组。 以前，当包含的POST请求  `extension_attributes` 已发送到 `estimate-shipping-methods`. 此错误（由先前的提交引入）会影响上设置的任何扩展属性 `Magento\Quote\Api\Data\AddressInterface` 不是物体。 _由Alexander Menk在拉取请求中提交的修复 [27338](https://github.com/magento/magento2/pull/27338)_. [GitHub-26682](https://github.com/magento/magento2/issues/26682)

<!-- ENGCOM-7618 -->

* 现在，您可以在使用PUT更新客户时指定单个字段 `V1/customers/:id` 端点。 以前，端点要求您指定客户电子邮件以及创建客户所需的其他字段。 _修复了Vadim Malesh在拉取请求中提交的问题 [28332](https://github.com/magento/magento2/pull/28332)_. [GitHub-21237](https://github.com/magento/magento2/issues/21237)

### 愿望列表

<!-- MC-35622-->

* 客户现在可以从愿望清单本身更改愿望清单中产品的数量。 以前，应用产品不更新产品数量，也不显示消息。

<!-- MC-35618-->

* 客户现在可以从愿望列表本身更改愿望列表中分组产品的数量。 以前，应用产品不更新产品数量或显示消息。

<!-- ENGCOM-7580-->

* 用于的填充 `Map`, `WeakMap`, `FormData`和 `MutationObserver` 现在只会根据需要加载。 _修复了由Dmitry Tsymbal在拉取请求中提交的问题 [28330](https://github.com/magento/magento2/pull/28330)_. [GitHub-28377](https://github.com/magento/magento2/issues/28377)

<!-- ENGCOM-7561-->

* 愿望清单更新过程现在支持同时更新愿望清单项目及其说明。 _由Eduard Chitoraga在拉取请求中提交的修复 [28222](https://github.com/magento/magento2/pull/28222)_. [GitHub-28261](https://github.com/magento/magento2/issues/28261)

<!-- ENGCOM-7660-->

* 添加了一个测试，用于共享超过允许电子邮件数量的客户愿望列表。 _修复了由Dmitry Tsymbal在拉取请求中提交的问题 [28641](https://github.com/magento/magento2/pull/28641)_. [GitHub-28720](https://github.com/magento/magento2/issues/28720)

<!-- MC-36250-->

* 管理员现在可以配置一个可配置的产品，该产品已由客户从非默认商店添加到愿望列表。 以前，当客户还从非默认商店添加可配置产品时，应用程序会引发错误。

<!-- ENGCOM-7660-->

* 添加了一个测试，用于共享超过允许电子邮件数量的客户愿望列表。 _修复了由Dmitry Tsymbal在拉取请求中提交的问题 [28641](https://github.com/magento/magento2/pull/28641)_. [GitHub-28720](https://github.com/magento/magento2/issues/28720)

<!-- ENGCOM-7674-->

* 添加了测试，用于从客户的愿望列表中删除项目作为管理员用户。 _修复了由Dmitry Tsymbal在拉取请求中提交的问题 [28632](https://github.com/magento/magento2/pull/28632)_. [GitHub-28721](https://github.com/magento/magento2/issues/28721)

<!-- ENGCOM-7675-->

* 添加了禁用愿望列表功能的测试。 _修复了由Dmitry Tsymbal在拉取请求中提交的问题 [28635](https://github.com/magento/magento2/pull/28635)_. [GitHub-28744](https://github.com/magento/magento2/issues/28744)

<!-- ENGCOM-7580-->

* 添加了在共享客户愿望列表时使用无效电子邮件地址的测试。 `StorefrontShareWishlistEntityTest` 已重构。 `StorefrontCustomerShareWishlistActionGroup` 已弃用。 _修复了由Dmitry Tsymbal在拉取请求中提交的问题 [28330](https://github.com/magento/magento2/pull/28330)_. [GitHub-28377](https://github.com/magento/magento2/issues/28377)

<!-- ENGCOM-7717-->

* 添加了一项测试，用于共享客户的愿望列表，该列表超出了允许的文本长度限制。 _修复了由Dmitry Tsymbal在拉取请求中提交的问题 [28812](https://github.com/magento/magento2/pull/28812)_. [GitHub-28969](https://github.com/magento/magento2/issues/28969)

## 已知问题

**问题**:使用第三方支付提供商时，下单页面上用于结账的新CAPTCHA功能无法按预期工作。 运行2.3.6或2.4.1的商户在下单店面页面上启用了CAPTCHA保护，则在使用第三方支付提供商（如PayPal）签出时，将会看到此错误： `Please provide CAPTCHA code and try again`. **解决方法**:此问题现已修复。 请参阅 [Magento Open Sourcev2.3.6/2.4.1结帐时CAPTCHA无法正常工作](https://support.magento.com/hc/en-us/articles/360051235772) 知识库文章。 我们的下一季度修补程序(Q12021)中还将包含修复。

**问题**:没有管理员权限的用户当前无法设置其个人2FA访问权限。 2FA包括两个ACL角色。 一个角色会影响全局系统配置，并且只有在配置系统时才需要它。 第二个ACL角色影响单个用户2FA帐户。 管理员用户必须配置此第二类2FA ACL。 **解决方法**:用户登录后看到“访问被拒绝”屏幕后，便可以访问 `https://<magento store>/<admin_path>/tfa/tfa/requestconfig/` 强制配置。 注意：我们不建议禁用安全设置。 但是，此解决方法仅在禁用管理员URL密钥时有效。

**问题**:的 **创建帐户** 如果购物者输入了无效数据，则“创建新帐户”页面上的按钮将保持禁用状态。 这样可防止购物者在出错后再次尝试创建帐户。 **解决方法**:应用修补程序 `MC-38509`. 我们的下一个季度版本（2.4.2、2.4.1-p1和2.3.6-p1）中也将包含修复内容，这些版本计划于2021年第1季度发布。 请参阅 [2.4.1和2.3.6创建帐户按钮已禁用的修补程序](https://support.magento.com/hc/en-us/articles/360051130212) 知识库文章。  [GitHub-30513](https://github.com/magento/magento2/issues/30513)

**问题**:启用dotdigital后，商户无法从Safari的管理员登录dotdigital。 请参阅 [启用dotdigital帐户后，无法通过管理面板在dotdigital中登录](https://support.magento.com/hc/en-us/articles/360050092291) 知识库文章。

**问题**:当购物者选择与帐单地址不同的送货地址时，顶点地址验证在付款期间不起作用。 此问题将在2.4.2中修复。请参阅 [2.4.1已知问题：更新地址后，顶点地址验证消息不会消失](https://support.magento.com/hc/en-us/articles/360050139631) 知识库文章。

**问题**:当商户在Safari浏览器上保存Dotdigital Page Builder表单时，应用程序会显示一个空页面。 **解决方法**:重新加载页面以应用您所做的更改。 请参阅 [2.4.1已知问题：保存dotdigital Page Builder表单后留空页面](https://support.magento.com/hc/en-us/articles/360049819092) 知识库文章。

**问题**:在某些情况下，应用程序会自动将客户登录到以前使用的Amazon帐户，而是提示客户在使用Amazon支付结帐时登录。 请参阅 [2.4.1已知问题：无法在Google Chrome中更改Amazon帐户](https://support.magento.com/hc/en-us/articles/360049814152) 知识库文章。

**问题**:当选择PayPalBraintree付款和多个地址发运时，应用产品会在结帐工作流的帐单页面上短暂显示错误消息。 请参阅 [2.4.1已知问题：在结帐时弹出错误并显示PayPalBraintree](https://support.magento.com/hc/en-us/articles/360050253211) 知识库文章。

**问题**:当来宾客户尝试在来宾结帐被禁用时通过Braintree向PayPal下订单时，应用程序会显示一条不详的错误消息。 请参阅 [2.4.1已知问题：使用Paypal通过Braintree在来宾结账期间显示无信息错误消息](https://support.magento.com/hc/en-us/articles/360050368111) 知识库文章。

## 社区贡献

我们感谢更广泛的Magento Open Source群体，并感谢他们对本稿的贡献。 请通过以下方式了解社区对当前版本的贡献：

* 如果社区成员已对此版本提供了修复，我们将在这些说明的“已修复问题”部分中标识该修复，并使用短语“*社区成员提供的修复*&quot;

* 社区工程团队 [Magento参与者](https://magento.com/magento-contributors) 按月、季度和年维护排名最前的参与个人和合作伙伴列表。 在该“参与者”页面中，您可以在GitHub上跟踪指向其合并PR的链接。

### 合作伙伴贡献

下表重点介绍了合作伙伴的贡献。 此表列出了提供拉取请求、外部拉取请求以及与其关联的GitHub问题编号（如果可用）的合作伙伴。

{{$include /help/_includes/release-notes/engcomm-2-4-1-partner.md}}

### 个人参与者贡献内容

下表列出了社区成员的贡献内容。 此表列出了外部拉取请求、与其关联的GitHub问题编号（如果可用），以及贡献拉取请求的社区成员。

{{$include /help/_includes/release-notes/engcomm-2-4-1-issues.md}}

### 系统要求

我们的技术堆栈构建在PHP和MySQL上。 有关更多信息，请参阅 [系统要求](../../../installation/system-requirements.md).

### 安装和升级说明

您可以使用编辑器安装Magento Open Source2.4.1。

## 迁移工具包

数据迁移工具可帮助将现有Magento1.x存储数据传输到Magento2.x。此命令行界面包括验证、进度跟踪、日志记录和测试功能。 有关安装说明，请参阅 [安装数据迁移工具](../../../tools/data-migration-tool/install.md). 考虑探索或为 [数据迁移存储库](https://github.com/magento/data-migration-tool).

的 [代码迁移工具包](https://github.com/magento-commerce/code-migration) 帮助将现有Magento1.x存储扩展和自定义项传输到Magento2.x。命令行界面包含用于转换Magento1.x模块和布局的脚本。
