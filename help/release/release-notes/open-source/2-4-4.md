---
title: Magento Open Source2.4.4发行说明
description: 了解2.4.4版本中的新增功能、增强功能、错误修复和已知问题Magento Open Source。
source-git-commit: 065c56f20ba5b1eef8c331c5c2f5649902f1442b
workflow-type: tm+mt
source-wordcount: '11128'
ht-degree: 0%

---


# Magento Open Source2.4.4发行说明

Magento Open Source2.4.4引入了对PHP 8.1的支持。为了与PHP 8.1兼容，所有项目库和依赖项都已更新。核心编辑器依赖项和第三方库也已升级到与PHP 8.1兼容的最新版本。此版本还支持OpenSearch 1.2。

此版本包括近250项质量修复和增强功能。

>[!NOTE]
>
>多亏了我们的搭档 [阿特维克斯](https://www.atwix.com/) 为使我们的2.4.4框架与PHP 8.1兼容做出了重大贡献。

{{bics}}

## 应用 `AC-3022.patch` 继续提供DHL作为航运公司

DHL已引入模式版本6.2，并将在不久的将来弃用模式版本6.0。 Adobe Commerce 2.4.4及更早版本（支持DHL集成）仅支持版本6.0。部署这些版本的商户应适用 `AC-3022.patch` 尽早将DHL作为航运公司继续提供。 请参阅 [应用补丁程序以继续提供DHL作为运输承运人](https://support.magento.com/hc/en-us/articles/7707818131597-Apply-a-patch-to-continue-offering-DHL-as-shipping-carrier) 有关下载和安装修补程序的信息，知识库文章。

## 其他发行信息

尽管这些功能的代码与每季度发布的Magento Open Source核心代码捆绑在一起，但其中一些项目也是独立发布的。 这些项目的错误修复会在特定于项目的单独发行信息中进行记录，该信息可在每个项目的文档中找到。

>[!NOTE]
>
>除Braintree外，所有与供应商捆绑的扩展都已从Magento Open Source2.4.4中删除。

>[!NOTE]
>
>编辑器2.2引入了一项安全功能，要求商家识别其中可信的插件 `composer.json` 文件，然后再执行插件。 目前， `composer.json` 文件但未标记为受信任的文件将自动安装。 但是，自2022年7月起，编辑器将不会加载插件，除非明确允许这些插件。 请参阅 [升级到Adobe Commerce 2.4.4时，编辑器插件出现问题](https://support.magento.com/hc/en-us/articles/6215997614093-Composer-plugins-issues-when-upgrading-to-Adobe-Commerce-2-4-4) 有关如何修改 `composer.json` 文件来明确允许加载插件。

### 此版本中包含的修补程序

Magento Open Source2.4.4包括通过以下修补程序解决的所有问题，这些修补程序为Adobe Commerce和Magento Open Source2.4.3、2.4.3-p1和2.3.7-p2提供：

* 解决的漏洞 `MDVA-43395_EE_2.4.3-p1_COMPOSER_v1.patch` 和 `MDVA-43443_EE_2.4.3-p1_COMPOSER_v1.patch` 已在此版本中解决。

* `AC-384_Fix_Incompatible_PHP_Method__2.4.3_ce.patch`. 此修补程序解决了升级期间发生的致命PHP错误。 请参阅 [Adobe Commerce升级2.4.3、2.3.7-p1 PHP错误修补程序](https://support.magento.com/hc/en-us/articles/4408021533069-Adobe-Commerce-upgrade-2-4-3-2-3-7-p1-PHP-Fatal-error-Hotfix) 知识库文章。

## Magento Open Source2.4.4亮点

在此版本中查找以下亮点。

### 安全性增强

此版本包括一项安全修复和平台安全改进。 此安全修复已支持到Magento Open Source2.4.3-p2和Magento Open Source2.3.7-p3。

迄今为止，尚未发生与这些问题相关的已确认攻击。 但是，某些漏洞可能会被利用来访问客户信息或接管管理员会话。 大多数这些问题要求攻击者首先获得对管理员的访问权限。 因此，我们提醒您采取一切必要步骤保护您的管理员，包括但不限于以下工作：

* IP
* [双重身份验证](https://devdocs.magento.com/guides/v2.4/security/two-factor-authentication.html)
* 使用VPN
* 使用唯一位置，而不是 `/admin`
* 密码卫生良好

请参阅 [Adobe安全公告](https://helpx.adobe.com/security/products/magento/apsb22-13.html) 以了解这些修复问题的最新讨论。

#### 其他安全增强功能

此版本的安全改进提高了对最新安全最佳实践的合规性，包括：

* 2.3.4中已弃用电子邮件变量用法，作为降低安全风险的一部分，转而使用更严格的变量语法。 此旧版行为已在此版本中完全删除，这是降低安全风险措施的延续。

   因此，升级到Adobe Commerce 2.4.4或Magento Open Source2.4.4后，在以前版本的Magento Open Source中工作的电子邮件或新闻稿模板可能无法正常工作。受影响的模板包括来自自定义模块或第三方扩展的管理员覆盖、主题、子主题和模板。 即使使用 [升级兼容性工具](https://experienceleague.adobe.com/docs/commerce-operations/upgrade-guide/upgrade-compatibility-tool/overview.html?lang=en) 修复已弃用的用法。 请参阅 [迁移自定义电子邮件模板](https://developer.adobe.com/commerce/frontend-core/guide/templates/email-migration/) 以了解有关迁移受影响模板的潜在影响和准则的信息。

* 集成令牌不能再用于API载体令牌身份验证。 以前，集成令牌可用作基于令牌的身份验证的独立密钥。 但是，由于永不过期的访问令牌的安全影响，默认情况下已禁用此行为。 以前的行为可以通过命令行或管理员来启用。 请参阅 [基于令牌的身份验证](https://developer.adobe.com/commerce/webapi/get-started/authentication/gs-authentication-token/). <!-- AC-1619 -->

* 会话ID不再存储在数据库中。 <!-- AC-522-->

* 现在，OAuth访问令牌和密码重置令牌在存储到数据库中时已进行加密。 <!-- AC-520 1323-->

* 已加强验证，以防止上载非字母数字文件扩展名。 <!-- AC-479-->

* 为优惠券代码添加了reCAPTCHA支持。 <!-- AC-461-->

* 现在，当Magento Open Source处于生产模式时，默认情况下会禁用Swagger。 <!-- AC-1450-->

* 现在，默认情况下为Magento Open Source店面启用HTTPS。 的 **在店面上使用安全URL** 和 **在管理员中使用安全URL** 设置默认处于启用状态，所有内置cookie现在都设置为安全。  <!-- AC-1173-->

* 现在，所有Magento Open Source安装都需要依赖项混淆插件。 以前，仅基于编辑器的安装需要使用此插件。 现在，它允许使用可信的版本。 商家可以绕过此插件中设置的限制，这些限制会禁止某些编辑器安装组合。 对于受信任的版本，可以绕过限制，现在，在继续安装之前，Magento Open Source会显示警告。  <!-- AC-501 970-->

* 开发人员现在可以基于每个端点对Magento Open SourceRESTful端点接受的阵列大小进行限制。 请参阅 [API安全](https://developer.adobe.com/commerce/webapi/get-started/api-security/). <!-- AC-465-->

* 添加了机制，用于限制用户在全系统范围内通过Web API可请求的资源大小和数量，以及覆盖单个模块中的默认值。 它解决了 `MC-43048__set_rate_limits__2.4.3.patch`. 请参阅 [API安全](https://developer.adobe.com/commerce/webapi/get-started/api-security/). <!-- AC-1120-->

### 平台增强功能

Magento Open Source2.4.4现在支持PHP 8.1。为与PHP 8.1兼容，已更新所有项目库和依赖项。其他平台增强功能包括：

* Magento Open Source2.4.4支持Elasticsearch7.16和OpenSearch 1.2。托管部署的应用程序开源商户可以使用任一解决方案。 但是，OpenSearch现在是云中托管的Magento Open Source2.4.4部署的默认搜索引擎。 升级到版本2.4.4的所有具有云部署的客户都必须使用OpenSearch。 请参阅 [在Cloud 2.4.4中切换到OpenSearch for Adobe Commerce](https://support.magento.com/hc/en-us/articles/4419942355725-Switching-to-OpenSearch-for-Adobe-Commerce-on-Cloud-2-4-4)

* 的 `JQuery` 库已升级到版本3.6。 `jquery-ui` 库已升级到版本1.13.0。其他一些JavaScript库已更新到最新版本。

* 现在支持TinyMCE 5.8.1。 TinyMCE 4已从代码库中删除。 <!-- AC-41-->

* 的 `RequireJS` 库已升级到最新版本(v2.3.6)。 [GitHub-33672](https://github.com/magento/magento2/issues/33672) <!-- AC-40 422-->

* PHPUnit已升级到最新版本(9.5.x)。 测试和测试框架已更新，以与新版本兼容。 <!-- AC-404-->

* 大多数Laminas依赖项已升级到与PHP 8.1兼容的最新版本。从代码库中删除了三个Laminas依赖项，以减少依赖项的数量。

#### jQuery UI升级

jQuery UI已升级到最新版本(v1.13.0)。 已删除以下v1.10.0 jQuery组件：

* `ajaxOptions` 和 `cache` 选项。 请参阅 [选项卡](https://jqueryui.com/changelog/1.10.0/#tabs).

* `.zIndex()`. jQuery UI v1.12.1包括 `jquery/z-index.js`，它支持使用 `.zIndex()`. 请参阅 [UI核心](https://jqueryui.com/changelog/1.12.0/#ui-core).

* 小组件名称的数据回传。 您必须对 `.data()` 键。

* 类的硬编码，例如 `ui-corner-all` 在小组件中。

### GraphQL

此版本包括以下GraphQL增强功能：

* **性能改进**:

   * GraphQL购物车操作的性能已得到改进。 的 `collectQuoteTotals()` 现在，在GraphQL请求期间只调用一次方法，这可缩短响应时间。 <!-- PWA-2110-->

   * 对GraphQL请求的缓存方式进行了更改，从而提高了Storefront性能。 现在，Fastly and Quiset可缓存随 `auth` 令牌。 <!-- PWA-1817-->

* **与店面相关的新管理员配置设置**. 的 `storeConfig` 查询现在返回零小计结账和支票/货币订单付款方法的配置设置。 <!-- PWA-1576-->

* **更新了核心GraphQL库**. 的 `webonyx` 使核心GraphQL能够正常运行的库已升级到版本^14.9。 <!-- PWA-2137 2184 -->

* **修复了GraphQL中多站点和多语言存储的翻译问题**. 现在，GraphQL解析程序会根据预期的存储范围返回已翻译的字符串。 <!-- PWA-1946-->

* GraphQL现在为New Relic提供描述性事务名称，这有助于进行调试。 [GitHub-30915](https://github.com/magento/magento2/issues/30915) <!-- PWA-1311-->

请参阅 [GraphQL开发人员指南](https://devdocs.magento.com/guides/v2.4/graphql/) 以了解这些增强功能的详细信息。

### 供应商捆绑的扩展

除 [Braintree](https://docs.magento.com/user-guide/payment/braintree.html)，则从Magento Open Source2.4.4代码库中删除了所有供应商捆绑的扩展。 商户应迁移到官方扩展，这些扩展在 [Commerce Marketplace](https://marketplace.magento.com/extensions.html).

[Amazon Pay](https://docs.magento.com/user-guide/payment/payments.html)

[dotdigital](https://docs.magento.com/user-guide/marketing/communications.html)

[克拉纳](https://docs.magento.com/user-guide/payment/payments.html)

[顶点](https://docs.magento.com/user-guide/tax/taxes.html)

[烟浦](https://docs.magento.com/user-guide/marketing/product-reviews.html)

### PayPal支付增强功能

* 现在支持维恩莫付款选项。  <!-- AC-1229-->

* 已根据购物者的位置（而非商户的位置）添加“稍后付款”作为购物者的选项。

* 现在，商家在测试其所选国家/地区的购物者体验时，可以设置购物者所在的国家/地区。 以前，测试仅限于测试商户所在的国家/地区。 此更改仅在沙盒模式下有效。

* 结账页面上的消息现在会显示有关购物者在使用“稍后付款”时预期支付的增量金额和增量的准确消息。

### 辅助功能更新

此版本增强了对标准无障碍准则的遵守。 它包括改进的工具提示、可访问的屏幕元素命名和标记，以及重新设计的图标和按钮。 其中80%以上的修复有助于改善无视力或视力受限用户的购物体验。

### 页面生成器

商户现在可以添加替换文本(`alt_text`)到图像（图像、横幅、幻灯片）以增强内容辅助功能。 [GitHub-746](https://github.com/magento/magento2-page-builder/issues/746) <!-- PB-1193-->

## 已修复的问题

我们正在修复Magento Open Source2.4.4核心代码中的数百个问题。 下面介绍了这些已修复问题的子集。

### 安装、升级、部署

<!-- MC-42026-->

* Magento Open Source现在可以按预期方式在生成日志文件中记录静态内容部署错误。

<!-- MC-43094-->

* 数据修补程序不能再忽略表的唯一约束并将重复值插入MySQL数据库表。 以前，修补程序可能会插入重复值，这会损坏数据库。

<!-- AC-1480-->

* 现在，商户可以通过Klarna成功从Magento Open Source2.4.2部署升级到Magento Open Source2.4.3。 [GitHub-33760](https://github.com/magento/magento2/issues/33760)

<!-- ACP2E-77-->

* 现在，可以从命令行成功更改站点地图生成器配置。 以前，当您尝试在“管理员”之外更改站点地图配置时，applicationOpenSource会显示此错误： `Import failed: Notice: Trying to access array offset on value of type null in app/code/Magento/Cron/Model/Config/Backend/Sitemap.php on line 78`.  [GitHub-31428](https://github.com/magento/magento2/issues/31428)

<!-- ACP2E-215-->

* 的 `bin/magento app:config:import` 现在，命令在您更新时执行时不出错 `time` 值 `config.php`. 以前，通过手动编辑（即不使用管理员）更改产品警报配置会导致错误。

### 辅助功能

<!-- AC-1589-->

* 解决了在购物车和结帐页面上导航时出现的辅助功能错误。 [GitHub-34483](https://github.com/magento/magento2/issues/34483)

<!-- AC-1289-->

* 屏幕阅读器现在可以阅读产品页面上的所有相关表单元素。

<!-- AC-1277-->

* 改进了整个店面中图像删除和移动图标按钮的对比度，以提高低视觉用户的可读性。

<!-- AC-1272-->

* 为用于在产品界面中执行搜索的放大镜图标分配了一个可访问的名称和替换文本。

<!-- AC-1275-->

* 现在可以使用Tab键访问富文本编辑器工具栏。

<!-- AC-1283-->

* 的 **此项目具有权重** 在 **目录** > **产品** 详细信息页面现在具有可见的标签和可访问的名称。

<!-- AC-1284-->

* 控件的辅助名称现在包含其可见标签的文本，用于显示每页面的项目数下拉列表。

<!-- AC-1287-->

* 表格控制 **目录** > **产品** 现在，在折叠表格时，“详细信息”页面具有可见的标签和可访问的名称。

<!-- AC-1288-->

* 现在，“产品”(Products)表格中的“编辑链接”(edit links)具有唯一且有意义的链接文本。

<!-- AC-1276-->

* 现在，扩展工具提示的触发器会提供文本名称。

<!-- AC-1285-->

* 整个店面的按钮现在具有唯一且描述性的可访问名称。 以前，带有文本按钮和相邻的向下箭头图标按钮的拆分按钮具有相同的可访问名称。

<!-- AC-1277-->

* 改进了整个店面中图像删除和移动图标按钮的对比度，以提高低视觉用户的可读性。

<!-- AC-1279-->

* 向铅笔图标中添加了文本替代内容，当商家编辑搜索引擎优化折叠面板的输入时，该图标会显示。

<!-- AC-1272-->

* 为用于在产品界面中执行搜索的放大镜图标分配了一个可访问的名称和替换文本。

<!-- AC-1286-->

* 产品页面 **新建视图** 文本输入字段现在具有可访问的名称。

<!-- AC-1283-->

* 的 **此项目具有权重** 在 **目录** > **产品** 详细信息页面现在具有可见的标签和可访问的名称。

### 后端

<!-- MC-43161-->

* 管理员现在可以在配置了自定义管理员路径且启用了密钥的部署中登录到管理员。 以前， applicationOpen Source显示以下错误： `Invalid security or form key. Please refresh the page`.

<!-- MC-41949-->

* Magento Open Source在多商店层次结构发生更改时不再重定向到“所有商店视图”范围。 以前，保存层级后，购物者会被重定向到错误的商店URL，并且在多商店部署中选择了“所有商店查看”范围。

### 捆绑产品

<!-- MC-42885-->

* 购物者现在可以向其购物车添加包含固定产品税和两个选项的捆绑产品。 以前，applicationOpen Source未添加产品并显示以下错误： `We can't add this item to your shopping cart right now`.

<!-- MC-42249-->

* 表单验证 `data-validate` 和 `min` 属性已添加到购物车数量字段，以防止捆绑产品出现负值。

<!-- MC-41794-->

* 的 `products` 现在，当在商店视图级别禁用子产品时，查询可正确筛选捆绑产品。 以前，查询会返回在商店视图级别禁用的子产品。

<!-- MC-42811-->

* `cron` 现在，按照 `indexer_update_all_views` 执行。 以前，在对类别中的许多产品进行批量更新后，applicationOpen Source在类别页面上显示错误的产品计数。

<!-- MC-42811-->

* Magento Open Source现在会在捆绑产品重新出现在库存中时，按预期更新类别产品缓存。

<!-- AC-715-->

* 现在，在使用不同货币的多商店部署中，对于捆绑产品购买，在电子邮件确认中会按预期进行货币换算。 [GitHub-33426](https://github.com/magento/magento2/issues/33426)

<!-- ACP2E-64-->

* 现在，在产品网格中，可以正确显示前缀为%的捆绑产品的高级定价特价折扣。 以前，在产品网格中错误地显示%折扣，其前缀是$ ，而不是% 。

<!-- ACP2E-262-->

* 现在，当相关产品更改其状态时，管理员中的捆绑产品状态会自动更新。

<!-- ACP2E-326-->

* 捆绑产品的GraphQL解析程序现在检查子捆绑产品是否已禁用。 以前，不会进行此检查，并会查询此类 `categoryList` 退货了不可售的儿童产品。

<!-- MC-43223-->

* `cart` 现在，查询响应会为具有动态价格的捆绑产品返回准确的折扣。 以前，查询响应包含单独应用于每个捆绑产品的折扣。

### 缓存

<!-- MC-42811-->

* 优化了在重新索引期间运行的缓存清理算法。 现在，在重新索引期间缓存类别时，捆绑产品会按预期显示。 以前，在重新索引期间缓存产品类别后的数小时内，不会显示捆绑产品。

<!-- AC-328-->

* 在典型使用下，页面缓存不再快速增长。 [GitHub-9458](https://github.com/magento/magento2/issues/9458)

<!-- magento/magento2/pull/33468-->

* 下订单不再导致从清漆缓存中删除与订购产品相关的所有缓存标记。 [GitHub-30128](https://github.com/magento/magento2/issues/30128)

<!-- AC-1478-->

* 当您从顶级类别更新产品或运行索引以更新产品属性或库存状态时，全站点页面缓存不再清除。 以前，清漆缓存会向所有页面缓存标记中添加顶级菜单类别ID。 [GitHub-33465](https://github.com/magento/magento2/issues/33465)

### 购物车和结账

<!-- MC-41494-->

* 最低广告价格 **这是什么？** 购物车页面上的链接现在可点击，并按预期打开信息弹出窗口。 以前，单击此链接不起作用。

<!-- MC-42639-->

* 现在，在启用永久性购物车的部署中，在会话超时后，购物者可以无错误下单。 以前，applicationOpen Source在会话超时后显示付款错误。

<!-- MC-42638-->

* 为客户地址属性分配高排序顺序值不再导致结帐页面上的性能下降。

<!-- MC-42813-->

* Magento Open Source现在会在更新数量无效时，将购物车产品数量还原为上一个值。

<!-- MC-42347-->

* 单击 **添加到购物车** 按钮现在会按照预期重定向到产品详细信息页面。 以前，购物者会被重定向到产品列表页面。

<!-- MC-33705-->

* 现在，来宾购物者可以使用包含多种类型自定义客户地址属性的客户地址成功签出。 以前，在结帐期间显示自定义属性的值时，其格式不正确。 [GitHub-30290](https://github.com/magento/magento2/issues/30290)

<!-- MC-24379-->

* 现在，在启用表费率的情况下，Magento Open Source可以正确地将免费发运阈值应用于订单。 [GitHub-21832](https://github.com/magento/magento2/issues/21832)

<!-- AC-271-->

* 您现在可以使用 `POST /V1/guest-carts/:cartId/items` 向购物车中添加不同选项的简单产品。 以前，此调用会更改您添加的第一个简单产品的数量，而不是添加具有指定选项的第二个简单产品。 [GitHub-32302](https://github.com/magento/magento2/issues/32302)

<!-- AC-1089-->

* 现在，在为 `Poland` 国家/地区 `PLN` 货币。 以前，购物车和结帐页面会显示金额 **0兹罗提**.

<!-- MC-32805-->

* Magento Open Source在购物者单击时不再引发错误 **更新购物车** 在迷你购物车中更改产品数量后。 以前， applicationOpen Source显示以下错误：  `The quote item isn't found. Verify the item and try again`.

<!-- MC-43176-->

* GraphQL `products` 现在，查询特定商店中的可配置产品将仅返回指定商店中产品的价格范围。 以前，请求返回非指定商店上简单产品的价格范围。

<!-- AC-691-->

* Magento Open Source在购物者添加的账单地址缺少street字段时，不再引发此错误： `Uncaught TypeError: Unable to process binding "text: function(){return currentBillingAddress().street.join(', ') }"`. [GitHub-33826](https://github.com/magento/magento2/issues/33826)

<!-- AC-1625-->

* Magento Open Source在从中删除迷你购物车的商店结账期间，不再引发控制台错误。 [GitHub-34513](https://github.com/magento/magento2/issues/34513)

<!-- AC-691-->

* 当帐单地址缺少street字段值或street字段值不是数组时，在付款阶段结帐不再失败。 以前，签出失败，并出现以下错误： `Uncaught TypeError: Unable to process binding "text: function(){return currentBillingAddress().street.join(', ') }"`. [GitHub-33826](https://github.com/magento/magento2/issues/33826)

<!-- ACP2E-10-->

* 现在，当将两个购物车规则应用于满足以下条件的订单时，Magento Open Source可以正确计算折扣：一个购物车规则与优惠券代码和 **整个购物车的固定价格**  条件和第二个购物车价格规则没有优惠券和 **产品价格折扣百分比** 条件。 以前，当前购物车规则已对某些产品应用了折扣时，相关算法无法按比例在购物车产品中正确拆分折扣。

<!-- ACP2E-22-->

* 现在，在优惠券报表网格中可以正确计算总销售额。 以前，销售总额不包括发运金额。

<!-- ACP2E-44-->

* 现在，当购物者在送货方法之间切换时，可正确计算整车折扣。

<!-- ACP2E-159-->

* 的下拉列表 **州** 现在，管理员创建订单页面上的字段由选定国家/地区的预定义值填充。 以前，此字段是输入文本字段，而不是下拉菜单。

<!-- ACP2E-172-->

* Magento Open Source在使用 `addConfigurableProductsToCart` 突变，在更改商店视图后直接将可配置产品添加到购物车。

<!-- ACP2E-176-->

* Magento Open Source在使用 `addConfigurableProductsToCart` 突变，将可配置产品的禁用子项添加到购物车。 以前，applicationOpen Source引发完整性约束冲突错误。

<!-- ACP2E-157-->

* 如果优惠券的应用顺序失败，则优惠券使用值不再更改。  以前，在购物车中应用优惠券后，一次性使用自动生成的优惠券会被标记为无效，但订单未下达。

<!-- ACP2E-137-->

* 已在结帐工作流中添加验证，以比较客户的街道地址与默认值。 如果验证过程识别了更改，则会设置 `customer_address_id` to `null` 将其视为新客户地址。 以前，如果客户在结帐时未进行验证而保存了地址，且同一客户在对结帐字段应用验证后尝试使用相同地址下单，则应用程序开源不接受编辑的地址并引发异常。

### 购物车价格规则

<!-- MC-42288-->

* 现在，在将相关的购物车价格规则与 `auto` 选项。 如果您尝试在未启用 `auto` 选项时，应用程序Open Source会显示以下消息： `Rule is not saved with auto generate option enabled. Please save the rule and try again`.

<!-- MC-42743-->

* 添加了用于确认正确应用购物车价格规则折扣的测试。

<!-- ACP2E-213-->

* 在 **如果在购物车中找到/未找到项目，且满足以下所有/任何条件** 现在，可配置产品可按预期使用。

<!-- ACP2E-225-->

* 现在，可以正确应用购物车价格规则来购买固定价格捆绑产品。 以前，当至少有一个子产品在规则条件中指定的属性集相同时，购物车价格规则不适用于这些产品。

<!-- ACP2E-285-->

* 现在，在为Magento Open Source配置了 **整个购物车的固定金额折扣** 购物车价格规则。 以前， applicationOpen Source显示以下错误：  `report.ERROR: Warning: Division by zero in /home/mer33515/public_html/ee24develop/app/code/Magento/SalesRule/Helper/CartFixedDiscount.php on line 85`.

<!-- ACP2E-306-->

* 更正了 `cart` 在激活具有固定金额折扣的购物车规则时，查询返回的折扣额不准确。

### 目录

<!-- MC-41796-->

* 当产品具有 `datetime` 属性。

<!-- MC-42571-->

* 现在，GraphQL查询会根据子产品的可见性过滤器设置返回可配置产品的子产品的结果。

<!-- MC-41853-->

* Magento Open Source在可配置产品属性发生更改时，不再修改相关产品价格。 以前，可配置产品的最低广告价格(MAP)会覆盖商店前相关产品的价格。

<!-- MC-41796-->

* 当产品具有 `datetime` 属性。

<!-- MC-42132-->

* 管理员产品网格和过滤器的下拉/多选属性值现在可以按照预期从管理员设置中派生。 以前，属性值是从默认存储设置派生的。

<!-- MC-43010-->

* GraphQL类别查询会按照预期返回有关暂存类别更改的信息。

<!-- AC-711-->

* 现在，在部署中，如果产品同时分配给父类别及其子类别，但在每个类别中的不同位置，则可以在管理员中准确显示产品列表。 以前，产品列表渲染失败，并出现以下错误： `Item (Magento\Catalog\Model\Product\Interceptor) with the same ID "<ID>" already exists`. [GitHub-33145](https://github.com/magento/magento2/issues/33145)

<!-- AC-1148-->

* 现在，可以为新产品分配具有许多选项的多选属性（超过150个）。 以前，属性选项保存在 `catalog_product_entity_varchar` 表格，并且并非所有选项都存在，因为您在管理员中重新打开产品时。 [GitHub-33486](https://github.com/magento/magento2/issues/33486)

<!-- AC-904-->

* 添加了对路由器无法实例化从URL收集的操作类的情况的验证。 应用程序开源现在显示标准错误消息。 以前， applicationOpen Source显示以下错误：  `PHP Error: Cannot instantiate abstract class Magento\Catalog\Controller\Product\Compare`.

<!-- ACP2E-115-->

* 将许多产品（大约10,000个）分配到某个类别不再导致浏览器崩溃。

<!-- ACP2E-122-->

* 无论是从管理员还是导入，图像属性现在都始终保存在数据库中。 以前，图像替换文本值的保存方式不一致。 如果图像存在，并且标签设置为null，则不会在数据库中重置标签值。

<!-- ACP2E-155-->

* 目录小组件SQL查询已得到优化。 以前，大型MySQL查询会减缓页面加载速度并导致MySQL中断。

<!-- ACP2E-165-->

* 现在，可配置的无现货产品可正确使用价格过滤器。 以前，无现货可配置产品无法在其正确价格范围内显示。

<!-- ACP2E-330-->

* 在部分索引过程中，更新子产品不再删除从其父可配置产品继承的目录规则折扣。 以前，当我们将可配置产品分配给类别，而不是其关联的简单产品，然后使用该类别创建目录规则时，应用程序开源在部分索引过程中删除了分配给简单产品的目录规则。

<!-- ACP2E-216-->

* 现在，在添加产品选项时，分组和可配置产品的网格视图列表仅包含简单和虚拟产品。 以前，应用程序包含带选项的简单产品。

### 目录规则

<!-- MC-41807-->

* 每天更新目录规则不再导致性能下降。 以前，部分目录产品价格指数没有删除旧价格或日期。

<!-- MC-38263-->

* Magento Open Source在部分重新索引期间不再删除可配置产品上的目录价格规则。 以前，在重新编入可配置产品的索引时，只会重新编入子产品的索引。

<!-- ACP2E-331-->

* 目录价格规则 **category不是category_id** 条件现在适用于不属于任何类别的产品。

### 可配置产品

<!-- MC-42188-->

* 现在，可配置的产品选项标签名称基于在管理员订单创建期间选定的商店视图。 以前， applicationOpen Source使用默认存储视图中的标签名称。

<!-- MC-42187-->

* 现在，当启用了用于显示缺货产品的全局标记时，产品列表可以正确包含缺货产品的子产品。 以前，如果启用此标志后，多个子产品选项中的一个出现缺货，则产品列表不包含子产品。

<!-- MC-42340-->

* 您现在可以使用 `addConfigurableProductsToCart` 突变，在非默认的商店视图中将可配置产品添加到购物车。 以前，当网站ID和商店ID不同时，您无法将可配置产品添加到购物车。 [GitHub-30948](https://github.com/magento/magento2/issues/30948)

<!-- MC-43051-->

* GraphQL `products` 查询不再返回有关可配置产品禁用的子产品的数据。

<!-- ACP2E-101-->

* 为可配置产品创建新配置不再覆盖现有配置中的更改。 以前，现有变量的状态会使用默认状态来覆盖 `enabled` 生成新变量之后。

<!-- ACP2E-175-->

* 当您尝试将可配置产品的禁用子项添加到购物车时，Magento Open Source不再引发内部错误。

### 客户

<!-- MC-24204-->

* Magento Open Source现在在创建订单时考虑网站的管理员区域设置范围。 以前，订单详细信息（如客户地址属性）仅在一个网站上的多站点部署中正常工作。 [GitHub-23254](https://github.com/magento/magento2/issues/23254)

### 电子邮件

<!-- MC-42592-->

* 现在，当客户尝试使用无效的电子邮件帐户登录时，结帐登录弹出窗口中的电子邮件字段验证错误与客户登录页面上的电子邮件验证错误匹配。

<!-- MC-42764-->

* Magento Open Source在管理员和 **通知客户** 复选框。 以前，发送确认电子邮件包含以下消息： `We're sorry, an error has occurred while generating this content`.

<!-- MC-42486-->

* 现在，可以在电子邮件模板中正确转换区域ID和国家/地区ID值。 以前，当您单击 **预览链接** 在管理员电子邮件模板中，国家/地区和区域名称未正确显示。

<!-- MC-36262-->

* 从管理员发送的针对非默认商店视图的销售更新电子邮件现在包含正确的订单状态标签。 以前，这些电子邮件始终显示默认商店的状态。 [GitHub-29263](https://github.com/magento/magento2/issues/29263)

<!-- AC-721-->

* Magento Open Source现在包括 `Content-Disposition: inline` 电子邮件中的标头（如预期）。 [GitHub-29258](https://github.com/magento/magento2/issues/29258)

<!-- magento/magento2/pull/32720-->

* 现在，在使用Microsoft Outlook和MS Exchange Server的部署中，订单和发运通知电子邮件可按预期工作。 以前，电子邮件正文为空，但包含标有ATT*的附件。 [GitHub-25076](https://github.com/magento/magento2/issues/25076)

<!-- ACP2E-47-->

* 订购电子邮件现在包含使用购物者区域设置按预期进行本地化的数据。 以前，使用“管理员”区域设置订购电子邮件。

<!-- ACP2E-107-->

* 现在，单击任何电子邮件模板的预览可在单独的窗口中按预期打开模板预览。  以前，applicationOpen Source会同时从“电子邮件模板”网格和弹出窗口中打开模板预览。

<!-- ACP2E-127-->

* 从非默认网站发送的异步订单电子邮件现在包含来自相应网站的徽标URL。 以前，这些电子邮件始终包含默认网站或主要网站中的徽标。 (使用 `storeCode` 已将值分配到传递到的第二个数组参数 `UrlInterface` `getUrl` 函数。 此值区分不同商店/网站的URL，并生成正确的 `baseUrl` （适用于发送给客户的电子邮件内容）。

### 框架

<!-- AC-515-->

* 数字和非数字字符串之间的非严格比较现在可以通过将数字转换为字符串并比较字符串来起作用。 数字和数字字符串之间的比较继续像以前一样工作。 这意味着 `0 == "not-a-number"` 现在被视为false。 [GitHub-33780](https://github.com/magento/magento2/issues/33780)

<!-- AC-1338-->

* 帮手 `Magento\Payment\Helper\Data` 不再在构造函数中创建新布局。 以前，当在自定义命令中使用此帮助程序而不指定区域代码时，Magento Open Source会引发错误。 [GitHub-33908](https://github.com/magento/magento2/issues/33908)

<!-- AC-1068-->

* 更新了 `allure-framework/allure-php-api` 编辑器依赖关系。

<!-- MC-42091-->

* 现在，当引导文件中发生异常时，Magento Open Source会返回500响应代码。 以前， applicationOpen Source返回一个200 OK状态代码。 [GitHub-22196](https://github.com/magento/magento2/issues/22196)

<!-- AC-1318-->

* 货币符号现在可以按预期加载到店面产品详细信息页面上。 以前，此符号有时会在JavaScript页面重新加载后消失。

<!-- AC-719-->

* 更新 `symfony/console` 运行时不再导致故障 `bin/magento setup:di:compile`. [GitHub-33595](https://github.com/magento/magento2/issues/33595)

<!-- AC-1504-->

* 向 `.htaccess` 和 `nginx.conf` Magento Open Source分发的PHP 8.x支持的文件。 已删除过时的选项。 [GitHub-34358](https://github.com/magento/magento2/issues/34358)

<!-- MC-42448-->

* 商家现在可以上传多个产品的视频。 现在，仅当上传的文件名包含扩展名时，文件生成过程才会向文件名附加扩展名。 以前，当商家尝试上传，然后为两个不同的产品保存同一视频时，应用程序开源抛出了以下错误： `Notice: Undefined index: extension in /app/7ha7zds7wvqys_stg/vendor/magento/framework/File/Uploader.php on line 699`. 发生此情况的原因是，无论上传的文件名是否具有扩展名，Magento Open Source都尝试将文件扩展名附加到该名称。

<!-- magento/magento2/pull/34106-->

* 更正了 `sprintf(__())` 和 `sprintf(Magento\Framework\Phrase())` 构建以在整个代码库中与PHP 8.x兼容。 以前，applicationOpen Source引发了以下类型的错误： `Expected parameter of type 'string', 'Magento\Framework\Phrase' provided`. [GitHub-34085](https://github.com/magento/magento2/issues/34085)

<!-- AC-1605-->

<!-- MC-42934-->

* 改进了高级搜索查询参数的验证。 [GitHub-33589](https://github.com/magento/magento2/issues/33589)

<!-- ACP2E-69-->

* 正在执行 `bin/magento support:backup:code` 现在可按预期创建备份。 以前，applicationOpen Source创建了备份，但引发了错误。

<!-- ACP2E-82-->

* 已成功执行 `cron` 进程现在的状态为 `success`. 以前， `cron` 进程可能运行两次，因为成功 `cron` 进程被分配 `pending` 状态。

<!-- ACP2E-102-->

* 的 `Magento_Logging` 模块现在支持IPv6。

### 一般修复

<!-- MC-42506-->

* Magento Open Source现在在复制产品时，会根据其定义的范围复制所有产品字段。 以前， **name** 和 **描述** 字段已重置为 `global` 范围。

<!-- MC-42612-->

* Magento Open Source在产品价格为0时，不再对折扣应用增量舍入。 以前，applicationOpen Source计算的折扣额为负。

<!-- MC-42215-->

* 具有 **设置为新** 现在可以成功保存分配了空开始日期和过期结束日期的属性。 以前，当您保存具有以下设置的产品时，applicationOpen Source会引发此错误： `Make sure the To Date is later than or the same as the From Date`.

<!-- MC-42775-->

* 管理员现在可以重试在最长处理时间内运行的操作。 默认最大为12小时。

<!-- MC-42514-->

* 在批量操作处理过程中，由于用户的未确认消息，不再出现管道错误中断。 现在，预取计数属性可为消费者限制这些消息，并避免出现错误。 以前，运行 `bin/magento queue:consumers:start async.operations.all` 生成此错误：  `Broken pipe or closed connection`.

<!-- MC-42075-->

* 现在，在第二次登录尝试失败后，购物者会按预期重定向回登录页面。 以前，在第二次登录尝试失败后，购物者会被重定向到404页面。 [GitHub-32885](https://github.com/magento/magento2/issues/32885)

<!-- magento/magento2/pull/25279-->

* 密码重置令牌有效性已扩展，以避免在提交密码更改页面期间出现争用情况。 [GitHub-29647](https://github.com/magento/magento2/issues/29647)

<!-- AC-1316-->

* 现在尊重分配给新集成的权限。 [GitHub-33347](https://github.com/magento/magento2/issues/33347)

<!-- AC-1328-->

* 更正了影响“联系我们”表单例外日志中剩余消息的回归问题。 [GitHub-34483](https://github.com/magento/magento2/issues/34483)

<!-- magento/magento2/pull/31654-->

* 解决了JavaScript加载客户数据时出现的多个问题。 [GitHub-30498](https://github.com/magento/magento2/issues/30498)

<!-- magento/magento2/pull/33324-->

* 使用 `QuoteIdToMaskedQuoteId` 扩展中的响应时间不再显着增加。 [GitHub-33676](https://github.com/magento/magento2/issues/33676)

<!-- AC-720-->

* 类 `BundleDiscountPrice` in `magento2/app/code/Magento/Bundle/Pricing/Price/ConfiguredPrice.php` 现在已按预期声明。 以前，applicationOpen Source引发此错误： `Class Magento\Bundle\Pricing\Price\BundleDiscountPrice not found`. [GitHub-33334](https://github.com/magento/magento2/issues/33334)

<!-- AC-1239-->

* 现在，由AWS S3适配器编写的转义CSV字段值与其他文件系统适配器编写的数据相匹配。

<!-- MC-43046-->

* 现在支持S3兼容存储。 [GitHub-32114](https://github.com/magento/magento2/issues/32114)

<!-- ACP2E-123-->

* 从一台设备注销不再自动从其他设备注销购物者。

### GraphQL

<!-- PWA-1938-->

* 的 `generateCustomerToken` 和 `revokeCustomerToken` 现在，突变为用户状态提供了正确的缓存ID。 以前，这些突变使用的是无效的 `x-magento-cache-id`，这会降低性能。

<!-- PWA-1506-->

* 的 `setBillingAddressToCart` 突变现在正确使用 `same_as_shipping` 参数来设置帐单地址以匹配预期的送货地址。 以前， applicationOpen Source显示以下错误： `The shipping method is missing. Select the shipping method and try again`. [GitHub-30924](https://github.com/magento/magento2/issues/30924)

<!-- PWA-1980-->

* GraphQL购物车操作现在仅在查询请求时才计算购物车总计。 以前，购物车操作始终计算总计，这是一项资源密集型操作。

<!-- MC-42781-->

* 的 `addProductsToCart` 突变现在只会添加到购物车中的产品，这些产品被分配到在标题中定义的商店。

<!-- MC-42783-->

* `products` 使用分层导航过滤器的查询现在可返回正确的子类别列表。 [GitHub-33387](https://github.com/magento/magento2/issues/33387)

<!-- MC-42831-->

* 返回 `ConfigurableCartItem` 对象包含有关已配置变体的信息（如预期）。

<!-- MC-42082-->

* 的 `products` 查询现在返回配置产品选项值和变量属性值。 以前，这些值在查询响应中为空。

<!-- MC-41794-->

* 的 `products` 现在，当在商店视图级别禁用子产品时，查询可正确筛选捆绑产品。 以前，查询会返回在商店视图级别禁用的子产品。

<!-- MC-42903-->

* 的 `setShippingAddressesOnCart` 变异现在支持在购物车上设置具有空电话号码值的送货地址(当 **显示电话** 管理员配置设置设置为可选。 以前，applicationOpen Source引发此错误： `Field CartAddressInput.telephone of required type String! was not provided`.

<!-- MC-42970-->

* 更正了 `addSimpleProductsToCart` 突变允许您将简单产品添加到未分配给目标网站的购物车。

<!-- MC-42600-->

* MySQL查询已针对GraphQL优化 `products` 使用搜索参数优化搜索结果的查询。

<!-- MC-43189-->

* 的 `addConfigurableProductToCart` 如果产品未包含在请求的范围中，则突变不再支持将产品添加到购物车。

<!-- MC-42666-->

* 的 `products` 查询现在只返回分配给请求存储视图的可配置变体。 以前，会返回所请求可配置产品的所有变体。

<!-- MC-42652-->

* `addSimpleProductsToCart` 现在，请求可以并行成功运行。 以前，对同一SKU的多个请求会为同一购物车ID创建重复的行项目，而不是按预期增加产品数量。

<!-- AC-856-->

* 的 `addProductsToCompareList` 突变现在可用于比较可配置产品的变体。

<!-- MC-42443-->

* 从后端更新层产品的价格时，客户购物车上的新价格会正确更新。 以前，尽管购物车摘要部分中的小计已正确更新，但行小计未更新。

<!-- AC-697-->

* 的 `addProductsToCart` 现在，当用于添加具有多个选择选项的捆绑产品时，突变会将所有选定选项添加到购物车。 以前，变异只增加了最后一个选择。 [GitHub-33123](https://github.com/magento/magento2/issues/33123)

<!-- MC-38815-->

* 当可选电话字段的值设置为空字符串时，GraphQL查询现在会按预期返回帐单地址。 以前，查询返回的地址值为null。 [GitHub-30218](https://github.com/magento/magento2/issues/30218)

<!-- ACP2E-51-->

* 的 `products` 当多个产品具有相同的相关性或价格值时，查询响应现在会根据指定的排序顺序列出产品。

<!-- ACP2E-75-->

* 并发 `addSimpleProductsToCart` 和 `addProductsToCart` 请求不再产生重复的报价项目。

<!-- ACP2E-76-->

* `products` 查询分层导航过滤器现在可返回正确的子类别列表。 现在，只有直接子类别才会包含在 `includeDirectChildrenOnly` 标记在请求中提供。 以前，当产品被分配到多个类别时，聚合部分中的响应中会包含所有类别。

<!-- ACP2E-132-->

* 为GraphQL搜索查询添加了搜索建议功能。

<!-- ACP2E-288-->

* 的 `OrderAddress.telephone` 字段现在为可选字段 `customer` 查询或其他查询和突变，这些查询和突变会返回或修改客户订单地址。

<!-- ACP2E-278-->

* 现在，当通过API更改组ID时，可在店面和管理员中为指定组中的客户正确更新价格。 以前，当通过API更改组ID时，这些价格未正确更新。

### 图像

<!-- MC-42080-->

* 在叠加的透明产品图像上，具有透明背景的水印图像不再具有白色背景。 以前，当水印图像和产品图像均具有透明背景时，水印以白色背景显示。

<!-- AC-1240-->

* 现在，在启用AWS S3时，将按预期上传和显示发票和发运收据的徽标。

<!-- MC-42160-->

* 与添加到部署中CMS页面（其中管理员设置为与存储URL不同的域）的图像关联的媒体标记现在按预期包含存储URL。 以前，媒体标记包含静态管理员URL，而不是预期的存储URL。 [GitHub-32930](https://github.com/magento/magento2/issues/32930)

<!-- ACP2E-315-->

* Magento Open Source在店面上同时加载图像时，刷新图像缓存不再引发错误。

### 导入/导出

<!-- AC-1486-->

* `bin/magento remote-storage:sync` 当文件名相似但只有一个或两个字符不同时，将不再失败。 以前，第一个图像存储正确，但第二个名称类似的图像触发了同步失败，并出现以下错误： `Notice: Undefined index: media/catalog/product/5/_ in /src/vendor/magento/module-remote-storage/Driver/Adapter/Cache/Generic.php on line 197`. [GitHub-34337](https://github.com/magento/magento2/issues/34337)

<!-- MC-41672 23734-->

* Magento Open Source现在会在计划导出后将导出文件名中的时间戳转换为用户的时区。 以前，这些值不会进行转换，Magento Open Source会显示UTC时间戳。

<!-- MC-42330-->

* 当多次导入同一CSV文件时，Magento Open Source将不再在远程存储中创建重复的图像。

<!-- AC-1045-->

* 导入不再失败，并出现以下消息： `Import failed: Area code not set: Area code must be set before starting a session`. [GitHub-16171](https://github.com/magento/magento2/issues/16171)

<!-- AC-988-->

* 现在，您可以在运行后成功导入 `bin/magento app:config:dump` 和手动编辑 `config.php`. [GitHub-31428](https://github.com/magento/magento2/issues/31428)

<!-- MC-41672-->

* 现在，在自定义多选属性中可以使用非默认的多个值分隔符。 以前，导入期间验证失败。 [GitHub-23156](https://github.com/magento/magento2/issues/23156)

<!-- ACP2E-86-->

* 现在，在从CSV导入期间，可以正确分配类别中的产品位置。

### 索引

<!-- MC-42791-->

* Magento Open Source现在会在重新索引后的店面上按预期显示产品。 以前，当前重新编入索引的前500个产品有现货，而后500个产品无现货时，店面没有显示任何其他产品。

<!-- magento/magento2/pull/27212-->

* 解决了合并后的一致性问题 `indexer.xml` 文件。 中允许的值 `classType` 现在在未合并和合并中相同 `indexer.xml` 文件。 [GitHub-29609](https://github.com/magento/magento2/issues/29609)

<!-- AC-190-->

* 已在类别索引器中实施了同步机制，以防止完全和部分索引器并行运行。 以前，当这些索引器并行运行时，可能会从店面类别页面中暂时省略产品，或类别页面可能临时清空产品。

### 基础架构

<!-- AC-1172-->

* 不支持的 `str_contains` 方法已被替换为支持的函数。 这是Magento Open Source2.4.3的已知问题。 [GitHub-33680](https://github.com/magento/magento2/issues/33680)

<!-- magento/partners-magento2ee/pull/573-->

* 重构了代码库以更正关键词的使用情况 `match`，这是PHP 8.x中的保留关键词。 [GitHub-33626](https://github.com/magento/magento2/issues/33626)

* HTML标记现在可正确嵌套和关闭，以符合JQuery 3.5.x中对于包括自定义元素在内的非撤消元素的标准。 <!-- AC-1942-->

<!-- magento/magento2/pull/34234)-->

* 已修复 `abs()` 和 `round()` 与PHP7.x和PHP8.x兼容的函数。  [GitHub-34322](https://github.com/magento/magento2/issues/34322)

<!-- AC-719-->

* 更新 `symfony/console` 不再导致运行失败 `bin/magento setup:di:compile`. [GitHub-33595 ](https://github.com/magento/magento2/issues/33595)

<!-- magento/magento2/pull/34175-->

* 更正了 `colinmollenhour/cache-backend-redis` 编辑器依赖关系。 [GitHub-34177](https://github.com/magento/magento2/issues/34177)

<!-- magento/magento2/pull/33932 magento/magento2/pull/33992-->

* 对代码库进行了重构，以删除对 `phpunit/phpunit`. [GitHub-33916](https://github.com/magento/magento2/issues/33916)

<!-- MC-42960-->

* Magento Open Source现在在，当管理员具有只读 `pubs/media` 会尝试访问包含图像的产品的产品详细信息页面。 以前，applicationOpen Source引发PHP错误。 [GitHub-32819](https://github.com/magento/magento2/issues/32819)

<!-- AC-853-->

* 所有成员级别 `@api` 在整个代码库中，注释已移到其类中。

<!-- AC-1977-->

* `gift-card Cms` 小组件数据从 `Magento/WidgetSampleData` (Magento Open Source) `Magento/GiftCardSampleData` (Adobe Commerce)。 这解决了在PHP8.1上安装(Magento Open Source)示例数据时出现的问题。

<!-- AC-1001-->

* 在Adobe Stock集成代码库中使用 `@api` 根据需要。 [GitHub-32875](https://github.com/magento/magento2/issues/32875)

<!-- AC-1770-->

* 现在，在使用模拟的预准备语句时，使用本机PHP类型而不是字符串返回整数和结果集中的浮点。 [GitHub-34625](https://github.com/magento/magento2/issues/34625)

<!-- AC-1697-->

* 已禁用从false值自动创建数组，以确保与PHP 8.1兼容。

<!-- AC-1338-->

* 帮手 `Magento\Payment\Helper\Data` 不再在构造函数中创建新布局。 以前，当在自定义命令中使用此帮助程序而未指定区域代码时，应用程序开源会引发错误。 [GitHub-33908](https://github.com/magento/magento2/issues/33908)

<!-- AC-1077-->

* 您现在可以通过 `data` 块实例构造函数的参数 `di.xml`.

<!-- MC-43096-->

* 已优化 `Generator.php` 可读性。 [GitHub-33809](https://github.com/magento/magento2/issues/33809)

<!-- AC-1313-->

* 改进了 `JwsManager` 类来处理直接在标头中设置算法的情况。 以前，此检查会忽略此有效方案。 [GitHub-32636](https://github.com/magento/magento2/issues/32636)

#### JavaScript依赖项更新

<!-- magento/magento2/pull/33871-->

* `jquery-validate` 第三方库 [GitHub-33853](https://github.com/magento/magento2/issues/33853)

<!-- ENGCOM-8667-->

* `Less.js` (v3.13.1) [GitHub-32845](https://github.com/magento/magento2/issues/32845)

#### 库移除和弃用

* 以下库已被删除，因为Magento Open Source2.4.x支持的所有浏览器都对此功能具有内置支持：

   * `es6-collections.js`   <!-- AC-18-->
   * `MutationObserver.js` <!-- AC-15-->
   * `Modernizr` <!-- AC-12-->
   * `FormData.js`

* 删除了未使用的 `jquery.hoverIntent` JavaScript库。 [GitHub-33732](https://github.com/magento/magento2/issues/33732) <!-- AC-97-->

* `lib/internal/Magento/Framework/Filter/Money.php` 已弃用。 它包含 `money_format()` 函数，已在PHP 8.x中删除。 [GitHub-33870](https://github.com/magento/magento2/issues/33870)<!-- magento/magento2/pull/34366)-->

* 删除了已弃用、不支持的 `grunt-autoprefixer` 包。 [GitHub-34037](https://github.com/magento/magento2/issues/34037) <!-- magento/magento2/pull/34032-->

#### 库升级

* 以下库已升级到更新版本：

   * `script.aculo.us` <!-- AC-363-->
   * `Chart.js`  <!-- AC-361-->
   * `moment.js` <!-- AC-11-->
   * `moment-timezone-with-data.js`   <!-- AC-10-->
   * `matchMedia.js` <!-- AC-8-->
   * `underscore.js`  <!-- AC-13-->
   * `PrototypeJS`  <!-- AC-17-->
   * `RequireJS`
   * `LessCSS`

### 发票

<!-- AC-1564-->

* 铸造到 `int` 前缀为字符串时，已删除自动递增的发票ID。 因此，对于带有字符串前缀的数字，发票现在显示0。 [GitHub-34451](https://github.com/magento/magento2/issues/34451)

### 记录

<!-- MC-42360-->

* Magento Open Source不再为在中执行批量操作的失败API调用创建日志条目 **系统** > **批量操作**. 以前，失败的API调用的永久条目会添加到批量操作日志中。

<!-- AC-1607-->

* 不再允许从false值自动创建数组。 [GitHub-34499](https://github.com/magento/magento2/issues/34499), [GitHub-34589](https://github.com/magento/magento2/issues/34589)

### Adobe Commerce编码标准

<!-- magento/magento-coding-standard/pull/219-->

* 已更新 `phpunit/ phpunit` 更新到 `magento-coding-standard` 存储库。 [GitHub-33622](https://github.com/magento/magento2/issues/33622)

<!-- magento/magento2/pull/33858-->

* 更新了 `webonyx/graphql-php` 与Adobe Commerce编码标准存储库中版本^14.9的依赖关系。 [GitHub-32863](https://github.com/magento/magento2/issues/32863)

<!-- magento/magento-coding-standard/pull/322-->

* 添加了新嗅探 `Magento2.PHP.ArrayAutovivification` 到Adobe Commerce编码标准，以识别从false值自动创建数组。 [GitHub-34509](https://github.com/magento/magento2/issues/34509)

<!-- magento/magento-coding-standard/pull/325-->

* 添加了新嗅探 `Magento2.Functions.DeprecatedFunction` Adobe Commerce编码标准。 [GitHub-34547](https://github.com/magento/magento2/issues/34547)

<!-- magento/magento-coding-standard/pull/326-->

* 添加了用于嗅探的已弃用函数 `Magento2.Functions.DiscouragedFunction` 在Adobe Commerce编码标准中。 [GitHub-34548](https://github.com/magento/magento2/issues/34548)

<!-- magento/magento-coding-standard/pull/335-->

* 的 `Magento2.Annotation.MethodAnnotationStructure` 嗅探不再失败，出现误报。 [GitHub-34679](https://github.com/magento/magento2/issues/34679)

### 媒体集

<!-- AC-1054-->

* 的 `bin/magento media-gallery:sync` 在启用了AWS S3的部署中，命令不再失败。

<!-- AC-1000-->

* 现在，当菜单项超过11且 **启用旧媒体集** 配置设置已启用。 [GitHub-33889](https://github.com/magento/magento2/issues/33889)

<!-- MC-42837-->

* 编辑含有多幅图像的产品时，“媒体集”选项卡的加载时间已得到改进。 [GitHub-33434](https://github.com/magento/magento2/issues/33434)

### MFTF

<!-- AC-516-->

* `CURLOPT_POSTFIELDS` 不再接受对象作为数组。 要将对象解释为数组，请执行显式(`array`)cast. 此做法也适用于接受数组的其他选项。 [GitHub-33781](https://github.com/magento/magento2/issues/33781)

* `curl_init()` 现在返回 `CurlHandle` 对象，而不是资源。 的 `curl_close()` 函数不再有效果。 相反， `CurlHandle` 如果实例不再引用，则会自动将其销毁。 [GitHub-33781](https://github.com/magento/magento2/issues/33781)

<!-- AC-1397-->

* 修复了可下载产品的MFTF测试中的错误。 [GitHub-34270](https://github.com/magento/magento2/issues/34270)

<!-- magento/magento2/pull/33530-->

* 已删除 `CliCacheFlushActionGroup` 从 `CatalogSearch`, `GroupedProduct`, `Newsletter`, `Paypal`, `Quote`和 `Review` 模块。 [GitHub-33531](https://github.com/magento/magento2/issues/33531)

<!-- AC-515-->

* 数字和非数字字符串之间的非严格比较现在可以通过将数字转换为字符串并比较字符串来起作用。 数字和数字字符串之间的比较继续像以前一样工作。 这表示0 ==“非数字”现在被视为false。 [GitHub-33780](https://github.com/magento/magento2/issues/33780)

<!-- AC-517-->

* `parse_url()` 现在，可区分缺失和空查询及片段。 [GitHub-33782](https://github.com/magento/magento2/issues/33782)

<!-- magento/magento2-functional-testing-framework/pull/873-->

* 更新了代码库，以避免在使用 `ReflectionType::isBuiltin()` 方法。 [GitHub-34194](https://github.com/magento/magento2/issues/34194)

#### 新操作组

`AdminCheckOrderStatusInGridActionGroup` [GitHub-33747](https://github.com/magento/magento2/issues/33747)

`StorefrontSelectFirstShippingMethodActionGroup` [GitHub-33773](https://github.com/magento/magento2/issues/33773)

`AdminClickUpdateChangesOnCreateOrderPageActionGroup` [GitHub-33689](https://github.com/magento/magento2/issues/33689)

#### 操作组

在这些测试中，重复操作已被替换为操作组：

`AdminAddInStockProductToTheCartTest` [GitHub-34512](https://github.com/magento/magento2/issues/34512)

`AdminAddBundleItemsTest` [GitHub-34312](https://github.com/magento/magento2/issues/34312)

`AdminConfigurableProductAddConfigurationTest` [GitHub-34511](https://github.com/magento/magento2/issues/34511)

`AdminConfigurableProductBulkUpdateTest` [GitHub-34435](https://github.com/magento/magento2/issues/34435)

`AdminConfigurableProductDisableAnOptionTest` [GitHub-34511](https://github.com/magento/magento2/issues/34511)

`AdminConfigurableProductOutOfStockAndDeleteCombinationTest` [GitHub-34316](https://github.com/magento/magento2/issues/34316)

`AdminConfigurableProductOutOfStockTestDeleteChildrenTest` [GitHub-34316](https://github.com/magento/magento2/issues/34316)

`AdminConfigurableProductRemoveAnOptionTest` [GitHub-34511](https://github.com/magento/magento2/issues/34511)

`AdminConfigurableProductRemoveConfigurationTest` [GitHub-34511](https://github.com/magento/magento2/issues/34511)

`AdminCreateAndEditSimpleProductSettingsTest` [GitHub-34435](https://github.com/magento/magento2/issues/34435)

`AdminCreateAndEditVirtualProductSettingsTest` [GitHub-34435](https://github.com/magento/magento2/issues/34435)

`AdminCreateInactiveFlatCategoryTest` [GitHub-34490](https://github.com/magento/magento2/issues/34490)

`AdminCreateInactiveInMenuFlatCategoryTest` [GitHub-34510](https://github.com/magento/magento2/issues/34510)

`AdminCreateDuplicateCategoryTest` [GitHub-34414](https://github.com/magento/magento2/issues/34414)

`AdminCreateDuplicateProductTest` [GitHub-34414](https://github.com/magento/magento2/issues/34414)

`AdminDeleteSimpleProductTest` [GitHub-33783](https://github.com/magento/magento2/issues/33783)

`AdminEditRelatedBundleProductTest` [GitHub-34313](https://github.com/magento/magento2/issues/34313)

`AdminMassDeleteBundleProductsTest` [GitHub-34313](https://github.com/magento/magento2/issues/34313)

`AdminNavigateMultipleUpSellProductsTest` [GitHub-34314](https://github.com/magento/magento2/issues/34314)

`AdminSimpleProductSetEditContentTest` [GitHub-34435](https://github.com/magento/magento2/issues/34435)

`AdminSimpleProductTypeSwitchingToConfigurableProductTest` [GitHub-33788](https://github.com/magento/magento2/issues/33788)

`AdminConfigurableProductTypeSwitchingToVirtualProductTest` [GitHub-33788](https://github.com/magento/magento2/issues/33788)

`AdminCreateConfigurableProductWithDisabledChildrenProductsTest` [GitHub-33775](https://github.com/magento/magento2/issues/33775)

`AdminUpdateFlatCategoryAndAddProductsTest` [GitHub-34490](https://github.com/magento/magento2/issues/34490)

`AdminUpdateTopCategoryUrlWithNoRedirectTest` [GitHub-33774](https://github.com/magento/magento2/issues/33774)

`AdminUpdateTopCategoryUrlWithRedirectTest` [GitHub-33774](https://github.com/magento/magento2/issues/33774)

`CatalogProductListWidgetOperatorsTest`  [GitHub-34579](https://github.com/magento/magento2/issues/34579)

`CreateProductAttributeEntityWithReservedKeysTest`[GitHub-34422](https://github.com/magento/magento2/issues/34422)

`EnableDisableBundleProductStatusTest` [GitHub-34313](https://github.com/magento/magento2/issues/34313)

`StorefrontCheckRefundGrandTotalActionGroup` [GitHub-34315](https://github.com/magento/magento2/issues/34315)

`StorefrontInactiveCatalogRuleTest` [GitHub-33556](https://github.com/magento/magento2/issues/33556)

`StorefrontConfigurableProductCantAddToCartTest` [GitHub-33786](https://github.com/magento/magento2/issues/33786)

`StorefrontConfigurableProductOptionsTest` [GitHub-33785](https://github.com/magento/magento2/issues/33785)

`StorefrontConfigurableProductCanAddToCartTest` [GitHub-33784](https://github.com/magento/magento2/issues/33784)

`StorefrontConfigurableProductGridViewTest` [GitHub-34311](https://github.com/magento/magento2/issues/34311)

`StorefrontConfigurableProductListViewTest` [GitHub-34311](https://github.com/magento/magento2/issues/34311)

`StorefrontProductNameWithHTMLEntitiesTest` [GitHub-33806](https://github.com/magento/magento2/issues/33806)

`StorefrontProductNameWithDoubleQuoteTest` [GitHub-32991](https://github.com/magento/magento2/issues/32991)

#### 新测试

`AdminCreateOrderWithCheckedAppendCommentCheckboxTest` [GitHub-32381](https://github.com/magento/magento2/issues/32381)

`CheckoutWithEnabledCaptchaTest` [GitHub-32991](https://github.com/magento/magento2/issues/32991)

`StorefrontAddProductWithBackordersAllowedOnProductLevelToCartTest` [GitHub-33635](https://github.com/magento/magento2/issues/33635)

`StorefrontGiftMessageForOrderOnCheckoutCartPageTest` [GitHub-32821](https://github.com/magento/magento2/issues/32821)

`StorefrontCaptchaCheckoutWithEnabledCaptchaTest` [GitHub-32821](https://github.com/magento/magento2/issues/32821)

`StorefrontCheckoutWithEnabledMinimumOrderAmountOptionTest` [GitHub-33460](https://github.com/magento/magento2/issues/33460)

#### 重构测试

`CaptchaWithDisabledGuestCheckoutTest` [GitHub-30828](https://github.com/magento/magento2/issues/30828)

### 新闻稿

<!-- ACP2E-147-->

* 现在，具有适当权限的用户可以按预期管理客户新闻稿订阅。 以前，只有具有完全权限的管理员才能在“管理员客户帐户”页面上管理客户新闻稿订阅。

### 订购

<!-- MC-41981-->

* 现在，购物者可以从店面和管理员中成功重新订购包含产品的现有订单，这些订单包含自定义选项类型为“file”（文件类型）和类型下拉列表的组合。 以前，applicationOpen Source引发错误，未处理重新排序。

<!-- MC-42332-->

* 管理员订单详细信息页面现在按预期加载。 以前，applicationOpen Source在加载具有特定税的订单的订单详细信息页面时引发以下错误： `Call to a member function getId() on array`.

<!-- MC-38521-->

* 具有限制权限（包括订单和发运权限）的管理员现在可以按预期查看订单页面。 以前，当具有这些权限的管理员尝试查看订单时，applicationOpen Source会引发错误。 [GitHub-14633](https://github.com/magento/magento2/issues/14633)

<!-- ACP2E-74-->

* 如果设置了允许的最大数量限制，购物者现在可以下订单，该订单中包含子可配置产品。

## 付款方法

<!-- AC-1830-->

* 在启用了3DS的部署中，购物者现在可以使用Braintree来使用未设置区域的帐单地址下订单。 以前，当购物者单击时，结帐将冻结 **下单**，且无法完成购买。 [GitHub-34204](https://github.com/magento/magento2/issues/34204)

<!-- AC-1229-->

* 现在支持维恩莫付款选项。

<!-- AC-1228-->

* PayPal现在可以通过BN代码跟踪。

<!-- AC-493-->

* `bin/magento setup:upgrade` 现在，从Magento Open Source2.4.2-p1升级时可以按预期运行。 以前，applicationOpen Source引发此错误： `Unable to apply data patch Magento\Paypal\Setup\Patch\Data\UpdateBmltoPayLater for module Magento_Paypal`. [GitHub-33678](https://github.com/magento/magento2/issues/33678)

<!-- MC-42830-->

* 现在，正确的商店ID可用于在管理员订单投放期间检索已保存的信用卡。 现在，根据网站范围配置设置，在下单期间会显示存储的信用卡。 以前，当管理员尝试从管理员为客户创建订单并选择存储的信用卡方法时，存储的信用卡没有可用的选项。

<!-- AC-344-->

* 已解决PayPal信用卡金额显示异常问题。 以前，启用PayPal信用并配置多个礼品卡金额时，如果购物者更改了礼品卡值的金额，则店面不会更新分期付款的金额。 这是Magento Open Source2.4.3中的已知问题。

### PayPal

<!-- MC-42154-->

* Magento Open Source在使用PayPal Express付款方法结账期间不再显示错误。 以前，尽管结帐过程已完成，但应用程序Open Source会显示以下错误： `Something went wrong`.

<!-- AC-722-->

* PayPal Express现在可以按预期从购物车运行。 以前，当您单击 **PayPal** 按钮以从购物车开始快速结帐，应用程序开源程序抛出此错误：  `To check out, please sign in with your email address`. [GitHub-33445](https://github.com/magento/magento2/issues/33445)

<!-- MC-42279-->

* PayPal Payflow Pro现在在PayPal Payflow Pro网关具有 **付款活动** 设置为 **授权**. A **销售** 交易会按照预期发送到Payflow，其父交易ID为在结帐时创建的保管库令牌。 以前， **延迟捕获**  交易记录已创建并发送到PayPal Payflow。 [GitHub-33445](https://github.com/magento/magento2/issues/33445)

<!-- MC-42442-->

* 现在，使用PayPal Payments Advanced付款完成付款后，购物者将按照预期重定向到成功页面。 以前，即使已成功处理付款且未记录任何错误，购物者也不会被重定向到此页面。

### 性能

<!-- MC-42158-->

* 模块列表加载执行时间已得到改进。

<!-- AC-932-->

* 热门搜索词缓存的性能已得到改进。 以前，越大 `search_query` 表中，完成搜索查询所花费的时间越长。 [GitHub-27559](https://github.com/magento/magento2/issues/27559)

<!-- MC-42892-->

* Magento Open Source默认情况下会在产品保存期间同步调整图像大小。 商家现在可以通过对 `di.xml` 文件。

<!-- ENGCOM-9168-->

* 在多商店部署中，类别产品索引器的性能已得到改进。 [GitHub-33984](https://github.com/magento/magento2/issues/33984)

<!-- AC-1179-->

* 用于 `glob()` 系统调用通过减少 `glob()` 调用。  [GitHub-34025](https://github.com/magento/magento2/issues/34025)

<!-- ACP2E-63-->

* 异步订单网格重新索引过程的性能已得到改进。

<!-- ACP2E-117-->

* 优化了产品导出期间的内存消耗。

### 定价

<!-- MC-42243-->

* 现在，当产品价格接近或等于零且启用了共享目录时，价格排序会按预期工作。 以前，在重新编制价格指数期间，零层价格被忽略。

### ProductAlert

<!-- MC-41917-->

* 新 `product_alert` 消费者通过创建队列消息、运行消费者并缩短执行时间，改进了客户警报的发送。 以前， applicationOpen Source在发送超过100,000个产品警报时引发内存不足异常。 应用程序开源还花费了20多小时来发送所有警报。

<!-- ACP2E-87-->

* 如果“类别”页面上的价格过滤器不包含第二个值，则Magento Open Source不再引发错误。 以前，applicationOpen Source在日志文件中引发异常。

### 产品视频

<!-- MC-42105-->

* Magento Open Source现在启用 **保存** 添加视频时输入不完整的URL时，按钮和自动结束字段(管理员 **目录**  > **产品** > **添加视频**)。 以前， **保存** 按钮被禁用，且未填充字段。

### 评论

* 产品列表视图现在显示产品的正确星号评级。 [GitHub-30196](https://github.com/magento/magento2/issues/30196)

<!-- ACP2E-89-->

* 现在，当购物者点击时，可按预期查看 **审阅** 在店面产品页面上。

<!-- ACP2E-111-->

* 现在，产品星级评级在店面产品列表页面上的网格视图和列表视图中保持一致。 以前，同一产品在网格视图和列表视图模式中可能具有不同的评级。

### 销售

<!-- MC-42025-->

* 升级到MariaDB 10.2.34后，具有大数据集的表在异步模式下进行销售网格更新的性能已得到改进。

<!-- MC-42531-->

* Magento Open Source现在会按照预期从店面删除HTML标记 **帐户** > **我的命令** > **查看顺序** 页面。 以前，applicationOpen Source会在店面客户订单评论部分显示HTML标记。

<!-- MC-42377-->

* 自动测试范围，以验证是否存在 `sales_shipment_grid.order_id` 已添加。

<!-- MC-43163-->

* `POST V1/orders` 调用现在可更新扩展属性，且无错误。 以前，会发生SQL语法错误。

### 搜索 {#search-heading}

<!-- MC-42799-->

* 价格范围的分层导航选项现在可在自定义价格属性中按预期使用。 在筛选自定义价格属性时，应用程序开源使用价格导航步骤的配置。 以前， applicationOpen Source使用手动步骤配置。

<!-- MC-42545-->

* 现在，无论目录中有多少个可用类别，店面都会在分层导航中显示当前类别的所有子类别。

<!-- MC-41706-->

* Elasticsearch目录搜索现在不区分变音。 以前，搜索不带重音的术语时，结果与搜索具有相同重音的术语时的结果不同。

<!-- ACP2E-8-->

* 现在，可以在包含特殊字符的SKU属性上正确设置搜索权重。

<!-- ACP2E-36-->

* `category_name` 已添加到系统保留的产品属性代码中。 如果用户尝试使用属性代码创建产品属性，应用程序开源现在会显示错误 `category_name`. 以前，产品未列在预期类别中，并且记录了Elasticsearch错误。

<!-- ACP2E-68-->

* 热门搜索词现在在每次GraphQL搜索查询后进行更新。

<!-- ACP2E-249-->

* Magento Open Source现在向Elasticsearch价格指数映射中添加了正确的价格字段。 以前，在使用商店ID而不是网站ID的索引中添加了不正确的价格字段。

### 装运

<!-- MC-42758-->

* 发运电子邮件现在仅包含当前发运的跟踪编号。 以前，当订单包含多批发运时，每个发运的电子邮件包含与订单相关的所有发运的跟踪编号。

<!-- MC-42396-->

* 现在，当购物者在多次送货模式下从购物车中删除产品，然后切换到单次送货地址时，Magento Open Source会成功更新迷你购物车。 以前，产品价格未按预期更新。

<!-- AC-267-->

* 现在，使用S3存储适配器时，表速率的导入可按预期工作。 以前， applicationOpen Source显示以下错误： `File "https://[bucket].s3.eu-central-1.amazonaws.com/[prefix]/tmp/phpLjGmHf" not found`. [GitHub-33072](https://github.com/magento/magento2/issues/33072)

<!-- magento/magento2/pull/33232-->

* 您现在可以按照预期从 **商店**  > **配置**  >  **销售**  >  **销售电子邮件**. [GitHub-33165](https://github.com/magento/magento2/issues/33165)

<!-- ACP2E-31-->

* Magento Open Source现在在“管理员”和“店面发票”页面合计中显示免费装运成本(0)。 以前，当订单的发运为零时，应用产品开放源不会在发票页发运合计上显示总发运金额。

<!-- ACP2E-120-->

* 对在线运输承运人的费率请求已从多个请求减少到一个。 现在，可以正确计算每个项目/包的包保险和处理价格。 以前，applicationOpen Source显示FedEx发运方法的发运费率不正确。

<!-- ACP2E-174-->

* Magento Open Source现在在为从波多黎各发货创建发货标签时显示UPS费率。 以前， applicationOpen Source不显示这些UPS费率。

<!-- ACP2E-227-->

* 现在，在从输入框中删除后，将完全按预期清除送货街道地址。 以前，在删除地址后，文本框会保留一个或多个字符。

### 存储

<!-- MC-42884-->

* 现在，在包含不同URL上的多个商店的部署中，“以客户身份登录”功能可按预期工作。 以前，applicationOpen Source不加载正确的存储，即使访问正确的存储域也是如此。

### 税

<!-- MC-41924-->

* 现在，当客户在选择送货到多个地址后删除某个项目时，Magento Open Source会正确计算小型购物车小计。

<!-- MC-41945-->

* 当购物车仅包含虚拟产品时，Magento Open Source现在在所有结帐页面上显示相同的税率。

<!-- AC-714-->

* 可配置产品的层价现在在店面上显示准确的包含和排除的税值。 以前，包含的税和排除的税都显示相同的值。 [GitHub-33673](https://github.com/magento/magento2/issues/33673)

### 测试

<!-- magento/magento2/pull/34798-->

* WebAPI测试现在与PHP 8.1兼容。 [GitHub-34653](https://github.com/magento/magento2/issues/34653)

<!-- magento/magento2/pull/34820-->

* 集成测试现在与PHP 8.1兼容。 [GitHub-34567](https://github.com/magento/magento2/issues/34567), [GitHub-34569](https://github.com/magento/magento2/issues/34569)

<!-- AC-1225-->

* 商家现在可以测试购物者所在国家/地区的购物者体验，而不是商家所在的地点。

* 功能测试已稳定，以兼容PHP 8.x。 [GitHub-34327](https://github.com/magento/magento2/issues/34327), [GitHub-34188](https://github.com/magento/magento2/issues/34188)

<!-- magento/magento2/pull/34198-->

* 修复了WebAPI测试中的功能问题。 [GitHub-34196](https://github.com/magento/magento2/issues/34196)

<!-- AC-1207-->

* 修复了导致误报静态测试的错误。 [GitHub-34056](https://github.com/magento/magento2/issues/34056)

<!-- magento/magento2/pull/34300-->

* 更新了 `call_user_func_array`. [GitHub-34301](https://github.com/magento/magento2/issues/34301)

<!-- AC-1978-->

* 的 `Magento\GraphQl\CatalogGraphQl\ProductSearchTest` 使用AWSElasticsearch运行时，测试不再引发此错误： `Magento\GraphQl\CatalogGraphQl\ProductSearchTest::testSearchSuggestions Failed asserting that an array is not empty. /var/www/html/dev/tests/api-functional/testsuite/Magento/GraphQl/CatalogGraphQl/ProductSearchTest.php:94 /var/www/html/dev/tests/api-functional/framework/Magento/TestFramework/TestCase/GraphQlAbstract.php:257`.

<!-- magento/magento2/pull/33699-->

* 通过重命名所有模拟变量以包含 `Mock` 后缀和删除对已弃用对象管理器类的引用。 [GitHub-33695](https://github.com/magento/magento2/issues/33695)

* 的 `Magento\Framework\MessageQueue\TopologyTest` 测试现在与AWS MQ兼容， [!DNL RabbitMQ] 服务。 以前，此测试失败，并显示以下消息： `Invalid exchange configuration: magento-topic-based-exchange1 Failed asserting that two arrays are equal`. <!-- AC-1248-->

<!-- magento/magento2/pull/34454-->

* 单元测试现在与PHP 8.1兼容。 [GitHub-34441](https://github.com/magento/magento2/issues/34441)

#### 单元测试

以下单元测试已重构为使用 `PHPUnit` 而不是 `AspectMock`:

`AllureHelperTest` [GitHub-33294](https://github.com/magento/magento2/issues/33294)

`ObjectHandlerUtil` [GitHub-33584](https://github.com/magento/magento2/issues/33584)

`MockModuleResolverBuilder` [GitHub-33583](https://github.com/magento/magento2/issues/33583)

`MagentoTestCase`  [GitHub-33582](https://github.com/magento/magento2/issues/33582)

`ModuleResolverTest` [GitHub-33308](https://github.com/magento/magento2/issues/33308)

`ParallelGroupSorterTest` [GitHub-33306](https://github.com/magento/magento2/issues/33306)

`SuiteGeneratorTest` [GitHub-33299](https://github.com/magento/magento2/issues/33299)

`OperationDataArrayResolverTest`  [GitHub-33296](https://github.com/magento/magento2/issues/33296)

### 主题

<!-- MC-41887-->

* 现在，当Magento Open Source在其基本URL中配置了子路径时，可正确显示通知消息。

<!-- MC-42469-->

* 添加了 `aria-label` 元素到storefront page模板，以指示购物者在单击链接时将导航到的页面。 以前，指向不同页面的链接使用相同的链接文本。 [GitHub-33075](https://github.com/magento/magento2/issues/33075)

<!-- ACP2E-73-->

* Magento Open Source在加载具有预先存在的自定义主题的商店主页时不再显示错误消息。 以前， applicationOpen Source会显示以下消息：  `The store will not work correctly in the case when cookies are disabled`.

### 翻译和区域设置

<!-- AC-285-->

* 的 `UserExpiration` 验证器不再失败 `de_DE` 和 `uk_UA` 区域设置。 以前，当管理员尝试从管理员中创建新用户(区域设置为 `de_DE` 或 `uk_UA`. [GitHub-32497](https://github.com/magento/magento2/issues/32497)

<!-- magento/magento2/pull/33787-->

* 现在，在创建或编辑地址表单中，瑞士地区名称始终以英文显示。 [GitHub-32602](https://github.com/magento/magento2/issues/32602)

<!-- magento/magento2/pull/33128-->

* 已更新 `zip_codes.xml` 格恩西岛支持GY10邮编的模式。 [GitHub-33144](https://github.com/magento/magento2/issues/33144)

<!-- AC-1080-->

* 白俄罗斯地区 `directory_country_region` 表。 [GitHub-33924](https://github.com/magento/magento2/issues/33924)

<!-- AC-1178-->

* 解决了运行菲律宾（菲律宾）区域设置的店面显示异常问题。 [GitHub-33996](https://github.com/magento/magento2/issues/33996)

<!-- AC-1308-->

* 现在，在设置为葡萄牙语（葡萄牙）区域设置的商店中创建新帐户时，您可以成功输入客户的出生日期。 以前，Magento Open Source在尝试创建帐户时抛出错误。 [GitHub-34130](https://github.com/magento/magento2/issues/34130)

<!-- ACP2E-457-->

* 现在，产品详细信息页面可成功显示为阿拉伯语（沙特阿拉伯）区域设置。 以前，此区域设置会破坏产品详细信息页面。

### UI

<!-- AC-258-->

* 使用的MFTF测试纠正了错误 `maps.googleapis.com`.

<!-- MC-41850-->

* Magento Open Source现在从“联系我们”表单电子邮件输入字段中裁切非中断空格字符。 以前，提交表单时不会从电子邮件输入中删除非中断空格字符（如果提供），这会导致日志文件中出现错误。 的 **回复** 在发送给存储管理员的“联系人”电子邮件消息中也缺少字段。

<!-- MC-42793-->

* Magento Open Source现在可根据其在管理员中的位置显示相关产品、向上销售产品和交叉销售产品。

<!-- MC-42502-->

* `.action-close` 按钮现在可按预期工作 `Multiselect` 用于模式。 以前， `action-close` 按钮不起作用，因为它继承了  `.action-close` 按钮。 [GitHub-27240](https://github.com/magento/magento2/issues/27240)

<!-- AC-1217-->

* 现在，“产品”视图的主价格字段中提供了丰富的选件代码片段。 以前，在产品视图的相关产品块的此字段中缺少此代码片段，这会导致Google搜索结果显示错误的价格。 [GitHub-34063](https://github.com/magento/magento2/issues/34063)

<!-- AC-1584-->

* 已解决运行iOS的设备上的模态高度问题。 [GitHub-34467](https://github.com/magento/magento2/issues/34467)

<!-- MC-40106-->

* 操作下拉菜单现在可以在整个店面中正确放置。 [GitHub-31379](https://github.com/magento/magento2/issues/31379)

<!-- AC-1589-->

* 解决了在购物车和结帐页面上导航时出现的辅助功能错误。 [GitHub-34483](https://github.com/magento/magento2/issues/34483)

<!-- AC-1289-->

* 屏幕阅读器现在可以阅读产品页面上的所有相关表单元素。

<!-- AC-872-->

* Storefront目录产品小组件排序顺序(**目录** > **类别** > **产品**)现在与管理员中配置的顺序匹配。 [GitHub-27126](https://github.com/magento/magento2/issues/27126)

<!-- AC-725-->

* 现在，区域选择器可在创建帐户页面中按预期工作。 [GitHub-30099](https://github.com/magento/magento2/issues/30099)

<!-- MC-42750-->

* 管理员客户网格现在可显示所有客户数据，包括新添加的数据 `date` 自定义属性（如预期）。 以前，applicationOpen Source引发错误，当 `date` 属性集被设置为列。

<!-- AC-1280-->

* 在 **目录**  >  **产品** 详细信息页面已更改，以准确反映输入的目的。 用户输入不需要的字段不再显示带有星号的标签。

<!-- AC-1275-->

* 现在可以使用Tab键访问富文本编辑器工具栏。

<!-- AC-1284-->

* 控件的辅助名称现在包含其可见标签的文本，用于显示每页面的项目数下拉列表。

<!-- AC-1287-->

* 表格控制 **目录** > **产品** 现在，在折叠表格时，“详细信息”页面具有可见的标签和可访问的名称。

<!-- AC-1285-->

* 整个店面的按钮现在具有唯一且描述性的可访问名称。 以前，带有文本按钮和相邻的向下箭头图标按钮的拆分按钮具有相同的可访问名称。

<!-- AC-1168-->

* 添加了 **今天** 查看“管理员订单和金额”功能板图表的选项，以提供当天的销售和订单汇总。 [GitHub-34008](https://github.com/magento/magento2/issues/34008)

<!-- AC-1481-->

* 多选的活动（单击）状态 **关闭** 按钮现在可以始终如一地工作。 [GitHub-34338](https://github.com/magento/magento2/issues/34338)

<!-- magento/magento2/pull/31879-->

* Magento Open Source在禁用Cookie限制模式后升级后不再显示此消息： `The store will not work correctly in the case when cookies are disabled`. [GitHub-33811](https://github.com/magento/magento2/issues/33811)

<!-- ACP2E-7-->

* 现在，在移动设备上以垂直缩略图导航方向的主题上，可正确显示全屏产品图像。 以前，在全屏模式下，移动设备上具有垂直缩略图导航方向的主题上，产品图像会被错误缩放或不可见。

<!-- ACP2E-23-->

* 当 **将小组件产品与后端存储同步** 配置设置已启用。

<!-- ACP2E-70-->

* 负值的验证已添加到 **退回数量** 字段。

<!-- ACP2E-105-->

* Magento Open Source在购物者点击时不再显示重复的地址 **更改地址** 在部署中， **地址搜索** 配置设置已启用。

<!-- ACP2E-136-->

* 的 **添加产品** 按“管理类别”页面上的“存储视图”范围工作时，对于具有受限权限的管理员，按预期启用按钮。

<!-- ACP2E-169-->

* 现在，视图断点在各个Magento Open Source中保持一致。

<!-- ACP2E-199-->

* Magento Open Source现在可以在“管理员客户”页面上正确显示自定义客户日期属性和自定义区域设置。

<!-- MC-41760-->

* 使用页面生成器添加的图像在使用浏览器窗口宽度768像素显示时，不会再在店面上重复显示。 以前，使用此浏览器窗口宽度，应用程序开源通过显示移动版和桌面版图像在店面上复制图像。

### URL重写

<!-- AC-1510-->

* 在创建新存储视图期间，执行时不再为所有存储视图重新生成URL重写 `bin/magento setup:upgrade`. [GitHub-32954](https://github.com/magento/magento2/issues/32954)

### Web API框架

<!-- MC-42008-->

* 启用永久性购物车后，对自授权客户资源的Web API请求不再引发授权错误。

<!-- MC-42313-->

* 您现在可以使用的子类创建对象 `\Magento\Framework\Api\AbstractSimpleObjectBuilder` 7.3菲律宾比索。以前， `preg_match` 在使用PHP 7.3的Redhat上托管Magento Open Source时，抛出了以下警告消息： `Warning: preg_match(): Compilation failed: unrecognized character follows...`.

<!-- MC-24548-->

* 检索到的总计 `PUT /V1/guest-carts/:cartId/collect-totals` 请求现已更新为正确的 `shippingMethod`. [GitHub-18508](https://github.com/magento/magento2/issues/18508)

<!-- MC-30627 AC-796-->

* 向REST API添加新反序列化器不再删除其他反序列化器。 以前，REST API接受新的内容类型，但CORE为API定义的内容类型不再有效，并返回400错误。 [GitHub-26433](https://github.com/magento/magento2/issues/26433)

<!-- AC-698-->

* 您现在可以删除 `webapi.xml`文件。 [GitHub-33843](https://github.com/magento/magento2/issues/33843)

<!-- AC-1212-->

* Magento Open Source现在生成 `customertoken` 按GraphQL或REST API请求进行的尝试（在连续多次失败的登录尝试后）。 以前， applicationOpen Source不检查 `lock_expires_at` in `oauth_token_request_log` 大于当前日期和时间，并始终返回失败的尝试次数，这会阻止客户永远登录。 [GitHub-34067](https://github.com/magento/magento2/issues/34067)

<!-- AC-1190-->

* 将掩码引号ID添加到 `QuoteRepository::getList` 不再导致无限循环。 以前，使用依赖REST API更新订单的付款处理器会触发此行为。 [GitHub-33675](https://github.com/magento/magento2/issues/33675)

<!-- MC-41612-->

* 的 `/rest/all/V1/categories/<above_created_category_id>`  PUT调用现在遵循 `available_sort_by`.  以前，已选中可用产品列表排序方式下拉列表，其中“类别”页面上包含所有可能的选项， **全部使用** 复选框。 [GitHub-32596](https://github.com/magento/magento2/issues/32596)

<!-- ACP2E-11-->

* 改进了创建客户令牌的REST API请求的性能。

<!-- ACP2E-91-->

* 更正了在 **将存储代码添加到Url** 设置为 **是** 和REST调用不包含存储代码。 尽管有效负载有效，但调用返回了以下错误： `Fatal error: Allowed memory size of ********** bytes exhausted (tried to allocate **** bytes) in vendor/magento/module-store/Model/StoreRepository.php on line 75`.

<!-- ACP2E-153-->

* 现在，可以使用REST API同时创建同一订单的部分发票。

### 愿望列表

<!-- MC-41880-->

* Magento Open Source在 **在侧栏中显示** “希望列表”选项已禁用。 以前，applicationOpen Source忽略此选项。

### 怀西威格

<!-- ACP2E-17-->

* 现在，使用WYSIWYG编辑器，PageBuilder可正确呈现自定义小组件。

## 已知问题

**问题**:在从Adobe Commerce 2.4.4升级到Adobe Commerce 2.4.4-p1期间，商家可能会注意到包版本降级通知。 这些消息可以忽略。 资源包版本之间的差异是由于资源包生成期间出现异常所致。 产品功能未受到影响。 请参阅 [从2.4.4升级到2.4.4-p1后，资源包降级](https://support.magento.com/hc/en-us/articles/8214752983949)  知识库文章，以介绍受影响的情景和解决方法。

**问题**:在“管理员”中未选择任何选项时，购物者无法将产品添加到购物车 **存储** >  **配置** > **常规** > **国家/地区选项** > **允许国家/地区**. 应用程序Open Source会显示以下控制台错误： `Failed to load resource: the server responded with a status of 400 (Bad Request)`. <!-- AC-2564-->

**问题**:论《网络世界》的描写 **查找合作伙伴和扩展** > **Magento Marketplace** 已过时。 以下是更新的描述：

Dotdigital是一个客户参与平台，可帮助数字营销人员和开发人员在整个客户历程中提供通信。 我们利用客户数据的强大功能，在品牌不断发展和扩展时为其提供更高的参与度、转化率和忠诚度。 客户喜欢我们易于使用的平台，该平台可连接跨系统的第一方数据，提供强大的洞察力，并自动执行预测性跨渠道消息。

Dotdigital的350多名员工为全球和各个行业的中端市场和企业公司服务。 我们渴望激励负责任的营销，并致力于可持续性、隐私和安全性。 Dotdigital为成为世界上第一个碳中性营销自动化平台而感到自豪，该平台已通过ISO 14001、ISO 27701和ISO 27001认证。

请参阅 [Dotdigital — 营销自动化](https://marketplace.magento.com/dotdigital-dotdigital-magento2-os-package.html) 以了解购买和下载信息。

## 社区贡献

我们感谢更广泛的Magento Open Source群体，并感谢他们对本稿的贡献。

社区工程团队 [Magento参与者](https://magento.com/magento-contributors) 按月、季度和年维护排名最前的参与个人和合作伙伴列表。 在该“参与者”页面中，您可以在GitHub上跟踪指向其合并PR的链接。

### 合作伙伴贡献

下表重点介绍了合作伙伴的贡献。 此表列出了提供拉取请求的合作伙伴、外部拉取请求编号以及与其关联的GitHub问题编号（如果可用）。

{{$include /help/_includes/release-notes/engcomm-2-4-4-partner.md}}

### 个人参与者贡献内容

下表列出了社区成员的贡献内容。 此表列出了贡献了拉取请求的社区成员、外部拉取请求编号以及与其关联的GitHub问题编号（如果可用）。

{{$include /help/_includes/release-notes/engcomm-2-4-4-issues.md}}

### 系统要求

我们的技术堆栈构建在PHP和MySQL上。 有关更多信息，请参阅 [系统要求](../../../installation/system-requirements.md).

### 安装和升级说明

您可以使用 [编辑器](../../../installation/composer.md).

## 迁移工具包

数据迁移工具可帮助将现有Magento1.x存储数据传输到Magento2.x。此命令行界面包括验证、进度跟踪、日志记录和测试功能。 有关安装说明，请参阅 [安装数据迁移工具](../../../tools/data-migration-tool/install.md). 考虑探索或为 [数据迁移存储库](https://github.com/magento/data-migration-tool).

的 [代码迁移工具包](https://github.com/magento-commerce/code-migration) 帮助将现有Magento1.x存储扩展和自定义项传输到Magento2.x。命令行界面包含用于转换Magento1.x模块和布局的脚本。
