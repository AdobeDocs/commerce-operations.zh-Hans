---
title: 拆分数据库性能解决方案
description: 阅读有关Adobe Commerce和Magento Open Source的拆分数据库解决方案。
source-git-commit: bda758381d8d1b9209110adb168c36e1d504c4fa
workflow-type: tm+mt
source-wordcount: '640'
ht-degree: 0%

---


# 拆分数据库解决方案概述

{#ee-only}

{{deprecate-split-db}}

Adobe Commerce具备多种可扩展性优势，包括能够为商务应用程序的不同功能区域使用三个单独的主控数据库。

结帐、订购和产品数据都可以使用单独的主控数据库，您可以选择复制该数据库。 这种分离方式可根据您的需求，独立地从网站结账、订单管理活动、网站浏览和促销活动中扩展负载。 这些更改在如何缩放数据库层方面提供了相当大的灵活性。

>[!INFO]
>
>云基础架构上的Adobe Commerce _not_ 支持此功能。

的 `ResourceConnections` 类提供与Commerce应用程序的统一MySQL数据库连接。 对于对主控数据库的查询，我们实现了命令查询责任隔离(CQRS)数据库模式。 此模式处理将读和写查询路由到相应数据库的逻辑。 开发人员无需知道正在使用的配置，并且没有单独的读写数据库连接。

如果设置可选的数据库复制，您将获得以下优势：

- 数据备份
- 数据分析而不影响主控数据库
- 可扩展性

MySQL数据库以异步方式复制，这意味着从服务器无需永久连接即可从主控接收更新。

下图显示了此功能的工作方式。

![Adobe Commerce使用不同的数据库来存储表](../../assets/configuration/split-db-diagram-ee.png)

在Magento Open Source中，只使用一个主控数据库。

Adobe Commerce使用三个主控数据库和可配置数量的从数据库进行复制。 Adobe Commerce具有用于数据库连接的单一接口，因此具有更快的性能和更好的可扩展性。

## 配置选项

由于拆分数据库性能解决方案的设计方式，您的自定义代码和安装的组件 _无法_ 执行以下任一操作：

- 直接写入数据库(而必须使用Adobe Commerce数据库接口)
- 使用影响销售或 [报价](https://glossary.magento.com/quote) 数据库
- 在结帐、销售或主数据库中使用表的外键

>[!WARNING]
>
>联系组件开发人员以验证其组件是否执行了上述任何操作。 如果是，则只能选择以下选项之一：
>
>- 要求组件开发人员更新其组件。
>- 按原样使用组件 _无_ 拆分数据库解决方案。
>- 删除组件，以便使用拆分数据库解决方案。


这也意味着您可以：

- 配置拆分数据库解决方案 _之前_ 将商业投入生产。

   Adobe建议在安装商务软件后尽快配置拆分数据库。

- [手动配置](multi-master-manual.md) 拆分数据库解决方案。

   如果已安装组件，或者商务已在生产中，则必须执行此任务。 (_不要_ 更新生产系统；在开发系统中进行更新，并在测试更改后进行同步。)

   >[!WARNING]
   >
   >您必须手动备份另外两个数据库实例。 商务仅备份主数据库实例。 的 [`magento setup:backup --db`](https://devdocs.magento.com/guides/v2.4/install-gde/install/cli/install-cli-backup.html) 命令和管理选项不备份其他表。

## 先决条件

拆分数据库要求您在任何主机上设置三个MySQL主控数据库（商务服务器上的所有三个数据库，单独服务器上的每个数据库，等等）。 这些是 _主控_ 数据库和数据库的使用方式如下：

- 一个主控的数据库 [结账](https://glossary.magento.com/checkout) 表
- 一个主控的销售表数据库(也称为 _订单管理系统_&#x200B;或 _OMS。_，表格)
- 一个主控数据库，用于Commerce 2应用程序表的其余部分

此外，您还可以选择设置任意数量的 _从属_ 用作负载平衡器和备份的数据库。

本指南讨论如何仅设置主控数据库。 我们提供示例配置和参考，以便您根据需要设置从数据库。

在本指南中，将三个主控数据库命名为：

- `magento_quote`
- `magento_sales`
- `magento`

（您可以随意命名数据库。）
